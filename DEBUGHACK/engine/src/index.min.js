/*! For license information please see index.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.wwtlib=e():t.wwtlib=e()}(self,(()=>(()=>{"use strict";var __webpack_modules__={560:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function _ss(){function _nop(){}function isValue(t){return null!=t}function _value(t){for(var e=2,i=t.length;e<i;e++)if(isValue(t[e]))return t[e];return null}function value(t,e){return isValue(t)?t:isValue(e)?e:_value(arguments)}function extend(t,e){for(var i in e)t[i]=e[i];return t}function parseBoolean(t){return"true"==t.toLowerCase()}function parseRegExp(t){if("/"==t[0]){var e=t.lastIndexOf("/");if(e>1){var i=t.substring(1,e),n=t.substr(e+1);return new RegExp(i,n)}}return null}function parseNumber(t){return t&&t.length?t.indexOf(".")>=0||t.indexOf("e")>=0||endsWith(t,"f")||endsWith(t,"F")?parseFloat(t):parseInt(t,10):0}function parseDate(t){var e=Date.parse(t);return isNaN(e)?void 0:new Date(e)}function truncate(t){return t>=0?Math.floor(t):Math.ceil(t)}function now(){return new Date}function today(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())}function compareDates(t,e){return t===e||!(!isValue(t)||!isValue(e))&&t.getTime()==e.getTime()}function _popStackFrame(t){if(isValue(t.stack)&&isValue(t.fileName)&&isValue(t.lineNumber)){for(var e=t.stack.split("\n"),i=e[0],n=t.fileName+":"+t.lineNumber;isValue(i)&&-1===i.indexOf(n);)e.shift(),i=e[0];var r=e[1];if(isValue(r)){var s=r.match(/@(.*):(\d+)$/);isValue(s)&&(e.shift(),t.stack=e.join("\n"),t.fileName=s[1],t.lineNumber=parseInt(s[2],10))}}}function error(t,e,i){var n=new Error(t);if(e)for(var r in e)n[r]=e[r];return i&&(n.innerException=i),_popStackFrame(n),n}function fail(message){console.assert(!1,message),globalThis.navigator&&eval("debugger;")}function toArray(t){return t?"string"==typeof t?JSON.parse("("+t+")"):Array.prototype.slice.call(t):null}function removeItem(t,e){var i=t.indexOf(e);return i>=0&&(t.splice(i,1),!0)}function clearKeys(t){for(var e in t)delete t[e]}function keyExists(t,e){return void 0!==t[e]}function keys(t){if(Object.keys)return Object.keys(t);var e=[];for(var i in t)e.push(i);return e}function keyCount(t){return keys(t).length}function Enumerator(t,e){var i=-1,n=e?e.length:t.length,r=e?function(){return{key:e[i],value:t[e[i]]}}:function(){return t[i]};this.current=null,this.moveNext=function(){return i++,this.current=r(),i<n},this.reset=function(){i=-1,this.current=null}}var _nopEnumerator={current:null,moveNext:function(){return!1},reset:_nop};function enumerate(t){return isValue(t)?t.getEnumerator?t.getEnumerator():void 0!==t.length?new Enumerator(t):new Enumerator(t,keys(t)):_nopEnumerator}function Stack(){this.count=0,this._items=[]}var Stack$={clear:function(){this._items.length=0,this.count=0},contains:function(t){for(var e=this.count-1;e>=0;e--)if(this._items[e]===t)return!0;return!1},getEnumerator:function(){return new Enumerator(this._items.reverse())},peek:function(){return this._items[this.count-1]},push:function(t){this._items.push(t),this.count++},pop:function(){if(this.count)return this.count--,this._items.pop()}};function Queue(){this.count=0,this._items=[],this._offset=0}function _cleanQueue(t){t._items=t._items.slice(t._offset),t._offset=0}var Queue$={clear:function(){this._items.length=0,this._offset=0,this.count=0},contains:function(t){for(var e=this._offset,i=this._items.length;e<=i;e++)if(this._items[e]===t)return!0;return!1},dequeue:function(){if(this.count){var t=this._items[this._offset];return 2*++this._offset>=this._items.length&&_cleanQueue(this),this.count--,t}},enqueue:function(t){this._items.push(t),this.count++},getEnumerator:function(){return 0!=this._offset&&_cleanQueue(this),new Enumerator(this._items)},peek:function(){return this._items.length?this._items[this._offset]:void 0}};function string(t,e){return"number"==typeof e?e>1?new Array(e+1).join(t):t:Array.prototype.join.call(arguments,"")}function emptyString(t){return!t||!t.length}function whitespace(t){return emptyString(t)||!t.replace(/^\s*/,"").length}function compareStrings(t,e,i){return t=t||"",e=e||"",i&&(t=t.toUpperCase(),e=e.toUpperCase()),t===e?0:t<e?-1:1}var _formatPlaceHolderRE=/(\{[^}^{]+\})/g,_formatters={};function format(t){var e=neutralCulture,i=t,n=Array.prototype.slice.call(arguments,1);return t.constructor!=String&&(e=t,i=n[0],n=n.slice(1)),i.replace(_formatPlaceHolderRE,(function(t,i){var r=parseInt(i.substr(1),10),s=n[r];if(!isValue(s))return"";var a=_formatters[typeName(s)];if(a){var o="",l=i.indexOf(":");if(l>0&&(o=i.substring(l+1,i.length-1)),o&&"i"!=o)return a(s,o,e)}return e==neutralCulture?s.toString():s.toLocaleString()}))}function trim(t,e){if(e||!String.prototype.trim){var i=(e=e?e.join(""):null)?new RegExp("^["+e+"]+|["+e+"]+$","g"):/^\s+|\s+$/g;return t.replace(i,"")}return t.trim()}function trimStart(t,e){var i=e?new RegExp("^["+e.join("")+"]+"):/^\s+/;return t.replace(i,"")}function trimEnd(t,e){var i=e?new RegExp("["+e.join("")+"]+$"):/\s+$/;return t.replace(i,"")}function startsWith(t,e){return!!emptyString(e)||!(emptyString(t)||e.length>t.length)&&t.substr(0,e.length)==e}function endsWith(t,e){return!!emptyString(e)||!(emptyString(t)||e.length>t.length)&&t.substr(-e.length)==e}function padLeft(t,e,i){return t.length<e?string(i||" ",e-t.length)+t:t}function padRight(t,e,i){return t.length<e?t+string(i||" ",e-t.length):t}function removeString(t,e,i){return!i||e+i>t.length?t.substr(0,e):t.substr(0,e)+t.substr(e+i)}function insertString(t,e,i){return i?e?t.substr(0,e)+i+t.substr(e):i+t:t}function replaceString(t,e,i){return t.split(e).join(i||"")}function _bindList(t){var e=function(){for(var e=arguments,i=null,n=0,r=t.length;n<r;n++)i=e.length?t[n].apply(null,e):t[n].call(null);return i};return e._fnList=t,e}function bind(t,e){if(!e)return t;var i=null;t="string"==typeof t?e[i=t]:t;var n=i?e.$$b||(e.$$b={}):null,r=n?n[i]:null;return r||(r=function(){return t.apply(e,arguments)},n&&(n[i]=r)),r}function bindAdd(t,e){return t?e?_bindList([].concat(t._fnList||t,e)):t:e}function bindSub(t,e){if(!t)return null;if(!e)return t;var i=t._fnList||[t],n=i.indexOf(e);return n>=0?1==i.length?null:_bindList(i=n?i.slice(0,n).concat(i.slice(n+1)):i.slice(1)):t}function bindExport(t,e,i,n){i=i||"__"+(new Date).valueOf(),n=n||globalThis;var r={name:i,detach:function(){n[i]=_nop},dispose:function(){try{delete n[i]}catch(t){n[i]=void 0}}};return n[i]=e?t:function(){return r.dispose(),t.apply(null,arguments)},r}function EventArgs(){}function CancelEventArgs(){this.cancel=!1}function IDisposable(){}function IEnumerable(){}function IEnumerator(){}function IObserver(){}function IApplication(){}function IContainer(){}function IObjectFactory(){}function IEventManager(){}function IInitializable(){}function StringBuilder(t){this._parts=isValue(t)&&""!==t?[t]:[],this.isEmpty=0==this._parts.length}EventArgs.Empty=new EventArgs;var StringBuilder$={append:function(t){return isValue(t)&&""!==t&&(this._parts.push(t),this.isEmpty=!1),this},appendLine:function(t){return this.append(t),this.append("\r\n"),this.isEmpty=!1,this},clear:function(){this._parts=[],this.isEmpty=!0},toString:function(t){return this._parts.join(t||"")}},_observerStack=[],_observerRegistration={dispose:function(){_observerStack.pop()}};function _captureObservers(t){var e=_observerStack,i=e.length;if(i){t=t||[];for(var n=0;n<i;n++){var r=e[n];t.indexOf(r)<0&&t.push(r)}return t}return null}function _invalidateObservers(t){for(var e=0,i=t.length;e<i;e++)t[e].invalidateObserver()}function Observable(t){this._v=t,this._observers=null}var Observable$={getValue:function(){return this._observers=_captureObservers(this._observers),this._v},setValue:function(t){if(this._v!==t){this._v=t;var e=this._observers;e&&(this._observers=null,_invalidateObservers(e))}}};function ObservableCollection(t){this._items=t||[],this._observers=null}Observable.registerObserver=function(t){return _observerStack.push(t),_observerRegistration};var ObservableCollection$={get_item:function(t){return this._observers=_captureObservers(this._observers),this._items[t]},set_item:function(t,e){this._items[t]=e,this._updated()},get_length:function(){return this._observers=_captureObservers(this._observers),this._items.length},add:function(t){this._items.push(t),this._updated()},clear:function(){this._items.clear(),this._updated()},contains:function(t){return this._items.indexOf(t)>=0},getEnumerator:function(){return this._observers=_captureObservers(this._observers),this._items.getEnumerator()},indexOf:function(t){return this._items.indexOf(t)},insert:function(t,e){this._items.insert(t,e),this._updated()},remove:function(t){return!!this._items.remove(t)&&(this._updated(),!0)},removeAt:function(t){this._items.splice(t,1),this._updated()},toArray:function(){return this._items},_updated:function(){var t=this._observers;t&&(this._observers=null,_invalidateObservers(t))}};function Task(t){this._continuations=void 0!==t?(this.status="done",null):(this.status="pending",[]),this.result=t,this.error=null}var Task$={get_completed:function(){return"pending"!=this.status},changeWith:function(t){var e=new Task;return this.continueWith((function(i){var n,r=i.error;if(!r)try{n=t(i)}catch(t){r=t}_updateTask(e,n,r)})),e},continueWith:function(t){if(this._continuations)this._continuations.push(t);else{var e=this;setTimeout((function(){t(e)}),0)}return this},done:function(t){return this.continueWith((function(e){"done"==e.status&&t(e.result)}))},fail:function(t){return this.continueWith((function(e){"failed"==e.status&&t(e.error)}))},then:function(t,e){return this.continueWith((function(i){"done"==i.status?t(i.result):e(i.error)}))}};function _updateTask(t,e,i){if("pending"==t.status){i?(t.error=i,t.status="failed"):(t.result=e,t.status="done");var n=t._continuations;t._continuations=null;for(var r=0,s=n.length;r<s;r++)n[r](t)}}function _joinTasks(t,e){var i=(t=toArray(t)).length,n=0;i>1&&"number"==typeof t[0]&&(n=t[0],t=t.slice(1),i--),Array.isArray(t[0])&&(t=t[0],i=t.length);var r=new Task,s=0;function a(t){"pending"==r.status&&(s++,e?_updateTask(r,t):s==i&&_updateTask(r,!0))}0!=n&&setTimeout((function(){"pending"==r.status&&_updateTask(r,!!e&&null)}),n);for(var o=0;o<i;o++)t[o].continueWith(a);return r}function deferred(t){var e=new Task(t);return{task:e,resolve:function(t){_updateTask(e,t)},reject:function(t){_updateTask(e,null,t||new Error)}}}Task.all=function(){return _joinTasks(arguments,!1)},Task.any=function(){return _joinTasks(arguments,!0)},Task.delay=function(t){var e=new Task;return setTimeout((function(){_updateTask(e,!0)}),t),e};var neutralCulture={name:"",nf:{nan:"NaN",neg:"-",pos:"+",negInf:"-Infinity",posInf:"Infinity",gw:[3],dd:2,ds:".",gs:",",per:"%",perGW:[3],perDD:2,perDS:".",perGS:",",perPP:"{0} %",perNP:"-{0} %",cur:"$",curGW:[3],curDD:2,curDS:".",curGS:",",curNP:"(${0})",curPP:"${0}"},dtf:{am:"AM",pm:"PM",ds:"/",ts:":",gmt:"ddd, dd MMM yyyy HH:mm:ss 'GMT'",uni:"yyyy-MM-dd HH:mm:ssZ",sort:"yyyy-MM-ddTHH:mm:ss",dt:"dddd, MMMM dd, yyyy h:mm:ss tt",ld:"dddd, MMMM dd, yyyy",sd:"M/d/yyyy",lt:"h:mm:ss tt",st:"h:mm tt",day0:0,day:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],sday:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],mday:["Su","Mo","Tu","We","Th","Fr","Sa"],mon:["January","February","March","April","May","June","July","August","September","October","November","December",""],smon:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]}},currentCulture={name:"en-us",dtf:neutralCulture.dtf,nf:neutralCulture.nf};function _commaFormatNumber(t,e,i,n){var r=null,s=t.indexOf(i);s>0&&(r=t.substr(s),t=t.substr(0,s));var a=t.startsWith("-");a&&(t=t.substr(1));var o=0,l=e[o];if(t.length<l)return r?t+r:t;for(var h=t.length,u="",c=!1;!c;){var _=l,d=h-_;if(d<0&&(l+=d,_+=d,d=0,c=!0),!_)break;var g=t.substr(d,_);u=u.length?g+n+u:g,h-=_,o<e.length-1&&(l=e[++o])}return a&&(u="-"+u),r?u+r:u}_formatters.Number=function(t,e,i){var n=i.nf,r="",s=-1;e.length>1&&(s=parseInt(e.substr(1)));var a=e.charAt(0);switch(a){case"d":case"D":r=parseInt(Math.abs(t)).toString(),-1!=s&&(r=padLeft(r,s,"0")),t<0&&(r="-"+r);break;case"x":case"X":r=parseInt(Math.abs(t)).toString(16),"X"==a&&(r=r.toUpperCase()),-1!=s&&(r=padLeft(r,s,"0"));break;case"e":case"E":r=-1==s?t.toExponential():t.toExponential(s),"E"==a&&(r=r.toUpperCase());break;case"f":case"F":case"n":case"N":if(-1==s&&(s=n.dd),r=t.toFixed(s).toString(),s&&"."!=n.ds){var o=r.indexOf(".");r=r.substr(0,o)+n.ds+r.substr(o+1)}"n"!=a&&"N"!=a||(r=_commaFormatNumber(r,n.gw,n.ds,n.gs));break;case"c":case"C":-1==s&&(s=n.curDD),r=Math.abs(t).toFixed(s).toString(),s&&"."!=n.curDS&&(o=r.indexOf("."),r=r.substr(0,o)+n.curDS+r.substr(o+1)),r=_commaFormatNumber(r,n.curGW,n.curDS,n.curGS),r=t<0?String.format(i,n.curNP,r):String.format(i,n.curPP,r);break;case"p":case"P":-1==s&&(s=n.perDD),r=(100*Math.abs(t)).toFixed(s).toString(),s&&"."!=n.perDS&&(o=r.indexOf("."),r=r.substr(0,o)+n.perDS+r.substr(o+1)),r=_commaFormatNumber(r,n.perGW,n.perDS,n.perGS),r=t<0?String.format(i,n.perNP,r):String.format(i,n.perPP,r)}return r};var _dateFormatRE=/'.*?[^\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z/g;_formatters.Date=function(t,e,i){if("iso"==e)return t.toISOString();if("i"==e.charAt(0)){var n="String";switch(e){case"id":n="DateString";break;case"it":n="TimeString"}return i==neutralCulture?t["to"+n]():t["toLocale"+n]()}var r=i.dtf;if(1==e.length)switch(e){case"f":e=r.ld+" "+r.st;break;case"F":e=r.dt;break;case"d":e=r.sd;break;case"D":e=r.ld;break;case"t":e=r.st;break;case"T":e=r.lt;break;case"g":e=r.sd+" "+r.st;break;case"G":e=r.sd+" "+r.lt;break;case"R":case"r":e=(r=neutralCulture.dtf).gmt;break;case"u":e=r.uni;break;case"U":e=r.dt,t=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds());break;case"s":e=r.sort}"%"==e.charAt(0)&&(e=e.substr(1));var s=new StringBuilder;for(_dateFormatRE.lastIndex=0;;){var a=_dateFormatRE.lastIndex,o=_dateFormatRE.exec(e);if(s.append(e.slice(a,o?o.index:e.length)),!o)break;var l=o[0],h=l;switch(l){case"dddd":h=r.day[t.getDay()];break;case"ddd":h=r.sday[t.getDay()];break;case"dd":h=padLeft(t.getDate().toString(),2,"0");break;case"d":h=t.getDate();break;case"MMMM":h=r.mon[t.getMonth()];break;case"MMM":h=r.smon[t.getMonth()];break;case"MM":h=padLeft((t.getMonth()+1).toString(),2,"0");break;case"M":h=t.getMonth()+1;break;case"yyyy":h=t.getFullYear();break;case"yy":h=padLeft((t.getFullYear()%100).toString(),2,"0");break;case"y":h=t.getFullYear()%100;break;case"h":case"hh":(h=t.getHours()%12)?"hh"==l&&(h=padLeft(h.toString(),2,"0")):h="12";break;case"HH":h=padLeft(t.getHours().toString(),2,"0");break;case"H":h=t.getHours();break;case"mm":h=padLeft(t.getMinutes().toString(),2,"0");break;case"m":h=t.getMinutes();break;case"ss":h=padLeft(t.getSeconds().toString(),2,"0");break;case"s":h=t.getSeconds();break;case"t":case"tt":h=t.getHours()<12?r.am:r.pm,"t"==l&&(h=h.charAt(0));break;case"fff":h=padLeft(t.getMilliseconds().toString(),3,"0");break;case"ff":h=padLeft(t.getMilliseconds().toString(),3).substr(0,2);break;case"f":h=padLeft(t.getMilliseconds().toString(),3).charAt(0);break;case"z":h=((h=t.getTimezoneOffset()/60)>=0?"-":"+")+Math.floor(Math.abs(h));break;case"zz":case"zzz":h=((h=t.getTimezoneOffset()/60)>=0?"-":"+")+padLeft(Math.floor(Math.abs(h)).toString(),2,"0"),"zzz"==l&&(h+=r.ts+padLeft(Math.abs(t.getTimezoneOffset()%60).toString(),2,"0"));break;default:"'"==h.charAt(0)&&(h=h.substr(1,h.length-2).replace(/\\'/g,"'"))}s.append(h)}return s.toString()};var _modules={},_classMarker="class",_interfaceMarker="interface";function createType(t,e,i){if(Array.isArray(e)){var n=e[0];if(e.length>=2){var r=e[2];if(r){var s=function(){};s.prototype=r.prototype,n.prototype=new s,n.prototype.constructor=n}e[1]&&extend(n.prototype,e[1]),n.$base=r||Object,n.$interfaces=e.slice(3),n.$type=_classMarker}else n.$type=_interfaceMarker;return n.$name=t,i[t]=n}return e}function isClass(t){return t.$type==_classMarker}function isInterface(t){return t.$type==_interfaceMarker}function typeOf(t){var e;try{e=t.constructor}catch(t){}return e||Object}function type(t){var e=t.indexOf("."),i=e>0?_modules[t.substr(0,e)]:globalThis,n=e>0?t.substr(e+1):t;return i?i[n]:null}var _typeNames=[Number,"Number",String,"String",Boolean,"Boolean",Array,"Array",Date,"Date",RegExp,"RegExp",Function,"Function"];function typeName(t){if(t instanceof Function||(t=t.constructor),t.$name)return t.$name;if(t.name)return t.name;for(var e=0,i=_typeNames.length;e<i;e+=2)if(t==_typeNames[e])return _typeNames[e+1];return"Object"}function canAssign(t,e){if(t==Object||t==e)return!0;if(t.$type==_classMarker)for(var i=e.$base;i;){if(t==i)return!0;i=i.$base}else if(t.$type==_interfaceMarker)for(i=e;i;){var n=i.$interfaces;if(n&&n.indexOf(t)>=0)return!0;i=i.$base}return!1}function instanceOf(t,e){return!!isValue(e)&&(t==Object||e instanceof t||canAssign(t,typeOf(e)))}function canCast(t,e){return instanceOf(e,t)}function safeCast(t,e){return instanceOf(e,t)?t:null}function ss_module(t,e,i){var n=_modules[t]={$name:t};if(e)for(var r in e)createType(r,e[r],n);var s={};if(i)for(var r in i)s[r]=createType(r,i[r],n);return s}function createRegistry(t){return _modules[t]={$name:t}}return extend(ss_module("ss",null,{IDisposable:[IDisposable],IEnumerable:[IEnumerable],IEnumerator:[IEnumerator],IObserver:[IObserver],IApplication:[IApplication],IContainer:[IContainer],IObjectFactory:[IObjectFactory],IEventManager:[IEventManager],IInitializable:[IInitializable],EventArgs:[EventArgs,{}],CancelEventArgs:[CancelEventArgs,{},EventArgs],StringBuilder:[StringBuilder,StringBuilder$],Stack:[Stack,Stack$],Queue:[Queue,Queue$],Observable:[Observable,Observable$],ObservableCollection:[ObservableCollection,ObservableCollection$,null,IEnumerable],Task:[Task,Task$]}),{version:"0.8",isValue,value,extend,keys,keyCount,keyExists,clearKeys,enumerate,array:toArray,remove:removeItem,boolean:parseBoolean,regexp:parseRegExp,number:parseNumber,date:parseDate,truncate,now,today,compareDates,error,string,emptyString,whitespace,format,compareStrings,startsWith,endsWith,padLeft,padRight,trim,trimStart,trimEnd,insertString,removeString,replaceString,bind,bindAdd,bindSub,bindExport,deferred,module:ss_module,modules:_modules,createRegistry,createType,isClass,isInterface,typeOf,type,typeName,canCast,safeCast,canAssign,instanceOf,culture:{neutral:neutralCulture,current:currentCulture},fail})}__webpack_require__.d(__webpack_exports__,{ss:()=>ss});var ss=_ss()},991:(t,e,i)=>{var n={};(0,i(609).assign)(n,i(143),i(613),i(436)),t.exports=n},143:(t,e,i)=>{var n=i(152),r=i(609),s=i(141),a=i(710),o=i(894),l=Object.prototype.toString,h=0,u=-1,c=0,_=8;function d(t){if(!(this instanceof d))return new d(t);this.options=r.assign({level:u,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var i=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(i!==h)throw new Error(a[i]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var g;if(g="string"==typeof e.dictionary?s.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(i=n.deflateSetDictionary(this.strm,g))!==h)throw new Error(a[i]);this._dict_set=!0}}function g(t,e){var i=new d(e);if(i.push(t,!0),i.err)throw i.msg||a[i.err];return i.result}d.prototype.push=function(t,e){var i,a,o=this.strm,u=this.options.chunkSize;if(this.ended)return!1;a=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=s.string2buf(t):"[object ArrayBuffer]"===l.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(u),o.next_out=0,o.avail_out=u),1!==(i=n.deflate(o,a))&&i!==h)return this.onEnd(i),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(s.buf2binstring(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==i);return 4===a?(i=n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===h):2!==a||(this.onEnd(h),o.avail_out=0,!0)},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===h&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Deflate=d,e.deflate=g,e.deflateRaw=function(t,e){return(e=e||{}).raw=!0,g(t,e)},e.gzip=function(t,e){return(e=e||{}).gzip=!0,g(t,e)}},613:(t,e,i)=>{var n=i(863),r=i(609),s=i(141),a=i(436),o=i(710),l=i(894),h=i(235),u=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=n.inflateInit2(this.strm,e.windowBits);if(i!==a.Z_OK)throw new Error(o[i]);if(this.header=new h,n.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=s.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(i=n.inflateSetDictionary(this.strm,e.dictionary))!==a.Z_OK))throw new Error(o[i])}function _(t,e){var i=new c(e);if(i.push(t,!0),i.err)throw i.msg||o[i.err];return i.result}c.prototype.push=function(t,e){var i,o,l,h,c,_=this.strm,d=this.options.chunkSize,g=this.options.dictionary,f=!1;if(this.ended)return!1;o=e===~~e?e:!0===e?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof t?_.input=s.binstring2buf(t):"[object ArrayBuffer]"===u.call(t)?_.input=new Uint8Array(t):_.input=t,_.next_in=0,_.avail_in=_.input.length;do{if(0===_.avail_out&&(_.output=new r.Buf8(d),_.next_out=0,_.avail_out=d),(i=n.inflate(_,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(i=n.inflateSetDictionary(this.strm,g)),i===a.Z_BUF_ERROR&&!0===f&&(i=a.Z_OK,f=!1),i!==a.Z_STREAM_END&&i!==a.Z_OK)return this.onEnd(i),this.ended=!0,!1;_.next_out&&(0!==_.avail_out&&i!==a.Z_STREAM_END&&(0!==_.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(_.output,_.next_out),h=_.next_out-l,c=s.buf2string(_.output,l),_.next_out=h,_.avail_out=d-h,h&&r.arraySet(_.output,_.output,l,h,0),this.onData(c)):this.onData(r.shrinkBuf(_.output,_.next_out)))),0===_.avail_in&&0===_.avail_out&&(f=!0)}while((_.avail_in>0||0===_.avail_out)&&i!==a.Z_STREAM_END);return i===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(i=n.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),_.avail_out=0,!0)},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){t===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},e.Inflate=c,e.inflate=_,e.inflateRaw=function(t,e){return(e=e||{}).raw=!0,_(t,e)},e.ungzip=_},609:(t,e)=>{var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var i=e.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var r in i)n(i,r)&&(t[r]=i[r])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var r={arraySet:function(t,e,i,n,r){if(e.subarray&&t.subarray)t.set(e.subarray(i,i+n),r);else for(var s=0;s<n;s++)t[r+s]=e[i+s]},flattenChunks:function(t){var e,i,n,r,s,a;for(n=0,e=0,i=t.length;e<i;e++)n+=t[e].length;for(a=new Uint8Array(n),r=0,e=0,i=t.length;e<i;e++)s=t[e],a.set(s,r),r+=s.length;return a}},s={arraySet:function(t,e,i,n,r){for(var s=0;s<n;s++)t[r+s]=e[i+s]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(i)},141:(t,e,i)=>{var n=i(609),r=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){r=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var a=new n.Buf8(256),o=0;o<256;o++)a[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(t,e){if(e<65534&&(t.subarray&&s||!t.subarray&&r))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var i="",a=0;a<e;a++)i+=String.fromCharCode(t[a]);return i}a[254]=a[254]=1,e.string2buf=function(t){var e,i,r,s,a,o=t.length,l=0;for(s=0;s<o;s++)55296==(64512&(i=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(r=t.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(r-56320),s++),l+=i<128?1:i<2048?2:i<65536?3:4;for(e=new n.Buf8(l),a=0,s=0;a<l;s++)55296==(64512&(i=t.charCodeAt(s)))&&s+1<o&&56320==(64512&(r=t.charCodeAt(s+1)))&&(i=65536+(i-55296<<10)+(r-56320),s++),i<128?e[a++]=i:i<2048?(e[a++]=192|i>>>6,e[a++]=128|63&i):i<65536?(e[a++]=224|i>>>12,e[a++]=128|i>>>6&63,e[a++]=128|63&i):(e[a++]=240|i>>>18,e[a++]=128|i>>>12&63,e[a++]=128|i>>>6&63,e[a++]=128|63&i);return e},e.buf2binstring=function(t){return l(t,t.length)},e.binstring2buf=function(t){for(var e=new n.Buf8(t.length),i=0,r=e.length;i<r;i++)e[i]=t.charCodeAt(i);return e},e.buf2string=function(t,e){var i,n,r,s,o=e||t.length,h=new Array(2*o);for(n=0,i=0;i<o;)if((r=t[i++])<128)h[n++]=r;else if((s=a[r])>4)h[n++]=65533,i+=s-1;else{for(r&=2===s?31:3===s?15:7;s>1&&i<o;)r=r<<6|63&t[i++],s--;s>1?h[n++]=65533:r<65536?h[n++]=r:(r-=65536,h[n++]=55296|r>>10&1023,h[n++]=56320|1023&r)}return l(h,n)},e.utf8border=function(t,e){var i;for((e=e||t.length)>t.length&&(e=t.length),i=e-1;i>=0&&128==(192&t[i]);)i--;return i<0||0===i?e:i+a[t[i]]>e?i:e}},530:t=>{t.exports=function(t,e,i,n){for(var r=65535&t|0,s=t>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{s=s+(r=r+e[n++]|0)|0}while(--a);r%=65521,s%=65521}return r|s<<16|0}},436:t=>{t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},383:t=>{var e=function(){for(var t,e=[],i=0;i<256;i++){t=i;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[i]=t}return e}();t.exports=function(t,i,n,r){var s=e,a=r+n;t^=-1;for(var o=r;o<a;o++)t=t>>>8^s[255&(t^i[o])];return-1^t}},152:(t,e,i)=>{var n,r=i(609),s=i(322),a=i(530),o=i(383),l=i(710),h=0,u=0,c=-2,_=2,d=8,g=286,f=30,m=19,p=2*g+1,w=15,b=3,v=258,y=v+b+1,S=42,x=103,T=113,M=666;function C(t,e){return t.msg=l[e],e}function A(t){return(t<<1)-(t>4?9:0)}function L(t){for(var e=t.length;--e>=0;)t[e]=0}function I(t){var e=t.state,i=e.pending;i>t.avail_out&&(i=t.avail_out),0!==i&&(r.arraySet(t.output,e.pending_buf,e.pending_out,i,t.next_out),t.next_out+=i,e.pending_out+=i,t.total_out+=i,t.avail_out-=i,e.pending-=i,0===e.pending&&(e.pending_out=0))}function k(t,e){s._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,I(t.strm)}function P(t,e){t.pending_buf[t.pending++]=e}function R(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function E(t,e){var i,n,r=t.max_chain_length,s=t.strstart,a=t.prev_length,o=t.nice_match,l=t.strstart>t.w_size-y?t.strstart-(t.w_size-y):0,h=t.window,u=t.w_mask,c=t.prev,_=t.strstart+v,d=h[s+a-1],g=h[s+a];t.prev_length>=t.good_match&&(r>>=2),o>t.lookahead&&(o=t.lookahead);do{if(h[(i=e)+a]===g&&h[i+a-1]===d&&h[i]===h[s]&&h[++i]===h[s+1]){s+=2,i++;do{}while(h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&h[++s]===h[++i]&&s<_);if(n=v-(_-s),s=_-v,n>a){if(t.match_start=e,a=n,n>=o)break;d=h[s+a-1],g=h[s+a]}}}while((e=c[e&u])>l&&0!=--r);return a<=t.lookahead?a:t.lookahead}function D(t){var e,i,n,s,l,h,u,c,_,d,g=t.w_size;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=g+(g-y)){r.arraySet(t.window,t.window,g,g,0),t.match_start-=g,t.strstart-=g,t.block_start-=g,e=i=t.hash_size;do{n=t.head[--e],t.head[e]=n>=g?n-g:0}while(--i);e=i=g;do{n=t.prev[--e],t.prev[e]=n>=g?n-g:0}while(--i);s+=g}if(0===t.strm.avail_in)break;if(h=t.strm,u=t.window,c=t.strstart+t.lookahead,_=s,d=void 0,(d=h.avail_in)>_&&(d=_),i=0===d?0:(h.avail_in-=d,r.arraySet(u,h.input,h.next_in,d,c),1===h.state.wrap?h.adler=a(h.adler,u,d,c):2===h.state.wrap&&(h.adler=o(h.adler,u,d,c)),h.next_in+=d,h.total_in+=d,d),t.lookahead+=i,t.lookahead+t.insert>=b)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+b-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<b)););}while(t.lookahead<y&&0!==t.strm.avail_in)}function F(t,e){for(var i,n;;){if(t.lookahead<y){if(D(t),t.lookahead<y&&e===h)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=b&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+b-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==i&&t.strstart-i<=t.w_size-y&&(t.match_length=E(t,i)),t.match_length>=b)if(n=s._tr_tally(t,t.strstart-t.match_start,t.match_length-b),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=b){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+b-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(k(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<b-1?t.strstart:b-1,4===e?(k(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(k(t,!1),0===t.strm.avail_out)?1:2}function N(t,e){for(var i,n,r;;){if(t.lookahead<y){if(D(t),t.lookahead<y&&e===h)return 1;if(0===t.lookahead)break}if(i=0,t.lookahead>=b&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+b-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=b-1,0!==i&&t.prev_length<t.max_lazy_match&&t.strstart-i<=t.w_size-y&&(t.match_length=E(t,i),t.match_length<=5&&(1===t.strategy||t.match_length===b&&t.strstart-t.match_start>4096)&&(t.match_length=b-1)),t.prev_length>=b&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-b,n=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-b),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+b-1])&t.hash_mask,i=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=b-1,t.strstart++,n&&(k(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=s._tr_tally(t,0,t.window[t.strstart-1]))&&k(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<b-1?t.strstart:b-1,4===e?(k(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(k(t,!1),0===t.strm.avail_out)?1:2}function $(t,e,i,n,r){this.good_length=t,this.max_lazy=e,this.nice_length=i,this.max_chain=n,this.func=r}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=d,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*p),this.dyn_dtree=new r.Buf16(2*(2*f+1)),this.bl_tree=new r.Buf16(2*(2*m+1)),L(this.dyn_ltree),L(this.dyn_dtree),L(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(w+1),this.heap=new r.Buf16(2*g+1),L(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*g+1),L(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function B(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=_,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?S:T,t.adler=2===e.wrap?0:1,e.last_flush=h,s._tr_init(e),u):C(t,c)}function U(t){var e,i=B(t);return i===u&&((e=t.state).window_size=2*e.w_size,L(e.head),e.max_lazy_match=n[e.level].max_lazy,e.good_match=n[e.level].good_length,e.nice_match=n[e.level].nice_length,e.max_chain_length=n[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=b-1,e.match_available=0,e.ins_h=0),i}function V(t,e,i,n,s,a){if(!t)return c;var o=1;if(-1===e&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>9||i!==d||n<8||n>15||e<0||e>9||a<0||a>4)return C(t,c);8===n&&(n=9);var l=new z;return t.state=l,l.strm=t,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+b-1)/b),l.window=new r.Buf8(2*l.w_size),l.head=new r.Buf16(l.hash_size),l.prev=new r.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new r.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=a,l.method=i,U(t)}n=[new $(0,0,0,0,(function(t,e){var i=65535;for(i>t.pending_buf_size-5&&(i=t.pending_buf_size-5);;){if(t.lookahead<=1){if(D(t),0===t.lookahead&&e===h)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+i;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,k(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-y&&(k(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(k(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(k(t,!1),t.strm.avail_out),1)})),new $(4,4,8,4,F),new $(4,5,16,8,F),new $(4,6,32,32,F),new $(4,4,16,16,N),new $(8,16,32,32,N),new $(8,16,128,128,N),new $(8,32,128,256,N),new $(32,128,258,1024,N),new $(32,258,258,4096,N)],e.deflateInit=function(t,e){return V(t,e,d,15,8,0)},e.deflateInit2=V,e.deflateReset=U,e.deflateResetKeep=B,e.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?c:(t.state.gzhead=e,u):c},e.deflate=function(t,e){var i,r,a,l;if(!t||!t.state||e>5||e<0)return t?C(t,c):c;if(r=t.state,!t.output||!t.input&&0!==t.avail_in||r.status===M&&4!==e)return C(t,0===t.avail_out?-5:c);if(r.strm=t,i=r.last_flush,r.last_flush=e,r.status===S)if(2===r.wrap)t.adler=0,P(r,31),P(r,139),P(r,8),r.gzhead?(P(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),P(r,255&r.gzhead.time),P(r,r.gzhead.time>>8&255),P(r,r.gzhead.time>>16&255),P(r,r.gzhead.time>>24&255),P(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),P(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(P(r,255&r.gzhead.extra.length),P(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=o(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(P(r,0),P(r,0),P(r,0),P(r,0),P(r,0),P(r,9===r.level?2:r.strategy>=2||r.level<2?4:0),P(r,3),r.status=T);else{var _=d+(r.w_bits-8<<4)<<8;_|=(r.strategy>=2||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(_|=32),_+=31-_%31,r.status=T,R(r,_),0!==r.strstart&&(R(r,t.adler>>>16),R(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>a&&(t.adler=o(t.adler,r.pending_buf,r.pending-a,a)),I(t),a=r.pending,r.pending!==r.pending_buf_size));)P(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(t.adler=o(t.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=o(t.adler,r.pending_buf,r.pending-a,a)),I(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,P(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=o(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(t.adler=o(t.adler,r.pending_buf,r.pending-a,a)),I(t),a=r.pending,r.pending===r.pending_buf_size)){l=1;break}l=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,P(r,l)}while(0!==l);r.gzhead.hcrc&&r.pending>a&&(t.adler=o(t.adler,r.pending_buf,r.pending-a,a)),0===l&&(r.status=x)}else r.status=x;if(r.status===x&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&I(t),r.pending+2<=r.pending_buf_size&&(P(r,255&t.adler),P(r,t.adler>>8&255),t.adler=0,r.status=T)):r.status=T),0!==r.pending){if(I(t),0===t.avail_out)return r.last_flush=-1,u}else if(0===t.avail_in&&A(e)<=A(i)&&4!==e)return C(t,-5);if(r.status===M&&0!==t.avail_in)return C(t,-5);if(0!==t.avail_in||0!==r.lookahead||e!==h&&r.status!==M){var g=2===r.strategy?function(t,e){for(var i;;){if(0===t.lookahead&&(D(t),0===t.lookahead)){if(e===h)return 1;break}if(t.match_length=0,i=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,i&&(k(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(k(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(k(t,!1),0===t.strm.avail_out)?1:2}(r,e):3===r.strategy?function(t,e){for(var i,n,r,a,o=t.window;;){if(t.lookahead<=v){if(D(t),t.lookahead<=v&&e===h)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=b&&t.strstart>0&&(n=o[r=t.strstart-1])===o[++r]&&n===o[++r]&&n===o[++r]){a=t.strstart+v;do{}while(n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&n===o[++r]&&r<a);t.match_length=v-(a-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=b?(i=s._tr_tally(t,1,t.match_length-b),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(i=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),i&&(k(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(k(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(k(t,!1),0===t.strm.avail_out)?1:2}(r,e):n[r.level].func(r,e);if(3!==g&&4!==g||(r.status=M),1===g||3===g)return 0===t.avail_out&&(r.last_flush=-1),u;if(2===g&&(1===e?s._tr_align(r):5!==e&&(s._tr_stored_block(r,0,0,!1),3===e&&(L(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),I(t),0===t.avail_out))return r.last_flush=-1,u}return 4!==e?u:r.wrap<=0?1:(2===r.wrap?(P(r,255&t.adler),P(r,t.adler>>8&255),P(r,t.adler>>16&255),P(r,t.adler>>24&255),P(r,255&t.total_in),P(r,t.total_in>>8&255),P(r,t.total_in>>16&255),P(r,t.total_in>>24&255)):(R(r,t.adler>>>16),R(r,65535&t.adler)),I(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?u:1)},e.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==S&&69!==e&&73!==e&&91!==e&&e!==x&&e!==T&&e!==M?C(t,c):(t.state=null,e===T?C(t,-3):u):c},e.deflateSetDictionary=function(t,e){var i,n,s,o,l,h,_,d,g=e.length;if(!t||!t.state)return c;if(2===(o=(i=t.state).wrap)||1===o&&i.status!==S||i.lookahead)return c;for(1===o&&(t.adler=a(t.adler,e,g,0)),i.wrap=0,g>=i.w_size&&(0===o&&(L(i.head),i.strstart=0,i.block_start=0,i.insert=0),d=new r.Buf8(i.w_size),r.arraySet(d,e,g-i.w_size,i.w_size,0),e=d,g=i.w_size),l=t.avail_in,h=t.next_in,_=t.input,t.avail_in=g,t.next_in=0,t.input=e,D(i);i.lookahead>=b;){n=i.strstart,s=i.lookahead-(b-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+b-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--s);i.strstart=n,i.lookahead=b-1,D(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=b-1,i.match_available=0,t.next_in=h,t.input=_,t.avail_in=l,i.wrap=o,u},e.deflateInfo="pako deflate (from Nodeca project)"},235:t=>{t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},121:t=>{t.exports=function(t,e){var i,n,r,s,a,o,l,h,u,c,_,d,g,f,m,p,w,b,v,y,S,x,T,M,C;i=t.state,n=t.next_in,M=t.input,r=n+(t.avail_in-5),s=t.next_out,C=t.output,a=s-(e-t.avail_out),o=s+(t.avail_out-257),l=i.dmax,h=i.wsize,u=i.whave,c=i.wnext,_=i.window,d=i.hold,g=i.bits,f=i.lencode,m=i.distcode,p=(1<<i.lenbits)-1,w=(1<<i.distbits)-1;t:do{g<15&&(d+=M[n++]<<g,g+=8,d+=M[n++]<<g,g+=8),b=f[d&p];e:for(;;){if(d>>>=v=b>>>24,g-=v,0==(v=b>>>16&255))C[s++]=65535&b;else{if(!(16&v)){if(0==(64&v)){b=f[(65535&b)+(d&(1<<v)-1)];continue e}if(32&v){i.mode=12;break t}t.msg="invalid literal/length code",i.mode=30;break t}y=65535&b,(v&=15)&&(g<v&&(d+=M[n++]<<g,g+=8),y+=d&(1<<v)-1,d>>>=v,g-=v),g<15&&(d+=M[n++]<<g,g+=8,d+=M[n++]<<g,g+=8),b=m[d&w];i:for(;;){if(d>>>=v=b>>>24,g-=v,!(16&(v=b>>>16&255))){if(0==(64&v)){b=m[(65535&b)+(d&(1<<v)-1)];continue i}t.msg="invalid distance code",i.mode=30;break t}if(S=65535&b,g<(v&=15)&&(d+=M[n++]<<g,(g+=8)<v&&(d+=M[n++]<<g,g+=8)),(S+=d&(1<<v)-1)>l){t.msg="invalid distance too far back",i.mode=30;break t}if(d>>>=v,g-=v,S>(v=s-a)){if((v=S-v)>u&&i.sane){t.msg="invalid distance too far back",i.mode=30;break t}if(x=0,T=_,0===c){if(x+=h-v,v<y){y-=v;do{C[s++]=_[x++]}while(--v);x=s-S,T=C}}else if(c<v){if(x+=h+c-v,(v-=c)<y){y-=v;do{C[s++]=_[x++]}while(--v);if(x=0,c<y){y-=v=c;do{C[s++]=_[x++]}while(--v);x=s-S,T=C}}}else if(x+=c-v,v<y){y-=v;do{C[s++]=_[x++]}while(--v);x=s-S,T=C}for(;y>2;)C[s++]=T[x++],C[s++]=T[x++],C[s++]=T[x++],y-=3;y&&(C[s++]=T[x++],y>1&&(C[s++]=T[x++]))}else{x=s-S;do{C[s++]=C[x++],C[s++]=C[x++],C[s++]=C[x++],y-=3}while(y>2);y&&(C[s++]=C[x++],y>1&&(C[s++]=C[x++]))}break}}break}}while(n<r&&s<o);n-=y=g>>3,d&=(1<<(g-=y<<3))-1,t.next_in=n,t.next_out=s,t.avail_in=n<r?r-n+5:5-(n-r),t.avail_out=s<o?o-s+257:257-(s-o),i.hold=d,i.bits=g}},863:(t,e,i)=>{var n=i(609),r=i(530),s=i(383),a=i(121),o=i(371),l=0,h=-2,u=1,c=12,_=30,d=852,g=592;function f(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function m(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function p(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=u,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(d),e.distcode=e.distdyn=new n.Buf32(g),e.sane=1,e.back=-1,l):h}function w(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,p(t)):h}function b(t,e){var i,n;return t&&t.state?(n=t.state,e<0?(i=0,e=-e):(i=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?h:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=i,n.wbits=e,w(t))):h}function v(t,e){var i,n;return t?(n=new m,t.state=n,n.window=null,(i=b(t,e))!==l&&(t.state=null),i):h}var y,S,x=!0;function T(t){if(x){var e;for(y=new n.Buf32(512),S=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(o(1,t.lens,0,288,y,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;o(2,t.lens,0,32,S,0,t.work,{bits:5}),x=!1}t.lencode=y,t.lenbits=9,t.distcode=S,t.distbits=5}function M(t,e,i,r){var s,a=t.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new n.Buf8(a.wsize)),r>=a.wsize?(n.arraySet(a.window,e,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((s=a.wsize-a.wnext)>r&&(s=r),n.arraySet(a.window,e,i-r,s,a.wnext),(r-=s)?(n.arraySet(a.window,e,i-r,r,0),a.wnext=r,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0}e.inflateReset=w,e.inflateReset2=b,e.inflateResetKeep=p,e.inflateInit=function(t){return v(t,15)},e.inflateInit2=v,e.inflate=function(t,e){var i,d,g,m,p,w,b,v,y,S,x,C,A,L,I,k,P,R,E,D,F,N,$,z,B=0,U=new n.Buf8(4),V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return h;(i=t.state).mode===c&&(i.mode=13),p=t.next_out,g=t.output,b=t.avail_out,m=t.next_in,d=t.input,w=t.avail_in,v=i.hold,y=i.bits,S=w,x=b,N=l;t:for(;;)switch(i.mode){case u:if(0===i.wrap){i.mode=13;break}for(;y<16;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(2&i.wrap&&35615===v){i.check=0,U[0]=255&v,U[1]=v>>>8&255,i.check=s(i.check,U,2,0),v=0,y=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&v)<<8)+(v>>8))%31){t.msg="incorrect header check",i.mode=_;break}if(8!=(15&v)){t.msg="unknown compression method",i.mode=_;break}if(y-=4,F=8+(15&(v>>>=4)),0===i.wbits)i.wbits=F;else if(F>i.wbits){t.msg="invalid window size",i.mode=_;break}i.dmax=1<<F,t.adler=i.check=1,i.mode=512&v?10:c,v=0,y=0;break;case 2:for(;y<16;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(i.flags=v,8!=(255&i.flags)){t.msg="unknown compression method",i.mode=_;break}if(57344&i.flags){t.msg="unknown header flags set",i.mode=_;break}i.head&&(i.head.text=v>>8&1),512&i.flags&&(U[0]=255&v,U[1]=v>>>8&255,i.check=s(i.check,U,2,0)),v=0,y=0,i.mode=3;case 3:for(;y<32;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}i.head&&(i.head.time=v),512&i.flags&&(U[0]=255&v,U[1]=v>>>8&255,U[2]=v>>>16&255,U[3]=v>>>24&255,i.check=s(i.check,U,4,0)),v=0,y=0,i.mode=4;case 4:for(;y<16;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}i.head&&(i.head.xflags=255&v,i.head.os=v>>8),512&i.flags&&(U[0]=255&v,U[1]=v>>>8&255,i.check=s(i.check,U,2,0)),v=0,y=0,i.mode=5;case 5:if(1024&i.flags){for(;y<16;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}i.length=v,i.head&&(i.head.extra_len=v),512&i.flags&&(U[0]=255&v,U[1]=v>>>8&255,i.check=s(i.check,U,2,0)),v=0,y=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((C=i.length)>w&&(C=w),C&&(i.head&&(F=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,d,m,C,F)),512&i.flags&&(i.check=s(i.check,d,C,m)),w-=C,m+=C,i.length-=C),i.length))break t;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===w)break t;C=0;do{F=d[m+C++],i.head&&F&&i.length<65536&&(i.head.name+=String.fromCharCode(F))}while(F&&C<w);if(512&i.flags&&(i.check=s(i.check,d,C,m)),w-=C,m+=C,F)break t}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===w)break t;C=0;do{F=d[m+C++],i.head&&F&&i.length<65536&&(i.head.comment+=String.fromCharCode(F))}while(F&&C<w);if(512&i.flags&&(i.check=s(i.check,d,C,m)),w-=C,m+=C,F)break t}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;y<16;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(v!==(65535&i.check)){t.msg="header crc mismatch",i.mode=_;break}v=0,y=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),t.adler=i.check=0,i.mode=c;break;case 10:for(;y<32;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}t.adler=i.check=f(v),v=0,y=0,i.mode=11;case 11:if(0===i.havedict)return t.next_out=p,t.avail_out=b,t.next_in=m,t.avail_in=w,i.hold=v,i.bits=y,2;t.adler=i.check=1,i.mode=c;case c:if(5===e||6===e)break t;case 13:if(i.last){v>>>=7&y,y-=7&y,i.mode=27;break}for(;y<3;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}switch(i.last=1&v,y-=1,3&(v>>>=1)){case 0:i.mode=14;break;case 1:if(T(i),i.mode=20,6===e){v>>>=2,y-=2;break t}break;case 2:i.mode=17;break;case 3:t.msg="invalid block type",i.mode=_}v>>>=2,y-=2;break;case 14:for(v>>>=7&y,y-=7&y;y<32;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if((65535&v)!=(v>>>16^65535)){t.msg="invalid stored block lengths",i.mode=_;break}if(i.length=65535&v,v=0,y=0,i.mode=15,6===e)break t;case 15:i.mode=16;case 16:if(C=i.length){if(C>w&&(C=w),C>b&&(C=b),0===C)break t;n.arraySet(g,d,m,C,p),w-=C,m+=C,b-=C,p+=C,i.length-=C;break}i.mode=c;break;case 17:for(;y<14;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(i.nlen=257+(31&v),v>>>=5,y-=5,i.ndist=1+(31&v),v>>>=5,y-=5,i.ncode=4+(15&v),v>>>=4,y-=4,i.nlen>286||i.ndist>30){t.msg="too many length or distance symbols",i.mode=_;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;y<3;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}i.lens[V[i.have++]]=7&v,v>>>=3,y-=3}for(;i.have<19;)i.lens[V[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,$={bits:i.lenbits},N=o(0,i.lens,0,19,i.lencode,0,i.work,$),i.lenbits=$.bits,N){t.msg="invalid code lengths set",i.mode=_;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;k=(B=i.lencode[v&(1<<i.lenbits)-1])>>>16&255,P=65535&B,!((I=B>>>24)<=y);){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(P<16)v>>>=I,y-=I,i.lens[i.have++]=P;else{if(16===P){for(z=I+2;y<z;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(v>>>=I,y-=I,0===i.have){t.msg="invalid bit length repeat",i.mode=_;break}F=i.lens[i.have-1],C=3+(3&v),v>>>=2,y-=2}else if(17===P){for(z=I+3;y<z;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}y-=I,F=0,C=3+(7&(v>>>=I)),v>>>=3,y-=3}else{for(z=I+7;y<z;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}y-=I,F=0,C=11+(127&(v>>>=I)),v>>>=7,y-=7}if(i.have+C>i.nlen+i.ndist){t.msg="invalid bit length repeat",i.mode=_;break}for(;C--;)i.lens[i.have++]=F}}if(i.mode===_)break;if(0===i.lens[256]){t.msg="invalid code -- missing end-of-block",i.mode=_;break}if(i.lenbits=9,$={bits:i.lenbits},N=o(1,i.lens,0,i.nlen,i.lencode,0,i.work,$),i.lenbits=$.bits,N){t.msg="invalid literal/lengths set",i.mode=_;break}if(i.distbits=6,i.distcode=i.distdyn,$={bits:i.distbits},N=o(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,$),i.distbits=$.bits,N){t.msg="invalid distances set",i.mode=_;break}if(i.mode=20,6===e)break t;case 20:i.mode=21;case 21:if(w>=6&&b>=258){t.next_out=p,t.avail_out=b,t.next_in=m,t.avail_in=w,i.hold=v,i.bits=y,a(t,x),p=t.next_out,g=t.output,b=t.avail_out,m=t.next_in,d=t.input,w=t.avail_in,v=i.hold,y=i.bits,i.mode===c&&(i.back=-1);break}for(i.back=0;k=(B=i.lencode[v&(1<<i.lenbits)-1])>>>16&255,P=65535&B,!((I=B>>>24)<=y);){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(k&&0==(240&k)){for(R=I,E=k,D=P;k=(B=i.lencode[D+((v&(1<<R+E)-1)>>R)])>>>16&255,P=65535&B,!(R+(I=B>>>24)<=y);){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}v>>>=R,y-=R,i.back+=R}if(v>>>=I,y-=I,i.back+=I,i.length=P,0===k){i.mode=26;break}if(32&k){i.back=-1,i.mode=c;break}if(64&k){t.msg="invalid literal/length code",i.mode=_;break}i.extra=15&k,i.mode=22;case 22:if(i.extra){for(z=i.extra;y<z;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}i.length+=v&(1<<i.extra)-1,v>>>=i.extra,y-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;k=(B=i.distcode[v&(1<<i.distbits)-1])>>>16&255,P=65535&B,!((I=B>>>24)<=y);){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(0==(240&k)){for(R=I,E=k,D=P;k=(B=i.distcode[D+((v&(1<<R+E)-1)>>R)])>>>16&255,P=65535&B,!(R+(I=B>>>24)<=y);){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}v>>>=R,y-=R,i.back+=R}if(v>>>=I,y-=I,i.back+=I,64&k){t.msg="invalid distance code",i.mode=_;break}i.offset=P,i.extra=15&k,i.mode=24;case 24:if(i.extra){for(z=i.extra;y<z;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}i.offset+=v&(1<<i.extra)-1,v>>>=i.extra,y-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){t.msg="invalid distance too far back",i.mode=_;break}i.mode=25;case 25:if(0===b)break t;if(C=x-b,i.offset>C){if((C=i.offset-C)>i.whave&&i.sane){t.msg="invalid distance too far back",i.mode=_;break}C>i.wnext?(C-=i.wnext,A=i.wsize-C):A=i.wnext-C,C>i.length&&(C=i.length),L=i.window}else L=g,A=p-i.offset,C=i.length;C>b&&(C=b),b-=C,i.length-=C;do{g[p++]=L[A++]}while(--C);0===i.length&&(i.mode=21);break;case 26:if(0===b)break t;g[p++]=i.length,b--,i.mode=21;break;case 27:if(i.wrap){for(;y<32;){if(0===w)break t;w--,v|=d[m++]<<y,y+=8}if(x-=b,t.total_out+=x,i.total+=x,x&&(t.adler=i.check=i.flags?s(i.check,g,x,p-x):r(i.check,g,x,p-x)),x=b,(i.flags?v:f(v))!==i.check){t.msg="incorrect data check",i.mode=_;break}v=0,y=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;y<32;){if(0===w)break t;w--,v+=d[m++]<<y,y+=8}if(v!==(4294967295&i.total)){t.msg="incorrect length check",i.mode=_;break}v=0,y=0}i.mode=29;case 29:N=1;break t;case _:N=-3;break t;case 31:return-4;default:return h}return t.next_out=p,t.avail_out=b,t.next_in=m,t.avail_in=w,i.hold=v,i.bits=y,(i.wsize||x!==t.avail_out&&i.mode<_&&(i.mode<27||4!==e))&&M(t,t.output,t.next_out,x-t.avail_out)?(i.mode=31,-4):(S-=t.avail_in,x-=t.avail_out,t.total_in+=S,t.total_out+=x,i.total+=x,i.wrap&&x&&(t.adler=i.check=i.flags?s(i.check,g,x,t.next_out-x):r(i.check,g,x,t.next_out-x)),t.data_type=i.bits+(i.last?64:0)+(i.mode===c?128:0)+(20===i.mode||15===i.mode?256:0),(0===S&&0===x||4===e)&&N===l&&(N=-5),N)},e.inflateEnd=function(t){if(!t||!t.state)return h;var e=t.state;return e.window&&(e.window=null),t.state=null,l},e.inflateGetHeader=function(t,e){var i;return t&&t.state?0==(2&(i=t.state).wrap)?h:(i.head=e,e.done=!1,l):h},e.inflateSetDictionary=function(t,e){var i,n=e.length;return t&&t.state?0!==(i=t.state).wrap&&11!==i.mode?h:11===i.mode&&r(1,e,n,0)!==i.check?-3:M(t,e,n,n)?(i.mode=31,-4):(i.havedict=1,l):h},e.inflateInfo="pako inflate (from Nodeca project)"},371:(t,e,i)=>{var n=i(609),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],a=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(t,e,i,l,h,u,c,_){var d,g,f,m,p,w,b,v,y,S=_.bits,x=0,T=0,M=0,C=0,A=0,L=0,I=0,k=0,P=0,R=0,E=null,D=0,F=new n.Buf16(16),N=new n.Buf16(16),$=null,z=0;for(x=0;x<=15;x++)F[x]=0;for(T=0;T<l;T++)F[e[i+T]]++;for(A=S,C=15;C>=1&&0===F[C];C--);if(A>C&&(A=C),0===C)return h[u++]=20971520,h[u++]=20971520,_.bits=1,0;for(M=1;M<C&&0===F[M];M++);for(A<M&&(A=M),k=1,x=1;x<=15;x++)if(k<<=1,(k-=F[x])<0)return-1;if(k>0&&(0===t||1!==C))return-1;for(N[1]=0,x=1;x<15;x++)N[x+1]=N[x]+F[x];for(T=0;T<l;T++)0!==e[i+T]&&(c[N[e[i+T]]++]=T);if(0===t?(E=$=c,w=19):1===t?(E=r,D-=257,$=s,z-=257,w=256):(E=a,$=o,w=-1),R=0,T=0,x=M,p=u,L=A,I=0,f=-1,m=(P=1<<A)-1,1===t&&P>852||2===t&&P>592)return 1;for(;;){b=x-I,c[T]<w?(v=0,y=c[T]):c[T]>w?(v=$[z+c[T]],y=E[D+c[T]]):(v=96,y=0),d=1<<x-I,M=g=1<<L;do{h[p+(R>>I)+(g-=d)]=b<<24|v<<16|y|0}while(0!==g);for(d=1<<x-1;R&d;)d>>=1;if(0!==d?(R&=d-1,R+=d):R=0,T++,0==--F[x]){if(x===C)break;x=e[i+c[T]]}if(x>A&&(R&m)!==f){for(0===I&&(I=A),p+=M,k=1<<(L=x-I);L+I<C&&!((k-=F[L+I])<=0);)L++,k<<=1;if(P+=1<<L,1===t&&P>852||2===t&&P>592)return 1;h[f=R&m]=A<<24|L<<16|p-u|0}}return 0!==R&&(h[p+R]=x-I<<24|64<<16|0),_.bits=A,0}},710:t=>{t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},322:(t,e,i)=>{var n=i(609);function r(t){for(var e=t.length;--e>=0;)t[e]=0}var s=256,a=286,o=30,l=15,h=16,u=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],d=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],g=new Array(576);r(g);var f=new Array(60);r(f);var m=new Array(512);r(m);var p=new Array(256);r(p);var w=new Array(29);r(w);var b,v,y,S=new Array(o);function x(t,e,i,n,r){this.static_tree=t,this.extra_bits=e,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=t&&t.length}function T(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function M(t){return t<256?m[t]:m[256+(t>>>7)]}function C(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function A(t,e,i){t.bi_valid>h-i?(t.bi_buf|=e<<t.bi_valid&65535,C(t,t.bi_buf),t.bi_buf=e>>h-t.bi_valid,t.bi_valid+=i-h):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=i)}function L(t,e,i){A(t,i[2*e],i[2*e+1])}function I(t,e){var i=0;do{i|=1&t,t>>>=1,i<<=1}while(--e>0);return i>>>1}function k(t,e,i){var n,r,s=new Array(l+1),a=0;for(n=1;n<=l;n++)s[n]=a=a+i[n-1]<<1;for(r=0;r<=e;r++){var o=t[2*r+1];0!==o&&(t[2*r]=I(s[o]++,o))}}function P(t){var e;for(e=0;e<a;e++)t.dyn_ltree[2*e]=0;for(e=0;e<o;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function R(t){t.bi_valid>8?C(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function E(t,e,i,n){var r=2*e,s=2*i;return t[r]<t[s]||t[r]===t[s]&&n[e]<=n[i]}function D(t,e,i){for(var n=t.heap[i],r=i<<1;r<=t.heap_len&&(r<t.heap_len&&E(e,t.heap[r+1],t.heap[r],t.depth)&&r++,!E(e,n,t.heap[r],t.depth));)t.heap[i]=t.heap[r],i=r,r<<=1;t.heap[i]=n}function F(t,e,i){var n,r,a,o,l=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],r=t.pending_buf[t.l_buf+l],l++,0===n?L(t,r,e):(L(t,(a=p[r])+s+1,e),0!==(o=u[a])&&A(t,r-=w[a],o),L(t,a=M(--n),i),0!==(o=c[a])&&A(t,n-=S[a],o))}while(l<t.last_lit);L(t,256,e)}function N(t,e){var i,n,r,s=e.dyn_tree,a=e.stat_desc.static_tree,o=e.stat_desc.has_stree,h=e.stat_desc.elems,u=-1;for(t.heap_len=0,t.heap_max=573,i=0;i<h;i++)0!==s[2*i]?(t.heap[++t.heap_len]=u=i,t.depth[i]=0):s[2*i+1]=0;for(;t.heap_len<2;)s[2*(r=t.heap[++t.heap_len]=u<2?++u:0)]=1,t.depth[r]=0,t.opt_len--,o&&(t.static_len-=a[2*r+1]);for(e.max_code=u,i=t.heap_len>>1;i>=1;i--)D(t,s,i);r=h;do{i=t.heap[1],t.heap[1]=t.heap[t.heap_len--],D(t,s,1),n=t.heap[1],t.heap[--t.heap_max]=i,t.heap[--t.heap_max]=n,s[2*r]=s[2*i]+s[2*n],t.depth[r]=(t.depth[i]>=t.depth[n]?t.depth[i]:t.depth[n])+1,s[2*i+1]=s[2*n+1]=r,t.heap[1]=r++,D(t,s,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var i,n,r,s,a,o,h=e.dyn_tree,u=e.max_code,c=e.stat_desc.static_tree,_=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,g=e.stat_desc.extra_base,f=e.stat_desc.max_length,m=0;for(s=0;s<=l;s++)t.bl_count[s]=0;for(h[2*t.heap[t.heap_max]+1]=0,i=t.heap_max+1;i<573;i++)(s=h[2*h[2*(n=t.heap[i])+1]+1]+1)>f&&(s=f,m++),h[2*n+1]=s,n>u||(t.bl_count[s]++,a=0,n>=g&&(a=d[n-g]),o=h[2*n],t.opt_len+=o*(s+a),_&&(t.static_len+=o*(c[2*n+1]+a)));if(0!==m){do{for(s=f-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[f]--,m-=2}while(m>0);for(s=f;0!==s;s--)for(n=t.bl_count[s];0!==n;)(r=t.heap[--i])>u||(h[2*r+1]!==s&&(t.opt_len+=(s-h[2*r+1])*h[2*r],h[2*r+1]=s),n--)}}(t,e),k(s,u,t.bl_count)}function $(t,e,i){var n,r,s=-1,a=e[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),e[2*(i+1)+1]=65535,n=0;n<=i;n++)r=a,a=e[2*(n+1)+1],++o<l&&r===a||(o<h?t.bl_tree[2*r]+=o:0!==r?(r!==s&&t.bl_tree[2*r]++,t.bl_tree[32]++):o<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=0,s=r,0===a?(l=138,h=3):r===a?(l=6,h=3):(l=7,h=4))}function z(t,e,i){var n,r,s=-1,a=e[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),n=0;n<=i;n++)if(r=a,a=e[2*(n+1)+1],!(++o<l&&r===a)){if(o<h)do{L(t,r,t.bl_tree)}while(0!=--o);else 0!==r?(r!==s&&(L(t,r,t.bl_tree),o--),L(t,16,t.bl_tree),A(t,o-3,2)):o<=10?(L(t,17,t.bl_tree),A(t,o-3,3)):(L(t,18,t.bl_tree),A(t,o-11,7));o=0,s=r,0===a?(l=138,h=3):r===a?(l=6,h=3):(l=7,h=4)}}r(S);var B=!1;function U(t,e,i,r){A(t,0+(r?1:0),3),function(t,e,i,r){R(t),C(t,i),C(t,~i),n.arraySet(t.pending_buf,t.window,e,i,t.pending),t.pending+=i}(t,e,i)}e._tr_init=function(t){B||(function(){var t,e,i,n,r,s=new Array(l+1);for(i=0,n=0;n<28;n++)for(w[n]=i,t=0;t<1<<u[n];t++)p[i++]=n;for(p[i-1]=n,r=0,n=0;n<16;n++)for(S[n]=r,t=0;t<1<<c[n];t++)m[r++]=n;for(r>>=7;n<o;n++)for(S[n]=r<<7,t=0;t<1<<c[n]-7;t++)m[256+r++]=n;for(e=0;e<=l;e++)s[e]=0;for(t=0;t<=143;)g[2*t+1]=8,t++,s[8]++;for(;t<=255;)g[2*t+1]=9,t++,s[9]++;for(;t<=279;)g[2*t+1]=7,t++,s[7]++;for(;t<=287;)g[2*t+1]=8,t++,s[8]++;for(k(g,287,s),t=0;t<o;t++)f[2*t+1]=5,f[2*t]=I(t,5);b=new x(g,u,257,a,l),v=new x(f,c,0,o,l),y=new x(new Array(0),_,0,19,7)}(),B=!0),t.l_desc=new T(t.dyn_ltree,b),t.d_desc=new T(t.dyn_dtree,v),t.bl_desc=new T(t.bl_tree,y),t.bi_buf=0,t.bi_valid=0,P(t)},e._tr_stored_block=U,e._tr_flush_block=function(t,e,i,n){var r,a,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,i=4093624447;for(e=0;e<=31;e++,i>>>=1)if(1&i&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<s;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),N(t,t.l_desc),N(t,t.d_desc),o=function(t){var e;for($(t,t.dyn_ltree,t.l_desc.max_code),$(t,t.dyn_dtree,t.d_desc.max_code),N(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*d[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),r=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=r&&(r=a)):r=a=i+5,i+4<=r&&-1!==e?U(t,e,i,n):4===t.strategy||a===r?(A(t,2+(n?1:0),3),F(t,g,f)):(A(t,4+(n?1:0),3),function(t,e,i,n){var r;for(A(t,e-257,5),A(t,i-1,5),A(t,n-4,4),r=0;r<n;r++)A(t,t.bl_tree[2*d[r]+1],3);z(t,t.dyn_ltree,e-1),z(t,t.dyn_dtree,i-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),F(t,t.dyn_ltree,t.dyn_dtree)),P(t),n&&R(t)},e._tr_tally=function(t,e,i){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&i,t.last_lit++,0===e?t.dyn_ltree[2*i]++:(t.matches++,e--,t.dyn_ltree[2*(p[i]+s+1)]++,t.dyn_dtree[2*M(e)]++),t.last_lit===t.lit_bufsize-1},e._tr_align=function(t){A(t,2,3),L(t,256,g),function(t){16===t.bi_valid?(C(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},894:t=>{t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var i=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](i,i.exports,__webpack_require__),i.exports}__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var i in e)__webpack_require__.o(e,i)&&!__webpack_require__.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ABR:()=>di,ACFT:()=>ci,ASEP:()=>g,Alignment:()=>Do,AltTypes:()=>eu,AltUnits:()=>xl,Annotation:()=>pa,AnnotationClickEventArgs:()=>ju,ArrivedEventArgs:()=>Yu,AstroCalc:()=>Hr,AstroRaDec:()=>Gr,AudioOverlay:()=>Mh,AudioType:()=>gh,BandPass:()=>Mo,BinaryReader:()=>js,Bitmap:()=>Os,BitmapOverlay:()=>bh,BlendState:()=>xr,BodyAngles:()=>Ko,C3D:()=>_,CAAEarth:()=>U,CAAEclipticalElementDetails:()=>mi,CAAEclipticalElements:()=>pi,CAAFK5:()=>V,CAAGlobe:()=>On,CAAJupiter:()=>ae,CAAKepler:()=>ui,CAAMars:()=>Vt,CAAMercury:()=>ot,CAAMoon:()=>Kn,CAAMoonNodes:()=>Qn,CAAMoonPerigeeApogee:()=>sr,CAAMoonPhases:()=>ar,CAANeptune:()=>ii,CAANutation:()=>X,CAAParallax:()=>ur,CAAPhysicalJupiter:()=>_r,CAAPhysicalJupiterDetails:()=>cr,CAAPhysicalMars:()=>gr,CAAPhysicalMarsDetails:()=>dr,CAAPhysicalSun:()=>mr,CAAPhysicalSunDetails:()=>fr,CAAPluto:()=>hi,CAAPrecession:()=>pr,CAARiseTransitSet:()=>br,CAARiseTransitSetDetails:()=>wr,CAASaturn:()=>Me,CAASaturnRingDetails:()=>vr,CAASaturnRings:()=>yr,CAASidereal:()=>or,CAAStellarMagnitudes:()=>Sr,CAASun:()=>H,CAATopocentricEclipticDetails:()=>lr,CAAUranus:()=>Ve,CAAVenus:()=>Tt,COR:()=>c,CT:()=>d,CalD:()=>o,CameraParameters:()=>Aa,CatalogSpreadSheetLayer:()=>gu,Circle:()=>ba,Classification:()=>Qo,CollectionLoadedEventArgs:()=>Wu,Color:()=>Oi,ColorMapContainer:()=>Ba,ColorMaps:()=>nu,ColorPicker:()=>ml,Colors:()=>Xi,ConstellationFilter:()=>Ia,Constellations:()=>Yo,ContextMenuStrip:()=>Gs,ConvexHull:()=>Rn,Coordinates:()=>Qs,CoordinatesTypes:()=>tu,CullMode:()=>Ts,Cursor:()=>Ri,Cursors:()=>Ei,DAY_OF_WEEK:()=>l,DT:()=>h,DYT:()=>fi,DataItem:()=>Cs,DataTypes:()=>Ha,DataVizWizard:()=>Cu,Dates:()=>As,Dialog:()=>pl,DialogResult:()=>Vi,DomainValue:()=>Ml,DoubleUtilities:()=>Tn,ELL:()=>$n,EO:()=>Nn,EOD:()=>Fn,EOE:()=>En,EOT:()=>zn,EPD:()=>Dn,EPO:()=>wi,EllipseRenderer:()=>Kl,EllipseShader:()=>gs,EquirectangularTile:()=>so,FadeType:()=>Tl,FastMath:()=>ea,FileCabinet:()=>ch,FileEntry:()=>uh,FitsImage:()=>Ga,FitsImageJs:()=>Ja,FitsImageTile:()=>to,FitsProperties:()=>Ra,FitsShader:()=>ws,FlipbookOverlay:()=>Ah,Folder:()=>Fu,FolderBrowser:()=>zu,FolderDownloadAction:()=>sc,FolderGroup:()=>Ru,FolderRefreshType:()=>Eu,FolderType:()=>Du,FolderUp:()=>nl,Formatting:()=>Zs,FrameTarget:()=>Su,FrameWizard:()=>xu,Fxyf:()=>ha,GFX:()=>oc,GM:()=>Vn,GMD:()=>Bn,GMDS:()=>Un,Galaxy:()=>Da,GlyphCache:()=>zo,GlyphItem:()=>$o,GreatCircleDialog:()=>Mu,GreatCirlceRouteLayer:()=>El,GridLayer:()=>Fl,Grids:()=>sl,GroundOverlayLayer:()=>yu,Group:()=>Vl,Guid:()=>Ii,HealpixTables:()=>aa,HealpixTile:()=>lo,HealpixUtils:()=>oa,HipsProperties:()=>Uu,Histogram:()=>bl,HistogramEqualization:()=>Ka,Hploc:()=>la,IFR:()=>Gn,INTP:()=>Xn,IPlace:()=>ca,ISSLayer:()=>Jh,ISettings:()=>fa,IThumbnail:()=>ua,IUIServicesCallbacks:()=>ga,IUiController:()=>_a,IUndoStep:()=>ma,IViewMover:()=>da,ImageSetLayer:()=>Nl,ImageSetType:()=>To,ImageShader:()=>bs,ImageShader2:()=>vs,Imageset:()=>Co,InViewReturnMessage:()=>Ou,IndexBuffer:()=>Wr,InterpolationType:()=>Ca,KeplerPointSpriteShader:()=>ds,KeplerVertex:()=>al,KeplerianElements:()=>Zo,Keys:()=>Di,KmlCoordinate:()=>hu,KmlLineList:()=>uu,Language:()=>Pi,LatLngEdges:()=>fo,Layer:()=>Cl,LayerInfo:()=>Fh,LayerManager:()=>wu,LayerMap:()=>bu,LayerUI:()=>Ll,LayerUIMenuItem:()=>Il,LayerUITreeNode:()=>Pl,LineList:()=>Es,LineShaderNormalDates:()=>cs,Linepoint:()=>Ho,Lineset:()=>Go,LocationHint:()=>un,LoopTypes:()=>mh,MIFR:()=>Jn,MPAC:()=>tr,MarkerMixes:()=>iu,MarkerScales:()=>su,MasterTime:()=>Kh,Material:()=>zl,Matrix2d:()=>xn,Matrix3d:()=>yn,MercatorTile:()=>uo,Mesh:()=>Ol,ModelShader:()=>fs,ModelShaderTan:()=>ms,MoonCoefficient1:()=>Hn,MoonCoefficient2:()=>Yn,Mouse:()=>ki,NUC:()=>O,Object3d:()=>Hl,Object3dLayer:()=>Bl,Object3dLayerUI:()=>Wl,ObjectNode:()=>jl,Orbit:()=>ql,OrbitLayer:()=>eh,OrbitLayerUI:()=>nh,OrbitLineList:()=>Ps,OrbitLineShader:()=>us,Overlay:()=>ph,OverlayAnchor:()=>dh,OverlayList:()=>Xh,OverlayProperties:()=>zi,Place:()=>tl,PlaneD:()=>Mn,Planets:()=>Jo,PlotTile:()=>go,PlotTypes:()=>ru,PlutoCoefficient1:()=>ni,PlutoCoefficient2:()=>ri,PointList:()=>zs,PointScaleTypes:()=>Ms,PointType:()=>Oo,Pointing:()=>ol,Poly:()=>ya,PolyLine:()=>xa,PopupColorPicker:()=>$i,PopupVolume:()=>Ni,PositionColored:()=>gn,PositionColoredTextured:()=>dn,PositionNormalTextured:()=>In,PositionNormalTexturedTangent:()=>mn,PositionNormalTexturedTangentVertexBuffer:()=>Qr,PositionNormalTexturedVertexBuffer:()=>Jr,PositionNormalTexturedX2:()=>An,PositionTexture:()=>cn,PositionVertexBuffer:()=>Zr,Primitives:()=>ah,ProjectionType:()=>xo,PushPin:()=>cu,RAUnits:()=>au,Rectangle:()=>Ai,ReferenceFrame:()=>Ql,ReferenceFrameProps:()=>Tu,ReferenceFrameTypes:()=>Jl,ReferenceFrames:()=>pu,RenderContext:()=>Gu,RenderTriangle:()=>no,RiseSetDetails:()=>Xr,ScaleLinear:()=>ja,ScaleLog:()=>Wa,ScaleMap:()=>Ya,ScalePow:()=>qa,ScaleSqrt:()=>Za,ScaleTypes:()=>Pa,ScriptInterface:()=>qu,SelectLink:()=>Fi,Selection:()=>kh,SelectionAnchor:()=>Ih,SettingParameter:()=>Io,Settings:()=>ko,ShapeOverlay:()=>xh,ShapeSpriteShader:()=>Ss,ShapeType:()=>fh,ShortIndexBuffer:()=>jr,SimpleInput:()=>qs,SimpleLineList:()=>Is,SimpleLineShader:()=>ls,SimpleLineShader2D:()=>hs,SkyImageTile:()=>wo,SkyOverlays:()=>vu,SlideChangedEventArgs:()=>Hu,SolarSystemObjects:()=>Ma,SoundEditor:()=>Yh,SpaceTimeController:()=>Wo,SphereHull:()=>Pn,SpreadSheetLayer:()=>_u,SpriteShader:()=>ys,Star:()=>Ea,StateType:()=>Na,StockSkyOverlayTypes:()=>Lo,Table:()=>rh,TagMe:()=>Ys,TangentTile:()=>mo,Tessellator:()=>as,Text3d:()=>Uo,Text3dBatch:()=>Fo,TextBorderStyle:()=>Ro,TextObject:()=>Eo,TextOverlay:()=>yh,TextShader:()=>xs,Texture:()=>rs,ThumbnailSize:()=>$u,Tile:()=>eo,TileShader:()=>ps,TimeLine:()=>Wh,TimeSeriesLayer:()=>ou,TimeSeriesLineVertex:()=>Us,TimeSeriesPointSpriteShader:()=>_s,TimeSeriesPointVertex:()=>Vs,ToastTile:()=>yo,ToolStripMenuItem:()=>Xs,ToolStripSeparator:()=>Hs,Tour:()=>ll,TourDocument:()=>Lu,TourEdit:()=>Hh,TourEditTab:()=>ku,TourEditor:()=>Oh,TourPlayer:()=>qh,TourStop:()=>Eh,TourStopList:()=>jh,TransitionType:()=>Rh,TriangleFanList:()=>Ns,TriangleList:()=>Fs,URLHelpers:()=>zr,URLRewriteMode:()=>$r,UiTools:()=>Fa,Undo:()=>zh,UndoStep:()=>Bh,UndoTourPropertiesChange:()=>Vh,UndoTourSlidelistChange:()=>Uh,UndoTourStopChange:()=>Nh,UserLevel:()=>Au,Util:()=>a,VSC:()=>f,Vector2d:()=>vn,Vector3d:()=>wn,Vector4d:()=>Cn,VertexBufferBase:()=>qr,VideoOutputType:()=>ul,ViewMoverKenBurnsStyle:()=>cl,VizLayer:()=>fl,VoColumn:()=>hh,VoRow:()=>lh,VoTable:()=>oh,VoTableLayer:()=>fu,WWTControl:()=>tc,WWTControlBuilder:()=>ic,WWTElementEvent:()=>rc,WcsImage:()=>Va,WebFile:()=>$a,Wtml:()=>ac,XmlTextWriter:()=>Ks,Xyf:()=>oo,set_tilePrepDevice:()=>Yi,set_useGlVersion2:()=>Qi,ss:()=>t.ss});var t=__webpack_require__(560);const e=t.ss.createRegistry("wwtlib"),i={};function n(i,n){t.ss.createType(i,n,e)}function r(t,e){i[t]=e}function s(){}function a(){}function o(){this.year=0,this.month=0,this.day=0,this.year=0,this.month=0,this.day=0}s.parse=function(t,e){if("Default"===e&&(e="DefaultV"),"0"===e)return 0;var n=e.substr(0,1).toLowerCase()+e.substr(1);return i[t][n]},s.toXml=function(t,e){var n="0",r=Object.keys(i[t]);for(var s in r)if(i[t][r[s]]==e){n=r[s];break}var a=n,o=a.substr(0,1).toUpperCase()+a.substr(1);return"DefaultV"===o&&(o="Default"),o},n("Enums",[s,{},null]),a.splitString=function(t,e){for(var i=[],n=0,r=0,s=0;s<t.length;s++){for(var a=!1,o=0;o<e.length;o++)t[s]!==e[o]?(n=s+1,r=s+1):(i.push(t.substring(n,r-n)),a=!0);a||r++}return r>n&&i.push(t.substring(n,r-n)),i},a.stringContains=function(t,e){for(var i=0;i<e.length;i++)if(t.indexOf(e[i])>-1)return!0;return!1},a.getHashCode=function(t){var e=0;if(!t.length)return e;for(var i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i);return e},a.compare=function(t,e){return t===e?0:t>e?1:-1},a.logN=function(t,e){return Math.log(t)/Math.log(e)},a.parseTimeSpan=function(e){var i=0,n=e.split(":");return 3===n.length&&(i+=36e5*parseInt(n[0]),i+=6e4*parseInt(n[1]),i+=t.ss.truncate(1e3*parseFloat(n[2]))),i},a.xmlDuration=function(e){var i=e/1e3,n=Math.floor(i/3600),r=Math.floor(i/60)-60*n,s=i-(3600*n+60*r);return t.ss.format("{0}:{1}:{2}",n,r,s)},a.xmlDate=function(t){var e=t.getHours(),i="AM";return e>12&&(e-=12,i="PM"),(t.getMonth()+1).toString()+"/"+t.getDate().toString()+"/"+t.getFullYear().toString()+" "+e.toString()+":"+t.getMinutes().toString()+":"+t.getSeconds().toString()+" "+i},a.selectSingleNode=function(e,i){for(var n=null,r=t.ss.enumerate(e.childNodes);r.moveNext();){var s=r.current;if(s.nodeName===i){n=s;break}}return n},a.getInnerText=function(e){return t.ss.emptyString(e.text)?e.textContent:e.text},a.getWrappedText=function(t,e,i){var n=[];return n.push(e),n},a.toHex=function(e){var i=Math.max(0,Math.min(t.ss.truncate(e),255));return"0123456789ABCDEF".substr((i-i%16)/16,1)+"0123456789ABCDEF".substr(i%16,1)},a.fromHex=function(t){var e=0;switch(t.substr(1,1).toUpperCase()){case"A":e+=10;break;case"B":e+=11;break;case"C":e+=12;break;case"D":e+=13;break;case"E":e+=14;break;case"F":e+=15;break;default:e+=parseInt(t.substr(1,1))}switch(t.substr(0,1).toUpperCase()){case"A":e+=160;break;case"B":e+=176;break;case"C":e+=192;break;case"D":e+=208;break;case"E":e+=224;break;case"F":e+=240;break;default:e+=16*parseInt(t.substr(0,1))}return e},a._openUrl=function(t){window.open(t)},a.log10=function(t){return Math.log(t)/2.30258509299405},a.sign=function(t){return t<0?-1:1},n("Util",[a,{},null]),o.create=function(t,e,i){var n=new o;return n.year=t,n.month=e,n.day=i,n},n("CalD",[o,{},null]);var l={SUNDAY:0,MONDAY:1,TUESDAY:2,WEDNESDAY:3,THURSDAY:4,FRIDAY:5,SATURDAY:6};function h(){this.m_dblJulian=0,this.m_bGregorianCalendar=!1,this.m_dblJulian=0,this.m_bGregorianCalendar=!1}n("DAY_OF_WEEK",l),h.create=function(t,e,i,n){var r=new h;return r.set(t,e,i,0,0,0,n),r},h.createHMS=function(t,e,i,n,r,s,a){var o=new h;return o.set(t,e,i,n,r,s,a),o},h.createJD=function(t,e){var i=new h;return i.setJD(t,e),i},h.dateToJD=function(e,i,n,r){var s=e,a=i;a<3&&(s-=1,a+=12);var o=0,l=0;return r&&(l=2-(o=t.ss.truncate(s/100))+t.ss.truncate(o/4)),t.ss.truncate(365.25*(s+4716))+t.ss.truncate(30.6001*(a+1))+n+l-1524.5},h.isLeap=function(t,e){return e?t%100?!(t%4):!(t%400):!(t%4)},h.afterPapalReform=function(t,e,i){return t>1582||1582===t&&e>10||1582===t&&10===e&&i>=15},h.afterPapalReformJD=function(t){return t>=2299160.5},h.dayOfYearJD=function(t,e,i){return t-h.dateToJD(e,1,1,i)+1},h.daysInMonthForMonth=function(t,e){console.assert(t>=1&&t<=12);var i=[31,28,31,30,31,30,31,31,30,31,30,31,0];return e&&i[1]++,i[t-1]},h.INT=function(e){return e>=0?t.ss.truncate(e):t.ss.truncate(e-1)};var u={julian:function(){return this.m_dblJulian},day:function(){var e=this.get();return t.ss.truncate(e[2])},month:function(){var e=this.get();return t.ss.truncate(e[1])},year:function(){var e=this.get();return t.ss.truncate(e[0])},hour:function(){var e=this.get();return t.ss.truncate(e[3])},minute:function(){var e=this.get();return t.ss.truncate(e[4])},second:function(){var e=this.get();return t.ss.truncate(e[5])},set:function(t,e,i,n,r,s,a){var o=i+n/24+r/1440+s/86400;this.setJD(h.dateToJD(t,e,o,a),a)},setJD:function(t,e){this.m_dblJulian=t,this.setInGregorianCalendar(e)},setInGregorianCalendar:function(t){var e=this.m_dblJulian>=2299160.5;this.m_bGregorianCalendar=t&&e},get:function(){var e,i,n,r,s,a,o=this.m_dblJulian+.5,l=Math.floor(o),h=o-l,u=t.ss.truncate(l);if(this.m_bGregorianCalendar){var c=t.ss.truncate((u-1867216.25)/36524.25);a=u+1+c-t.ss.truncate(c/4)}else a=u;var _=a+1524,d=t.ss.truncate((_-122.1)/365.25),g=t.ss.truncate(365.25*d),f=t.ss.truncate((_-g)/30.6001),m=_-g-t.ss.truncate(30.6001*f)+h;return n=t.ss.truncate(m),e=(i=f<14?f-1:f-13)>2?d-4716:d-4715,h=m-(l=Math.floor(m)),[e,i,n,r=t.ss.truncate(24*h),s=t.ss.truncate(1440*(h-r/24)),86400*(h-r/24-s/1440)]},dayOfWeek:function(){return t.ss.truncate(this.m_dblJulian+1.5)%7},dayOfYear:function(){var e=t.ss.truncate(this.get()[0]);return h.dayOfYearJD(this.m_dblJulian,e,h.afterPapalReform(e,1,1))},daysInMonth:function(){var e=this.get(),i=t.ss.truncate(e[0]),n=t.ss.truncate(e[1]);return h.daysInMonthForMonth(n,h.isLeap(i,this.m_bGregorianCalendar))},daysInYear:function(){var e=this.get(),i=t.ss.truncate(e[0]);return h.isLeap(i,this.m_bGregorianCalendar)?366:365},leap:function(){return h.isLeap(this.year(),this.m_bGregorianCalendar)},inGregorianCalendar:function(){return this.m_bGregorianCalendar},fractionalYear:function(){var e,i=this.get(),n=t.ss.truncate(i[0]);return t.ss.truncate(i[1]),t.ss.truncate(i[2]),t.ss.truncate(i[3]),t.ss.truncate(i[4]),i[5],e=h.isLeap(n,this.m_bGregorianCalendar)?366:365,n+(this.m_dblJulian-h.dateToJD(n,1,1,h.afterPapalReform(n,1,1)))/e}};function c(){this.x=0,this.y=0,this.x=0,this.y=0}function _(){this.x=0,this.y=0,this.z=0,this.x=0,this.y=0,this.z=0}function d(){}function g(){}function f(t,e,i){this.a=0,this.b=0,this.c=0,this.a=t,this.b=e,this.c=i}n("DT",[h,u,null]),c.create=function(t,e){var i=new c;return i.x=t,i.y=e,i},n("COR",[c,{},null]),_.create=function(t,e,i){var n=new _;return n.x=t,n.y=e,n.z=i,n},n("C3D",[_,{},null]),d.eq2Ec=function(t,e,i){t=d.h2R(t),e=d.d2R(e),i=d.d2R(i);var n=new c;return n.x=d.r2D(Math.atan2(Math.sin(t)*Math.cos(i)+Math.tan(e)*Math.sin(i),Math.cos(t))),n.x<0&&(n.x+=360),n.y=d.r2D(Math.asin(Math.sin(e)*Math.cos(i)-Math.cos(e)*Math.sin(i)*Math.sin(t))),n},d.ec2Eq=function(t,e,i){t=d.d2R(t),e=d.d2R(e),i=d.d2R(i);var n=new c;return n.x=d.r2H(Math.atan2(Math.sin(t)*Math.cos(i)-Math.tan(e)*Math.sin(i),Math.cos(t))),n.x<0&&(n.x+=24),n.y=d.r2D(Math.asin(Math.sin(e)*Math.cos(i)+Math.cos(e)*Math.sin(i)*Math.sin(t))),n},d.eq2H=function(t,e,i){t=d.h2R(t),e=d.d2R(e),i=d.d2R(i);var n=new c;return n.x=d.r2D(Math.atan2(Math.sin(t),Math.cos(t)*Math.sin(i)-Math.tan(e)*Math.cos(i))),n.x<0&&(n.x+=360),n.y=d.r2D(Math.asin(Math.sin(i)*Math.sin(e)+Math.cos(i)*Math.cos(e)*Math.cos(t))),n},d.h2Eq=function(t,e,i){t=d.d2R(t),e=d.d2R(e),i=d.d2R(i);var n=new c;return n.x=d.r2H(Math.atan2(Math.sin(t),Math.cos(t)*Math.sin(i)+Math.tan(e)*Math.cos(i))),n.x<0&&(n.x+=24),n.y=d.r2D(Math.asin(Math.sin(i)*Math.sin(e)-Math.cos(i)*Math.cos(e)*Math.cos(t))),n},d.eq2G=function(t,e){t=192.25-d.h2D(t),t=d.d2R(t),e=d.d2R(e);var i=new c;return i.x=d.r2D(Math.atan2(Math.sin(t),Math.cos(t)*Math.sin(d.d2R(27.4))-Math.tan(e)*Math.cos(d.d2R(27.4)))),i.x=303-i.x,i.x>=360&&(i.x-=360),i.y=d.r2D(Math.asin(Math.sin(e)*Math.sin(d.d2R(27.4))+Math.cos(e)*Math.cos(d.d2R(27.4))*Math.cos(t))),i},d.g2Eq=function(t,e){t-=123,t=d.d2R(t),e=d.d2R(e);var i=new c;return i.x=d.r2D(Math.atan2(Math.sin(t),Math.cos(t)*Math.sin(d.d2R(27.4))-Math.tan(e)*Math.cos(d.d2R(27.4)))),i.x+=12.25,i.x<0&&(i.x+=360),i.x=d.d2H(i.x),i.y=d.r2D(Math.asin(Math.sin(e)*Math.sin(d.d2R(27.4))+Math.cos(e)*Math.cos(d.d2R(27.4))*Math.cos(t))),i},d.d2R=function(t){return.0174532925199433*t},d.r2D=function(t){return 57.2957795130823*t},d.r2H=function(t){return 3.81971863420549*t},d.h2R=function(t){return.261799387799149*t},d.h2D=function(t){return 15*t},d.d2H=function(t){return t/15},d.PI=function(){return 3.14159265358979},d.m360=function(t){return t-360*Math.floor(t/360)},d.m24=function(t){return t-24*Math.floor(t/24)},d.dmS2D=function(t,e,i){return d.dmS2Dp(t,e,i,!0)},d.dmS2Dp=function(t,e,i,n){return n||(console.assert(t>=0),console.assert(e>=0),console.assert(i>=0)),n?t+e/60+i/3600:-t-e/60-i/3600},n("CT",[d,{},null]),g.separation=function(t,e,i,n){e=d.d2R(e),n=d.d2R(n),t=d.h2R(t),i=d.h2R(i);var r=Math.cos(e)*Math.sin(n)-Math.sin(e)*Math.cos(n)*Math.cos(i-t),s=Math.cos(n)*Math.sin(i-t),a=Math.sin(e)*Math.sin(n)+Math.cos(e)*Math.cos(n)*Math.cos(i-t),o=Math.atan2(Math.sqrt(r*r+s*s),a);return(o=d.r2D(o))<0&&(o+=180),o},g.positionAngle=function(t,e,i,n){var r,s;r=d.d2R(e),s=d.d2R(n);var a=d.h2R(t)-d.h2R(i),o=Math.cos(s)*Math.tan(r)-Math.sin(s)*Math.cos(a),l=Math.sin(a),h=Math.atan2(l,o);return d.r2D(h)},g.distanceFromGreatArc=function(t,e,i,n,r,s){e=d.d2R(e),n=d.d2R(n),s=d.d2R(s),t=d.h2R(t),i=d.h2R(i),r=d.h2R(r);var a=Math.cos(e)*Math.cos(t),o=Math.cos(n)*Math.cos(i),l=Math.cos(e)*Math.sin(t),h=Math.cos(n)*Math.sin(i),u=Math.sin(e),c=Math.sin(n),_=l*c-u*h,g=u*o-a*c,f=a*h-l*o,m=Math.tan(r),p=Math.tan(s)/Math.cos(r),w=Math.asin((_+g*m+f*p)/(Math.sqrt(_*_+g*g+f*f)*Math.sqrt(1+m*m+p*p)));return(w=d.r2D(w))<0&&(w=Math.abs(w)),w},n("ASEP",[g,{},null]),n("VSC",[f,{},null]);const m=[new f(175347046,0,0),new f(3341656,4.6692568,6283.07585),new f(34894,4.6261,12566.1517),new f(3497,2.7441,5753.3849),new f(3418,2.8289,3.5231),new f(3136,3.6277,77713.7715),new f(2676,4.4181,7860.4194),new f(2343,6.1352,3930.2097),new f(1324,.7425,11506.7698),new f(1273,2.0371,529.691),new f(1199,1.1096,1577.3435),new f(990,5.233,5884.927),new f(902,2.045,26.298),new f(857,3.508,398.149),new f(780,1.179,5223.694),new f(753,2.533,5507.553),new f(505,4.583,18849.228),new f(492,4.205,775.523),new f(357,2.92,.067),new f(317,5.849,11790.629),new f(284,1.899,796.288),new f(271,.315,10977.079),new f(243,.345,5486.778),new f(206,4.806,2544.314),new f(205,1.869,5573.143),new f(202,2.458,6069.777),new f(156,.833,213.299),new f(132,3.411,2942.463),new f(126,1.083,20.775),new f(115,.645,.98),new f(103,.636,4694.003),new f(102,.976,15720.839),new f(102,4.267,7.114),new f(99,6.21,2146.17),new f(98,.68,155.42),new f(86,5.98,161000.69),new f(85,1.3,6275.96),new f(85,3.67,71430.7),new f(80,1.81,17260.15),new f(79,3.04,12036.46),new f(75,1.76,5088.63),new f(74,3.5,3154.69),new f(74,4.68,801.82),new f(70,.83,9437.76),new f(62,3.98,8827.39),new f(61,1.82,7084.9),new f(57,2.78,6286.6),new f(56,4.39,14143.5),new f(56,3.47,6279.55),new f(52,.19,12139.55),new f(52,1.33,1748.02),new f(51,.28,5856.48),new f(49,.49,1194.45),new f(41,5.37,8429.24),new f(41,2.4,19651.05),new f(39,6.17,10447.39),new f(37,6.04,10213.29),new f(37,2.57,1059.38),new f(36,1.71,2352.87),new f(36,1.78,6812.77),new f(33,.59,17789.85),new f(30,.44,83996.85),new f(30,2.74,1349.87),new f(25,3.16,4690.48)],p=[new f(628331966747,0,0),new f(206059,2.678235,6283.07585),new f(4303,2.6351,12566.1517),new f(425,1.59,3.523),new f(119,5.796,26.298),new f(109,2.966,1577.344),new f(93,2.59,18849.23),new f(72,1.14,529.69),new f(68,1.87,398.15),new f(67,4.41,5507.55),new f(59,2.89,5223.69),new f(56,2.17,155.42),new f(45,.4,796.3),new f(36,.47,775.52),new f(29,2.65,7.11),new f(21,5.43,.98),new f(19,1.85,5486.78),new f(19,4.97,213.3),new f(17,2.99,6275.96),new f(16,.03,2544.31),new f(16,1.43,2146.17),new f(15,1.21,10977.08),new f(12,2.83,1748.02),new f(12,3.26,5088.63),new f(12,5.27,1194.45),new f(12,2.08,4694),new f(11,.77,553.57),new f(10,1.3,6286.6),new f(10,4.24,1349.87),new f(9,2.7,242.73),new f(9,5.64,951.72),new f(8,5.3,2352.87),new f(6,2.65,9437.76),new f(6,4.67,4690.48)],w=[new f(52919,0,0),new f(8720,1.0721,6283.0758),new f(309,.867,12566.152),new f(27,.05,3.52),new f(16,5.19,26.3),new f(16,3.68,155.42),new f(10,.76,18849.23),new f(9,2.06,77713.77),new f(7,.83,775.52),new f(5,4.66,1577.34),new f(4,1.03,7.11),new f(4,3.44,5573.14),new f(3,5.14,796.3),new f(3,6.05,5507.55),new f(3,1.19,242.73),new f(3,6.12,529.69),new f(3,.31,398.15),new f(3,2.28,553.57),new f(2,4.38,5223.69),new f(2,3.75,.98)],b=[new f(289,5.844,6283.076),new f(35,0,0),new f(17,5.49,12566.15),new f(3,5.2,155.42),new f(1,4.72,3.52),new f(1,5.3,18849.23),new f(1,5.97,242.73)],v=[new f(114,3.142,0),new f(8,4.13,6283.08),new f(1,3.84,12566.15)],y=[new f(1,3.14,0)],S=[new f(280,3.199,84334.662),new f(102,5.422,5507.553),new f(80,3.88,5223.69),new f(44,3.7,2352.87),new f(32,4,1577.34)],x=[new f(9,3.9,5507.55),new f(6,1.73,5223.69)],T=[new f(22378,3.38509,10213.28555),new f(282,0,0),new f(173,5.256,20426.571),new f(27,3.87,30639.86)],M=[new f(647,4.992,10213.286),new f(20,3.14,0),new f(6,.77,20426.57),new f(3,5.44,30639.86)],C=[new f(14,.32,10213.29)],A=[new f(100013989,0,0),new f(1670700,3.0984635,6283.07585),new f(13956,3.05525,12566.1517),new f(3084,5.1985,77713.7715),new f(1628,1.1739,5753.3849),new f(1576,2.8469,7860.4194),new f(925,5.453,11506.77),new f(542,4.564,3930.21),new f(472,3.661,5884.927),new f(346,.964,5507.553),new f(329,5.9,5223.694),new f(307,.299,5573.143),new f(243,4.273,11790.629),new f(212,5.847,1577.344),new f(186,5.022,10977.079),new f(175,3.012,18849.228),new f(110,5.055,5486.778),new f(98,.89,6069.78),new f(86,5.69,15720.84),new f(86,1.27,161000.69),new f(65,.27,17260.15),new f(63,.92,529.69),new f(57,2.01,83996.85),new f(56,5.24,71430.7),new f(49,3.25,2544.31),new f(47,2.58,775.52),new f(45,5.54,9437.76),new f(43,6.01,6275.96),new f(39,5.36,4694),new f(38,2.39,8827.39),new f(37,.83,19651.05),new f(37,4.9,12139.55),new f(36,1.67,12036.46),new f(35,1.84,2942.46),new f(33,.24,7084.9),new f(32,.18,5088.63),new f(32,1.78,398.15),new f(28,1.21,6286.6),new f(28,1.9,6279.55),new f(26,4.59,10447.39)],L=[new f(103019,1.10749,6283.07585),new f(1721,1.0644,12566.1517),new f(702,3.142,0),new f(32,1.02,18849.23),new f(31,2.84,5507.55),new f(25,1.32,5223.69),new f(18,1.42,1577.34),new f(10,5.91,10977.08),new f(9,1.42,6275.96),new f(9,.27,5486.78)],I=[new f(4359,5.7846,6283.0758),new f(124,5.579,12566.152),new f(12,3.14,0),new f(9,3.63,77713.77),new f(6,1.87,5573.14),new f(3,5.47,18849.23)],k=[new f(145,4.273,6283.076),new f(7,3.92,12566.15)],P=[new f(4,2.56,6283.08)],R=[new f(628307584999,0,0),new f(206059,2.678235,6283.07585),new f(4303,2.6351,12566.1517),new f(425,1.59,3.523),new f(119,5.796,26.298),new f(109,2.966,1577.344),new f(93,2.59,18849.23),new f(72,1.14,529.69),new f(68,1.87,398.15),new f(67,4.41,5507.55),new f(59,2.89,5223.69),new f(56,2.17,155.42),new f(45,.4,796.3),new f(36,.47,775.52),new f(29,2.65,7.11),new f(21,5.43,.98),new f(19,1.85,5486.78),new f(19,4.97,213.3),new f(17,2.99,6275.96),new f(16,.03,2544.31),new f(16,1.43,2146.17),new f(15,1.21,10977.08),new f(12,2.83,1748.02),new f(12,3.26,5088.63),new f(12,5.27,1194.45),new f(12,2.08,4694),new f(11,.77,553.57),new f(10,1.3,6286.6),new f(10,4.24,1349.87),new f(9,2.7,242.73),new f(9,5.64,951.72),new f(8,5.3,2352.87),new f(6,2.65,9437.76),new f(6,4.67,4690.48)],E=[new f(8722,1.0725,6283.0758),new f(991,3.1416,0),new f(295,.437,12566.152),new f(27,.05,3.52),new f(16,5.19,26.3),new f(16,3.69,155.42),new f(9,.3,18849.23),new f(9,2.06,77713.77),new f(7,.83,775.52),new f(5,4.66,1577.34),new f(4,1.03,7.11),new f(4,3.44,5573.14),new f(3,5.14,796.3),new f(3,6.05,5507.55),new f(3,1.19,242.73),new f(3,6.12,529.69),new f(3,.3,398.15),new f(3,2.28,553.57),new f(2,4.38,5223.69),new f(2,3.75,.98)],D=[new f(289,5.842,6283.076),new f(21,6.05,12566.15),new f(3,5.2,155.42),new f(3,3.14,0),new f(1,4.72,3.52),new f(1,5.97,242.73),new f(1,5.54,18849.23)],F=[new f(8,4.14,6283.08),new f(1,3.28,12566.15)],N=[new f(227778,3.413766,6283.07585),new f(3806,3.3706,12566.1517),new f(3620,0,0),new f(72,3.33,18849.23),new f(8,3.89,5507.55),new f(8,1.79,5223.69),new f(6,5.2,2352.87)],$=[new f(9721,5.1519,6283.07585),new f(233,3.1416,0),new f(134,.644,12566.152),new f(7,1.07,18849.23)],z=[new f(276,.595,6283.076),new f(17,3.14,0),new f(4,.12,12566.15)],B=[new f(6,2.27,6283.08),new f(1,0,0)];function U(){}function V(){}function O(t,e,i,n,r,s,a,o,l){this.d=0,this.m=0,this.mprime=0,this.f=0,this.omega=0,this.sincoeff1=0,this.sincoeff2=0,this.coscoeff1=0,this.coscoeff2=0,this.d=t,this.m=e,this.mprime=i,this.f=n,this.omega=r,this.sincoeff1=s,this.sincoeff2=a,this.coscoeff1=o,this.coscoeff2=l}U.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=m.length,l=0;for(e=0;e<o;e++)l+=m[e].a*Math.cos(m[e].b+m[e].c*i);var h=p.length,u=0;for(e=0;e<h;e++)u+=p[e].a*Math.cos(p[e].b+p[e].c*i);var c=w.length,_=0;for(e=0;e<c;e++)_+=w[e].a*Math.cos(w[e].b+w[e].c*i);var g=b.length,f=0;for(e=0;e<g;e++)f+=b[e].a*Math.cos(b[e].b+b[e].c*i);var S=v.length,x=0;for(e=0;e<S;e++)x+=v[e].a*Math.cos(v[e].b+v[e].c*i);var T=y.length,M=0;for(e=0;e<T;e++)M+=y[e].a*Math.cos(y[e].b+y[e].c*i);var C=(l+u*i+_*n+f*r+x*s+M*a)/1e8;return d.m360(d.r2D(C))},U.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=S.length,o=0;for(e=0;e<a;e++)o+=S[e].a*Math.cos(S[e].b+S[e].c*i);var l=x.length,h=0;for(e=0;e<l;e++)h+=x[e].a*Math.cos(x[e].b+x[e].c*i);var u=T.length,c=0;for(e=0;e<u;e++)c+=T[e].a*Math.cos(T[e].b+T[e].c*i);var _=M.length,g=0;for(e=0;e<_;e++)g+=M[e].a*Math.cos(M[e].b+M[e].c*i);var f=C.length,m=0;for(e=0;e<f;e++)m+=C[e].a*Math.cos(C[e].b+C[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},U.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=A.length,o=0;for(e=0;e<a;e++)o+=A[e].a*Math.cos(A[e].b+A[e].c*i);var l=L.length,h=0;for(e=0;e<l;e++)h+=L[e].a*Math.cos(L[e].b+L[e].c*i);var u=I.length,c=0;for(e=0;e<u;e++)c+=I[e].a*Math.cos(I[e].b+I[e].c*i);var _=k.length,d=0;for(e=0;e<_;e++)d+=k[e].a*Math.cos(k[e].b+k[e].c*i);var g=P.length,f=0;for(e=0;e<g;e++)f+=P[e].a*Math.cos(P[e].b+P[e].c*i);return(o+h*i+c*n+d*r+f*s)/1e8},U.sunMeanAnomaly=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(357.5291092+35999.0502909*e-1536e-7*i+n/2449e4)},U.eccentricity=function(t){var e=(t-2451545)/36525;return 1-.002516*e-e*e*74e-7},U.eclipticLongitudeJ2000=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=m.length,o=0;for(e=0;e<a;e++)o+=m[e].a*Math.cos(m[e].b+m[e].c*i);var l=R.length,h=0;for(e=0;e<l;e++)h+=R[e].a*Math.cos(R[e].b+R[e].c*i);var u=E.length,c=0;for(e=0;e<u;e++)c+=E[e].a*Math.cos(E[e].b+E[e].c*i);var _=D.length,g=0;for(e=0;e<_;e++)g+=D[e].a*Math.cos(D[e].b+D[e].c*i);var f=F.length,p=0;for(e=0;e<f;e++)p+=F[e].a*Math.cos(F[e].b+F[e].c*i);var w=(o+h*i+c*n+g*r+p*s)/1e8;return d.m360(d.r2D(w))},U.eclipticLatitudeJ2000=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=S.length,o=0;for(e=0;e<a;e++)o+=S[e].a*Math.cos(S[e].b+S[e].c*i);var l=N.length,h=0;for(e=0;e<l;e++)h+=N[e].a*Math.cos(N[e].b+N[e].c*i);var u=$.length,c=0;for(e=0;e<u;e++)c+=$[e].a*Math.cos($[e].b+$[e].c*i);var _=z.length,g=0;for(e=0;e<_;e++)g+=z[e].a*Math.cos(z[e].b+z[e].c*i);var f=B.length,m=0;for(e=0;e<f;e++)m+=B[e].a*Math.cos(B[e].b+B[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},n("CAAEarth",[U,{},null]),V.correctionInLongitude=function(t,e,i){var n=(i-2451545)/36525,r=t-1.397*n-31e-5*n*n;r=d.d2R(r),t=d.d2R(t),e=d.d2R(e);var s=.03916*(Math.cos(r)+Math.sin(r))*Math.tan(e)-.09033;return d.dmS2D(0,0,s)},V.correctionInLatitude=function(t,e){var i=(e-2451545)/36525,n=t-1.397*i-31e-5*i*i;n=d.d2R(n),t=d.d2R(t);var r=.03916*(Math.cos(n)-Math.sin(n));return d.dmS2D(0,0,r)},V.convertVSOPToFK5J2000=function(t){var e=new _;return e.x=t.x+4.4036e-7*t.y-1.90919e-7*t.z,e.y=-4.79966e-7*t.x+.917482137087*t.y-.397776982902*t.z,e.z=.397776982902*t.y+.917482137087*t.z,e},V.convertVSOPToFK5B1950=function(t){var e=new _;return e.x=.999925702634*t.x+.012189716217*t.y+11134016e-12*t.z,e.y=-.011179418036*t.x+.917413998946*t.y-.397777041885*t.z,e.z=-.004859003787*t.x+.397747363646*t.y+.917482111428*t.z,e},V.convertVSOPToFK5AnyEquinox=function(t,e){var i=(e-2451545)/36525,n=i*i,r=n*i,s=2306.2181*i+.30188*n+.017988*r;s=d.d2R(d.dmS2D(0,0,s));var a=2306.2181*i+1.09468*n+.018203*r;a=d.d2R(d.dmS2D(0,0,a));var o=2004.3109*i-.42665*n-.041833*r;o=d.d2R(d.dmS2D(0,0,o));var l=Math.cos(s),h=Math.cos(a),u=Math.cos(o),c=Math.sin(s),g=Math.sin(a),f=Math.sin(o),m=l*h*u-c*g,p=c*h+l*g*u,w=l*f,b=-l*g-c*h*u,v=l*h-c*g*u,y=-c*f,S=-h*f,x=-g*f,T=u,M=new _;return M.x=m*t.x+b*t.y+S*t.z,M.y=p*t.x+v*t.y+x*t.z,M.z=w*t.x+y*t.y+T*t.z,M},n("CAAFK5",[V,{},null]),n("NUC",[O,{},null]);const G=[new O(0,0,0,0,1,-171996,-174.2,92025,8.9),new O(-2,0,0,2,2,-13187,-1.6,5736,-3.1),new O(0,0,0,2,2,-2274,-.2,977,-.5),new O(0,0,0,0,2,2062,.2,-895,.5),new O(0,1,0,0,0,1426,-3.4,54,-.1),new O(0,0,1,0,0,712,.1,-7,0),new O(-2,1,0,2,2,-517,1.2,224,-.6),new O(0,0,0,2,1,-386,-.4,200,0),new O(0,0,1,2,2,-301,0,129,-.1),new O(-2,-1,0,2,2,217,-.5,-95,.3),new O(-2,0,1,0,0,-158,0,0,0),new O(-2,0,0,2,1,129,.1,-70,0),new O(0,0,-1,2,2,123,0,-53,0),new O(2,0,0,0,0,63,0,0,0),new O(0,0,1,0,1,63,.1,-33,0),new O(2,0,-1,2,2,-59,0,26,0),new O(0,0,-1,0,1,-58,-.1,32,0),new O(0,0,1,2,1,-51,0,27,0),new O(-2,0,2,0,0,48,0,0,0),new O(0,0,-2,2,1,46,0,-24,0),new O(2,0,0,2,2,-38,0,16,0),new O(0,0,2,2,2,-31,0,13,0),new O(0,0,2,0,0,29,0,0,0),new O(-2,0,1,2,2,29,0,-12,0),new O(0,0,0,2,0,26,0,0,0),new O(-2,0,0,2,0,-22,0,0,0),new O(0,0,-1,2,1,21,0,-10,0),new O(0,2,0,0,0,17,-.1,0,0),new O(2,0,-1,0,1,16,0,-8,0),new O(-2,2,0,2,2,-16,.1,7,0),new O(0,1,0,0,1,-15,0,9,0),new O(-2,0,1,0,1,-13,0,7,0),new O(0,-1,0,0,1,-12,0,6,0),new O(0,0,2,-2,0,11,0,0,0),new O(2,0,-1,2,1,-10,0,5,0),new O(2,0,1,2,2,-8,0,3,0),new O(0,1,0,2,2,7,0,-3,0),new O(-2,1,1,0,0,-7,0,0,0),new O(0,-1,0,2,2,-7,0,3,0),new O(2,0,0,2,1,-7,0,3,0),new O(2,0,1,0,0,6,0,0,0),new O(-2,0,2,2,2,6,0,-3,0),new O(-2,0,1,2,1,6,0,-3,0),new O(2,0,-2,0,1,-6,0,3,0),new O(2,0,0,0,1,-6,0,3,0),new O(0,-1,1,0,0,5,0,0,0),new O(-2,-1,0,2,1,-5,0,3,0),new O(-2,0,0,0,1,-5,0,3,0),new O(0,0,2,2,1,-5,0,3,0),new O(-2,0,2,0,1,4,0,0,0),new O(-2,1,0,2,1,4,0,0,0),new O(0,0,1,-2,0,4,0,0,0),new O(-1,0,1,0,0,-4,0,0,0),new O(-2,1,0,0,0,-4,0,0,0),new O(1,0,0,0,0,-4,0,0,0),new O(0,0,1,2,0,3,0,0,0),new O(0,0,-2,2,2,-3,0,0,0),new O(-1,-1,1,0,0,-3,0,0,0),new O(0,1,1,0,0,-3,0,0,0),new O(0,-1,1,2,2,-3,0,0,0),new O(2,-1,-1,2,2,-3,0,0,0),new O(0,0,3,2,2,-3,0,0,0),new O(2,-1,0,2,2,-3,0,0,0)];function X(){}function H(){}X.nutationInLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=297.85036+445267.11148*e-.0019142*i+n/189474;r=d.m360(r);var s=357.52772+35999.05034*e-1603e-7*i-n/3e5;s=d.m360(s);var a=134.96298+477198.867398*e+.0086972*i+n/56250;a=d.m360(a);var o=93.27191+483202.017538*e-.0036825*i+n/327270;o=d.m360(o);var l=125.04452-1934.136261*e+.0020708*i+n/45e4;l=d.m360(l);for(var h=G.length,u=0,c=0;c<h;c++){var _=G[c].d*r+G[c].m*s+G[c].mprime*a+G[c].f*o+G[c].omega*l,g=d.d2R(_);u+=(G[c].sincoeff1+G[c].sincoeff2*e)*Math.sin(g)*1e-4}return u},X.nutationInObliquity=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=297.85036+445267.11148*e-.0019142*i+n/189474;r=d.m360(r);var s=357.52772+35999.05034*e-1603e-7*i-n/3e5;s=d.m360(s);var a=134.96298+477198.867398*e+.0086972*i+n/56250;a=d.m360(a);var o=93.27191+483202.017538*e-.0036825*i+n/327270;o=d.m360(o);var l=125.04452-1934.136261*e+.0020708*i+n/45e4;l=d.m360(l);for(var h=G.length,u=0,c=0;c<h;c++){var _=G[c].d*r+G[c].m*s+G[c].mprime*a+G[c].f*o+G[c].omega*l,g=d.d2R(_);u+=(G[c].coscoeff1+G[c].coscoeff2*e)*Math.cos(g)*1e-4}return u},X.nutationInRightAscension=function(t,e,i,n,r){return t=d.h2R(t),e=d.d2R(e),i=d.d2R(i),(Math.cos(i)+Math.sin(i)*Math.sin(t)*Math.tan(e))*n-Math.cos(t)*Math.tan(e)*r},X.nutationInDeclination=function(t,e,i,n,r){return t=d.h2R(t),e=d.d2R(e),i=d.d2R(i),Math.sin(i)*Math.cos(t)*n+Math.sin(t)*r},X.meanObliquityOfEcliptic=function(t){var e=(t-2451545)/3652500,i=e*e,n=i*e,r=n*e,s=r*e,a=s*e,o=a*e,l=o*e,h=l*e,u=h*e;return d.dmS2D(23,26,21.448)-d.dmS2D(0,0,4680.93)*e-d.dmS2D(0,0,1.55)*i+d.dmS2D(0,0,1999.25)*n-d.dmS2D(0,0,51.38)*r-d.dmS2D(0,0,249.67)*s-d.dmS2D(0,0,39.05)*a+d.dmS2D(0,0,7.12)*o+d.dmS2D(0,0,27.87)*l+d.dmS2D(0,0,5.79)*h+d.dmS2D(0,0,2.45)*u},X.trueObliquityOfEcliptic=function(t){return X.meanObliquityOfEcliptic(t)+d.dmS2D(0,0,X.nutationInObliquity(t))},n("CAANutation",[X,{},null]),H.geometricEclipticLongitude=function(t){return d.m360(U.eclipticLongitude(t)+180)},H.geometricEclipticLatitude=function(t){return-U.eclipticLatitude(t)},H.geometricEclipticLongitudeJ2000=function(t){return d.m360(U.eclipticLongitudeJ2000(t)+180)},H.geometricEclipticLatitudeJ2000=function(t){return-U.eclipticLatitudeJ2000(t)},H.geometricFK5EclipticLongitude=function(t){var e=H.geometricEclipticLongitude(t),i=H.geometricEclipticLatitude(t);return e+V.correctionInLongitude(e,i,t)},H.geometricFK5EclipticLatitude=function(t){var e=H.geometricEclipticLongitude(t);return H.geometricEclipticLatitude(t)+V.correctionInLatitude(e,t)},H.apparentEclipticLongitude=function(t){var e=H.geometricFK5EclipticLongitude(t);e+=d.dmS2D(0,0,X.nutationInLongitude(t));var i=U.radiusVector(t);return e-d.dmS2D(0,0,20.4898/i)},H.apparentEclipticLatitude=function(t){return H.geometricFK5EclipticLatitude(t)},H.eclipticRectangularCoordinatesMeanEquinox=function(t){var e=d.d2R(H.geometricFK5EclipticLongitude(t)),i=d.d2R(H.geometricFK5EclipticLatitude(t)),n=U.radiusVector(t),r=d.d2R(X.meanObliquityOfEcliptic(t)),s=new _;return s.x=n*Math.cos(i)*Math.cos(e),s.y=n*(Math.cos(i)*Math.sin(e)*Math.cos(r)-Math.sin(i)*Math.sin(r)),s.z=n*(Math.cos(i)*Math.sin(e)*Math.sin(r)+Math.sin(i)*Math.cos(r)),s},H.eclipticRectangularCoordinatesJ2000=function(t){var e=H.geometricEclipticLongitudeJ2000(t);e=d.d2R(e);var i=H.geometricEclipticLatitudeJ2000(t);i=d.d2R(i);var n=U.radiusVector(t),r=new _,s=Math.cos(i);return r.x=n*s*Math.cos(e),r.y=n*s*Math.sin(e),r.z=n*Math.sin(i),r},H.equatorialRectangularCoordinatesJ2000=function(t){var e=H.eclipticRectangularCoordinatesJ2000(t);return V.convertVSOPToFK5J2000(e)},H.equatorialRectangularCoordinatesB1950=function(t){var e=H.eclipticRectangularCoordinatesJ2000(t);return V.convertVSOPToFK5B1950(e)},H.equatorialRectangularCoordinatesAnyEquinox=function(t,e){var i=H.equatorialRectangularCoordinatesJ2000(t);return V.convertVSOPToFK5AnyEquinox(i,e)},n("CAASun",[H,{},null]);const Y=[new f(440250710,0,0),new f(40989415,1.48302034,26087.90314157),new f(5046294,4.47785449,52175.8062831),new f(855347,1.165203,78263.709425),new f(165590,4.119692,104351.612566),new f(34562,.77931,130439.51571),new f(7583,3.7135,156527.4188),new f(3560,1.512,1109.3786),new f(1803,4.1033,5661.332),new f(1726,.3583,182615.322),new f(1590,2.9951,25028.5212),new f(1365,4.5992,27197.2817),new f(1017,.8803,31749.2352),new f(714,1.541,24978.525),new f(644,5.303,21535.95),new f(451,6.05,51116.424),new f(404,3.282,208703.225),new f(352,5.242,20426.571),new f(345,2.792,15874.618),new f(343,5.765,955.6),new f(339,5.863,25558.212),new f(325,1.337,53285.185),new f(273,2.495,529.691),new f(264,3.917,57837.138),new f(260,.987,4551.953),new f(239,.113,1059.382),new f(235,.267,11322.664),new f(217,.66,13521.751),new f(209,2.092,47623.853),new f(183,2.629,27043.503),new f(182,2.434,25661.305),new f(176,4.536,51066.428),new f(173,2.452,24498.83),new f(142,3.36,37410.567),new f(138,.291,10213.286),new f(125,3.721,39609.655),new f(118,2.781,77204.327),new f(106,4.206,19804.827)],j=[new f(2608814706223,0,0),new f(1126008,6.2170397,26087.9031416),new f(303471,3.055655,52175.806283),new f(80538,6.10455,78263.70942),new f(21245,2.83532,104351.61257),new f(5592,5.8268,130439.5157),new f(1472,2.5185,156527.4188),new f(388,5.48,182615.322),new f(352,3.052,1109.379),new f(103,2.149,208703.225),new f(94,6.12,27197.28),new f(91,0,24978.52),new f(52,5.62,5661.33),new f(44,4.57,25028.52),new f(28,3.04,51066.43),new f(27,5.09,234791.13)],W=[new f(53050,0,0),new f(16904,4.69072,26087.90314),new f(7397,1.3474,52175.8063),new f(3018,4.4564,78263.7094),new f(1107,1.264,104351.6126),new f(378,4.32,130439.516),new f(123,1.069,156527.419),new f(39,4.08,182615.32),new f(15,4.63,1109.38),new f(12,.79,208703.23)],q=[new f(188,.035,52175.806),new f(142,3.125,26087.903),new f(97,3,78263.71),new f(44,6.02,104351.61),new f(35,0,0),new f(18,2.78,130439.52),new f(7,5.82,156527.42),new f(3,2.57,182615.32)],Z=[new f(114,3.1416,0),new f(2,2.03,26087.9),new f(2,1.42,78263.71),new f(2,4.5,52175.81),new f(1,4.5,104351.61),new f(1,1.27,130439.52)],K=[new f(1,3.14,0)],J=[new f(11737529,1.98357499,26087.90314157),new f(2388077,5.0373896,52175.8062831),new f(1222840,3.1415927,0),new f(543252,1.796444,78263.709425),new f(129779,4.832325,104351.612566),new f(31867,1.58088,130439.51571),new f(7963,4.6097,156527.4188),new f(2014,1.3532,182615.322),new f(514,4.378,208703.325),new f(209,2.02,24978.525),new f(208,4.918,27197.282),new f(132,1.119,234791.128),new f(121,1.813,53285.185),new f(100,5.657,20426.571)],Q=[new f(429151,3.501698,26087.903142),new f(146234,3.141593,0),new f(22675,.01515,52175.80628),new f(10895,.4854,78263.70942),new f(6353,3.4294,104351.6126),new f(2496,.1605,130439.5157),new f(860,3.185,156527.419),new f(278,6.21,182615.322),new f(86,2.95,208703.23),new f(28,.29,27197.28),new f(26,5.98,234791.13)],tt=[new f(11831,4.79066,26087.90314),new f(1914,0,0),new f(1045,1.2122,52175.8063),new f(266,4.434,78263.709),new f(170,1.623,104351.613),new f(96,4.8,130439.52),new f(45,1.61,156527.42),new f(18,4.67,182615.32),new f(7,1.43,208703.23)],et=[new f(235,.354,26087.903),new f(161,0,0),new f(19,4.36,52175.81),new f(6,2.51,78263.71),new f(5,6.14,104351.61),new f(3,3.12,130439.52),new f(2,6.27,156527.42)],it=[new f(4,1.75,26087.9),new f(1,3.14,0)],nt=[new f(39528272,0,0),new f(7834132,6.1923372,26087.9031416),new f(795526,2.959897,52175.806283),new f(121282,6.010642,78263.709425),new f(21922,2.7782,104351.61257),new f(4354,5.8289,130439.5157),new f(918,2.597,156527.419),new f(290,1.424,25028.521),new f(260,3.028,27197.282),new f(202,5.647,182615.322),new f(201,5.592,31749.235),new f(142,6.253,24978.525),new f(100,3.734,21535.95)],rt=[new f(217348,4.656172,26087.903142),new f(44142,1.42386,52175.80628),new f(10094,4.47466,78263.70942),new f(2433,1.2423,104351.6126),new f(1624,0,0),new f(604,4.293,130439.516),new f(153,1.061,156527.419),new f(39,4.11,182615.32)],st=[new f(3118,3.0823,26087.9031),new f(1245,6.1518,52175.8063),new f(425,2.926,78263.709),new f(136,5.98,104351.613),new f(42,2.75,130439.52),new f(22,3.14,0),new f(13,5.8,156527.42)],at=[new f(33,1.68,26087.9),new f(24,4.63,52175.81),new f(12,1.39,78263.71),new f(5,4.44,104351.61),new f(2,1.21,130439.52)];function ot(){}ot.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=Y.length,l=0;for(e=0;e<o;e++)l+=Y[e].a*Math.cos(Y[e].b+Y[e].c*i);var h=j.length,u=0;for(e=0;e<h;e++)u+=j[e].a*Math.cos(j[e].b+j[e].c*i);var c=W.length,_=0;for(e=0;e<c;e++)_+=W[e].a*Math.cos(W[e].b+W[e].c*i);var g=q.length,f=0;for(e=0;e<g;e++)f+=q[e].a*Math.cos(q[e].b+q[e].c*i);var m=Z.length,p=0;for(e=0;e<m;e++)p+=Z[e].a*Math.cos(Z[e].b+Z[e].c*i);var w=K.length,b=0;for(e=0;e<w;e++)b+=K[e].a*Math.cos(K[e].b+K[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.m360(d.r2D(v))},ot.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=J.length,o=0;for(e=0;e<a;e++)o+=J[e].a*Math.cos(J[e].b+J[e].c*i);var l=Q.length,h=0;for(e=0;e<l;e++)h+=Q[e].a*Math.cos(Q[e].b+Q[e].c*i);var u=tt.length,c=0;for(e=0;e<u;e++)c+=tt[e].a*Math.cos(tt[e].b+tt[e].c*i);var _=et.length,g=0;for(e=0;e<_;e++)g+=et[e].a*Math.cos(et[e].b+et[e].c*i);var f=it.length,m=0;for(e=0;e<f;e++)m+=it[e].a*Math.cos(it[e].b+it[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},ot.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=nt.length,a=0;for(e=0;e<s;e++)a+=nt[e].a*Math.cos(nt[e].b+nt[e].c*i);var o=rt.length,l=0;for(e=0;e<o;e++)l+=rt[e].a*Math.cos(rt[e].b+rt[e].c*i);var h=st.length,u=0;for(e=0;e<h;e++)u+=st[e].a*Math.cos(st[e].b+st[e].c*i);var c=at.length,_=0;for(e=0;e<c;e++)_+=at[e].a*Math.cos(at[e].b+at[e].c*i);return(a+l*i+u*n+_*r)/1e8},n("CAAMercury",[ot,{},null]);const lt=[new f(317614667,0,0),new f(1353968,5.5931332,10213.2855462),new f(89892,5.3065,20426.57109),new f(5477,4.4163,7860.4194),new f(3456,2.6996,11790.6291),new f(2372,2.9938,3930.2097),new f(1664,4.2502,1577.3435),new f(1438,4.1575,9683.5946),new f(1317,5.1867,26.2983),new f(1201,6.1536,30639.8566),new f(769,.816,9437.763),new f(761,1.95,529.691),new f(708,1.065,775.523),new f(585,3.998,191.448),new f(500,4.123,15720.839),new f(429,3.586,19367.189),new f(327,5.677,5507.553),new f(326,4.591,10404.734),new f(232,3.163,9153.904),new f(180,4.653,1109.379),new f(155,5.57,19651.048),new f(128,4.226,20.775),new f(128,.962,5661.332),new f(106,1.537,801.821)],ht=[new f(0xedcd611dcd,0,0),new f(95708,2.46424,10213.28555),new f(14445,.51625,20426.57109),new f(213,1.795,30639.857),new f(174,2.655,26.298),new f(152,6.106,1577.344),new f(82,5.7,191.45),new f(70,2.68,9437.76),new f(52,3.6,775.52),new f(38,1.03,529.69),new f(30,1.25,5507.55),new f(25,6.11,10404.73)],ut=[new f(54127,0,0),new f(3891,.3451,10213.2855),new f(1338,2.0201,20426.5711),new f(24,2.05,26.3),new f(19,3.54,30639.86),new f(10,3.97,775.52),new f(7,1.52,1577.34),new f(6,1,191.45)],ct=[new f(136,4.804,10213.286),new f(78,3.67,20426.57),new f(26,0,0)],_t=[new f(114,3.1416,0),new f(3,5.21,20426.57),new f(2,2.51,10213.29)],dt=[new f(1,3.14,0)],gt=[new f(5923638,.2670278,10213.2855462),new f(40108,1.14737,20426.57109),new f(32815,3.14737,0),new f(1011,1.0895,30639.8566),new f(149,6.254,18073.705),new f(138,.86,1577.344),new f(130,3.672,9437.763),new f(120,3.705,2352.866),new f(108,4.539,22003.915)],ft=[new f(513348,1.803643,10213.285546),new f(4380,3.3862,20426.5711),new f(199,0,0),new f(197,2.53,30639.857)],mt=[new f(22378,3.38509,10213.28555),new f(282,0,0),new f(173,5.256,20426.571),new f(27,3.87,30639.86)],pt=[new f(647,4.992,10213.286),new f(20,3.14,0),new f(6,.77,20426.57),new f(3,5.44,30639.86)],wt=[new f(14,.32,10213.29)],bt=[new f(72334821,0,0),new f(489824,4.021518,10213.285546),new f(1658,4.9021,20426.5711),new f(1632,2.8455,7860.4194),new f(1378,1.1285,11790.6291),new f(498,2.587,9683.595),new f(374,1.423,3930.21),new f(264,5.529,9437.763),new f(237,2.551,15720.839),new f(222,2.013,19367.189),new f(126,2.728,1577.344),new f(119,3.02,10404.734)],vt=[new f(34551,.89199,10213.28555),new f(234,1.772,20426.571),new f(234,3.142,0)],yt=[new f(1407,5.0637,10213.2855),new f(16,5.47,20426.57),new f(13,0,0)],St=[new f(50,3.22,10213.29)],xt=[new f(1,.92,10213.29)];function Tt(){}Tt.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=lt.length,l=0;for(e=0;e<o;e++)l+=lt[e].a*Math.cos(lt[e].b+lt[e].c*i);var h=ht.length,u=0;for(e=0;e<h;e++)u+=ht[e].a*Math.cos(ht[e].b+ht[e].c*i);var c=ut.length,_=0;for(e=0;e<c;e++)_+=ut[e].a*Math.cos(ut[e].b+ut[e].c*i);var g=ct.length,f=0;for(e=0;e<g;e++)f+=ct[e].a*Math.cos(ct[e].b+ct[e].c*i);var m=_t.length,p=0;for(e=0;e<m;e++)p+=_t[e].a*Math.cos(_t[e].b+_t[e].c*i);var w=dt.length,b=0;for(e=0;e<w;e++)b+=dt[e].a*Math.cos(dt[e].b+dt[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.m360(d.r2D(v))},Tt.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=gt.length,o=0;for(e=0;e<a;e++)o+=gt[e].a*Math.cos(gt[e].b+gt[e].c*i);var l=ft.length,h=0;for(e=0;e<l;e++)h+=ft[e].a*Math.cos(ft[e].b+ft[e].c*i);var u=mt.length,c=0;for(e=0;e<u;e++)c+=mt[e].a*Math.cos(mt[e].b+mt[e].c*i);var _=pt.length,g=0;for(e=0;e<_;e++)g+=pt[e].a*Math.cos(pt[e].b+pt[e].c*i);var f=wt.length,m=0;for(e=0;e<f;e++)m+=wt[e].a*Math.cos(wt[e].b+wt[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},Tt.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=bt.length,o=0;for(e=0;e<a;e++)o+=bt[e].a*Math.cos(bt[e].b+bt[e].c*i);var l=vt.length,h=0;for(e=0;e<l;e++)h+=vt[e].a*Math.cos(vt[e].b+vt[e].c*i);var u=yt.length,c=0;for(e=0;e<u;e++)c+=yt[e].a*Math.cos(yt[e].b+yt[e].c*i);var _=St.length,d=0;for(e=0;e<_;e++)d+=St[e].a*Math.cos(St[e].b+St[e].c*i);var g=xt.length,f=0;for(e=0;e<g;e++)f+=xt[e].a*Math.cos(xt[e].b+xt[e].c*i);return(o+h*i+c*n+d*r+f*s)/1e8},n("CAAVenus",[Tt,{},null]);const Mt=[new f(620347712,0,0),new f(18656368,5.050371,3340.6124267),new f(1108217,5.4009984,6681.2248534),new f(91798,5.75479,10021.83728),new f(27745,5.9705,3.52312),new f(12316,.84956,2810.92146),new f(10610,2.93959,2281.2305),new f(8927,4.157,.0173),new f(8716,6.1101,13362.4497),new f(7775,3.3397,5621.8429),new f(6798,.3646,398.149),new f(4161,.2281,2942.4634),new f(3575,1.6619,2544.3144),new f(3075,.857,191.4483),new f(2938,6.0789,.0673),new f(2628,.6481,3337.0893),new f(2580,.03,3344.1355),new f(2389,5.039,796.298),new f(1799,.6563,529.691),new f(1546,2.9158,1751.5395),new f(1528,1.1498,6151.5339),new f(1286,3.068,2146.1654),new f(1264,3.6228,5092.152),new f(1025,3.6933,8962.4553),new f(892,.183,16703.062),new f(859,2.401,2914.014),new f(833,4.495,3340.63),new f(833,2.464,3340.595),new f(749,3.822,155.42),new f(724,.675,3738.761),new f(713,3.663,1059.382),new f(655,.489,3127.313),new f(636,2.922,8432.764),new f(553,4.475,1748.016),new f(550,3.81,.98),new f(472,3.625,1194.447),new f(426,.554,6283.076),new f(415,.497,213.299),new f(312,.999,6677.702),new f(307,.381,6684.748),new f(302,4.486,3532.061),new f(299,2.783,6254.627),new f(293,4.221,20.775),new f(284,5.769,3149.164),new f(281,5.882,1349.867),new f(274,.542,3340.545),new f(274,.134,3340.68),new f(239,5.372,4136.91),new f(236,5.755,3333.499),new f(231,1.282,3870.303),new f(221,3.505,382.897),new f(204,2.821,1221.849),new f(193,3.357,3.59),new f(189,1.491,9492.146),new f(179,1.006,951.718),new f(174,2.414,553.569),new f(172,.439,5486.778),new f(160,3.949,4562.461),new f(144,1.419,135.065),new f(140,3.326,2700.715),new f(138,4.301,7.114),new f(131,4.045,12303.068),new f(128,2.208,1592.596),new f(128,1.807,5088.629),new f(117,3.128,7903.073),new f(113,3.701,1589.073),new f(110,1.052,242.729),new f(105,.785,8827.39),new f(100,3.243,11773.377)],Ct=[new f(334085627474,0,0),new f(1458227,3.6042605,3340.6124267),new f(164901,3.926313,6681.224853),new f(19963,4.26594,10021.83728),new f(3452,4.7321,3.5231),new f(2485,4.6128,13362.4497),new f(842,4.459,2281.23),new f(538,5.016,398.149),new f(521,4.994,3344.136),new f(433,2.561,191.448),new f(430,5.316,155.42),new f(382,3.539,796.298),new f(314,4.963,16703.062),new f(283,3.16,2544.314),new f(206,4.569,2146.165),new f(169,1.329,3337.089),new f(158,4.185,1751.54),new f(134,2.233,.98),new f(134,5.974,1748.016),new f(118,6.024,6151.534),new f(117,2.213,1059.382),new f(114,2.129,1194.447),new f(114,5.428,3738.761),new f(91,1.1,1349.87),new f(85,3.91,553.57),new f(83,5.3,6684.75),new f(81,4.43,529.69),new f(80,2.25,8962.46),new f(73,2.5,951.72),new f(73,5.84,242.73),new f(71,3.86,2914.01),new f(68,5.02,382.9),new f(65,1.02,3340.6),new f(65,3.05,3340.63),new f(62,4.15,3149.16),new f(57,3.89,4136.91),new f(48,4.87,213.3),new f(48,1.18,3333.5),new f(47,1.31,3185.19),new f(41,.71,1592.6),new f(40,2.73,7.11),new f(40,5.32,20043.67),new f(33,5.41,6283.08),new f(28,.05,9492.15),new f(27,3.89,1221.85),new f(27,5.11,2700.72)],At=[new f(58016,2.04979,3340.61243),new f(54188,0,0),new f(13908,2.45742,6681.22485),new f(2465,2.8,10021.8373),new f(398,3.141,13362.45),new f(222,3.194,3.523),new f(121,.543,155.42),new f(62,3.49,16703.06),new f(54,3.54,3344.14),new f(34,6,2281.23),new f(32,4.14,191.45),new f(30,2,796.3),new f(23,4.33,242.73),new f(22,3.45,398.15),new f(20,5.42,553.57),new f(16,.66,.98),new f(16,6.11,2146.17),new f(16,1.22,1748.02),new f(15,6.1,3185.19),new f(14,4.02,951.72),new f(14,2.62,1349.87),new f(13,.6,1194.45),new f(12,3.86,6684.75),new f(11,4.72,2544.31),new f(10,.25,382.9),new f(9,.68,1059.38),new f(9,3.83,20043.67),new f(9,3.88,3738.76),new f(8,5.46,1751.54),new f(7,2.58,3149.16),new f(7,2.38,4136.91),new f(6,5.48,1592.6),new f(6,2.34,3097.88)],Lt=[new f(1482,.4443,3340.6124),new f(662,.885,6681.225),new f(188,1.288,10021.837),new f(41,1.65,13362.45),new f(26,0,0),new f(23,2.05,155.42),new f(10,1.58,3.52),new f(8,2,16703.06),new f(5,2.82,242.73),new f(4,2.02,3344.14),new f(3,4.59,3185.19),new f(3,.65,553.57)],It=[new f(114,3.1416,0),new f(29,5.64,6681.22),new f(24,5.14,3340.61),new f(11,6.03,10021.84),new f(3,.13,13362.45),new f(3,3.56,155.42),new f(1,.49,16703.06),new f(1,1.32,242.73)],kt=[new f(1,3.14,0),new f(1,4.04,6681.22)],Pt=[new f(3197135,3.7683204,3340.6124267),new f(298033,4.10617,6681.224853),new f(289105,0,0),new f(31366,4.44651,10021.83728),new f(3484,4.7881,13362.4497),new f(443,5.026,3344.136),new f(443,5.652,3337.089),new f(399,5.131,16703.062),new f(293,3.793,2281.23),new f(182,6.136,6151.534),new f(163,4.264,529.691),new f(160,2.232,1059.382),new f(149,2.165,5621.843),new f(143,1.182,3340.595),new f(143,3.213,3340.63),new f(139,2.418,8962.455)],Rt=[new f(350069,5.368478,3340.612427),new f(14116,3.14159,0),new f(9671,5.4788,6681.2249),new f(1472,3.2021,10021.8373),new f(426,3.408,13362.45),new f(102,.776,3337.089),new f(79,3.72,16703.06),new f(33,3.46,5621.84),new f(26,2.48,2281.23)],Et=[new f(16727,.60221,3340.61243),new f(4987,4.1416,0),new f(302,3.559,6681.225),new f(26,1.9,13362.45),new f(21,.92,10021.84),new f(12,2.24,3337.09),new f(8,2.25,16703.06)],Dt=[new f(607,1.981,3340.612),new f(43,0,0),new f(14,1.8,6681.22),new f(3,3.45,10021.84)],Ft=[new f(13,0,0),new f(11,3.46,3340.61),new f(1,.5,6681.22)],Nt=[new f(153033488,0,0),new f(14184953,3.47971284,3340.6124267),new f(660776,3.817834,6681.224853),new f(46179,4.15595,10021.83728),new f(8110,5.5596,2810.9215),new f(7485,1.7724,5621.8429),new f(5523,1.3644,2281.2305),new f(3825,4.4941,13362.4497),new f(2484,4.9255,2942.4634),new f(2307,.0908,2544.3144),new f(1999,5.3606,3337.0893),new f(1960,4.7425,3344.1355),new f(1167,2.1126,5092.152),new f(1103,5.0091,398.149),new f(992,5.839,6151.534),new f(899,4.408,529.691),new f(807,2.102,1059.382),new f(798,3.448,796.298),new f(741,1.499,2146.165),new f(726,1.245,8432.764),new f(692,2.134,8962.455),new f(633,.894,3340.595),new f(633,2.924,3340.63),new f(630,1.287,1751.54),new f(574,.829,2914.014),new f(526,5.383,3738.761),new f(473,5.199,3127.313),new f(348,4.832,16703.062),new f(284,2.907,3532.061),new f(280,5.257,6283.076),new f(276,1.218,6254.627),new f(275,2.908,1748.016),new f(270,3.764,5884.927),new f(239,2.037,1194.447),new f(234,5.105,5486.778),new f(228,3.255,6872.673),new f(223,4.199,3149.164),new f(219,5.583,191.448),new f(208,5.255,3340.545),new f(208,4.846,3340.68),new f(186,5.699,6677.702),new f(183,5.081,6684.748),new f(179,4.184,3333.499),new f(176,5.953,3870.303),new f(164,3.799,4136.91)],$t=[new f(1107433,2.0325052,3340.6124267),new f(103176,2.370718,6681.224853),new f(12877,0,0),new f(10816,2.70888,10021.83728),new f(1195,3.047,13362.4497),new f(439,2.888,2281.23),new f(396,3.423,3344.136),new f(183,1.584,2544.314),new f(136,3.385,16703.062),new f(128,6.043,3337.089),new f(128,.63,1059.382),new f(127,1.954,796.298),new f(118,2.998,2146.165),new f(88,3.42,398.15),new f(83,3.86,3738.76),new f(76,4.45,6151.53),new f(72,2.76,529.69),new f(67,2.55,1751.54),new f(66,4.41,1748.02),new f(58,.54,1194.45),new f(54,.68,8962.46),new f(51,3.73,6684.75),new f(49,5.73,3340.6),new f(49,1.48,3340.63),new f(48,2.58,3149.16),new f(48,2.29,2914.01),new f(39,2.32,4136.91)],zt=[new f(44242,.47931,3340.61243),new f(8138,.87,6681.2249),new f(1275,1.2259,10021.8373),new f(187,1.573,13362.45),new f(52,3.14,0),new f(41,1.97,3344.14),new f(27,1.92,16703.06),new f(18,4.43,2281.23),new f(12,4.53,3185.19),new f(10,5.39,1059.38),new f(10,.42,796.3)],Bt=[new f(1113,5.1499,3340.6124),new f(424,5.613,6681.225),new f(100,5.997,10021.837),new f(20,.08,13362.45),new f(5,3.14,0),new f(3,.43,16703.06)],Ut=[new f(20,3.58,3340.61),new f(16,4.05,6681.22),new f(6,4.46,10021.84),new f(2,4.84,13362.45)];function Vt(){}Vt.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=Mt.length,l=0;for(e=0;e<o;e++)l+=Mt[e].a*Math.cos(Mt[e].b+Mt[e].c*i);var h=Ct.length,u=0;for(e=0;e<h;e++)u+=Ct[e].a*Math.cos(Ct[e].b+Ct[e].c*i);var c=At.length,_=0;for(e=0;e<c;e++)_+=At[e].a*Math.cos(At[e].b+At[e].c*i);var g=Lt.length,f=0;for(e=0;e<g;e++)f+=Lt[e].a*Math.cos(Lt[e].b+Lt[e].c*i);var m=It.length,p=0;for(e=0;e<m;e++)p+=It[e].a*Math.cos(It[e].b+It[e].c*i);var w=kt.length,b=0;for(e=0;e<w;e++)b+=kt[e].a*Math.cos(kt[e].b+kt[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.m360(d.r2D(v))},Vt.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=Pt.length,o=0;for(e=0;e<a;e++)o+=Pt[e].a*Math.cos(Pt[e].b+Pt[e].c*i);var l=Rt.length,h=0;for(e=0;e<l;e++)h+=Rt[e].a*Math.cos(Rt[e].b+Rt[e].c*i);var u=Et.length,c=0;for(e=0;e<u;e++)c+=Et[e].a*Math.cos(Et[e].b+Et[e].c*i);var _=Dt.length,g=0;for(e=0;e<_;e++)g+=Dt[e].a*Math.cos(Dt[e].b+Dt[e].c*i);var f=Ft.length,m=0;for(e=0;e<f;e++)m+=Ft[e].a*Math.cos(Ft[e].b+Ft[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},Vt.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=Nt.length,o=0;for(e=0;e<a;e++)o+=Nt[e].a*Math.cos(Nt[e].b+Nt[e].c*i);var l=$t.length,h=0;for(e=0;e<l;e++)h+=$t[e].a*Math.cos($t[e].b+$t[e].c*i);var u=zt.length,c=0;for(e=0;e<u;e++)c+=zt[e].a*Math.cos(zt[e].b+zt[e].c*i);var _=Bt.length,d=0;for(e=0;e<_;e++)d+=Bt[e].a*Math.cos(Bt[e].b+Bt[e].c*i);var g=Ut.length,f=0;for(e=0;e<g;e++)f+=Ut[e].a*Math.cos(Ut[e].b+Ut[e].c*i);return(o+h*i+c*n+d*r+f*s)/1e8},n("CAAMars",[Vt,{},null]);const Ot=[new f(59954691,0,0),new f(9695899,5.0619179,529.6909651),new f(573610,1.444062,7.113547),new f(306389,5.417347,1059.38193),new f(97178,4.14265,632.78374),new f(72903,3.64043,522.57742),new f(64264,3.41145,103.09277),new f(39806,2.29377,419.48464),new f(38858,1.27232,316.39187),new f(27965,1.78455,536.80451),new f(13590,5.77481,1589.0729),new f(8769,3.63,949.1756),new f(8246,3.5823,206.1855),new f(7368,5.081,735.8765),new f(6263,.025,213.2991),new f(6114,4.5132,1162.4747),new f(5305,4.1863,1052.2684),new f(5305,1.3067,14.2271),new f(4905,1.3208,110.2063),new f(4647,4.6996,3.9322),new f(3045,4.3168,426.5982),new f(2610,1.5667,846.0828),new f(2028,1.0638,3.1814),new f(1921,.9717,639.8973),new f(1765,2.1415,1066.4955),new f(1723,3.8804,1265.5675),new f(1633,3.582,515.4639),new f(1432,4.2968,625.6702),new f(973,4.098,95.979),new f(884,2.437,412.371),new f(733,6.085,838.969),new f(731,3.806,1581.959),new f(709,1.293,742.99),new f(692,6.134,2118.764),new f(614,4.109,1478.867),new f(582,4.54,309.278),new f(495,3.756,323.505),new f(441,2.958,454.909),new f(417,1.036,2.488),new f(390,4.897,1692.166),new f(376,4.703,1368.66),new f(341,5.715,533.623),new f(330,4.74,.048),new f(262,1.877,.963),new f(261,.82,380.128),new f(257,3.724,199.072),new f(244,5.22,728.763),new f(235,1.227,909.819),new f(220,1.651,543.918),new f(207,1.855,525.759),new f(202,1.807,1375.774),new f(197,5.293,1155.361),new f(175,3.73,942.062),new f(175,3.226,1898.351),new f(175,5.91,956.289),new f(158,4.365,1795.258),new f(151,3.906,74.782),new f(149,4.377,1685.052),new f(141,3.136,491.558),new f(138,1.318,1169.588),new f(131,4.169,1045.155),new f(117,2.5,1596.186),new f(117,3.389,.521),new f(106,4.554,526.51)],Gt=[new f(52993480757,0,0),new f(489741,4.220667,529.690965),new f(228919,6.026475,7.113547),new f(27655,4.57266,1059.38193),new f(20721,5.45939,522.57742),new f(12106,.16986,536.80451),new f(6068,4.4242,103.0928),new f(5434,3.9848,419.4846),new f(4238,5.8901,14.2271),new f(2212,5.2677,206.1855),new f(1746,4.9267,1589.0729),new f(1296,5.5513,3.1814),new f(1173,5.8565,1052.2684),new f(1163,.5145,3.9322),new f(1099,5.307,515.4639),new f(1007,.4648,735.8765),new f(1004,3.1504,426.5982),new f(848,5.758,110.206),new f(827,4.803,213.299),new f(816,.586,1066.495),new f(725,5.518,639.897),new f(568,5.989,625.67),new f(474,4.132,412.371),new f(413,5.737,95.979),new f(345,4.242,632.784),new f(336,3.732,1162.475),new f(234,4.035,949.176),new f(234,6.243,309.278),new f(199,1.505,838.969),new f(195,2.219,323.505),new f(187,6.086,742.99),new f(184,6.28,543.918),new f(171,5.417,199.072),new f(131,.626,728.763),new f(115,.68,846.083),new f(115,5.286,2118.764),new f(108,4.493,956.289),new f(80,5.82,1045.15),new f(72,5.34,942.06),new f(70,5.97,532.87),new f(67,5.73,21.34),new f(66,.13,526.51),new f(65,6.09,1581.96),new f(59,.59,1155.36),new f(58,.99,1596.19),new f(57,5.97,1169.59),new f(57,1.41,533.62),new f(55,5.43,10.29),new f(52,5.73,117.32),new f(52,.23,1368.66),new f(50,6.08,525.76),new f(47,3.63,1478.87),new f(47,.51,1265.57),new f(40,4.16,1692.17),new f(34,.1,302.16),new f(33,5.04,220.41),new f(32,5.37,508.35),new f(29,5.42,1272.68),new f(29,3.36,4.67),new f(29,.76,88.87),new f(25,1.61,831.86)],Xt=[new f(47234,4.32148,7.11355),new f(38966,0,0),new f(30629,2.93021,529.69097),new f(3189,1.055,522.5774),new f(2729,4.8455,536.8045),new f(2723,3.4141,1059.3819),new f(1721,4.1873,14.2271),new f(383,5.768,419.485),new f(378,.76,515.464),new f(367,6.055,103.093),new f(337,3.786,3.181),new f(308,.694,206.186),new f(218,3.814,1589.073),new f(199,5.34,1066.495),new f(197,2.484,3.932),new f(156,1.406,1052.268),new f(146,3.814,639.897),new f(142,1.634,426.598),new f(130,5.837,412.371),new f(117,1.414,625.67),new f(97,4.03,110.21),new f(91,1.11,95.98),new f(87,2.52,632.78),new f(79,4.64,543.92),new f(72,2.22,735.88),new f(58,.83,199.07),new f(57,3.12,213.3),new f(49,1.67,309.28),new f(40,4.02,21.34),new f(40,.62,323.51),new f(36,2.33,728.76),new f(29,3.61,10.29),new f(28,3.24,838.97),new f(26,4.5,742.99),new f(26,2.51,1162.47),new f(25,1.22,1045.15),new f(24,3.01,956.29),new f(19,4.29,532.87),new f(18,.81,508.35),new f(17,4.2,2118.76),new f(17,1.83,526.51),new f(15,5.81,1596.19),new f(15,.68,942.06),new f(15,4,117.32),new f(14,5.95,316.39),new f(14,1.8,302.16),new f(13,2.52,88.87),new f(13,4.37,1169.59),new f(11,4.44,525.76),new f(10,1.72,1581.96),new f(9,2.18,1155.36),new f(9,3.29,220.41),new f(9,3.32,831.86),new f(8,5.76,846.08),new f(8,2.71,533.62),new f(7,2.18,1265.57),new f(6,.5,949.18)],Ht=[new f(6502,2.5986,7.1135),new f(1357,1.3464,529.691),new f(471,2.475,14.227),new f(417,3.245,536.805),new f(353,2.974,522.577),new f(155,2.076,1059.382),new f(87,2.51,515.46),new f(44,0,0),new f(34,3.83,1066.5),new f(28,2.45,206.19),new f(24,1.28,412.37),new f(23,2.98,543.92),new f(20,2.1,639.9),new f(20,1.4,419.48),new f(19,1.59,103.09),new f(17,2.3,21.34),new f(17,2.6,1589.07),new f(16,3.15,625.67),new f(16,3.36,1052.27),new f(13,2.76,95.98),new f(13,2.54,199.07),new f(13,6.27,426.6),new f(9,1.76,10.29),new f(9,2.27,110.21),new f(7,3.43,309.28),new f(7,4.04,728.76),new f(6,2.52,508.35),new f(5,2.91,1045.15),new f(5,5.25,323.51),new f(4,4.3,88.87),new f(4,3.52,302.16),new f(4,4.09,735.88),new f(3,1.43,956.29),new f(3,4.36,1596.19),new f(3,1.25,213.3),new f(3,5.02,838.97),new f(3,2.24,117.32),new f(2,2.9,742.99),new f(2,2.36,942.06)],Yt=[new f(669,.853,7.114),new f(114,3.142,0),new f(100,.743,14.227),new f(50,1.65,536.8),new f(44,5.82,529.69),new f(32,4.86,522.58),new f(15,4.29,515.46),new f(9,.71,1059.38),new f(5,1.3,543.92),new f(4,2.32,1066.5),new f(4,.48,21.34),new f(3,3,412.37),new f(2,.4,639.9),new f(2,4.26,199.07),new f(2,4.91,625.67),new f(2,4.26,206.19),new f(1,5.26,1052.27),new f(1,4.72,95.98),new f(1,1.29,1589.07)],jt=[new f(50,5.26,7.11),new f(16,5.25,14.23),new f(4,.01,536.8),new f(2,1.1,522.58),new f(1,3.14,0)],Wt=[new f(2268616,3.5585261,529.6909651),new f(110090,0,0),new f(109972,3.908093,1059.38193),new f(8101,3.6051,522.5774),new f(6438,.3063,536.8045),new f(6044,4.2588,1589.0729),new f(1107,2.9853,1162.4747),new f(944,1.675,426.598),new f(942,2.936,1052.268),new f(894,1.754,7.114),new f(836,5.179,103.093),new f(767,2.155,632.784),new f(684,3.678,213.299),new f(629,.643,1066.495),new f(559,.014,846.083),new f(532,2.703,110.206),new f(464,1.173,949.176),new f(431,2.608,419.485),new f(351,4.611,2118.764),new f(132,4.778,742.99),new f(123,3.35,1692.166),new f(116,1.387,323.505),new f(115,5.049,316.392),new f(104,3.701,515.464),new f(103,2.319,1478.867),new f(102,3.153,1581.959)],qt=[new f(177352,5.701665,529.690965),new f(3230,5.7794,1059.3819),new f(3081,5.4746,522.5774),new f(2212,4.7348,536.8045),new f(1694,3.1416,0),new f(346,4.746,1052.268),new f(234,5.189,1066.495),new f(196,6.186,7.114),new f(150,3.927,1589.073),new f(114,3.439,632.784),new f(97,2.91,949.18),new f(82,5.08,1162.47),new f(77,2.51,103.09),new f(77,.61,419.48),new f(74,5.5,515.46),new f(61,5.45,213.3),new f(50,3.95,735.88),new f(46,.54,110.21),new f(45,1.9,846.08),new f(37,4.7,543.92),new f(36,6.11,316.39),new f(32,4.92,1581.96)],Zt=[new f(8094,1.4632,529.691),new f(813,3.1416,0),new f(742,.957,522.577),new f(399,2.899,536.805),new f(342,1.447,1059.382),new f(74,.41,1052.27),new f(46,3.48,1066.5),new f(30,1.93,1589.07),new f(29,.99,515.46),new f(23,4.27,7.11),new f(14,2.92,543.92),new f(12,5.22,632.78),new f(11,4.88,949.18),new f(6,6.21,1045.15)],Kt=[new f(252,3.381,529.691),new f(122,2.733,522.577),new f(49,1.04,536.8),new f(11,2.31,1052.27),new f(8,2.77,515.46),new f(7,4.25,1059.38),new f(6,1.78,1066.5),new f(4,1.13,543.92),new f(3,3.14,0)],Jt=[new f(15,4.53,522.58),new f(5,4.47,529.69),new f(4,5.44,536.8),new f(3,0,0),new f(2,4.52,515.46),new f(1,4.2,1052.27)],Qt=[new f(1,.09,522.58)],te=[new f(520887429,0,0),new f(25209327,3.4910864,529.69096509),new f(610600,3.841154,1059.38193),new f(282029,2.574199,632.783739),new f(187647,2.075904,522.577418),new f(86793,.71001,419.48464),new f(72063,.21466,536.80451),new f(65517,5.97996,316.39187),new f(30135,2.16132,949.17561),new f(29135,1.67759,103.09277),new f(23947,.27458,7.11355),new f(23453,3.54023,735.87651),new f(22284,4.19363,1589.0729),new f(13033,2.96043,1162.4747),new f(12749,2.7155,1052.26838),new f(9703,1.9067,206.1855),new f(9161,4.4135,213.2991),new f(7895,2.4791,426.5982),new f(7058,2.1818,1265.5675),new f(6138,6.2642,846.0828),new f(5477,5.6573,639.8973),new f(4170,2.0161,515.4639),new f(4137,2.7222,625.6702),new f(3503,.5653,1066.4955),new f(2617,2.0099,1581.9593),new f(2500,4.5518,838.9693),new f(2128,6.1275,742.9901),new f(1912,.8562,412.3711),new f(1611,3.0887,1368.6603),new f(1479,2.6803,1478.8666),new f(1231,1.8904,323.5054),new f(1217,1.8017,110.2063),new f(1015,1.3867,454.9094),new f(999,2.872,309.278),new f(961,4.549,2118.764),new f(886,4.148,533.623),new f(821,1.593,1898.351),new f(812,5.941,909.819),new f(777,3.677,728.763),new f(727,3.988,1155.361),new f(655,2.791,1685.052),new f(654,3.382,1692.166),new f(621,4.823,956.289),new f(615,2.276,942.062),new f(562,.081,543.918),new f(542,.284,525.759)],ee=[new f(1271802,2.6493751,529.6909651),new f(61662,3.00076,1059.38193),new f(53444,3.89718,522.57742),new f(41390,0,0),new f(31185,4.88277,536.80451),new f(11847,2.4133,419.48464),new f(9166,4.7598,7.1135),new f(3404,3.3469,1589.0729),new f(3203,5.2108,735.8765),new f(3176,2.793,103.0928),new f(2806,3.7422,515.4639),new f(2677,4.3305,1052.2684),new f(2600,3.6344,206.1855),new f(2412,1.4695,426.5982),new f(2101,3.9276,639.8973),new f(1646,4.4163,1066.4955),new f(1641,4.4163,625.6702),new f(1050,3.1611,213.2991),new f(1025,2.5543,412.3711),new f(806,2.678,632.784),new f(741,2.171,1162.475),new f(677,6.25,838.969),new f(567,4.577,742.99),new f(485,2.469,949.176),new f(469,4.71,543.918),new f(445,.403,323.505),new f(416,5.368,728.763),new f(402,4.605,309.278),new f(347,4.681,14.227),new f(338,3.168,956.289),new f(261,5.343,846.083),new f(247,3.923,942.062),new f(220,4.842,1368.66),new f(203,5.6,1155.361),new f(200,4.439,1045.155),new f(197,3.706,2118.764),new f(196,3.759,199.072),new f(184,4.265,95.979),new f(180,4.402,532.872),new f(170,4.846,526.51),new f(146,6.13,533.623),new f(133,1.322,110.206),new f(132,4.512,525.759)],ie=[new f(79645,1.35866,529.69097),new f(8252,5.7777,522.5774),new f(7030,3.2748,536.8045),new f(5314,1.8384,1059.3819),new f(1861,2.9768,7.1135),new f(964,5.48,515.464),new f(836,4.199,419.485),new f(498,3.142,0),new f(427,2.228,639.897),new f(406,3.783,1066.495),new f(377,2.242,1589.073),new f(363,5.368,206.186),new f(342,6.099,1052.268),new f(339,6.127,625.67),new f(333,.003,426.598),new f(280,4.262,412.371),new f(257,.963,632.784),new f(230,.705,735.877),new f(201,3.069,543.918),new f(200,4.429,103.093),new f(139,2.932,14.227),new f(114,.787,728.763),new f(95,1.7,838.97),new f(86,5.14,323.51),new f(83,.06,309.28),new f(80,2.98,742.99),new f(75,1.6,956.29),new f(70,1.51,213.3),new f(67,5.47,199.07),new f(62,6.1,1045.15),new f(56,.96,1162.47),new f(52,5.58,942.06),new f(50,2.72,532.87),new f(45,5.52,508.35),new f(44,.27,526.51),new f(40,5.95,95.98)],ne=[new f(3519,6.058,529.691),new f(1073,1.6732,536.8045),new f(916,1.413,522.577),new f(342,.523,1059.382),new f(255,1.196,7.114),new f(222,.952,515.464),new f(90,3.14,0),new f(69,2.27,1066.5),new f(58,1.41,543.92),new f(58,.53,639.9),new f(51,5.98,412.37),new f(47,1.58,625.67),new f(43,6.12,419.48),new f(37,1.18,14.23),new f(34,1.67,1052.27),new f(34,.85,206.19),new f(31,1.04,1589.07),new f(30,4.63,426.6),new f(21,2.5,728.76),new f(15,.89,199.07),new f(14,.96,508.35),new f(13,1.5,1045.15),new f(12,2.61,735.88),new f(12,3.56,323.51),new f(11,1.79,309.28),new f(11,6.28,956.29),new f(10,6.26,103.09),new f(9,3.45,838.97)],re=[new f(129,.084,536.805),new f(113,4.249,529.691),new f(83,3.3,522.58),new f(38,2.73,515.46),new f(27,5.69,7.11),new f(18,5.4,1059.38),new f(13,6.02,543.92),new f(9,.77,1066.5),new f(8,5.68,14.23),new f(7,1.43,412.37),new f(6,5.12,639.9),new f(5,3.34,625.67),new f(3,3.4,1052.27),new f(3,4.16,728.76),new f(3,2.9,426.6)],se=[new f(11,4.75,536.8),new f(4,5.92,522.58),new f(2,5.57,515.46),new f(2,4.3,543.92),new f(2,3.69,7.11),new f(2,4.13,1059.38),new f(2,5.49,1066.5)];function ae(){}ae.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=Ot.length,l=0;for(e=0;e<o;e++)l+=Ot[e].a*Math.cos(Ot[e].b+Ot[e].c*i);var h=Gt.length,u=0;for(e=0;e<h;e++)u+=Gt[e].a*Math.cos(Gt[e].b+Gt[e].c*i);var c=Xt.length,_=0;for(e=0;e<c;e++)_+=Xt[e].a*Math.cos(Xt[e].b+Xt[e].c*i);var g=Ht.length,f=0;for(e=0;e<g;e++)f+=Ht[e].a*Math.cos(Ht[e].b+Ht[e].c*i);var m=Yt.length,p=0;for(e=0;e<m;e++)p+=Yt[e].a*Math.cos(Yt[e].b+Yt[e].c*i);var w=jt.length,b=0;for(e=0;e<w;e++)b+=jt[e].a*Math.cos(jt[e].b+jt[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.m360(d.r2D(v))},ae.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=Wt.length,l=0;for(e=0;e<o;e++)l+=Wt[e].a*Math.cos(Wt[e].b+Wt[e].c*i);var h=qt.length,u=0;for(e=0;e<h;e++)u+=qt[e].a*Math.cos(qt[e].b+qt[e].c*i);var c=Zt.length,_=0;for(e=0;e<c;e++)_+=Zt[e].a*Math.cos(Zt[e].b+Zt[e].c*i);var g=Kt.length,f=0;for(e=0;e<g;e++)f+=Kt[e].a*Math.cos(Kt[e].b+Kt[e].c*i);var m=Jt.length,p=0;for(e=0;e<m;e++)p+=Jt[e].a*Math.cos(Jt[e].b+Jt[e].c*i);var w=Qt.length,b=0;for(e=0;e<w;e++)b+=Qt[e].a*Math.cos(Qt[e].b+Qt[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.r2D(v)},ae.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=te.length,l=0;for(e=0;e<o;e++)l+=te[e].a*Math.cos(te[e].b+te[e].c*i);var h=ee.length,u=0;for(e=0;e<h;e++)u+=ee[e].a*Math.cos(ee[e].b+ee[e].c*i);var c=ie.length,_=0;for(e=0;e<c;e++)_+=ie[e].a*Math.cos(ie[e].b+ie[e].c*i);var d=ne.length,g=0;for(e=0;e<d;e++)g+=ne[e].a*Math.cos(ne[e].b+ne[e].c*i);var f=re.length,m=0;for(e=0;e<f;e++)m+=re[e].a*Math.cos(re[e].b+re[e].c*i);var p=se.length,w=0;for(e=0;e<p;e++)w+=se[e].a*Math.cos(se[e].b+se[e].c*i);return(l+u*i+_*n+g*r+m*s+w*a)/1e8},n("CAAJupiter",[ae,{},null]);const oe=[new f(87401354,0,0),new f(11107660,3.9620509,213.29909544),new f(1414151,4.5858152,7.113547),new f(398379,.52112,206.185548),new f(350769,3.303299,426.598191),new f(206816,.246584,103.092774),new f(79271,3.84007,220.41264),new f(23990,4.66977,110.20632),new f(16574,.43719,419.48464),new f(15820,.93809,632.78374),new f(15054,2.7167,639.89729),new f(14907,5.76903,316.39187),new f(14610,1.56519,3.93215),new f(13160,4.44891,14.22709),new f(13005,5.98119,11.0457),new f(10725,3.1294,202.2534),new f(6126,1.7633,277.035),new f(5863,.2366,529.691),new f(5228,4.2078,3.1814),new f(5020,3.1779,433.7117),new f(4593,.6198,199.072),new f(4006,2.2448,63.7359),new f(3874,3.2228,138.5175),new f(3269,.7749,949.1756),new f(2954,.9828,95.9792),new f(2461,2.0316,735.8765),new f(1758,3.2658,522.5774),new f(1640,5.505,846.0828),new f(1581,4.3727,309.2783),new f(1391,4.0233,323.5054),new f(1124,2.8373,415.5525),new f(1087,4.1834,2.4477),new f(1017,3.717,227.5262),new f(957,.507,1265.567),new f(853,3.421,175.166),new f(849,3.191,209.367),new f(789,5.007,.963),new f(749,2.144,853.196),new f(744,5.253,224.345),new f(687,1.747,1052.268),new f(654,1.599,.048),new f(634,2.299,412.371),new f(625,.97,210.118),new f(580,3.093,74.782),new f(546,2.127,350.332),new f(543,1.518,9.561),new f(530,4.449,117.32),new f(478,2.965,137.033),new f(474,5.475,742.99),new f(452,1.044,490.334),new f(449,1.29,127.472),new f(372,2.278,217.231),new f(355,3.013,838.969),new f(347,1.539,340.771),new f(343,.246,.521),new f(330,.247,1581.959),new f(322,.961,203.738),new f(322,2.572,647.011),new f(309,3.495,216.48),new f(287,2.37,351.817),new f(278,.4,211.815),new f(249,1.47,1368.66),new f(227,4.91,12.53),new f(220,4.204,200.769),new f(209,1.345,625.67),new f(208,.483,1162.475),new f(208,1.283,39.357),new f(204,6.011,265.989),new f(185,3.503,149.563),new f(184,.973,4.193),new f(182,5.491,2.921),new f(174,1.863,.751),new f(165,.44,5.417),new f(149,5.736,52.69),new f(148,1.535,5.629),new f(146,6.231,195.14),new f(140,4.295,21.341),new f(131,4.068,10.295),new f(125,6.277,1898.351),new f(122,1.976,4.666),new f(118,5.341,554.07),new f(117,2.679,1155.361),new f(114,5.594,1059.382),new f(112,1.105,191.208),new f(110,.166,1.484),new f(109,3.438,536.805),new f(107,4.012,956.289),new f(104,2.192,88.866),new f(103,1.197,1685.052),new f(101,4.965,269.921)],le=[new f(21354295596,0,0),new f(1296855,1.8282054,213.2990954),new f(564348,2.885001,7.113547),new f(107679,2.277699,206.185548),new f(98323,1.0807,426.59819),new f(40255,2.04128,220.41264),new f(19942,1.27955,103.09277),new f(10512,2.7488,14.22709),new f(6939,.4049,639.8973),new f(4803,2.4419,419.4846),new f(4056,2.9217,110.2063),new f(3769,3.6497,3.9322),new f(3385,2.4169,3.1814),new f(3302,1.2626,433.7117),new f(3071,2.3274,199.072),new f(1953,3.5639,11.0457),new f(1249,2.628,95.9792),new f(922,1.961,227.526),new f(706,4.417,529.691),new f(650,6.174,202.253),new f(628,6.111,309.278),new f(487,6.04,853.196),new f(479,4.988,522.577),new f(468,4.617,63.736),new f(417,2.117,323.505),new f(408,1.299,209.367),new f(352,2.317,632.784),new f(344,3.959,412.371),new f(340,3.634,316.392),new f(336,3.772,735.877),new f(332,2.861,210.118),new f(289,2.733,117.32),new f(281,5.744,2.448),new f(266,.543,647.011),new f(230,1.644,216.48),new f(192,2.965,224.345),new f(173,4.077,846.083),new f(167,2.597,21.341),new f(136,2.286,10.295),new f(131,3.441,742.99),new f(128,4.095,217.231),new f(109,6.161,415.552),new f(98,4.73,838.97),new f(94,3.48,1052.27),new f(92,3.95,88.87),new f(87,1.22,440.83),new f(83,3.11,625.67),new f(78,6.24,302.16),new f(67,.29,4.67),new f(66,5.65,9.56),new f(62,4.29,127.47),new f(62,1.83,195.14),new f(58,2.48,191.96),new f(57,5.02,137.03),new f(55,.28,74.78),new f(54,5.13,490.33),new f(51,1.46,536.8),new f(47,1.18,149.56),new f(47,5.15,515.46),new f(46,2.23,956.29),new f(44,2.71,5.42),new f(40,.41,269.92),new f(40,3.89,728.76),new f(38,.65,422.67),new f(38,2.53,12.53),new f(37,3.78,2.92),new f(35,6.08,5.63),new f(34,3.21,1368.66),new f(33,4.64,277.03),new f(33,5.43,1066.5),new f(33,.3,351.82),new f(32,4.39,1155.36),new f(31,2.43,52.69),new f(30,2.84,203),new f(30,6.19,284.15),new f(30,3.39,1059.38),new f(29,2.03,330.62),new f(28,2.74,265.99),new f(26,4.51,340.77)],he=[new f(116441,1.179879,7.113547),new f(91921,.07425,213.2991),new f(90592,0,0),new f(15277,4.06492,206.18555),new f(10631,.25778,220.41264),new f(10605,5.40964,426.59819),new f(4265,1.046,14.2271),new f(1216,2.9186,103.0928),new f(1165,4.6094,639.8973),new f(1082,5.6913,433.7117),new f(1045,4.0421,199.072),new f(1020,.6337,3.1814),new f(634,4.388,419.485),new f(549,5.573,3.932),new f(457,1.268,110.206),new f(425,.209,227.526),new f(274,4.288,95.979),new f(162,1.381,11.046),new f(129,1.566,309.278),new f(117,3.881,853.196),new f(105,4.9,647.011),new f(101,.893,21.341),new f(96,2.91,316.39),new f(95,5.63,412.37),new f(85,5.73,209.37),new f(83,6.05,216.48),new f(82,1.02,117.32),new f(75,4.76,210.12),new f(67,.46,522.58),new f(66,.48,10.29),new f(64,.35,323.51),new f(61,4.88,632.78),new f(53,2.75,529.69),new f(46,5.69,440.83),new f(45,1.67,202.25),new f(42,5.71,88.87),new f(32,.07,63.74),new f(32,1.67,302.16),new f(31,4.16,191.96),new f(27,.83,224.34),new f(25,5.66,735.88),new f(20,5.94,217.23),new f(18,4.9,625.67),new f(17,1.63,742.99),new f(16,.58,515.46),new f(14,.21,838.97),new f(14,3.76,195.14),new f(12,4.72,203),new f(12,.13,234.64),new f(12,3.12,846.08),new f(11,5.92,536.8),new f(11,5.6,728.76),new f(11,3.2,1066.5),new f(10,4.99,422.67),new f(10,.26,330.62),new f(10,4.15,860.31),new f(9,.46,956.29),new f(8,2.14,269.92),new f(8,5.25,429.78),new f(8,4.03,9.56),new f(7,5.4,1052.27),new f(6,4.46,284.15),new f(6,5.93,405.26)],ue=[new f(16039,5.73945,7.11355),new f(4250,4.5854,213.2991),new f(1907,4.7608,220.4126),new f(1466,5.9133,206.1855),new f(1162,5.6197,14.2271),new f(1067,3.6082,426.5982),new f(239,3.861,433.712),new f(237,5.768,199.072),new f(166,5.116,3.181),new f(151,2.736,639.897),new f(131,4.743,227.526),new f(63,.23,419.48),new f(62,4.74,103.09),new f(40,5.47,21.34),new f(40,5.96,95.98),new f(39,5.83,110.21),new f(28,3.01,647.01),new f(25,.99,3.93),new f(19,1.92,853.2),new f(18,4.97,10.29),new f(18,1.03,412.37),new f(18,4.2,216.48),new f(18,3.32,309.28),new f(16,3.9,440.83),new f(16,5.62,117.32),new f(13,1.18,88.87),new f(11,5.58,11.05),new f(11,5.93,191.96),new f(10,3.95,209.37),new f(9,3.39,302.16),new f(8,4.88,323.51),new f(7,.38,632.78),new f(6,2.25,522.58),new f(6,1.06,210.12),new f(5,4.64,234.64),new f(4,3.14,0),new f(4,2.31,515.46),new f(3,2.2,860.31),new f(3,.59,529.69),new f(3,4.93,224.34),new f(3,.42,625.67),new f(2,4.77,330.62),new f(2,3.35,429.78),new f(2,3.2,202.25),new f(2,1.19,1066.5),new f(2,1.35,405.26),new f(2,4.16,223.59),new f(2,3.07,654.12)],ce=[new f(1662,3.9983,7.1135),new f(257,2.984,220.413),new f(236,3.902,14.227),new f(149,2.741,213.299),new f(114,3.142,0),new f(110,1.515,206.186),new f(68,1.72,426.6),new f(40,2.05,433.71),new f(38,1.24,199.07),new f(31,3.01,227.53),new f(15,.83,639.9),new f(9,3.71,21.34),new f(6,2.42,419.48),new f(6,1.16,647.01),new f(4,1.45,95.98),new f(4,2.12,440.83),new f(3,4.09,110.21),new f(3,2.77,412.37),new f(3,3.01,88.87),new f(3,0,853.2),new f(3,.39,103.09),new f(2,3.78,117.32),new f(2,2.83,234.64),new f(2,5.08,309.28),new f(2,2.24,216.48),new f(2,5.19,302.16),new f(1,1.55,191.96)],_e=[new f(124,2.259,7.114),new f(34,2.16,14.23),new f(28,1.2,220.41),new f(6,1.22,227.53),new f(5,.24,433.71),new f(4,6.23,426.6),new f(3,2.97,199.07),new f(3,4.29,206.19),new f(2,6.25,213.3),new f(1,5.28,639.9),new f(1,.24,440.83),new f(1,3.14,0)],de=[new f(4330678,3.6028443,213.2990954),new f(240348,2.852385,426.598191),new f(84746,0,0),new f(34116,.57297,206.18555),new f(30863,3.48442,220.41264),new f(14734,2.11847,639.89729),new f(9917,5.79,419.4846),new f(6994,4.736,7.1135),new f(4808,5.4331,316.3919),new f(4788,4.9651,110.2063),new f(3432,2.7326,433.7117),new f(1506,6.013,103.0928),new f(1060,5.631,529.691),new f(969,5.204,632.784),new f(942,1.396,853.196),new f(708,3.803,323.505),new f(552,5.131,202.253),new f(400,3.359,227.526),new f(319,3.626,209.367),new f(316,1.997,647.011),new f(314,.465,217.231),new f(284,4.886,224.345),new f(236,2.139,11.046),new f(215,5.95,846.083),new f(209,2.12,415.552),new f(207,.73,199.072),new f(179,2.954,63.736),new f(141,.644,490.334),new f(139,4.595,14.227),new f(139,1.998,735.877),new f(135,5.245,742.99),new f(122,3.115,522.577),new f(116,3.109,216.48),new f(114,.963,210.118)],ge=[new f(397555,5.3329,213.299095),new f(49479,3.14159,0),new f(18572,6.09919,426.59819),new f(14801,2.30586,206.18555),new f(9644,1.6967,220.4126),new f(3757,1.2543,419.4846),new f(2717,5.9117,639.8973),new f(1455,.8516,433.7117),new f(1291,2.9177,7.1135),new f(853,.436,316.392),new f(298,.919,632.784),new f(292,5.316,853.196),new f(284,1.619,227.526),new f(275,3.889,103.093),new f(172,.052,647.011),new f(166,2.444,199.072),new f(158,5.209,110.206),new f(128,1.207,529.691),new f(110,2.457,217.231),new f(82,2.76,210.12),new f(81,2.86,14.23),new f(69,1.66,202.25),new f(65,1.26,216.48),new f(61,1.25,209.37),new f(59,1.82,323.51),new f(46,.82,440.83),new f(36,1.82,224.34),new f(34,2.84,117.32),new f(33,1.31,412.37),new f(32,1.19,846.08),new f(27,4.65,1066.5),new f(27,4.44,11.05)],fe=[new f(20630,.50482,213.2991),new f(3720,3.9983,206.1855),new f(1627,6.1819,220.4126),new f(1346,0,0),new f(706,3.039,419.485),new f(365,5.099,426.598),new f(330,5.279,433.712),new f(219,3.828,639.897),new f(139,1.043,7.114),new f(104,6.157,227.526),new f(93,1.98,316.39),new f(71,4.15,199.07),new f(52,2.88,632.78),new f(49,4.43,647.01),new f(41,3.16,853.2),new f(29,4.53,210.12),new f(24,1.12,14.23),new f(21,4.35,217.23),new f(20,5.31,440.83),new f(18,.85,110.21),new f(17,5.68,216.48),new f(16,4.26,103.09),new f(14,3,412.37),new f(12,2.53,529.69),new f(8,3.32,202.25),new f(7,5.56,209.37),new f(7,.29,323.51),new f(6,1.16,117.32),new f(6,3.61,869.31)],me=[new f(666,1.99,213.299),new f(632,5.698,206.186),new f(398,0,0),new f(188,4.338,220.413),new f(92,4.84,419.48),new f(52,3.42,433.71),new f(42,2.38,426.6),new f(26,4.4,227.53),new f(21,5.85,199.07),new f(18,1.99,639.9),new f(11,5.37,7.11),new f(10,2.55,647.01),new f(7,3.46,316.39),new f(6,4.8,632.78),new f(6,.02,210.12),new f(6,3.52,440.83),new f(5,5.64,14.23),new f(5,1.22,853.2),new f(4,4.71,412.37),new f(3,.63,103.09),new f(2,3.72,216.48)],pe=[new f(80,1.12,206.19),new f(32,3.12,213.3),new f(17,2.48,220.41),new f(12,3.14,0),new f(9,.38,419.48),new f(6,1.56,433.71),new f(5,2.63,227.53),new f(5,1.28,199.07),new f(1,1.43,426.6),new f(1,.67,647.01),new f(1,1.72,440.83),new f(1,6.18,639.9)],we=[new f(8,2.82,206.19),new f(1,.51,220.41)],be=[new f(955758136,0,0),new f(52921382,2.3922622,213.29909544),new f(1873680,5.2354961,206.1855484),new f(1464664,1.6476305,426.5981909),new f(821891,5.9352,316.39187),new f(547507,5.015326,103.092774),new f(371684,2.271148,220.412642),new f(361778,3.139043,7.113547),new f(140618,5.704067,632.783739),new f(108975,3.293136,110.206321),new f(69007,5.941,419.48464),new f(61053,.94038,639.89729),new f(48913,1.55733,202.2534),new f(34144,.19519,277.03499),new f(32402,5.47085,949.17561),new f(20937,.46349,735.87651),new f(20839,1.52103,433.71174),new f(20747,5.33256,199.072),new f(15298,3.05944,529.69097),new f(14296,2.60434,323.50542),new f(12884,1.64892,138.5175),new f(11993,5.98051,846.08283),new f(11380,1.73106,522.57742),new f(9796,5.2048,1265.5675),new f(7753,5.8519,95.9792),new f(6771,3.0043,14.2271),new f(6466,.1773,1052.2684),new f(5850,1.4552,415.5525),new f(5307,.5974,63.7359),new f(4696,2.1492,227.5262),new f(4044,1.6401,209.3669),new f(3688,.7802,412.3711),new f(3461,1.8509,175.1661),new f(3420,4.9455,1581.9593),new f(3401,.5539,350.3321),new f(3376,3.6953,224.3448),new f(2976,5.6847,210.1177),new f(2885,1.3876,838.9693),new f(2881,.1796,853.1964),new f(2508,3.5385,742.9901),new f(2448,6.1841,1368.6603),new f(2406,2.9656,117.3199),new f(2174,.0151,340.7709),new f(2024,5.0541,11.0457)],ve=[new f(6182981,.2584352,213.2990954),new f(506578,.711147,206.185548),new f(341394,5.796358,426.598191),new f(188491,.472157,220.412642),new f(186262,3.141593,0),new f(143891,1.407449,7.113547),new f(49621,6.01744,103.09277),new f(20928,5.09246,639.89729),new f(19953,1.1756,419.48464),new f(18840,1.6082,110.20632),new f(13877,.75886,199.072),new f(12893,5.9433,433.71174),new f(5397,1.2885,14.2271),new f(4869,.8679,323.5054),new f(4247,.393,227.5262),new f(3252,1.2585,95.9792),new f(3081,3.4366,522.5774),new f(2909,4.6068,202.2534),new f(2856,2.1673,735.8765),new f(1988,2.4505,412.3711),new f(1941,6.0239,209.3669),new f(1581,1.2919,210.1177),new f(1340,4.308,853.1964),new f(1316,1.253,117.3199),new f(1203,1.8665,316.3919),new f(1091,.0753,216.4805),new f(966,.48,632.784),new f(954,5.152,647.011),new f(898,.983,529.691),new f(882,1.885,1052.268),new f(874,1.402,224.345),new f(785,3.064,838.969),new f(740,1.382,625.67),new f(658,4.144,309.278),new f(650,1.725,742.99),new f(613,3.033,63.736),new f(599,2.549,217.231),new f(503,2.13,3.932)],ye=[new f(436902,4.786717,213.299095),new f(71923,2.5007,206.18555),new f(49767,4.97168,220.41264),new f(43221,3.8694,426.59819),new f(29646,5.9631,7.11355),new f(4721,2.4753,199.072),new f(4142,4.1067,433.7117),new f(3789,3.0977,639.8973),new f(2964,1.3721,103.0928),new f(2556,2.8507,419.4846),new f(2327,0,0),new f(2208,6.2759,110.2063),new f(2188,5.8555,14.2271),new f(1957,4.9245,227.5262),new f(924,5.464,323.505),new f(706,2.971,95.979),new f(546,4.129,412.371),new f(431,5.178,522.577),new f(405,4.173,209.367),new f(391,4.481,216.48),new f(374,5.834,117.32),new f(361,3.277,647.011),new f(356,3.192,210.118),new f(326,2.269,853.196),new f(207,4.022,735.877),new f(204,.088,202.253),new f(180,3.597,632.784),new f(178,4.097,440.825),new f(154,3.135,625.67),new f(148,.136,302.165),new f(133,2.594,191.958),new f(132,5.933,309.278)],Se=[new f(20315,3.02187,213.2991),new f(8924,3.1914,220.4126),new f(6909,4.3517,206.1855),new f(4087,4.2241,7.1135),new f(3879,2.0106,426.5982),new f(1071,4.2036,199.072),new f(907,2.283,433.712),new f(606,3.175,227.526),new f(597,4.135,14.227),new f(483,1.173,639.897),new f(393,0,0),new f(229,4.698,419.485),new f(188,4.59,110.206),new f(150,3.202,103.093),new f(121,3.768,323.505),new f(102,4.71,95.979),new f(101,5.819,412.371),new f(93,1.44,647.01),new f(84,2.63,216.48),new f(73,4.15,117.32),new f(62,2.31,440.83),new f(55,.31,853.2),new f(50,2.39,209.37),new f(45,4.37,191.96),new f(41,.69,522.58),new f(40,1.84,302.16),new f(38,5.94,88.87),new f(32,4.01,21.34)],xe=[new f(1202,1.415,220.4126),new f(708,1.162,213.299),new f(516,6.24,206.186),new f(427,2.469,7.114),new f(268,.187,426.598),new f(170,5.959,199.072),new f(150,.48,433.712),new f(145,1.442,227.526),new f(121,2.405,14.227),new f(47,5.57,639.9),new f(19,5.86,647.01),new f(17,.53,440.83),new f(16,2.9,110.21),new f(15,.3,419.48),new f(14,1.3,412.37),new f(13,2.09,323.51),new f(11,.22,95.98),new f(11,2.46,117.32),new f(10,3.14,0),new f(9,1.56,88.87),new f(9,2.28,21.34),new f(9,.68,216.48),new f(8,1.27,234.64)],Te=[new f(129,5.913,220.413),new f(32,.69,7.11),new f(27,5.91,227.53),new f(20,4.95,433.71),new f(20,.67,14.23),new f(14,2.67,206.19),new f(14,1.46,199.07),new f(13,4.59,426.6),new f(7,4.63,213.3),new f(5,3.61,639.9),new f(4,4.9,440.83),new f(3,4.07,647.01),new f(3,4.66,191.96),new f(3,.49,323.51),new f(3,3.18,419.48),new f(2,3.7,88.87),new f(2,3.32,95.98),new f(2,.56,117.32)];function Me(){}Me.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=oe.length,l=0;for(e=0;e<o;e++)l+=oe[e].a*Math.cos(oe[e].b+oe[e].c*i);var h=le.length,u=0;for(e=0;e<h;e++)u+=le[e].a*Math.cos(le[e].b+le[e].c*i);var c=he.length,_=0;for(e=0;e<c;e++)_+=he[e].a*Math.cos(he[e].b+he[e].c*i);var g=ue.length,f=0;for(e=0;e<g;e++)f+=ue[e].a*Math.cos(ue[e].b+ue[e].c*i);var m=ce.length,p=0;for(e=0;e<m;e++)p+=ce[e].a*Math.cos(ce[e].b+ce[e].c*i);var w=_e.length,b=0;for(e=0;e<w;e++)b+=_e[e].a*Math.cos(_e[e].b+_e[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.m360(d.r2D(v))},Me.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=de.length,l=0;for(e=0;e<o;e++)l+=de[e].a*Math.cos(de[e].b+de[e].c*i);var h=ge.length,u=0;for(e=0;e<h;e++)u+=ge[e].a*Math.cos(ge[e].b+ge[e].c*i);var c=fe.length,_=0;for(e=0;e<c;e++)_+=fe[e].a*Math.cos(fe[e].b+fe[e].c*i);var g=me.length,f=0;for(e=0;e<g;e++)f+=me[e].a*Math.cos(me[e].b+me[e].c*i);var m=pe.length,p=0;for(e=0;e<m;e++)p+=pe[e].a*Math.cos(pe[e].b+pe[e].c*i);var w=we.length,b=0;for(e=0;e<w;e++)b+=we[e].a*Math.cos(we[e].b+we[e].c*i);var v=(l+u*i+_*n+f*r+p*s+b*a)/1e8;return d.r2D(v)},Me.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=s*i,o=be.length,l=0;for(e=0;e<o;e++)l+=be[e].a*Math.cos(be[e].b+be[e].c*i);var h=ve.length,u=0;for(e=0;e<h;e++)u+=ve[e].a*Math.cos(ve[e].b+ve[e].c*i);var c=ye.length,_=0;for(e=0;e<c;e++)_+=ye[e].a*Math.cos(ye[e].b+ye[e].c*i);var d=Se.length,g=0;for(e=0;e<d;e++)g+=Se[e].a*Math.cos(Se[e].b+Se[e].c*i);var f=xe.length,m=0;for(e=0;e<f;e++)m+=xe[e].a*Math.cos(xe[e].b+xe[e].c*i);var p=Te.length,w=0;for(e=0;e<p;e++)w+=Te[e].a*Math.cos(Te[e].b+Te[e].c*i);return(l+u*i+_*n+g*r+m*s+w*a)/1e8},n("CAASaturn",[Me,{},null]);const Ce=[new f(548129294,0,0),new f(9260408,.8910642,74.7815986),new f(1504248,3.6271926,1.4844727),new f(365982,1.899622,73.297126),new f(272328,3.358237,149.563197),new f(70328,5.39254,63.7359),new f(68893,6.09292,76.26607),new f(61999,2.26952,2.96895),new f(61951,2.85099,11.0457),new f(26469,3.14152,71.81265),new f(25711,6.1138,454.90937),new f(21079,4.36059,148.07872),new f(17819,1.74437,36.64856),new f(14613,4.73732,3.93215),new f(11163,5.82682,224.3448),new f(10998,.48865,138.5175),new f(9527,2.9552,35.1641),new f(7546,5.2363,109.9457),new f(4220,3.2333,70.8494),new f(4052,2.2775,151.0477),new f(3490,5.4831,146.5943),new f(3355,1.0655,4.4534),new f(3144,4.752,77.7505),new f(2927,4.629,9.5612),new f(2922,5.3524,85.8273),new f(2273,4.366,70.3282),new f(2149,.6075,38.133),new f(2051,1.5177,.1119),new f(1992,4.9244,277.035),new f(1667,3.6274,380.1278),new f(1533,2.5859,52.6902),new f(1376,2.0428,65.2204),new f(1372,4.1964,111.4302),new f(1284,3.1135,202.2534),new f(1282,.5427,222.8603),new f(1244,.9161,2.4477),new f(1221,.199,108.4612),new f(1151,4.179,33.6796),new f(1150,.9334,3.1814),new f(1090,1.775,12.5302),new f(1072,.2356,62.2514),new f(946,1.192,127.472),new f(708,5.183,213.299),new f(653,.966,78.714),new f(628,.182,984.6),new f(607,5.432,529.691),new f(559,3.358,.521),new f(524,2.013,299.126),new f(483,2.106,.963),new f(471,1.407,184.727),new f(467,.415,145.11),new f(434,5.521,183.243),new f(405,5.987,8.077),new f(399,.338,415.552),new f(396,5.87,351.817),new f(379,2.35,56.622),new f(310,5.833,145.631),new f(300,5.644,22.091),new f(294,5.839,39.618),new f(252,1.637,221.376),new f(249,4.746,225.829),new f(239,2.35,137.033),new f(224,.516,84.343),new f(223,2.843,.261),new f(220,1.922,67.668),new f(217,6.142,5.938),new f(216,4.778,340.771),new f(208,5.58,68.844),new f(202,1.297,.048),new f(199,.956,152.532),new f(194,1.888,456.394),new f(193,.916,453.425),new f(187,1.319,.16),new f(182,3.536,79.235),new f(173,1.539,160.609),new f(172,5.68,219.891),new f(170,3.677,5.417),new f(169,5.879,18.159),new f(165,1.424,106.977),new f(163,3.05,112.915),new f(158,.738,54.175),new f(147,1.263,59.804),new f(143,1.3,35.425),new f(139,5.386,32.195),new f(139,4.26,909.819),new f(124,1.374,7.114),new f(110,2.027,554.07),new f(109,5.706,77.963),new f(104,5.028,.751),new f(104,1.458,24.379),new f(103,.681,14.978)],Ae=[new f(7502543122,0,0),new f(154458,5.242017,74.781599),new f(24456,1.71256,1.48447),new f(9258,.4284,11.0457),new f(8266,1.5022,63.7359),new f(7842,1.3198,149.5632),new f(3899,.4648,3.9322),new f(2284,4.1737,76.2661),new f(1927,.5301,2.9689),new f(1233,1.5863,70.8494),new f(791,5.436,3.181),new f(767,1.996,73.297),new f(482,2.984,85.827),new f(450,4.138,138.517),new f(446,3.723,224.345),new f(427,4.731,71.813),new f(354,2.583,148.079),new f(348,2.454,9.561),new f(317,5.579,52.69),new f(206,2.363,2.448),new f(189,4.202,56.622),new f(184,.284,151.048),new f(180,5.684,12.53),new f(171,3.001,78.714),new f(158,2.909,.963),new f(155,5.591,4.453),new f(154,4.652,35.164),new f(152,2.942,77.751),new f(143,2.59,62.251),new f(121,4.148,127.472),new f(116,3.732,65.22),new f(102,4.188,145.631),new f(102,6.034,.112),new f(88,3.99,18.16),new f(88,6.16,202.25),new f(81,2.64,22.09),new f(72,6.05,70.33),new f(69,4.05,77.96),new f(59,3.7,67.67),new f(47,3.54,351.82),new f(44,5.91,7.11),new f(43,5.72,5.42),new f(39,4.92,222.86),new f(36,5.9,33.68),new f(36,3.29,8.08),new f(36,3.33,71.6),new f(35,5.08,38.13),new f(31,5.62,984.6),new f(31,5.5,59.8),new f(31,5.46,160.61),new f(30,1.66,447.8),new f(29,1.15,462.02),new f(29,4.52,84.34),new f(27,5.54,131.4),new f(27,6.15,299.13),new f(26,4.99,137.03),new f(25,5.74,380.13)],Le=[new f(53033,0,0),new f(2358,2.2601,74.7816),new f(769,4.526,11.046),new f(552,3.258,63.736),new f(542,2.276,3.932),new f(529,4.923,1.484),new f(258,3.691,3.181),new f(239,5.858,149.563),new f(182,6.218,70.849),new f(54,1.44,76.27),new f(49,6.03,56.62),new f(45,3.91,2.45),new f(45,.81,85.83),new f(38,1.78,52.69),new f(37,4.46,2.97),new f(33,.86,9.56),new f(29,5.1,73.3),new f(24,2.11,18.16),new f(22,5.99,138.52),new f(22,4.82,78.71),new f(21,2.4,77.96),new f(21,2.17,224.34),new f(17,2.54,145.63),new f(17,3.47,12.53),new f(12,.02,22.09),new f(11,.08,127.47),new f(10,5.16,71.6),new f(10,4.46,62.25),new f(9,4.26,7.11),new f(8,5.5,67.67),new f(7,1.25,5.42),new f(6,3.36,447.8),new f(6,5.45,65.22),new f(6,4.52,151.05),new f(6,5.73,462.02)],Ie=[new f(121,.024,74.782),new f(68,4.12,3.93),new f(53,2.39,11.05),new f(46,0,0),new f(45,2.04,3.18),new f(44,2.96,1.48),new f(25,4.89,63.74),new f(21,4.55,70.85),new f(20,2.31,149.56),new f(9,1.58,56.62),new f(4,.23,18.16),new f(4,5.39,76.27),new f(4,.95,77.96),new f(3,4.98,85.83),new f(3,4.13,52.69),new f(3,.37,78.71),new f(2,.86,145.63),new f(2,5.66,9.56)],ke=[new f(114,3.142,0),new f(6,4.58,74.78),new f(3,.35,11.05),new f(1,3.42,56.62)],Pe=[new f(1346278,2.6187781,74.7815986),new f(62341,5.08111,149.5632),new f(61601,3.14159,0),new f(9964,1.616,76.2661),new f(9926,.5763,73.2971),new f(3259,1.2612,224.3448),new f(2972,2.2437,1.4845),new f(2010,6.0555,148.0787),new f(1522,.2796,63.7359),new f(924,4.038,151.048),new f(761,6.14,71.813),new f(522,3.321,138.517),new f(463,.743,85.827),new f(437,3.381,529.691),new f(435,.341,77.751),new f(431,3.554,213.299),new f(420,5.213,11.046),new f(245,.788,2.969),new f(233,2.257,222.86),new f(216,1.591,38.133),new f(180,3.725,299.126),new f(175,1.236,146.594),new f(174,1.937,380.128),new f(160,5.336,111.43),new f(144,5.962,35.164),new f(116,5.739,70.849),new f(106,.941,70.328),new f(102,2.619,78.714)],Re=[new f(206366,4.123943,74.781599),new f(8563,.3382,149.5632),new f(1726,2.1219,73.2971),new f(1374,0,0),new f(1369,3.0686,76.2661),new f(451,3.777,1.484),new f(400,2.848,224.345),new f(307,1.255,148.079),new f(154,3.786,63.736),new f(112,5.573,151.048),new f(111,5.329,138.517),new f(83,3.59,71.81),new f(56,3.4,85.83),new f(54,1.7,77.75),new f(42,1.21,11.05),new f(41,4.45,78.71),new f(32,3.77,222.86),new f(30,2.56,2.97),new f(27,5.34,213.3),new f(26,.42,380.13)],Ee=[new f(9212,5.8004,74.7816),new f(557,0,0),new f(286,2.177,149.563),new f(95,3.84,73.3),new f(45,4.88,76.27),new f(20,5.46,1.48),new f(15,.88,138.52),new f(14,2.85,148.08),new f(14,5.07,63.74),new f(10,5,224.34),new f(8,6.27,78.71)],De=[new f(268,1.251,74.782),new f(11,3.14,0),new f(6,4.01,149.56),new f(3,5.78,73.3)],Fe=[new f(6,2.85,74.78)],Ne=[new f(1921264848,0,0),new f(88784984,5.60377527,74.78159857),new f(3440836,.328361,73.2971259),new f(2055653,1.7829517,149.5631971),new f(649322,4.522473,76.266071),new f(602248,3.860038,63.735898),new f(496404,1.401399,454.909367),new f(338526,1.580027,138.517497),new f(243508,1.570866,71.812653),new f(190522,1.998094,1.484473),new f(161858,2.791379,148.078724),new f(143706,1.383686,11.0457),new f(93192,.17437,36.64856),new f(89806,3.66105,109.94569),new f(71424,4.24509,224.3448),new f(46677,1.39977,35.16409),new f(39026,3.36235,277.03499),new f(39010,1.66971,70.84945),new f(36755,3.88649,146.59425),new f(30349,.701,151.04767),new f(29156,3.18056,77.75054),new f(25786,3.78538,85.8273),new f(25620,5.25656,380.12777),new f(22637,.72519,529.69097),new f(20473,2.7964,70.32818),new f(20472,1.55589,202.2534),new f(17901,.55455,2.96895),new f(15503,5.35405,38.13304),new f(14702,4.90434,108.46122),new f(12897,2.62154,111.43016),new f(12328,5.96039,127.4718),new f(11959,1.75044,984.60033),new f(11853,.99343,52.6902),new f(11696,3.29826,3.93215),new f(11495,.43774,65.22037),new f(10793,1.42105,213.2991),new f(9111,4.9964,62.2514),new f(8421,5.2535,222.8603),new f(8402,5.0388,415.5525),new f(7449,.7949,351.8166),new f(7329,3.9728,183.2428),new f(6046,5.6796,78.7138),new f(5524,3.115,9.5612),new f(5445,5.1058,145.1098),new f(5238,2.6296,33.6796),new f(4079,3.2206,340.7709),new f(3919,4.2502,39.6175),new f(3802,6.1099,184.7273),new f(3781,3.4584,456.3938),new f(3687,2.4872,453.4249),new f(3102,4.1403,219.8914),new f(2963,.8298,56.6224),new f(2942,.4239,299.1264),new f(2940,2.1464,137.033),new f(2938,3.6766,140.002),new f(2865,.31,12.5302),new f(2538,4.8546,131.4039),new f(2364,.4425,554.07),new f(2183,2.9404,305.3462)],$e=[new f(1479896,3.6720571,74.7815986),new f(71212,6.22601,63.7359),new f(68627,6.13411,149.5632),new f(24060,3.14159,0),new f(21468,2.60177,76.26607),new f(20857,5.24625,11.0457),new f(11405,.01848,70.84945),new f(7497,.4236,73.2971),new f(4244,1.4169,85.8273),new f(3927,3.1551,71.8127),new f(3578,2.3116,224.3448),new f(3506,2.5835,138.5175),new f(3229,5.255,3.9322),new f(3060,.1532,1.4845),new f(2564,.9808,148.0787),new f(2429,3.9944,52.6902),new f(1645,2.6535,127.4718),new f(1584,1.4305,78.7138),new f(1508,5.06,151.0477),new f(1490,2.6756,56.6224),new f(1413,4.5746,202.2534),new f(1403,1.3699,77.7505),new f(1228,1.047,62.2514),new f(1033,.2646,131.4039),new f(992,2.172,65.22),new f(862,5.055,351.817),new f(744,3.076,35.164),new f(687,2.499,77.963),new f(647,4.473,70.328),new f(624,.863,9.561),new f(604,.907,984.6),new f(575,3.231,447.796),new f(562,2.718,462.023),new f(530,5.917,213.299),new f(528,5.151,2.969)],ze=[new f(22440,.69953,74.7816),new f(4727,1.699,63.7359),new f(1682,4.6483,70.8494),new f(1650,3.0966,11.0457),new f(1434,3.5212,149.5632),new f(770,0,0),new f(500,6.172,76.266),new f(461,.767,3.932),new f(390,4.496,56.622),new f(390,5.527,85.827),new f(292,.204,52.69),new f(287,3.534,73.297),new f(273,3.847,138.517),new f(220,1.964,131.404),new f(216,.848,77.963),new f(205,3.248,78.714),new f(149,4.898,127.472),new f(129,2.081,3.181)],Be=[new f(1164,4.7345,74.7816),new f(212,3.343,63.736),new f(196,2.98,70.849),new f(105,.958,11.046),new f(73,1,149.56),new f(72,.03,56.62),new f(55,2.59,3.93),new f(36,5.65,77.96),new f(34,3.82,76.27),new f(32,3.6,131.4)],Ue=[new f(53,3.01,74.78),new f(10,1.91,56.62)];function Ve(){}Ve.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=Ce.length,o=0;for(e=0;e<a;e++)o+=Ce[e].a*Math.cos(Ce[e].b+Ce[e].c*i);var l=Ae.length,h=0;for(e=0;e<l;e++)h+=Ae[e].a*Math.cos(Ae[e].b+Ae[e].c*i);var u=Le.length,c=0;for(e=0;e<u;e++)c+=Le[e].a*Math.cos(Le[e].b+Le[e].c*i);var _=Ie.length,g=0;for(e=0;e<_;e++)g+=Ie[e].a*Math.cos(Ie[e].b+Ie[e].c*i);var f=ke.length,m=0;for(e=0;e<f;e++)m+=ke[e].a*Math.cos(ke[e].b+ke[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.m360(d.r2D(p))},Ve.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=Pe.length,o=0;for(e=0;e<a;e++)o+=Pe[e].a*Math.cos(Pe[e].b+Pe[e].c*i);var l=Re.length,h=0;for(e=0;e<l;e++)h+=Re[e].a*Math.cos(Re[e].b+Re[e].c*i);var u=Ee.length,c=0;for(e=0;e<u;e++)c+=Ee[e].a*Math.cos(Ee[e].b+Ee[e].c*i);var _=De.length,g=0;for(e=0;e<_;e++)g+=De[e].a*Math.cos(De[e].b+De[e].c*i);var f=Fe.length,m=0;for(e=0;e<f;e++)m+=Fe[e].a*Math.cos(Fe[e].b+Fe[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},Ve.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=Ne.length,o=0;for(e=0;e<a;e++)o+=Ne[e].a*Math.cos(Ne[e].b+Ne[e].c*i);var l=$e.length,h=0;for(e=0;e<l;e++)h+=$e[e].a*Math.cos($e[e].b+$e[e].c*i);var u=ze.length,c=0;for(e=0;e<u;e++)c+=ze[e].a*Math.cos(ze[e].b+ze[e].c*i);var _=Be.length,d=0;for(e=0;e<_;e++)d+=Be[e].a*Math.cos(Be[e].b+Be[e].c*i);var g=Ue.length,f=0;for(e=0;e<g;e++)f+=Ue[e].a*Math.cos(Ue[e].b+Ue[e].c*i);return(o+h*i+c*n+d*r+f*s)/1e8},n("CAAUranus",[Ve,{},null]);const Oe=[new f(531188633,0,0),new f(1798476,2.9010127,38.1330356),new f(1019728,.4858092,1.4844727),new f(124532,4.830081,36.648563),new f(42064,5.41055,2.96895),new f(37715,6.09222,35.16409),new f(33785,1.24489,76.26607),new f(16483,8e-5,491.55793),new f(9199,4.9375,39.6175),new f(8994,.2746,175.1661),new f(4216,1.9871,73.2971),new f(3365,1.0359,33.6796),new f(2285,4.2061,4.4534),new f(1434,2.7834,74.7816),new f(900,2.076,109.946),new f(745,3.19,71.813),new f(506,5.748,114.399),new f(400,.35,1021.249),new f(345,3.462,41.102),new f(340,3.304,77.751),new f(323,2.248,32.195),new f(306,.497,.521),new f(287,4.505,.048),new f(282,2.246,146.594),new f(267,4.889,.963),new f(252,5.782,388.465),new f(245,1.247,9.561),new f(233,2.505,137.033),new f(227,1.797,453.425),new f(170,3.324,108.461),new f(151,2.192,33.94),new f(150,2.997,5.938),new f(148,.859,111.43),new f(119,3.677,2.448),new f(109,2.416,183.243),new f(103,.041,.261),new f(103,4.404,70.328),new f(102,5.705,.112)],Ge=[new f(3837687717,0,0),new f(16604,4.86319,1.48447),new f(15807,2.27923,38.13304),new f(3335,3.682,76.2661),new f(1306,3.6732,2.9689),new f(605,1.505,35.164),new f(179,3.453,39.618),new f(107,2.451,4.453),new f(106,2.755,33.68),new f(73,5.49,36.65),new f(57,1.86,114.4),new f(57,5.22,.52),new f(35,4.52,74.78),new f(32,5.9,77.75),new f(30,3.67,388.47),new f(29,5.17,9.56),new f(29,5.17,2.45),new f(26,5.25,168.05)],Xe=[new f(53893,0,0),new f(296,1.855,1.484),new f(281,1.191,38.133),new f(270,5.721,76.266),new f(23,1.21,2.97),new f(9,4.43,35.16),new f(7,.54,2.45)],He=[new f(31,0,0),new f(15,1.35,76.27),new f(12,6.04,1.48),new f(12,6.11,38.13)],Ye=[new f(114,3.142,0)],je=[new f(3088623,1.4410437,38.1330356),new f(27789,5.91272,76.26607),new f(27624,0,0),new f(15448,3.50877,39.61751),new f(15355,2.52124,36.64856),new f(2e3,1.51,74.7816),new f(1968,4.3778,1.4845),new f(1015,3.2156,35.1641),new f(606,2.802,73.297),new f(595,2.129,41.102),new f(589,3.187,2.969),new f(402,4.169,114.399),new f(280,1.682,77.751),new f(262,3.767,213.299),new f(254,3.271,453.425),new f(206,4.257,529.691),new f(140,3.53,137.033)],We=[new f(227279,3.807931,38.133036),new f(1803,1.9758,76.2661),new f(1433,3.1416,0),new f(1386,4.8256,36.6486),new f(1073,6.0805,39.6175),new f(148,3.858,74.782),new f(136,.478,1.484),new f(70,6.19,35.16),new f(52,5.05,73.3),new f(43,.31,114.4),new f(37,4.89,41.1),new f(37,5.76,2.97),new f(26,5.22,213.3)],qe=[new f(9691,5.5712,38.133),new f(79,3.63,76.27),new f(72,.45,36.65),new f(59,3.14,0),new f(30,1.61,39.62),new f(6,5.61,74.78)],Ze=[new f(273,1.017,38.133),new f(2,0,0),new f(2,2.37,36.65),new f(2,5.33,76.27)],Ke=[new f(6,2.67,38.13)],Je=[new f(3007013206,0,0),new f(27062259,1.32999459,38.13303564),new f(1691764,3.2518614,36.6485629),new f(807831,5.185928,1.484473),new f(537761,4.521139,35.16409),new f(495726,1.571057,491.557929),new f(274572,1.845523,175.16606),new f(135134,3.372206,39.617508),new f(121802,5.797544,76.266071),new f(100895,.377027,73.297126),new f(69792,3.79617,2.96895),new f(46688,5.74938,33.67962),new f(24594,.50802,109.94569),new f(16939,1.59422,71.81265),new f(14230,1.07786,74.7816),new f(12012,1.92062,1021.24889),new f(8395,.6782,146.5943),new f(7572,1.0715,388.4652),new f(5721,2.5906,4.4534),new f(4840,1.9069,41.102),new f(4483,2.9057,529.691),new f(4421,1.7499,108.4612),new f(4354,.6799,32.1951),new f(4270,3.4134,453.4249),new f(3381,.8481,183.2428),new f(2881,1.986,137.033),new f(2879,3.6742,350.3321),new f(2636,3.0976,213.2991),new f(2530,5.7984,490.0735),new f(2523,.4863,493.0424),new f(2306,2.8096,70.3282),new f(2087,.6186,33.9402)],Qe=[new f(236339,.70498,38.133036),new f(13220,3.32015,1.48447),new f(8622,6.2163,35.1641),new f(2702,1.8814,39.6175),new f(2155,2.0943,2.9689),new f(2153,5.1687,76.2661),new f(1603,0,0),new f(1464,1.1842,33.6796),new f(1136,3.9189,36.6486),new f(898,5.241,388.465),new f(790,.533,168.053),new f(760,.021,182.28),new f(607,1.077,1021.249),new f(572,3.401,484.444),new f(561,2.887,498.671)],ti=[new f(4247,5.8991,38.133),new f(218,.346,1.484),new f(163,2.239,168.053),new f(156,4.594,182.28),new f(127,2.848,35.164)],ei=[new f(166,4.552,38.133)];function ii(){}function ni(t,e,i){this.j=0,this.s=0,this.p=0,this.j=t,this.s=e,this.p=i}function ri(t,e){this.a=0,this.b=0,this.a=t,this.b=e}ii.eclipticLongitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=Oe.length,o=0;for(e=0;e<a;e++)o+=Oe[e].a*Math.cos(Oe[e].b+Oe[e].c*i);var l=Ge.length,h=0;for(e=0;e<l;e++)h+=Ge[e].a*Math.cos(Ge[e].b+Ge[e].c*i);var u=Xe.length,c=0;for(e=0;e<u;e++)c+=Xe[e].a*Math.cos(Xe[e].b+Xe[e].c*i);var _=He.length,g=0;for(e=0;e<_;e++)g+=He[e].a*Math.cos(He[e].b+He[e].c*i);var f=Ye.length,m=0;for(e=0;e<f;e++)m+=Ye[e].a*Math.cos(Ye[e].b+Ye[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.m360(d.r2D(p))},ii.eclipticLatitude=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=r*i,a=je.length,o=0;for(e=0;e<a;e++)o+=je[e].a*Math.cos(je[e].b+je[e].c*i);var l=We.length,h=0;for(e=0;e<l;e++)h+=We[e].a*Math.cos(We[e].b+We[e].c*i);var u=qe.length,c=0;for(e=0;e<u;e++)c+=qe[e].a*Math.cos(qe[e].b+qe[e].c*i);var _=Ze.length,g=0;for(e=0;e<_;e++)g+=Ze[e].a*Math.cos(Ze[e].b+Ze[e].c*i);var f=Ke.length,m=0;for(e=0;e<f;e++)m+=Ke[e].a*Math.cos(Ke[e].b+Ke[e].c*i);var p=(o+h*i+c*n+g*r+m*s)/1e8;return d.r2D(p)},ii.radiusVector=function(t){var e,i=(t-2451545)/365250,n=i*i,r=n*i,s=Je.length,a=0;for(e=0;e<s;e++)a+=Je[e].a*Math.cos(Je[e].b+Je[e].c*i);var o=Qe.length,l=0;for(e=0;e<o;e++)l+=Qe[e].a*Math.cos(Qe[e].b+Qe[e].c*i);var h=ti.length,u=0;for(e=0;e<h;e++)u+=ti[e].a*Math.cos(ti[e].b+ti[e].c*i);var c=ei.length,_=0;for(e=0;e<c;e++)_+=ei[e].a*Math.cos(ei[e].b+ei[e].c*i);return(a+l*i+u*n+_*r)/1e8},n("CAANeptune",[ii,{},null]),n("PlutoCoefficient1",[ni,{},null]),n("PlutoCoefficient2",[ri,{},null]);const si=[new ni(0,0,1),new ni(0,0,2),new ni(0,0,3),new ni(0,0,4),new ni(0,0,5),new ni(0,0,6),new ni(0,1,-1),new ni(0,1,0),new ni(0,1,1),new ni(0,1,2),new ni(0,1,3),new ni(0,2,-2),new ni(0,2,-1),new ni(0,2,0),new ni(1,-1,0),new ni(1,-1,1),new ni(1,0,-3),new ni(1,0,-2),new ni(1,0,-1),new ni(1,0,0),new ni(1,0,1),new ni(1,0,2),new ni(1,0,3),new ni(1,0,4),new ni(1,1,-3),new ni(1,1,-2),new ni(1,1,-1),new ni(1,1,0),new ni(1,1,1),new ni(1,1,3),new ni(2,0,-6),new ni(2,0,-5),new ni(2,0,-4),new ni(2,0,-3),new ni(2,0,-2),new ni(2,0,-1),new ni(2,0,0),new ni(2,0,1),new ni(2,0,2),new ni(2,0,3),new ni(3,0,-2),new ni(3,0,-1),new ni(3,0,0)],ai=[new ri(-19799805,19850055),new ri(897144,-4954829),new ri(611149,1211027),new ri(-341243,-189585),new ri(129287,-34992),new ri(-38164,30893),new ri(20442,-9987),new ri(-4063,-5071),new ri(-6016,-3336),new ri(-3956,3039),new ri(-667,3572),new ri(1276,501),new ri(1152,-917),new ri(630,-1277),new ri(2571,-459),new ri(899,-1449),new ri(-1016,1043),new ri(-2343,-1012),new ri(7042,788),new ri(1199,-338),new ri(418,-67),new ri(120,-274),new ri(-60,-159),new ri(-82,-29),new ri(-36,-29),new ri(-40,7),new ri(-14,22),new ri(4,13),new ri(5,2),new ri(-1,0),new ri(2,0),new ri(-4,5),new ri(4,-7),new ri(14,24),new ri(-49,-34),new ri(163,-48),new ri(9,-24),new ri(-4,1),new ri(-3,1),new ri(1,3),new ri(-3,-1),new ri(5,-3),new ri(0,0)],oi=[new ri(-5452852,-14974862),new ri(3527812,1672790),new ri(-1050748,327647),new ri(178690,-292153),new ri(18650,100340),new ri(-30697,-25823),new ri(4878,11248),new ri(226,-64),new ri(2030,-836),new ri(69,-604),new ri(-247,-567),new ri(-57,1),new ri(-122,175),new ri(-49,-164),new ri(-197,199),new ri(-25,217),new ri(589,-248),new ri(-269,711),new ri(185,193),new ri(315,807),new ri(-130,-43),new ri(5,3),new ri(2,17),new ri(2,5),new ri(2,3),new ri(3,1),new ri(2,-1),new ri(1,-1),new ri(0,-1),new ri(0,0),new ri(0,-2),new ri(2,2),new ri(-7,0),new ri(10,-8),new ri(-3,20),new ri(6,5),new ri(14,17),new ri(-2,0),new ri(0,0),new ri(0,0),new ri(0,1),new ri(0,0),new ri(1,0)],li=[new ri(66865439,68951812),new ri(-11827535,-332538),new ri(1593179,-1438890),new ri(-18444,483220),new ri(-65977,-85431),new ri(31174,-6032),new ri(-5794,22161),new ri(4601,4032),new ri(-1729,234),new ri(-415,702),new ri(239,723),new ri(67,-67),new ri(1034,-451),new ri(-129,504),new ri(480,-231),new ri(2,-441),new ri(-3359,265),new ri(7856,-7832),new ri(36,45763),new ri(8663,8547),new ri(-809,-769),new ri(263,-144),new ri(-126,32),new ri(-35,-16),new ri(-19,-4),new ri(-15,8),new ri(-4,12),new ri(5,6),new ri(3,1),new ri(6,-2),new ri(2,2),new ri(-2,-2),new ri(14,13),new ri(-63,13),new ri(136,-236),new ri(273,1065),new ri(251,149),new ri(-25,-9),new ri(9,-2),new ri(-8,7),new ri(2,-10),new ri(19,35),new ri(10,3)];function hi(){}function ui(){}function ci(t,e,i,n,r,s,a,o,l,h,u,c,_,d,g,f,m,p,w,b,v,y,S){this.l2=0,this.l3=0,this.l4=0,this.l5=0,this.l6=0,this.l7=0,this.l8=0,this.ldash=0,this.d=0,this.mdash=0,this.f=0,this.xsin=0,this.xsint=0,this.xcos=0,this.xcost=0,this.ysin=0,this.ysint=0,this.ycos=0,this.ycost=0,this.zsin=0,this.zsint=0,this.zcos=0,this.zcost=0,this.l2=t,this.l3=e,this.l4=i,this.l5=n,this.l6=r,this.l7=s,this.l8=a,this.ldash=o,this.d=l,this.mdash=h,this.f=u,this.xsin=c,this.xsint=_,this.xcos=d,this.xcost=g,this.ysin=f,this.ysint=m,this.ycos=p,this.ycost=w,this.zsin=b,this.zsint=v,this.zcos=y,this.zcost=S}hi.eclipticLongitude=function(t){for(var e=(t-2451545)/36525,i=34.35+3034.9057*e,n=50.08+1222.1138*e,r=238.96+144.96*e,s=0,a=si.length,o=0;o<a;o++){var l=si[o].j*i+si[o].s*n+si[o].p*r;l=d.d2R(l),s+=ai[o].a*Math.sin(l)+ai[o].b*Math.cos(l)}return s/=1e6,s+=238.958116+144.96*e,d.m360(s)},hi.eclipticLatitude=function(t){for(var e=(t-2451545)/36525,i=34.35+3034.9057*e,n=50.08+1222.1138*e,r=238.96+144.96*e,s=0,a=si.length,o=0;o<a;o++){var l=si[o].j*i+si[o].s*n+si[o].p*r;l=d.d2R(l),s+=oi[o].a*Math.sin(l)+oi[o].b*Math.cos(l)}return(s/=1e6)+-3.908239},hi.radiusVector=function(t){for(var e=(t-2451545)/36525,i=34.35+3034.9057*e,n=50.08+1222.1138*e,r=238.96+144.96*e,s=0,a=si.length,o=0;o<a;o++){var l=si[o].j*i+si[o].s*n+si[o].p*r;l=d.d2R(l),s+=li[o].a*Math.sin(l)+li[o].b*Math.cos(l)}return(s/=1e7)+40.7241346},n("CAAPluto",[hi,{},null]),ui.calculate=function(t,e){return ui.calculateIter(t,e,53)},ui.calculateIter=function(e,i,n){e=d.d2R(e);var r=d.PI(),s=1;e<0&&(s=-1),(e=2*((e=Math.abs(e)/(2*r))-t.ss.truncate(e))*r*s)<0&&(e+=2*r),s=1,e>r&&(s=-1),e>r&&(e=2*r-e);for(var a=r/2,o=r/4,l=0;l<n;l++)e>a-i*Math.sin(a)?a+=o:a-=o,o/=2;return d.r2D(a)*s},n("CAAKepler",[ui,{},null]),n("ACFT",[ci,{},null]);const _i=[new ci(0,1,0,0,0,0,0,0,0,0,0,-1719914,-2,-25,0,25,-13,1578089,156,10,32,684185,-358),new ci(0,2,0,0,0,0,0,0,0,0,0,6434,141,28007,-107,25697,-95,-5904,-130,11141,-48,-2559,-55),new ci(0,0,0,1,0,0,0,0,0,0,0,715,0,0,0,6,0,-657,0,-15,0,-282,0),new ci(0,0,0,0,0,0,0,1,0,0,0,715,0,0,0,0,0,-656,0,0,0,-285,0),new ci(0,3,0,0,0,0,0,0,0,0,0,486,-5,-236,-4,-216,-4,-446,5,-94,0,-193,0),new ci(0,0,0,0,1,0,0,0,0,0,0,159,0,0,0,2,0,-147,0,-6,0,-61,0),new ci(0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,26,0,0,0,-59,0),new ci(0,0,0,0,0,0,0,1,0,1,0,39,0,0,0,0,0,-36,0,0,0,-16,0),new ci(0,0,0,2,0,0,0,0,0,0,0,33,0,-10,0,-9,0,-30,0,-5,0,-13,0),new ci(0,2,0,-1,0,0,0,0,0,0,0,31,0,1,0,1,0,-28,0,0,0,-12,0),new ci(0,3,-8,3,0,0,0,0,0,0,0,8,0,-28,0,25,0,8,0,11,0,3,0),new ci(0,5,-8,3,0,0,0,0,0,0,0,8,0,-28,0,-25,0,-8,0,-11,0,-3,0),new ci(2,-1,0,0,0,0,0,0,0,0,0,21,0,0,0,0,0,-19,0,0,0,-8,0),new ci(1,0,0,0,0,0,0,0,0,0,0,-19,0,0,0,0,0,17,0,0,0,8,0),new ci(0,0,0,0,0,1,0,0,0,0,0,17,0,0,0,0,0,-16,0,0,0,-7,0),new ci(0,1,0,-2,0,0,0,0,0,0,0,16,0,0,0,0,0,15,0,1,0,7,0),new ci(0,0,0,0,0,0,1,0,0,0,0,16,0,0,0,1,0,-15,0,-3,0,-6,0),new ci(0,1,0,1,0,0,0,0,0,0,0,11,0,-1,0,-1,0,-10,0,-1,0,-5,0),new ci(2,-2,0,0,0,0,0,0,0,0,0,0,0,-11,0,-10,0,0,0,-4,0,0,0),new ci(0,1,0,-1,0,0,0,0,0,0,0,-11,0,-2,0,-2,0,9,0,-1,0,4,0),new ci(0,4,0,0,0,0,0,0,0,0,0,-7,0,-8,0,-8,0,6,0,-3,0,3,0),new ci(0,3,0,-2,0,0,0,0,0,0,0,-10,0,0,0,0,0,9,0,0,0,4,0),new ci(1,-2,0,0,0,0,0,0,0,0,0,-9,0,0,0,0,0,-9,0,0,0,-4,0),new ci(2,-3,0,0,0,0,0,0,0,0,0,-9,0,0,0,0,0,-8,0,0,0,-4,0),new ci(0,0,0,0,2,0,0,0,0,0,0,0,0,-9,0,-8,0,0,0,-3,0,0,0),new ci(2,-4,0,0,0,0,0,0,0,0,0,0,0,-9,0,8,0,0,0,3,0,0,0),new ci(0,3,-2,0,0,0,0,0,0,0,0,8,0,0,0,0,0,-8,0,0,0,-3,0),new ci(0,0,0,0,0,0,0,1,2,-1,0,8,0,0,0,0,0,-7,0,0,0,-3,0),new ci(8,-12,0,0,0,0,0,0,0,0,0,-4,0,-7,0,-6,0,4,0,-3,0,2,0),new ci(8,-14,0,0,0,0,0,0,0,0,0,-4,0,-7,0,6,0,-4,0,3,0,-2,0),new ci(0,0,2,0,0,0,0,0,0,0,0,-6,0,-5,0,-4,0,5,0,-2,0,2,0),new ci(3,-4,0,0,0,0,0,0,0,0,0,-1,0,-1,0,-2,0,-7,0,1,0,-4,0),new ci(0,2,0,-2,0,0,0,0,0,0,0,4,0,-6,0,-5,0,-4,0,-2,0,-2,0),new ci(3,-3,0,0,0,0,0,0,0,0,0,0,0,-7,0,-6,0,0,0,-3,0,0,0),new ci(0,2,-2,0,0,0,0,0,0,0,0,5,0,-5,0,-4,0,-5,0,-2,0,-2,0),new ci(0,0,0,0,0,0,0,1,-2,0,0,5,0,0,0,0,0,-5,0,0,0,-2,0)];function di(){}di.earthVelocity=function(t){for(var e=(t-2451545)/36525,i=3.1761467+1021.3285546*e,n=1.7534703+628.3075849*e,r=6.2034809+334.0612431*e,s=.5995465+52.9690965*e,a=.8740168+21.3299095*e,o=5.4812939+7.4781599*e,l=5.3118863+3.8133036*e,h=3.8103444+8399.6847337*e,u=5.1984667+7771.3771486*e,c=2.3555559+8328.6914289*e,d=1.6279052+8433.4661601*e,g=new _,f=_i.length,m=0;m<f;m++){var p=_i[m].l2*i+_i[m].l3*n+_i[m].l4*r+_i[m].l5*s+_i[m].l6*a+_i[m].l7*o+_i[m].l8*l+_i[m].ldash*h+_i[m].d*u+_i[m].mdash*c+_i[m].f*d;g.x+=(_i[m].xsin+_i[m].xsint*e)*Math.sin(p),g.x+=(_i[m].xcos+_i[m].xcost*e)*Math.cos(p),g.y+=(_i[m].ysin+_i[m].ysint*e)*Math.sin(p),g.y+=(_i[m].ycos+_i[m].ycost*e)*Math.cos(p),g.z+=(_i[m].zsin+_i[m].zsint*e)*Math.sin(p),g.z+=(_i[m].zcos+_i[m].zcost*e)*Math.cos(p)}return g},di.eclipticAberration=function(t,e,i){var n=new c,r=(i-2451545)/36525,s=r*r,a=.016708634-42037e-9*r-1.267e-7*s,o=102.93735+1.71946*r+46e-5*s,l=20.49552,h=H.geometricEclipticLongitude(i);return o=d.d2R(o),t=d.d2R(t),e=d.d2R(e),h=d.d2R(h),n.x=(-l*Math.cos(h-t)+a*l*Math.cos(o-t))/Math.cos(e)/3600,n.y=-l*Math.sin(e)*(Math.sin(h-t)-a*Math.sin(o-t))/3600,n},di.equatorialAberration=function(t,e,i){t=d.d2R(15*t),e=d.d2R(e);var n=Math.cos(t),r=Math.sin(t),s=Math.cos(e),a=Math.sin(e),o=di.earthVelocity(i),l=new c;return l.x=d.r2H((o.y*n-o.x*r)/(17314463350*s)),l.y=d.r2D(-((o.x*n+o.y*r)*a-o.z*s)/17314463350),l},n("ABR",[di,{},null]);const gi=[121,112,103,95,88,82,77,72,68,63,60,56,53,51,48,46,44,42,40,38,35,33,31,29,26,24,22,20,18,16,14,12,11,10,9,8,7,7,7,7,7,7,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,12,12,12,12,13,13,13,14,14,14,14,15,15,15,15,15,16,16,16,16,16,16,16,16,15,15,14,13,13.1,12.5,12.2,12,12,12,12,12,12,11.9,11.6,11,10.2,9.2,8.2,7.1,6.2,5.6,5.4,5.3,5.4,5.6,5.9,6.2,6.5,6.8,7.1,7.3,7.5,7.6,7.7,7.3,6.2,5.2,2.7,1.4,-1.2,-2.8,-3.8,-4.8,-5.5,-5.3,-5.6,-5.7,-5.9,-6,-6.3,-6.5,-6.2,-4.7,-2.8,-.1,2.6,5.3,7.7,10.4,13.3,16,18.2,20.2,21.2,22.4,23.5,23.8,24.3,24,23.9,23.9,23.7,24,24.3,25.3,26.2,27.3,28.2,29.1,30,30.7,31.4,32.2,33.1,34,35,36.5,38.3,40.18,42.2,44.5,46.5,48.5,50.54,52.2,53.8,54.9,55.8,56.86,58.31,59.99,61.63,62.97];function fi(){}function mi(){this.i=0,this.w=0,this.omega=0,this.i=0,this.w=0,this.omega=0}function pi(){}function wi(){}fi.deltaT=function(e){var i,n=h.createJD(e,h.afterPapalReformJD(e)).fractionalYear(),r=(n-2e3)/100;if(n<948)i=2177+497*r+44.1*r*r;else if(n<1620)i=102+102*r+25.3*r*r;else if(n<1998){var s=t.ss.truncate((n-1620)/2);console.assert(s<gi.length),i=gi[s]+(gi[s+1]-gi[s])*(n=n/2-s-810)}else i=n<=2e3?gi[gi.length-1]:n<2100?102+102*r+25.3*r*r+.37*(n-2100):102+102*r+25.3*r*r;return i},n("DYT",[fi,{},null]),n("CAAEclipticalElementDetails",[mi,{},null]),pi.calculate=function(t,e,i,n,r){var s=(n-2451545)/36525,a=s*s,o=(r-n)/36525,l=o*o,h=l*o,u=d.d2R(t),c=d.d2R(i),_=(47.0029-.06603*s+598e-6*a)*o+(598e-6*s-.03302)*l+6e-5*h;_=d.d2R(d.dmS2D(0,0,_));var g=629554.9824+3289.4789*s+.60622*a-(869.8089+.50491*s)*o+.03536*l;g=d.d2R(d.dmS2D(0,0,g));var f=(5029.0966+2.22226*s-42e-6*a)*o+(1.11113-42e-6*s)*l-6e-6*h;f=d.d2R(d.dmS2D(0,0,f));var m=Math.sin(u),p=Math.cos(u),w=Math.sin(c-g),b=Math.cos(c-g),v=Math.sin(_),y=Math.cos(_),S=m*w,x=-v*p+y*m*b,T=Math.asin(Math.sqrt(S*S+x*x)),M=new mi;M.i=d.r2D(T),p*y+m*v*b<0&&(M.i=180-M.i);var C=g+f;M.omega=d.m360(d.r2D(Math.atan2(S,x)+C)),S=-v*w,x=m*y-p*v*b;var A=d.r2D(Math.atan2(S,x));return M.w=d.m360(e+A),M},pi.fK4B1950ToFK5J2000=function(t,e,i){var n=d.d2R(5.19856209),r=d.d2R(.00651966),s=d.d2R(t),a=d.d2R(i),o=Math.sin(s),l=Math.cos(s),h=Math.cos(r),u=Math.sin(r),c=n+a,_=Math.cos(c),g=Math.sin(c),f=u*g,m=o*h+l*u*_,p=new mi;return p.i=d.r2D(Math.asin(Math.sqrt(f*f+m*m))),l*h-o*u*_<0&&(p.i=180-p.i),p.w=d.m360(e+d.r2D(Math.atan2(f,m))),p.omega=d.m360(d.r2D(Math.atan2(o*g,l*u+o*h*_))-4.50001688),p},n("CAAEclipticalElements",[pi,{},null]),wi.mercuryMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(252.250906+149474.0722491*e+3035e-7*i+18e-9*n)},wi.mercurySemimajorAxis=function(t){return.38709831},wi.mercuryEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.20563175+20407e-9*e-2.83e-8*i-i*e*1.8e-10},wi.mercuryInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(7.004986+.0018215*e-181e-7*i+56e-9*n)},wi.mercuryLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(48.330893+1.1861883*e+17542e-8*i+215e-9*n)},wi.mercuryLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(77.456119+1.5564776*e+29544e-8*i+9e-9*n)},wi.venusMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(181.979801+58519.2130302*e+31014e-8*i+15e-9*n)},wi.venusSemimajorAxis=function(t){return.72332982},wi.venusEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.00677192-47765e-9*e+9.81e-8*i+i*e*4.6e-10},wi.venusInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(3.394662+.0010037*e-88e-8*i-7e-9*n)},wi.venusLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(76.67992+.9011206*e+40618e-8*i-93e-9*n)},wi.venusLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(131.563703+1.4022288*e-.00107618*i-5678e-9*n)},wi.earthMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(100.466457+36000.7698278*e+30322e-8*i+2e-8*n)},wi.earthSemimajorAxis=function(t){return 1.000001018},wi.earthEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.01670863-42037e-9*e-1.267e-7*i+i*e*1.4e-10},wi.earthInclination=function(t){return 0},wi.earthLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(102.937348+1.17195366*e+45688e-8*i-18e-9*n)},wi.marsMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(355.433+19141.6964471*e+31052e-8*i+16e-9*n)},wi.marsSemimajorAxis=function(t){return 1.523679342},wi.marsEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.09340065+90484e-9*e-8.06e-8*i-i*e*2.5e-10},wi.marsInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(1.849726-6011e-7*e+1276e-8*i-7e-9*n)},wi.marsLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(49.588093+.7720959*e+1557e-8*i+2267e-9*n)},wi.marsLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(336.060234+1.8410449*e+13477e-8*i+536e-9*n)},wi.jupiterMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(34.351519+3036.3027748*e+2233e-7*i+37e-9*n)},wi.jupiterSemimajorAxis=function(t){return 5.202603209+(t-2451545)/36525*1.913e-7},wi.jupiterEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.04849793+163225e-9*e-4.714e-7*i-i*e*2.01e-9},wi.jupiterInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(1.303267-.0054965*e+466e-8*i-2e-9*n)},wi.jupiterLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(100.464407+1.0209774*e+40315e-8*i+404e-9*n)},wi.jupiterLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(14.331207+1.6126352*e+.00103042*i-4464e-9*n)},wi.saturnMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(50.077444+1223.5110686*e+51908e-8*i-3e-8*n)},wi.saturnSemimajorAxis=function(t){var e=(t-2451545)/36525;return 9.554909192-2139e-9*e+e*e*4e-9},wi.saturnEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.05554814-.0003446641*e-6.436e-7*i+i*e*3.4e-9},wi.saturnInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(2.488879-.0037362*e-1519e-8*i+87e-9*n)},wi.saturnLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(113.665503+.877088*e-12176e-8*i-2249e-9*n)},wi.saturnLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(93.057237+1.19637613*e+83753e-8*i+4928e-9*n)},wi.uranusMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(314.055005+429.8640561*e+3039e-7*i+26e-9*n)},wi.uranusSemimajorAxis=function(t){var e=(t-2451545)/36525;return 19.218446062-3.72e-8*e+e*e*9.8e-10},wi.uranusEccentricity=function(t){var e=(t-2451545)/36525,i=e*e;return.04638122-27293e-9*e+7.89e-8*i+i*e*2.4e-10},wi.uranusInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(.773197+7744e-7*e+3749e-8*i-92e-9*n)},wi.uranusLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(74.005957+.5211278*e+.00133947*i+18484e-9*n)},wi.uranusLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(173.005291+1.486379*e+21406e-8*i+434e-9*n)},wi.neptuneMeanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(304.348665+219.8833092*e+30882e-8*i+18e-9*n)},wi.neptuneSemimajorAxis=function(t){var e=(t-2451545)/36525;return 30.110386869-1.663e-7*e+e*e*6.9e-10},wi.neptuneEccentricity=function(t){var e=(t-2451545)/36525;return.00945575+6033e-9*e-e*e*e*5e-11},wi.neptuneInclination=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(1.769953-.0093082*e-708e-8*i+27e-9*n)},wi.neptuneLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(131.784057+1.1022039*e+25952e-8*i-637e-9*n)},wi.neptuneLongitudePerihelion=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(48.120276+1.4262957*e+38434e-8*i+2e-8*n)},wi.mercuryMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(252.250906+149472.6746358*e-536e-8*i+2e-9*n)},wi.mercuryInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(7.004986-.0059516*e+8e-7*i+43e-9*n)},wi.mercuryLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(48.330893-.1254227*e-8833e-8*i-2e-7*n)},wi.mercuryLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(77.456119+.1588643*e-1342e-8*i-7e-9*n)},wi.venusMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(181.979801+58517.815676*e+165e-8*i-2e-9*n)},wi.venusInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(3.394662-8568e-7*e-3244e-8*i+9e-9*n)},wi.venusLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(76.67992-.2780134*e-14257e-8*i-164e-9*n)},wi.venusLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(131.563703+.0048746*e-.00138467*i-5695e-9*n)},wi.earthMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(100.466457+35999.3728565*e-568e-8*i-1e-9*n)},wi.earthInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e;return.0130548*e-931e-8*i-i*e*34e-9},wi.earthLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(174.873176-.241098*e+4262e-8*i+1e-9*n)},wi.earthLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(102.937348+.3225654*e+14799e-8*i-39e-9*n)},wi.marsMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(355.433+19140.2993039*e+262e-8*i-3e-9*n)},wi.marsInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(1.849726-.0081477*e-2255e-8*i-29e-9*n)},wi.marsLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(49.588093-.295025*e-64048e-8*i-1964e-9*n)},wi.marsLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(336.060234+.4439016*e-17313e-8*i+518e-9*n)},wi.jupiterMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(34.351519+3034.9056606*e-8501e-8*i+16e-9*n)},wi.jupiterInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(1.303267-.0019877*e+332e-7*i+97e-9*n)},wi.jupiterLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(100.464407+.1767232*e+907e-6*i-7272e-9*n)},wi.jupiterLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(14.331207+.2155209*e+72211e-8*i-4485e-9*n)},wi.saturnMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(50.077444+1222.1138488*e+21004e-8*i-46e-9*n)},wi.saturnInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(2.488879+.0025514*e-4906e-8*i+17e-9*n)},wi.saturnLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(113.665503-.2566722*e-18399e-8*i+48e-8*n)},wi.saturnLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(93.057237+.5665415*e+5285e-7*i+4912e-9*n)},wi.uranusMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(314.055005+428.4669983*e-486e-8*i+6e-9*n)},wi.uranusInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(.773197-.0016869*e+349e-8*i+16e-9*n)},wi.uranusLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(74.005957+.0741431*e+40539e-8*i+119e-9*n)},wi.uranusLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(173.005291+.0893212*e-947e-7*i+414e-9*n)},wi.neptuneMeanLongitudeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(304.348665+218.4862002*e+59e-8*i-2e-9*n)},wi.neptuneInclinationJ2000=function(t){var e=(t-2451545)/36525,i=e*e;return d.m360(1.769953+2256e-7*e+23e-8*i)},wi.neptuneLongitudeAscendingNodeJ2000=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e;return d.m360(131.784057-.0061651*e-219e-8*i-78e-9*n)},wi.neptuneLongitudePerihelionJ2000=function(t){var e=(t-2451545)/36525,i=e*e;return d.m360(48.120276+.0291866*e+761e-7*i)},n("EPO",[wi,{},null]);const bi=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,vi=function(t){return"string"==typeof t&&bi.test(t)};for(var yi=[],Si=0;Si<256;++Si)yi.push((Si+256).toString(16).substr(1));function xi(t,e,i,n){switch(t){case 0:return e&i^~e&n;case 1:case 3:return e^i^n;case 2:return e&i^e&n^i&n}}function Ti(t,e){return t<<e|t>>>32-e}var Mi=function(t,e,i){function n(t,e,n,r){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],i=0;i<t.length;++i)e.push(t.charCodeAt(i));return e}(t)),"string"==typeof e&&(e=function(t){if(!vi(t))throw TypeError("Invalid UUID");var e,i=new Uint8Array(16);return i[0]=(e=parseInt(t.slice(0,8),16))>>>24,i[1]=e>>>16&255,i[2]=e>>>8&255,i[3]=255&e,i[4]=(e=parseInt(t.slice(9,13),16))>>>8,i[5]=255&e,i[6]=(e=parseInt(t.slice(14,18),16))>>>8,i[7]=255&e,i[8]=(e=parseInt(t.slice(19,23),16))>>>8,i[9]=255&e,i[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,i[11]=e/4294967296&255,i[12]=e>>>24&255,i[13]=e>>>16&255,i[14]=e>>>8&255,i[15]=255&e,i}(e)),16!==e.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+t.length);if(s.set(e),s.set(t,e.length),(s=i(s))[6]=15&s[6]|80,s[8]=63&s[8]|128,n){r=r||0;for(var a=0;a<16;++a)n[r+a]=s[a];return n}return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=(yi[t[e+0]]+yi[t[e+1]]+yi[t[e+2]]+yi[t[e+3]]+"-"+yi[t[e+4]]+yi[t[e+5]]+"-"+yi[t[e+6]]+yi[t[e+7]]+"-"+yi[t[e+8]]+yi[t[e+9]]+"-"+yi[t[e+10]]+yi[t[e+11]]+yi[t[e+12]]+yi[t[e+13]]+yi[t[e+14]]+yi[t[e+15]]).toLowerCase();if(!vi(i))throw TypeError("Stringified UUID is invalid");return i}(s)}try{n.name="v5"}catch(t){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}(0,0,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var n=unescape(encodeURIComponent(t));t=[];for(var r=0;r<n.length;++r)t.push(n.charCodeAt(r))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var s=t.length/4+2,a=Math.ceil(s/16),o=new Array(a),l=0;l<a;++l){for(var h=new Uint32Array(16),u=0;u<16;++u)h[u]=t[64*l+4*u]<<24|t[64*l+4*u+1]<<16|t[64*l+4*u+2]<<8|t[64*l+4*u+3];o[l]=h}o[a-1][14]=8*(t.length-1)/Math.pow(2,32),o[a-1][14]=Math.floor(o[a-1][14]),o[a-1][15]=8*(t.length-1)&4294967295;for(var c=0;c<a;++c){for(var _=new Uint32Array(80),d=0;d<16;++d)_[d]=o[c][d];for(var g=16;g<80;++g)_[g]=Ti(_[g-3]^_[g-8]^_[g-14]^_[g-16],1);for(var f=i[0],m=i[1],p=i[2],w=i[3],b=i[4],v=0;v<80;++v){var y=Math.floor(v/20),S=Ti(f,5)+xi(y,m,p,w)+b+e[y]+_[v]>>>0;b=w,w=p,p=Ti(m,30)>>>0,m=f,f=S}i[0]=i[0]+f>>>0,i[1]=i[1]+m>>>0,i[2]=i[2]+p>>>0,i[3]=i[3]+w>>>0,i[4]=i[4]+b>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]}));const Ci=Mi;function Ai(){this.x=0,this.y=0,this.width=0,this.height=0}Ai.create=function(t,e,i,n){var r=new Ai;return r.x=t,r.y=e,r.width=i,r.height=n,r};var Li={get_left:function(){return this.x},get_right:function(){return this.x+this.width},get_top:function(){return this.y},get_bottom:function(){return this.y+this.height},contains:function(t){return this._between(t.x,this.x,this.x+this.width)&&this._between(t.y,this.y,this.y+this.height)},_between:function(t,e,i){return e>i?!(t>e||t<i):!(t<e||t>i)},copy:function(){var t=new Ai;return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}};function Ii(){this._guid=Ii.create()}function ki(){}function Pi(){}function Ri(){}function Ei(){}n("Rectangle",[Ai,Li,null]),Ii.newGuid=function(){return new Ii},Ii.fromString=function(e){var i=new Ii;return i._guid=t.ss.trim(e),i},Ii.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)}))},Ii.createFrom=function(t){var e=Ci(t,"1420736a-a637-40a7-813a-ba692e72204e");return Ii.fromString(e)},n("Guid",[Ii,{toString:function(){return this._guid}},null]),ki.offsetX=function(t,e){var i=0,n=t,r=e;if(null!=n.offsetParent)do{i+=n.offsetLeft}while(null!=(n=n.offsetParent));return r.pageX-i},ki.offsetY=function(t,e){var i=0,n=t,r=e;if(null!=n.offsetParent)do{i+=n.offsetTop}while(null!=(n=n.offsetParent));return r.pageY-i},n("Mouse",[ki,null,null]),Pi.getLocalizedText=function(t,e){return e},n("Language",[Pi,{},null]),Ri.get_position=function(){return new vn},Ri.get_current=function(){return document.body.style.cursor},Ri.set_current=function(t){return document.body.style.cursor=t,t},n("Cursor",[Ri,{},null]),Ei.get_arrow=function(){return"default"},Ei.get_cross=function(){return"crosshair"},Ei.get_defaultV=function(){return"default"},Ei.get_hand=function(){return"grab"},Ei.get_help=function(){return"help"},Ei.get_hSplit=function(){return"row-resize"},Ei.get_iBeam=function(){return"text"},Ei.get_no=function(){return"not-allowed"},Ei.get_sizeAll=function(){return"help"},Ei.get_sizeNESW=function(){return"nwse-resize"},Ei.get_sizeNS=function(){return"ns-resize"},Ei.get_sizeNWSE=function(){return"nwse-resize"},Ei.get_sizeWE=function(){return"ew-resize"},Ei.get_upArrow=function(){return"help"},Ei.get_vSplit=function(){return"col-resize"},Ei.get_waitCursor=function(){return"wait"},n("Cursors",[Ei,{},null]);var Di={modifiers:-65536,none:0,lButton:1,rButton:2,cancel:3,mButton:4,xButton1:5,xButton2:6,back:8,tab:9,lineFeed:10,clearKey:12,returnKey:13,enter:13,shiftKey:16,controlKey:17,menu:18,pause:19,capital:20,capsLock:20,kanaMode:21,hanguelMode:21,hangulMode:21,junjaMode:23,finalMode:24,hanjaMode:25,kanjiMode:25,escape:27,imeConvert:28,imeNonconvert:29,imeAccept:30,imeAceept:30,imeModeChange:31,space:32,prior:33,pageUp:33,next:34,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,select:41,print:42,execute:43,snapshot:44,printScreen:44,insertKey:45,deleteKey:46,help:47,d0:48,d1:49,d2:50,d3:51,d4:52,d5:53,d6:54,d7:55,d8:56,d9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,lWin:91,rWin:92,apps:93,sleep:95,numPad0:96,numPad1:97,numPad2:98,numPad3:99,numPad4:100,numPad5:101,numPad6:102,numPad7:103,numPad8:104,numPad9:105,multiply:106,add:107,separator:108,subtract:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,f13:124,f14:125,f15:126,f16:127,f17:128,f18:129,f19:130,f20:131,f21:132,f22:133,f23:134,f24:135,numLock:144,scroll:145,lShiftKey:160,rShiftKey:161,lControlKey:162,rControlKey:163,lMenu:164,rMenu:165,browserBack:166,browserForward:167,browserRefresh:168,browserStop:169,browserSearch:170,browserFavorites:171,browserHome:172,volumeMute:173,volumeDown:174,volumeUp:175,mediaNextTrack:176,mediaPreviousTrack:177,mediaStop:178,mediaPlayPause:179,launchMail:180,selectMedia:181,launchApplication1:182,launchApplication2:183,oemSemicolon:186,oem1:186,oemplus:187,oemcomma:188,oemMinus:189,oemPeriod:190,oemQuestion:191,oem2:191,oemtilde:192,oem3:192,oemOpenBrackets:219,oem4:219,oemPipe:220,oem5:220,oemCloseBrackets:221,oem6:221,oemQuotes:222,oem7:222,oem8:223,oemBackslash:226,oem102:226,processKey:229,packet:231,attn:246,crsel:247,exsel:248,eraseEof:249,play:250,zoom:251,noName:252,pa1:253,oemClear:254,keyCode:65535,shift:65536,control:131072,alt:262144};function Fi(t){this._return=!1,this._next=!0,this._linkSlide=!1,this._slide=null,this._ok=!1,null!=t?this.set_id(t):this.set_next(!0)}function Ni(){this.volume=0}function $i(){this.volume=0,this.location=new vn,this.color=new Oi}function zi(){this.volume=0,this.location=new vn,this.overlay=null}function Bi(t,e,i,n,r){if(7===t.get_projection()&&null!=r){var s=4*r.ipix+2*n+i;return t.get_imageSetID().toString()+"\\"+e.toString()+"\\"+s.toString()}return t.get_imageSetID().toString()+"\\"+e.toString()+"\\"+n.toString()+"_"+i.toString()}function Ui(){}n("Keys",Di),n("SelectLink",[Fi,{get_returnCaller:function(){return this._return},set_returnCaller:function(t){return t&&(this._slide="Return"),this._return=t,t},get_next:function(){return this._next},set_next:function(t){return t&&(this._slide="Next"),this._next=t,t},get_linkToSlide:function(){return this._linkSlide},set_linkToSlide:function(t){return t&&(this._slide="Next"),this._linkSlide=t,t},get_id:function(){return this._slide},set_id:function(t){return this._return=!1,this._next=!1,this._linkSlide=!0,this._slide=t,t},get_OK:function(){return this._ok},set_OK:function(t){return this._ok=t,t}},null]),n("PopupVolume",[Ni,{showDialog:function(){return 1}},null]),n("PopupColorPicker",[$i,{showDialog:function(){return 1}},null]),n("OverlayProperties",[zi,{showDialog:function(){return 1}},null]),Ui.lineToPoint=function(t,e,i){var n=wn.subtractVectors(e,t),r=wn.subtractVectors(i,t);return wn.cross(r,n).length()/n.length()},Ui.getUVFromInnerPoint=function(t,e,i,n,r){t.normalize(),e.normalize(),i.normalize(),n.normalize(),r.normalize();var s=Ui.lineToPoint(t,e,r),a=s+Ui.lineToPoint(i,n,r),o=Ui.lineToPoint(e,n,r),l=Ui.lineToPoint(t,i,r),h=o+l;return vn.create(l/h,s/a)},n("DistanceCalc",[Ui,{},null]);var Vi={OK:1};function Oi(){this.a=255,this.b=255,this.g=255,this.r=255,this.name=""}n("DialogResult",Vi),r("DialogResult",Vi),Oi.fromArgb=function(t,e,i,n){var r=new Oi;return r.a=t,r.r=e,r.g=i,r.b=n,r},Oi._fromArgbColor=function(t,e){var i=new Oi;return i.a=t,i.r=e.r,i.g=e.g,i.b=e.b,i},Oi.fromName=function(t){return Oi.load(t)},Oi.load=function(e){var i=255,n=255,r=255,s=255,a=e.split(":");if(5===a.length)i=parseInt(a[1]),n=parseInt(a[2]),r=parseInt(a[3]),s=parseInt(a[4]);else{if(2===a.length)return Oi.fromName(a[1].toLowerCase());if(1===a.length&&t.ss.startsWith(a[0],"#"))return Oi.fromHex(a[0]);if(1===a.length&&8===a[0].length)return Oi.fromSimpleHex(a[0]);if(1===a.length)return Oi._fromWindowsNamedColor(a[0])}return Oi.fromArgb(i,n,r,s)},Oi._fromWindowsNamedColor=function(t){switch(t.toLowerCase()){case"activeborder":return Oi.fromArgb(255,180,180,180);case"activecaption":return Oi.fromArgb(255,153,180,209);case"activecaptiontext":case"controltext":case"inactivecaptiontext":case"infotext":case"menutext":case"windowtext":case"black":return Oi.fromArgb(255,0,0,0);case"appworkspace":return Oi.fromArgb(255,171,171,171);case"control":case"menu":case"buttonface":case"menubar":return Oi.fromArgb(255,240,240,240);case"controldark":case"buttonshadow":return Oi.fromArgb(255,160,160,160);case"controldarkdark":case"dimgray":return Oi.fromArgb(255,105,105,105);case"controllight":return Oi.fromArgb(255,227,227,227);case"controllightlight":case"desktop":case"highlighttext":case"window":case"white":case"buttonhighlight":return Oi.fromArgb(255,255,255,255);case"graytext":return Oi.fromArgb(255,109,109,109);case"highlight":case"menuhighlight":return Oi.fromArgb(255,51,153,255);case"hottrack":return Oi.fromArgb(255,0,102,204);case"inactiveborder":return Oi.fromArgb(255,244,247,252);case"inactivecaption":return Oi.fromArgb(255,191,205,219);case"info":return Oi.fromArgb(255,255,255,225);case"scrollbar":return Oi.fromArgb(255,200,200,200);case"windowframe":return Oi.fromArgb(255,100,100,100);case"transparent":return Oi.fromArgb(0,255,255,255);case"aliceblue":return Oi.fromArgb(255,240,248,255);case"antiquewhite":return Oi.fromArgb(255,250,235,215);case"aqua":case"cyan":return Oi.fromArgb(255,0,255,255);case"aquamarine":return Oi.fromArgb(255,127,255,212);case"azure":return Oi.fromArgb(255,240,255,255);case"beige":return Oi.fromArgb(255,245,245,220);case"bisque":return Oi.fromArgb(255,255,228,196);case"blanchedalmond":return Oi.fromArgb(255,255,235,205);case"blue":return Oi.fromArgb(255,0,0,255);case"blueviolet":return Oi.fromArgb(255,138,43,226);case"brown":return Oi.fromArgb(255,165,42,42);case"burlywood":return Oi.fromArgb(255,222,184,135);case"cadetblue":return Oi.fromArgb(255,95,158,160);case"chartreuse":return Oi.fromArgb(255,127,255,0);case"chocolate":return Oi.fromArgb(255,210,105,30);case"coral":return Oi.fromArgb(255,255,127,80);case"cornflowerblue":return Oi.fromArgb(255,100,149,237);case"cornsilk":return Oi.fromArgb(255,255,248,220);case"crimson":return Oi.fromArgb(255,220,20,60);case"darkblue":return Oi.fromArgb(255,0,0,139);case"darkcyan":return Oi.fromArgb(255,0,139,139);case"darkgoldenrod":return Oi.fromArgb(255,184,134,11);case"darkgray":return Oi.fromArgb(255,169,169,169);case"darkgreen":return Oi.fromArgb(255,0,100,0);case"darkkhaki":return Oi.fromArgb(255,189,183,107);case"darkmagenta":return Oi.fromArgb(255,139,0,139);case"darkolivegreen":return Oi.fromArgb(255,85,107,47);case"darkorange":return Oi.fromArgb(255,255,140,0);case"darkorchid":return Oi.fromArgb(255,153,50,204);case"darkred":return Oi.fromArgb(255,139,0,0);case"darksalmon":return Oi.fromArgb(255,233,150,122);case"darkseagreen":return Oi.fromArgb(255,143,188,139);case"darkslateblue":return Oi.fromArgb(255,72,61,139);case"darkslategray":return Oi.fromArgb(255,47,79,79);case"darkturquoise":return Oi.fromArgb(255,0,206,209);case"darkviolet":return Oi.fromArgb(255,148,0,211);case"deeppink":return Oi.fromArgb(255,255,20,147);case"deepskyblue":return Oi.fromArgb(255,0,191,255);case"dodgerblue":return Oi.fromArgb(255,30,144,255);case"firebrick":return Oi.fromArgb(255,178,34,34);case"floralwhite":return Oi.fromArgb(255,255,250,240);case"forestgreen":return Oi.fromArgb(255,34,139,34);case"fuchsia":case"magenta":return Oi.fromArgb(255,255,0,255);case"gainsboro":return Oi.fromArgb(255,220,220,220);case"ghostwhite":return Oi.fromArgb(255,248,248,255);case"gold":return Oi.fromArgb(255,255,215,0);case"goldenrod":return Oi.fromArgb(255,218,165,32);case"gray":return Oi.fromArgb(255,128,128,128);case"green":return Oi.fromArgb(255,0,128,0);case"greenyellow":return Oi.fromArgb(255,173,255,47);case"honeydew":return Oi.fromArgb(255,240,255,240);case"hotpink":return Oi.fromArgb(255,255,105,180);case"indianred":return Oi.fromArgb(255,205,92,92);case"indigo":return Oi.fromArgb(255,75,0,130);case"ivory":return Oi.fromArgb(255,255,255,240);case"khaki":return Oi.fromArgb(255,240,230,140);case"lavender":return Oi.fromArgb(255,230,230,250);case"lavenderblush":return Oi.fromArgb(255,255,240,245);case"lawngreen":return Oi.fromArgb(255,124,252,0);case"lemonchiffon":return Oi.fromArgb(255,255,250,205);case"lightblue":return Oi.fromArgb(255,173,216,230);case"lightcoral":return Oi.fromArgb(255,240,128,128);case"lightcyan":return Oi.fromArgb(255,224,255,255);case"lightgoldenrodyellow":return Oi.fromArgb(255,250,250,210);case"lightgray":return Oi.fromArgb(255,211,211,211);case"lightgreen":return Oi.fromArgb(255,144,238,144);case"lightpink":return Oi.fromArgb(255,255,182,193);case"lightsalmon":return Oi.fromArgb(255,255,160,122);case"lightseagreen":return Oi.fromArgb(255,32,178,170);case"lightskyblue":return Oi.fromArgb(255,135,206,250);case"lightslategray":return Oi.fromArgb(255,119,136,153);case"lightsteelblue":return Oi.fromArgb(255,176,196,222);case"lightyellow":return Oi.fromArgb(255,255,255,224);case"lime":return Oi.fromArgb(255,0,255,0);case"limegreen":return Oi.fromArgb(255,50,205,50);case"linen":return Oi.fromArgb(255,250,240,230);case"maroon":return Oi.fromArgb(255,128,0,0);case"mediumaquamarine":return Oi.fromArgb(255,102,205,170);case"mediumblue":return Oi.fromArgb(255,0,0,205);case"mediumorchid":return Oi.fromArgb(255,186,85,211);case"mediumpurple":return Oi.fromArgb(255,147,112,219);case"mediumseagreen":return Oi.fromArgb(255,60,179,113);case"mediumslateblue":return Oi.fromArgb(255,123,104,238);case"mediumspringgreen":return Oi.fromArgb(255,0,250,154);case"mediumturquoise":return Oi.fromArgb(255,72,209,204);case"mediumvioletred":return Oi.fromArgb(255,199,21,133);case"midnightblue":return Oi.fromArgb(255,25,25,112);case"mintcream":return Oi.fromArgb(255,245,255,250);case"mistyrose":return Oi.fromArgb(255,255,228,225);case"moccasin":return Oi.fromArgb(255,255,228,181);case"navajowhite":return Oi.fromArgb(255,255,222,173);case"navy":return Oi.fromArgb(255,0,0,128);case"oldlace":return Oi.fromArgb(255,253,245,230);case"olive":return Oi.fromArgb(255,128,128,0);case"olivedrab":return Oi.fromArgb(255,107,142,35);case"orange":return Oi.fromArgb(255,255,165,0);case"orangered":return Oi.fromArgb(255,255,69,0);case"orchid":return Oi.fromArgb(255,218,112,214);case"palegoldenrod":return Oi.fromArgb(255,238,232,170);case"palegreen":return Oi.fromArgb(255,152,251,152);case"paleturquoise":return Oi.fromArgb(255,175,238,238);case"palevioletred":return Oi.fromArgb(255,219,112,147);case"papayawhip":return Oi.fromArgb(255,255,239,213);case"peachpuff":return Oi.fromArgb(255,255,218,185);case"peru":return Oi.fromArgb(255,205,133,63);case"pink":return Oi.fromArgb(255,255,192,203);case"plum":return Oi.fromArgb(255,221,160,221);case"powderblue":return Oi.fromArgb(255,176,224,230);case"purple":return Oi.fromArgb(255,128,0,128);case"red":return Oi.fromArgb(255,255,0,0);case"rosybrown":return Oi.fromArgb(255,188,143,143);case"royalblue":return Oi.fromArgb(255,65,105,225);case"saddlebrown":return Oi.fromArgb(255,139,69,19);case"salmon":return Oi.fromArgb(255,250,128,114);case"sandybrown":return Oi.fromArgb(255,244,164,96);case"seagreen":return Oi.fromArgb(255,46,139,87);case"seashell":return Oi.fromArgb(255,255,245,238);case"sienna":return Oi.fromArgb(255,160,82,45);case"silver":return Oi.fromArgb(255,192,192,192);case"skyblue":return Oi.fromArgb(255,135,206,235);case"slateblue":return Oi.fromArgb(255,106,90,205);case"slategray":return Oi.fromArgb(255,112,128,144);case"snow":return Oi.fromArgb(255,255,250,250);case"springgreen":return Oi.fromArgb(255,0,255,127);case"steelblue":return Oi.fromArgb(255,70,130,180);case"tan":return Oi.fromArgb(255,210,180,140);case"teal":return Oi.fromArgb(255,0,128,128);case"thistle":return Oi.fromArgb(255,216,191,216);case"tomato":return Oi.fromArgb(255,255,99,71);case"turquoise":return Oi.fromArgb(255,64,224,208);case"violet":return Oi.fromArgb(255,238,130,238);case"wheat":return Oi.fromArgb(255,245,222,179);case"whitesmoke":return Oi.fromArgb(255,245,245,245);case"yellow":return Oi.fromArgb(255,255,255,0);case"yellowgreen":return Oi.fromArgb(255,154,205,50);case"gradientactivecaption":return Oi.fromArgb(255,185,209,234);case"gradientinactivecaption":return Oi.fromArgb(255,215,228,242)}return Oi.fromArgb(255,255,255,255)},Oi.fromHex=function(t){var e=a.fromHex(t.substr(1,2)),i=a.fromHex(t.substr(3,2)),n=a.fromHex(t.substr(5,2));return Oi.fromArgb(255,e,i,n)},Oi.fromSimpleHex=function(t){var e=a.fromHex(t.substr(0,2)),i=a.fromHex(t.substr(2,2)),n=a.fromHex(t.substr(4,2)),r=a.fromHex(t.substr(6,2));return Oi.fromArgb(e,i,n,r)},Oi.fromInt=function(t){var e=(4278190080&t)>>>24,i=(16711680&t)>>>16,n=(65280&t)>>>8,r=255&t;return Oi.fromArgb(r,e,i,n)};var Gi={toFormat:function(){return t.ss.emptyString(this.name)?t.ss.format("rgb({0},{1},{2})",this.r.toString(),this.g.toString(),this.b.toString()):this.name},save:function(){return t.ss.emptyString(this.name)?t.ss.format("{0}:{1}:{2}:{3}:{4}",1,this.a,this.r,this.g,this.b):t.ss.format("{0}:{1}",0,this.name)},toString:function(){return t.ss.emptyString(this.name)?t.ss.format("#{0}{1}{2}",a.toHex(this.r),a.toHex(this.g),a.toHex(this.b)):this.name},toSimpleHex:function(){return t.ss.emptyString(this.name)?t.ss.format("{0}{1}{2}{3}",a.toHex(this.a),a.toHex(this.r),a.toHex(this.g),a.toHex(this.b)):this.name},_clone:function(){return Oi.fromArgb(this.a,this.r,this.g,this.b)}};function Xi(){}n("Color",[Oi,Gi,null]),Xi.get_black=function(){return Oi.fromArgb(255,0,0,0)},Xi.get_blue=function(){return Oi.fromArgb(255,0,0,255)},Xi.get_brown=function(){return Oi.fromArgb(255,165,42,42)},Xi.get_cyan=function(){return Oi.fromArgb(255,0,255,255)},Xi.get_darkGray=function(){return Oi.fromArgb(255,169,169,169)},Xi.get_gray=function(){return Oi.fromArgb(255,128,128,128)},Xi.get_green=function(){return Oi.fromArgb(255,0,255,0)},Xi.get_lightGray=function(){return Oi.fromArgb(255,211,211,211)},Xi.get_magenta=function(){return Oi.fromArgb(255,255,0,255)},Xi.get_orange=function(){return Oi.fromArgb(255,255,165,0)},Xi.get_purple=function(){return Oi.fromArgb(255,128,0,128)},Xi.get_red=function(){return Oi.fromArgb(255,255,0,0)},Xi.get_transparent=function(){return Oi.fromArgb(0,255,255,255)},Xi.get_white=function(){return Oi.fromArgb(255,255,255,255)},Xi.get_yellow=function(){return Oi.fromArgb(255,255,255,0)},n("Colors",[Xi,{},null]);var Hi=null;function Yi(t){Hi=t}var ji=256;function Wi(t){ji=t}var qi=!1;function Zi(t){qi=!!t}var Ki=!1,Ji=!1;function Qi(t){Ji=!!t}var tn=null,en=null,nn=0,rn=null,sn=null,an=null;const on=3.1415927/180;function ln(t,e){return wn.create(Math.cos(e*on)*Math.cos(t*on)*1,1*Math.sin(t*on),Math.sin(e*on)*Math.cos(t*on)*1)}function hn(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=Math.atan2(t.z,t.x),n=Math.asin(t.y/e),r=(i+=80*Math.PI%(2*Math.PI))/on;return r>180&&(r=180-r-180),[n/on,r]}var un={slash:0,backslash:1,top:2};function cn(){this.tu=0,this.tv=0,this.position=new wn}n("LocationHint",un),cn.createPos=function(t,e,i){var n=new cn;return n.tu=e*ji,n.tv=i*ji,n.position=t,n},cn.createPosRaw=function(t,e,i){var n=new cn;return n.tu=e,n.tv=i,n.position=t,n},cn.createPosSize=function(t,e,i,n,r){var s=new cn;return s.tu=e*n,s.tv=i*r,s.position=t,s},cn.create=function(t,e,i,n,r){var s=new cn;return s.position=wn.create(t,e,i),s.tu=n*ji,s.tv=r*ji,s};var _n={copy:function(){var t=new cn;return t.position=wn.makeCopy(this.position),t.tu=this.tu,t.tv=this.tv,t},toString:function(){return t.ss.format("{0}, {1}, {2}, {3}, {4}",this.position.x,this.position.y,this.position.z,this.tu,this.tv)}};function dn(){this.tu=0,this.tv=0,this.color=new Oi,this.position=new wn}function gn(t,e){this.color=new Oi,this.color=e._clone(),this.position=t.copy()}n("PositionTexture",[cn,_n,null]),dn.createPos=function(t,e,i){var n=new dn;return n.tu=e*ji,n.tv=i*ji,n.position=t,n},dn.createPosRaw=function(t,e,i){var n=new dn;return n.tu=e,n.tv=i,n.position=t,n},dn.createPosSize=function(t,e,i,n,r){var s=new dn;return s.tu=e*n,s.tv=i*r,s.position=t,s},dn.create=function(t,e,i,n,r){var s=new cn;return s.position=wn.create(t,e,i),s.tu=n*ji,s.tv=r*ji,s},n("PositionColoredTextured",[dn,{copy:function(){var t=new cn;return t.position=wn.makeCopy(this.position),t.tu=this.tu,t.tv=this.tv,t},toString:function(){return t.ss.format("{0}, {1}, {2}, {3}, {4}",this.position.x,this.position.y,this.position.z,this.tu,this.tv)}},null]);var fn={copy:function(){return new gn(this.position,this.color)},toString:function(){return t.ss.format("{0}, {1}, {2}, {3}",this.position.x,this.position.y,this.position.z,this.color.toString())}};function mn(t,e,i,n){this.x=0,this.y=0,this.z=0,this.nx=0,this.ny=0,this.nz=0,this.tu=0,this.tv=0,this.tanx=0,this.tany=0,this.tanz=0,this.x=t.x,this.y=t.y,this.z=t.z,this.nx=e.x,this.ny=e.y,this.nz=e.z,this.tu=i.x,this.tv=i.y,this.tanx=n.x,this.tany=n.y,this.tanz=n.z}n("PositionColored",[gn,fn,null]);var pn={get_normal:function(){return wn.create(this.nx,this.ny,this.nz)},set_normal:function(t){return this.nx=t.x,this.ny=t.y,this.nz=t.z,t},get_position:function(){return wn.create(this.x,this.y,this.z)},set_position:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,t},get_texCoord:function(){return vn.create(this.tu,this.tv)},set_texCoord:function(t){return this.tu=t.x,this.tv=t.y,t},get_tangent:function(){return wn.create(this.tanx,this.tany,this.tanz)},set_tangent:function(t){return this.tanx=t.x,this.tany=t.y,this.tanz=t.z,t},toString:function(){return t.ss.format("X={0}, Y={1}, Z={2}, Nx={3}, Ny={4}, Nz={5}, U={6}, V={7}, TanX={8}, TanY={9}, TanZ={10}",this.x,this.y,this.z,this.nx,this.ny,this.nz,this.tu,this.tv,this.tanx,this.tany,this.tanz)}};function wn(){this.x=0,this.y=0,this.z=0}n("PositionNormalTexturedTangent",[mn,pn,null]),wn.create=function(t,e,i){var n=new wn;return n.x=t,n.y=e,n.z=i,n},wn.makeCopy=function(t){var e=new wn;return e.x=t.x,e.y=t.y,e.z=t.z,e},wn.negate=function(t){return wn.create(-t.x,-t.y,-t.z)},wn.midPoint=function(t,e){return wn.create((t.x+e.x)/2,(t.y+e.y)/2,(t.z+e.z)/2)},wn.midPointByLength=function(t,e){var i=wn.create((t.x+e.x)/2,(t.y+e.y)/2,(t.z+e.z)/2);return i.normalize(),i.multiply(t.length()),i},wn.get_empty=function(){return wn.create(0,0,0)},wn.addVectors=function(t,e){return wn.create(t.x+e.x,t.y+e.y,t.z+e.z)},wn.cross=function(t,e){return wn.create(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},wn.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},wn.getLength=function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},wn.getLengthSq=function(t){return t.x*t.x+t.y*t.y+t.z*t.z},wn.lerp=function(t,e,i){return wn.create(t.x*(1-i)+e.x*i,t.y*(1-i)+e.y*i,t.z*(1-i)+e.z*i)},wn.midpoint=function(t,e){var i=wn.create(.5*t.x+.5*e.x,.5*t.y+.5*e.y,.5*t.z+.5*e.z);return i.normalize(),i},wn.slerp=function(t,e,i){for(var n=wn.dot(t,e);n<.98;){var r=wn.midpoint(t,e);i>.5?(t=r,i-=.5,i*=2):(e=r,i*=2),n=wn.dot(t,e)}var s=wn.lerp(t,e,i);return s.normalize(),s},wn.multiplyScalar=function(t,e){var i=t.copy();return i.multiply(e),i},wn.scale=function(t,e){var i=t;return i.multiply(e),i},wn.subtractVectors=function(t,e){var i=t.copy();return i.subtract(e),i},wn.parse=function(t){var e=new wn,i=t.split(",");return 3===i.length&&(e.x=parseFloat(i[0]),e.y=parseFloat(i[1]),e.z=parseFloat(i[2])),e},wn._transformCoordinate=function(t,e){return e.transform(t)};var bn={set:function(t,e,i){this.x=t,this.y=e,this.z=i},copy:function(){var t=new wn;return t.x=this.x,t.y=this.y,t.z=this.z,t},round:function(){this.x=t.ss.truncate(65536*this.x)/65536,this.y=t.ss.truncate(65536*this.y)/65536,this.z=t.ss.truncate(65536*this.z)/65536},add:function(t){this.x+=t.x,this.y+=t.y,this.z+=t.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},multiply:function(t){this.x*=t,this.y*=t,this.z*=t},normalize:function(){var t=this.length();t&&(this.x/=t,this.y/=t,this.z/=t)},rotateX:function(t){var e,i;i=this.y*Math.cos(t)-this.z*Math.sin(t),e=this.y*Math.sin(t)+this.z*Math.cos(t),this.z=e,this.y=i},rotateZ:function(t){var e,i;e=this.x*Math.cos(t)-this.y*Math.sin(t),i=this.x*Math.sin(t)+this.y*Math.cos(t),this.y=i,this.x=e},rotateY:function(t){var e,i;e=this.z*Math.cos(t)-this.x*Math.sin(t),i=this.z*Math.sin(t)+this.x*Math.cos(t),this.x=i,this.z=e},subtract:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},toString:function(){return t.ss.format("{0}, {1}, {2}",this.x,this.y,this.z)},toSpherical:function(){var t,e,i=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z),n=Math.sqrt(this.x*this.x+this.z*this.z);return e=Math.asin(this.y/i),t=n?0<=this.x?Math.asin(this.z/n):Math.PI-Math.asin(this.z/n):0,vn.create((t+Math.PI)%(2*Math.PI),e+Math.PI/2)},toRaDec:function(){var t=this.toSpherical();return t.x=t.x/Math.PI*12,t.y=t.y/Math.PI*180-90,t},distanceToLine:function(t,e){var i=wn.subtractVectors(e,t),n=wn.subtractVectors(t,this);return wn.cross(i,n).length()/wn.subtractVectors(e,t).length()},_transformByMatrics:function(t){var e=t.transform(this);this.x=e.x,this.y=e.y,this.z=e.z}};function vn(){this.x=0,this.y=0}function yn(){this._m11=0,this._m12=0,this._m13=0,this._m14=0,this._m21=0,this._m22=0,this._m23=0,this._m24=0,this._m31=0,this._m32=0,this._m33=0,this._m34=0,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._m44=0,this._isNotKnownToBeIdentity=!1}n("Vector3d",[wn,bn,null]),wn.zero=new wn,vn.lerp=function(t,e,i){return vn.create(t.x*(1-i)+e.x*i,t.y*(1-i)+e.y*i)},vn.cartesianToSpherical2=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=Math.atan2(t.z,t.x),n=Math.asin(t.y/e);return vn.create(i/Math.PI*180,n/Math.PI*180)},vn.average3d=function(t,e){var i=ln(t.y,t.x),n=ln(e.y,e.x),r=wn.addVectors(i,n);return r.multiply(.5),r.normalize(),vn.cartesianToSpherical2(r)},vn.create=function(t,e){var i=new vn;return i.x=t,i.y=e,i},vn.subtract=function(t,e){return vn.create(t.x-e.x,t.y-e.y)},n("Vector2d",[vn,{distance3d:function(t){var e=ln(t.y,t.x),i=ln(this.y,this.x);return wn.subtractVectors(e,i).length()/Math.PI*180},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var t=this.get_length();t&&(this.x/=t,this.y/=t)},extend:function(t){this.x=this.x*t,this.y=this.y*t}},null]),yn.create=function(t,e,i,n,r,s,a,o,l,h,u,c,_,d,g,f){var m=new yn;return m._m11=t,m._m12=e,m._m13=i,m._m14=n,m._m21=r,m._m22=s,m._m23=a,m._m24=o,m._m31=l,m._m32=h,m._m33=u,m._m34=c,m._offsetX=_,m._offsetY=d,m._offsetZ=g,m._m44=f,m._isNotKnownToBeIdentity=!0,m},yn.get_identity=function(){var t=new yn;return t.set(yn._s_identity),t},yn.multiplyMatrix=function(t,e){return t.get__isDistinguishedIdentity()?e:e.get__isDistinguishedIdentity()?t:yn.create(t._m11*e._m11+t._m12*e._m21+t._m13*e._m31+t._m14*e._offsetX,t._m11*e._m12+t._m12*e._m22+t._m13*e._m32+t._m14*e._offsetY,t._m11*e._m13+t._m12*e._m23+t._m13*e._m33+t._m14*e._offsetZ,t._m11*e._m14+t._m12*e._m24+t._m13*e._m34+t._m14*e._m44,t._m21*e._m11+t._m22*e._m21+t._m23*e._m31+t._m24*e._offsetX,t._m21*e._m12+t._m22*e._m22+t._m23*e._m32+t._m24*e._offsetY,t._m21*e._m13+t._m22*e._m23+t._m23*e._m33+t._m24*e._offsetZ,t._m21*e._m14+t._m22*e._m24+t._m23*e._m34+t._m24*e._m44,t._m31*e._m11+t._m32*e._m21+t._m33*e._m31+t._m34*e._offsetX,t._m31*e._m12+t._m32*e._m22+t._m33*e._m32+t._m34*e._offsetY,t._m31*e._m13+t._m32*e._m23+t._m33*e._m33+t._m34*e._offsetZ,t._m31*e._m14+t._m32*e._m24+t._m33*e._m34+t._m34*e._m44,t._offsetX*e._m11+t._offsetY*e._m21+t._offsetZ*e._m31+t._m44*e._offsetX,t._offsetX*e._m12+t._offsetY*e._m22+t._offsetZ*e._m32+t._m44*e._offsetY,t._offsetX*e._m13+t._offsetY*e._m23+t._offsetZ*e._m33+t._m44*e._offsetZ,t._offsetX*e._m14+t._offsetY*e._m24+t._offsetZ*e._m34+t._m44*e._m44)},yn.lookAtLH=function(t,e,i){var n=wn.subtractVectors(e,t);n.normalize();var r=wn.cross(i,n);r.normalize();var s=wn.cross(n,r);return yn.create(r.x,s.x,n.x,0,r.y,s.y,n.y,0,r.z,s.z,n.z,0,-wn.dot(r,t),-wn.dot(s,t),-wn.dot(n,t),1)},yn._createIdentity=function(){var t=yn.create(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return t.set__isDistinguishedIdentity(!0),t},yn.equals=function(t,e){return t.get__isDistinguishedIdentity()||e.get__isDistinguishedIdentity()?t.get_isIdentity()===e.get_isIdentity():t.get_m11()===e.get_m11()&&t.get_m12()===e.get_m12()&&t.get_m13()===e.get_m13()&&t.get_m14()===e.get_m14()&&t.get_m21()===e.get_m21()&&t.get_m22()===e.get_m22()&&t.get_m23()===e.get_m23()&&t.get_m24()===e.get_m24()&&t.get_m31()===e.get_m31()&&t.get_m32()===e.get_m32()&&t.get_m33()===e.get_m33()&&t.get_m34()===e.get_m34()&&t.get_offsetX()===e.get_offsetX()&&t.get_offsetY()===e.get_offsetY()&&t.get_offsetZ()===e.get_offsetZ()&&t.get_m44()===e.get_m44()},yn.fromMatrix2d=function(t){var e=yn._createIdentity();return e.set_m11(t.m11),e.set_m12(t.m12),e.set_m13(t.m13),e.set_m21(t.m21),e.set_m22(t.m22),e.set_m23(t.m23),e.set_m31(t.m31),e.set_m32(t.m32),e.set_m33(t.m33),e._isNotKnownToBeIdentity=!0,e},yn.rotationYawPitchRoll=function(t,e,i){var n=yn._rotationX(e),r=yn._rotationY(t),s=yn._rotationZ(i);return yn.multiplyMatrix(yn.multiplyMatrix(r,n),s)},yn._rotationY=function(t){var e=t,i=yn.get_identity();return i._m11=Math.cos(e),i._m22=1,i._m31=Math.sin(e),i._m13=-Math.sin(e),i._m33=Math.cos(e),i._isNotKnownToBeIdentity=!0,i},yn._rotationX=function(t){var e=t,i=yn.get_identity();return i._m11=1,i._m22=Math.cos(e),i._m32=-Math.sin(e),i._m23=Math.sin(e),i._m33=Math.cos(e),i._isNotKnownToBeIdentity=!0,i},yn._rotationZ=function(t){var e=t,i=yn.get_identity();return i._m11=Math.cos(e),i._m21=-Math.sin(e),i._m12=Math.sin(e),i._m22=Math.cos(e),i._m33=1,i._isNotKnownToBeIdentity=!0,i},yn._scaling=function(t,e,i){var n=yn.get_identity();return n._m11=t,n._m22=e,n._m33=i,n._isNotKnownToBeIdentity=!0,n},yn._translationXYZ=function(t,e,i){var n=yn.get_identity();return n.set_offsetX(t),n.set_offsetY(e),n.set_offsetZ(i),n._isNotKnownToBeIdentity=!0,n},yn.perspectiveFovLH=function(t,e,i,n){var r=1/Math.tan(t/2),s=r/e;return yn.create(s,0,0,0,0,r,0,0,0,0,n/(n-i),1,0,0,-i*n/(n-i),0)},yn.perspectiveOffCenterLH=function(t,e,i,n,r,s){return yn.create(2*r/(e-t),0,0,0,0,2*r/(n-i),0,0,(t+e)/(t-e),(n+i)/(i-n),s/(s-r),1,0,0,r*s/(r-s),0)},yn.invertMatrix=function(t){var e=t.clone();return e.invert(),e},yn.translation=function(t){return yn._translationXYZ(t.x,t.y,t.z)},yn.getMapMatrix=function(t,e,i,n){var r,s;r=-(t.get_lng()+180-e/2)/360,s=-(1-(t.get_lat()+90+i/2)/180);var a,o,l=new xn;return a=360/e,o=180/i,l=xn.multiply(l,xn.translation(r,s)),l=xn.multiply(l,xn.scaling(a,o)),n&&(l=xn.multiply(l,xn.translation(-.5,-.5)),l=xn.multiply(l,xn.rotation(n)),l=xn.multiply(l,xn.translation(.5,.5))),yn.fromMatrix2d(l)};var Sn={clone:function(){var t=new yn;return t.set(this),t},setIdentity:function(){this.set(yn._s_identity)},set:function(t){this._m11=t._m11,this._m12=t._m12,this._m13=t._m13,this._m14=t._m14,this._m21=t._m21,this._m22=t._m22,this._m23=t._m23,this._m24=t._m24,this._m31=t._m31,this._m32=t._m32,this._m33=t._m33,this._m34=t._m34,this._offsetX=t._offsetX,this._offsetY=t._offsetY,this._offsetZ=t._offsetZ,this._m44=t._m44,this._isNotKnownToBeIdentity=!0},floatArray:function(){var t=new Array(16);return t[0]=this._m11,t[1]=this._m12,t[2]=this._m13,t[3]=this._m14,t[4]=this._m21,t[5]=this._m22,t[6]=this._m23,t[7]=this._m24,t[8]=this._m31,t[9]=this._m32,t[10]=this._m33,t[11]=this._m34,t[12]=this._offsetX,t[13]=this._offsetY,t[14]=this._offsetZ,t[15]=this._m44,t},get_isIdentity:function(){return!!this.get__isDistinguishedIdentity()||!(1!==this._m11||this._m12||this._m13||this._m14||this._m21||1!==this._m22||this._m23||this._m24||this._m31||this._m32||1!==this._m33||this._m34||this._offsetX||this._offsetY||this._offsetZ||1!==this._m44)&&(this.set__isDistinguishedIdentity(!0),!0)},prepend:function(t){this.set(yn.multiplyMatrix(t,this))},append:function(t){this._multiply(t)},scale:function(t){this.get__isDistinguishedIdentity()?this._setScaleMatrix(t):(this._m11*=t.x,this._m12*=t.y,this._m13*=t.z,this._m21*=t.x,this._m22*=t.y,this._m23*=t.z,this._m31*=t.x,this._m32*=t.y,this._m33*=t.z,this._offsetX*=t.x,this._offsetY*=t.y,this._offsetZ*=t.z)},scalePrepend:function(t){this.get__isDistinguishedIdentity()?this._setScaleMatrix(t):(this._m11*=t.x,this._m12*=t.x,this._m13*=t.x,this._m14*=t.x,this._m21*=t.y,this._m22*=t.y,this._m23*=t.y,this._m24*=t.y,this._m31*=t.z,this._m32*=t.z,this._m33*=t.z,this._m34*=t.z)},scaleAt:function(t,e){if(this.get__isDistinguishedIdentity())this._setScaleMatrixCenter(t,e);else{var i=this._m14*e.x;this._m11=i+t.x*(this._m11-i),i=this._m14*e.y,this._m12=i+t.y*(this._m12-i),i=this._m14*e.z,this._m13=i+t.z*(this._m13-i),i=this._m24*e.x,this._m21=i+t.x*(this._m21-i),i=this._m24*e.y,this._m22=i+t.y*(this._m22-i),i=this._m24*e.z,this._m23=i+t.z*(this._m23-i),i=this._m34*e.x,this._m31=i+t.x*(this._m31-i),i=this._m34*e.y,this._m32=i+t.y*(this._m32-i),i=this._m34*e.z,this._m33=i+t.z*(this._m33-i),i=this._m44*e.x,this._offsetX=i+t.x*(this._offsetX-i),i=this._m44*e.y,this._offsetY=i+t.y*(this._offsetY-i),i=this._m44*e.z,this._offsetZ=i+t.z*(this._offsetZ-i)}},scaleAtPrepend:function(t,e){if(this.get__isDistinguishedIdentity())this._setScaleMatrixCenter(t,e);else{var i=e.x-e.x*t.x,n=e.y-e.y*t.y,r=e.z-e.z*t.z;this._offsetX+=this._m11*i+this._m21*n+this._m31*r,this._offsetY+=this._m12*i+this._m22*n+this._m32*r,this._offsetZ+=this._m13*i+this._m23*n+this._m33*r,this._m44+=this._m14*i+this._m24*n+this._m34*r,this._m11*=t.x,this._m12*=t.x,this._m13*=t.x,this._m14*=t.x,this._m21*=t.y,this._m22*=t.y,this._m23*=t.y,this._m24*=t.y,this._m31*=t.z,this._m32*=t.z,this._m33*=t.z,this._m34*=t.z}},translate:function(t){this.get__isDistinguishedIdentity()?this._setTranslationMatrix(t):(this._m11+=this._m14*t.x,this._m12+=this._m14*t.y,this._m13+=this._m14*t.z,this._m21+=this._m24*t.x,this._m22+=this._m24*t.y,this._m23+=this._m24*t.z,this._m31+=this._m34*t.x,this._m32+=this._m34*t.y,this._m33+=this._m34*t.z,this._offsetX+=this._m44*t.x,this._offsetY+=this._m44*t.y,this._offsetZ+=this._m44*t.z)},translatePrepend:function(t){this.get__isDistinguishedIdentity()?this._setTranslationMatrix(t):(this._offsetX+=this._m11*t.x+this._m21*t.y+this._m31*t.z,this._offsetY+=this._m12*t.x+this._m22*t.y+this._m32*t.z,this._offsetZ+=this._m13*t.x+this._m23*t.y+this._m33*t.z,this._m44+=this._m14*t.x+this._m24*t.y+this._m34*t.z)},transform:function(t){var e=new wn;if(!this.get__isDistinguishedIdentity()){var i=t.x,n=t.y,r=t.z;if(e.x=i*this._m11+n*this._m21+r*this._m31+this._offsetX,e.y=i*this._m12+n*this._m22+r*this._m32+this._offsetY,e.z=i*this._m13+n*this._m23+r*this._m33+this._offsetZ,!this.get_isAffine()){var s=i*this._m14+n*this._m24+r*this._m34+this._m44;e.x/=s,e.y/=s,e.z/=s}}return e},_transformTo:function(t,e){e.x=t.x*this._m11+t.y*this._m21+t.z*this._m31+this._offsetX,e.y=t.x*this._m12+t.y*this._m22+t.z*this._m32+this._offsetY,e.z=t.x*this._m13+t.y*this._m23+t.z*this._m33+this._offsetZ;var i=t.x*this._m14+t.y*this._m24+t.z*this._m34+this._m44;e.x/=i,e.y/=i,e.z/=i},transformArray:function(t){if(null!=t)for(var e=0;e<t.length;e++)this._multiplyPoint(t[e])},projectArrayToScreen:function(t,e){if(null!=t&&null!=e)for(var i=this.get_isAffine(),n=0;n<t.length;n++){var r=t[n].x,s=t[n].y,a=t[n].z;if(i)e[n].x=r*this._m11+s*this._m21+a*this._m31+this._offsetX,e[n].y=r*this._m12+s*this._m22+a*this._m32+this._offsetY,e[n].z=r*this._m13+s*this._m23+a*this._m33+this._offsetZ;else{var o=r*this._m14+s*this._m24+a*this._m34+this._m44;e[n].x=(r*this._m11+s*this._m21+a*this._m31+this._offsetX)/o,e[n].y=(r*this._m12+s*this._m22+a*this._m32+this._offsetY)/o,e[n].z=(r*this._m13+s*this._m23+a*this._m33+this._offsetZ)/o}}},projectToScreen:function(t,e,i){var n=new wn,r=t.x,s=t.y,a=t.z;if(this.get_isAffine())n.x=(r*this._m11+s*this._m21+a*this._m31+this._offsetX+.5)*e,n.y=(.5-(r*this._m12+s*this._m22+a*this._m32+this._offsetY))*i,n.z=r*this._m13+s*this._m23+a*this._m33+this._offsetZ;else{var o=r*this._m14+s*this._m24+a*this._m34+this._m44;n.x=((r*this._m11+s*this._m21+a*this._m31+this._offsetX)/o+.5)*e,n.y=(-(r*this._m12+s*this._m22+a*this._m32+this._offsetY)/o+.5)*i,n.z=(r*this._m13+s*this._m23+a*this._m33+this._offsetZ)/o}return n},get_isAffine:function(){return!!this.get__isDistinguishedIdentity()||!(this._m14||this._m24||this._m34)&&1===this._m44},get_determinant:function(){if(this.get__isDistinguishedIdentity())return 1;if(this.get_isAffine())return this._getNormalizedAffineDeterminant();var t=this._m13*this._m24-this._m23*this._m14,e=this._m13*this._m34-this._m33*this._m14,i=this._m13*this._m44-this._offsetZ*this._m14,n=this._m23*this._m34-this._m33*this._m24,r=this._m23*this._m44-this._offsetZ*this._m24,s=this._m33*this._m44-this._offsetZ*this._m34,a=this._m22*e-this._m32*t-this._m12*n,o=this._m12*r-this._m22*i+this._offsetY*t,l=this._m32*i-this._offsetY*e-this._m12*s,h=this._m22*s-this._m32*r+this._offsetY*n;return this._offsetX*a+this._m31*o+this._m21*l+this._m11*h},get_hasInverse:function(){return!Tn.isZero(this.get_determinant())},invert:function(){this._invertCore()},transpose:function(){var t=new yn;t.set(this),this._m12=t._m21,this._m13=t._m31,this._m14=t._offsetX,this._m23=t._m32,this._m24=t._offsetY,this._m34=t._offsetZ,this._m21=t._m12,this._m31=t._m13,this._offsetX=t._m14,this._m32=t._m23,this._offsetY=t._m24,this._offsetZ=t._m34},get_m11:function(){return this.get__isDistinguishedIdentity()?1:this._m11},set_m11:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m11=t,t},get_m12:function(){return this._m12},set_m12:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m12=t,t},get_m13:function(){return this._m13},set_m13:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m13=t,t},get_m14:function(){return this._m14},set_m14:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m14=t,t},get_m21:function(){return this._m21},set_m21:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m21=t,t},get_m22:function(){return this.get__isDistinguishedIdentity()?1:this._m22},set_m22:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m22=t,t},get_m23:function(){return this._m23},set_m23:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m23=t,t},get_m24:function(){return this._m24},set_m24:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m24=t,t},get_m31:function(){return this._m31},set_m31:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m31=t,t},get_m32:function(){return this._m32},set_m32:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m32=t,t},get_m33:function(){return this.get__isDistinguishedIdentity()?1:this._m33},set_m33:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m33=t,t},get_m34:function(){return this._m34},set_m34:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m34=t,t},get_m41:function(){return this.get_offsetX()},set_m41:function(t){return this.set_offsetX(t),t},get_m42:function(){return this.get_offsetY()},set_m42:function(t){return this.set_offsetY(t),t},get_m43:function(){return this.get_offsetZ()},set_m43:function(t){return this.set_offsetZ(t),t},get_offsetX:function(){return this._offsetX},set_offsetX:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._offsetX=t,t},get_offsetY:function(){return this._offsetY},set_offsetY:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._offsetY=t,t},get_offsetZ:function(){return this._offsetZ},set_offsetZ:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._offsetZ=t,t},get_m44:function(){return this.get__isDistinguishedIdentity()?1:this._m44},set_m44:function(t){return this.get__isDistinguishedIdentity()&&(this.set(yn._s_identity),this.set__isDistinguishedIdentity(!1)),this._m44=t,t},_setScaleMatrix:function(t){this._m11=t.x,this._m22=t.y,this._m33=t.z,this._m44=1,this.set__isDistinguishedIdentity(!1)},_setScaleMatrixCenter:function(t,e){this._m11=t.x,this._m22=t.y,this._m33=t.z,this._m44=1,this._offsetX=e.x-e.x*t.x,this._offsetY=e.y-e.y*t.y,this._offsetZ=e.z-e.z*t.z,this.set__isDistinguishedIdentity(!1)},_setTranslationMatrix:function(t){this._m11=this._m22=this._m33=this._m44=1,this._offsetX=t.x,this._offsetY=t.y,this._offsetZ=t.z,this.set__isDistinguishedIdentity(!1)},_multiplyPoint:function(t){if(!this.get__isDistinguishedIdentity()){var e=t.x,i=t.y,n=t.z;if(t.x=e*this._m11+i*this._m21+n*this._m31+this._offsetX,t.y=e*this._m12+i*this._m22+n*this._m32+this._offsetY,t.z=e*this._m13+i*this._m23+n*this._m33+this._offsetZ,!this.get_isAffine()){var r=e*this._m14+i*this._m24+n*this._m34+this._m44;t.x/=r,t.y/=r,t.z/=r}}},multiplyVector:function(t){if(!this.get__isDistinguishedIdentity()){var e=t.x,i=t.y,n=t.z;t.x=e*this._m11+i*this._m21+n*this._m31,t.y=e*this._m12+i*this._m22+n*this._m32,t.z=e*this._m13+i*this._m23+n*this._m33}},_getNormalizedAffineDeterminant:function(){var t=this._m12*this._m23-this._m22*this._m13,e=this._m32*this._m13-this._m12*this._m33,i=this._m22*this._m33-this._m32*this._m23;return this._m31*t+this._m21*e+this._m11*i},_normalizedAffineInvert:function(){var t=this._m12*this._m23-this._m22*this._m13,e=this._m32*this._m13-this._m12*this._m33,i=this._m22*this._m33-this._m32*this._m23,n=this._m31*t+this._m21*e+this._m11*i;if(Tn.isZero(n))return!1;var r=this._m21*this._m13-this._m11*this._m23,s=this._m11*this._m33-this._m31*this._m13,a=this._m31*this._m23-this._m21*this._m33,o=this._m11*this._m22-this._m21*this._m12,l=this._m11*this._m32-this._m31*this._m12,h=this._m11*this._offsetY-this._offsetX*this._m12,u=this._m21*this._m32-this._m31*this._m22,c=this._m21*this._offsetY-this._offsetX*this._m22,_=this._m31*this._offsetY-this._offsetX*this._m32,d=this._m23*h-this._offsetZ*o-this._m13*c,g=this._m13*_-this._m33*h+this._offsetZ*l,f=this._m33*c-this._offsetZ*u-this._m23*_,m=o,p=-l,w=u,b=1/n;return this._m11=i*b,this._m12=e*b,this._m13=t*b,this._m21=a*b,this._m22=s*b,this._m23=r*b,this._m31=w*b,this._m32=p*b,this._m33=m*b,this._offsetX=f*b,this._offsetY=g*b,this._offsetZ=d*b,!0},_invertCore:function(){if(!this.get__isDistinguishedIdentity()){if(this.get_isAffine())return this._normalizedAffineInvert();var t=this._m13*this._m24-this._m23*this._m14,e=this._m13*this._m34-this._m33*this._m14,i=this._m13*this._m44-this._offsetZ*this._m14,n=this._m23*this._m34-this._m33*this._m24,r=this._m23*this._m44-this._offsetZ*this._m24,s=this._m33*this._m44-this._offsetZ*this._m34,a=this._m22*e-this._m32*t-this._m12*n,o=this._m12*r-this._m22*i+this._offsetY*t,l=this._m32*i-this._offsetY*e-this._m12*s,h=this._m22*s-this._m32*r+this._offsetY*n,u=this._offsetX*a+this._m31*o+this._m21*l+this._m11*h;if(Tn.isZero(u))return!1;var c=this._m11*n-this._m21*e+this._m31*t,_=this._m21*i-this._offsetX*t-this._m11*r,d=this._m11*s-this._m31*i+this._offsetX*e,g=this._m31*r-this._offsetX*n-this._m21*s;t=this._m11*this._m22-this._m21*this._m12,e=this._m11*this._m32-this._m31*this._m12,i=this._m11*this._offsetY-this._offsetX*this._m12,n=this._m21*this._m32-this._m31*this._m22,r=this._m21*this._offsetY-this._offsetX*this._m22,s=this._m31*this._offsetY-this._offsetX*this._m32;var f=this._m13*n-this._m23*e+this._m33*t,m=this._m23*i-this._offsetZ*t-this._m13*r,p=this._m13*s-this._m33*i+this._offsetZ*e,w=this._m33*r-this._offsetZ*n-this._m23*s,b=this._m24*e-this._m34*t-this._m14*n,v=this._m14*r-this._m24*i+this._m44*t,y=this._m34*i-this._m44*e-this._m14*s,S=this._m24*s-this._m34*r+this._m44*n,x=1/u;this._m11=h*x,this._m12=l*x,this._m13=o*x,this._m14=a*x,this._m21=g*x,this._m22=d*x,this._m23=_*x,this._m24=c*x,this._m31=S*x,this._m32=y*x,this._m33=v*x,this._m34=b*x,this._offsetX=w*x,this._offsetY=p*x,this._offsetZ=m*x,this._m44=f*x}return!0},get__isDistinguishedIdentity:function(){return!this._isNotKnownToBeIdentity},set__isDistinguishedIdentity:function(t){return this._isNotKnownToBeIdentity=!t,t},_multiply:function(t){this.set(yn.multiplyMatrix(this,t))}};function xn(){this.m11=1,this.m12=0,this.m13=0,this.m21=0,this.m22=1,this.m23=0,this.m31=0,this.m32=0,this.m33=1}function Tn(){}function Mn(t,e,i,n){this.a=0,this.b=0,this.c=0,this.d=0,this.a=t,this.b=e,this.c=i,this.d=n}function Cn(t,e,i,n){this.x=0,this.y=0,this.z=0,this.w=0,this.x=t,this.y=e,this.z=i,this.w=n}function An(){this.x=0,this.y=0,this.z=0,this.nx=0,this.ny=0,this.nz=0,this.tu=0,this.tv=0,this.tu1=0,this.tv1=0}n("Matrix3d",[yn,Sn,null]),yn._s_identity=yn._createIdentity(),xn.create=function(t,e,i,n,r,s,a,o,l){var h=new xn;return h.m11=t,h.m12=e,h.m13=i,h.m21=n,h.m22=r,h.m23=s,h.m31=a,h.m32=o,h.m33=l,h},xn.rotation=function(t){var e=new xn;return e.m11=Math.cos(t),e.m21=-Math.sin(t),e.m12=Math.sin(t),e.m22=Math.cos(t),e},xn.translation=function(t,e){var i=new xn;return i.m31=t,i.m32=e,i},xn.scaling=function(t,e){var i=new xn;return i.m11=t,i.m22=e,i},xn.multiply=function(t,e){return xn.create(t.m11*e.m11+t.m12*e.m21+t.m13*e.m31,t.m11*e.m12+t.m12*e.m22+t.m13*e.m32,t.m11*e.m13+t.m12*e.m23+t.m13*e.m33,t.m21*e.m11+t.m22*e.m21+t.m23*e.m31,t.m21*e.m12+t.m22*e.m22+t.m23*e.m32,t.m21*e.m13+t.m22*e.m23+t.m23*e.m33,t.m31*e.m11+t.m32*e.m21+t.m33*e.m31,t.m31*e.m12+t.m32*e.m22+t.m33*e.m32,t.m31*e.m13+t.m32*e.m23+t.m33*e.m33)},xn.rotateAt=function(t,e){var i=xn.translation(-e.x,-e.y),n=xn.rotation(t),r=xn.translation(e.x,e.y);return xn.multiply(xn.multiply(i,n),r)},n("Matrix2d",[xn,{_transformPoints:function(e){for(var i=t.ss.enumerate(e);i.moveNext();){var n=i.current;this.multiplyPoint(n)}},multiplyPoint:function(t){var e=t.x,i=t.y;t.x=e*this.m11+i*this.m21+this.m31,t.y=e*this.m12+i*this.m22+this.m32}},null]),Tn.isZero=function(t){return Math.abs(t)<2.22044604925031e-50},Tn.isOne=function(t){return Math.abs(t-1)<2.22044604925031e-50},Tn.radiansToDegrees=function(t){return 180*t/Math.PI},Tn.degreesToRadians=function(t){return t*Math.PI/180},Tn.clamp=function(t,e,i){return Math.max(e,Math.min(t,i))},n("DoubleUtilities",[Tn,null,null]),n("PlaneD",[Mn,{normalize:function(){var t=Math.sqrt(this.a*this.a+this.b*this.b+this.c*this.c);this.a/=t,this.b/=t,this.c/=t,this.d/=t},dot:function(t){return this.b*t.y+this.c*t.z+this.d*t.w+this.a*t.x}},null]),n("Vector4d",[Cn,{},null]),An.create2UV=function(t,e,i,n,r,s){var a=new An;return a.x=t.x,a.y=t.y,a.z=t.z,a.nx=e.x,a.ny=e.y,a.nz=e.z,a.tu=i,a.tv=n,a.tu1=r,a.tv1=s,a},An.create=function(t,e,i,n){var r=new An;r.x=t.x,r.y=t.y,r.z=t.z,r.nx=e.x,r.ny=e.y,r.nz=e.z,r.tu=i,r.tv=n;var s=hn(e);return r.tu1=(s[1]+180)/360,r.tv1=1-(s[0]+90)/180,r},An.createLong2UV=function(t,e,i,n,r,s,a,o,l,h){var u=new An;return u.x=t,u.y=e,u.z=i,u.nx=n,u.ny=r,u.nz=s,u.tu=a,u.tv=o,u.tu1=l,u.tv1=h,u},An.get_strideSize=function(){return 40};var Ln={get_lat:function(){return 180*(1-this.tv1)-90},set_lat:function(t){return this.tv1=1-(t+90)/180,t},get_lng:function(){return 360*this.tu1-180},set_lng:function(t){return this.tu1=(t+180)/360,t},createLong:function(t,e,i,n,r,s,a,o){var l=new An;l.x=t,l.y=e,l.z=i,l.nx=n,l.ny=r,l.nz=s,l.tu=a,l.tv=o;var h=hn(wn.create(this.nx,this.ny,this.nz));return l.tu1=(h[1]+180)/360,l.tv1=1-(h[0]+90)/180,l},get_normal:function(){return wn.create(this.nx,this.ny,this.nz)},set_normal:function(t){return this.nx=t.x,this.ny=t.y,this.nz=t.z,t},get_position:function(){return wn.create(this.x,this.y,this.y)},set_position:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,t},toString:function(){return t.ss.format("X={0}, Y={1}, Z={2}, Nx={3}, Ny={4}, Nz={5}, U={6}, V={7}, U1={8}, U2={9}",this.x,this.y,this.z,this.nx,this.ny,this.nz,this.tu,this.tv,this.tu1,this.tv1)}};function In(){this.x=0,this.y=0,this.z=0,this.nx=0,this.ny=0,this.nz=0,this.tu=0,this.tv=0}n("PositionNormalTexturedX2",[An,Ln,null]),In.createShort=function(t,e,i,n){var r=new In;return r.x=t.x,r.y=t.y,r.z=t.z,r.nx=e.x,r.ny=e.y,r.nz=e.z,r.tu=i,r.tv=n,r},In._create=function(t,e,i,n,r,s,a,o){var l=new In;return l.x=t,l.y=e,l.z=i,l.nx=n,l.ny=r,l.nz=s,l.tu=a,l.tv=o,l},In.createUV=function(t,e,i){var n=new In;return n.x=t.x,n.y=t.y,n.z=t.z,n.nx=e.x,n.ny=e.y,n.nz=e.z,n.tu=i.x,n.tv=i.y,n};var kn={createLong:function(t,e,i,n,r,s,a,o){var l=new An;return l.x=t,l.y=e,l.z=i,l.nx=n,l.ny=r,l.nz=s,l.tu=a,l.tv=o,l},get_normal:function(){return wn.create(this.nx,this.ny,this.nz)},set_normal:function(t){return this.nx=t.x,this.ny=t.y,this.nz=t.z,t},get_position:function(){return wn.create(this.x,this.y,this.z)},set_position:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,t},toString:function(){return t.ss.format("X={0}, Y={1}, Z={2}, Nx={3}, Ny={4}, Nz={5}, U={6}, V={7}, U1={8}, U2={9}",this.x,this.y,this.z,this.nx,this.ny,this.nz,this.tu,this.tv)}};function Pn(){this.radius=0}function Rn(){}function En(){this.a=0,this.e=0,this.i=0,this.w=0,this.omega=0,this.jdEquinox=0,this.t=0,this.n=0,this.meanAnnomolyOut=0,this.a=0,this.e=0,this.i=0,this.w=0,this.omega=0,this.jdEquinox=0,this.t=0}function Dn(){this.apparentGeocentricLongitude=0,this.apparentGeocentricLatitude=0,this.apparentGeocentricDistance=0,this.apparentLightTime=0,this.apparentGeocentricRA=0,this.apparentGeocentricDeclination=0,this.apparentGeocentricLongitude=0,this.apparentGeocentricLatitude=0,this.apparentGeocentricDistance=0,this.apparentLightTime=0,this.apparentGeocentricRA=0,this.apparentGeocentricDeclination=0}function Fn(){this.heliocentricRectangularEquatorial=new _,this.heliocentricRectangularEcliptical=new _,this.heliocentricEclipticLongitude=0,this.heliocentricEclipticLatitude=0,this.trueGeocentricRA=0,this.trueGeocentricDeclination=0,this.trueGeocentricDistance=0,this.trueGeocentricLightTime=0,this.astrometricGeocenticRA=0,this.astrometricGeocentricDeclination=0,this.astrometricGeocentricDistance=0,this.astrometricGeocentricLightTime=0,this.elongation=0,this.phaseAngle=0,this.heliocentricEclipticLongitude=0,this.heliocentricEclipticLatitude=0,this.trueGeocentricRA=0,this.trueGeocentricDeclination=0,this.trueGeocentricDistance=0,this.trueGeocentricLightTime=0,this.astrometricGeocenticRA=0,this.astrometricGeocentricDeclination=0,this.astrometricGeocentricDistance=0,this.astrometricGeocentricLightTime=0,this.elongation=0,this.phaseAngle=0}n("PositionNormalTextured",[In,kn,null]),Pn._create=function(t,e){var i=new Pn;return i.center=t,i.radius=e,i},n("SphereHull",[Pn,{},null]),Rn.findEnclosingSphereFast=function(t){for(var e=new Pn,i=t.length,n=wn.zero,r=0;r<i;++r)n.add(t[r]);n.multiply(1/i);var s=0;for(r=0;r<i;++r){var a=wn.getLengthSq(wn.subtractVectors(t[r],n));a>s&&(s=a)}return s=Math.sqrt(s),e.center=n,e.radius=s,e},Rn.findEnclosingSphere=function(t){var e,i,n,r,s,a,o,l,h,u,c,_=new wn,d=0,g=t.length,f=new wn,m=new wn,p=new wn,w=new wn,b=new wn,v=new wn,y=new wn,S=new wn;for(f.x=p.y=b.z=1e8,m.x=w.y=v.z=-1e9,e=0;e<g;e++)(x=t[e]).x<f.x&&(f=x),x.x>m.x&&(m=x),x.y<p.y&&(p=x),x.y>w.y&&(w=x),x.z<b.z&&(b=x),x.z>v.z&&(v=x);for(a=(i=m.x-f.x)*i+(n=m.y-f.y)*n+(r=m.z-f.z)*r,y=f,S=m,(o=(i=w.x-p.x)*i+(n=w.y-p.y)*n+(r=w.z-p.z)*r)>(l=a)&&(l=o,y=p,S=w),(i=v.x-b.x)*i+(n=v.y-b.y)*n+(r=v.z-b.z)*r>l&&(y=b,S=v),_.x=(y.x+S.x)/2,_.y=(y.y+S.y)/2,_.z=(y.z+S.z)/2,s=(i=S.x-_.x)*i+(n=S.y-_.y)*n+(r=S.z-_.z)*r,d=Math.sqrt(s),e=0;e<g;e++){var x;(u=(i=(x=t[e]).x-_.x)*i+(n=x.y-_.y)*n+(r=x.z-_.z)*r)>s&&(s=(d=(d+(h=Math.sqrt(u)))/2)*d,c=h-d,_.x=(d*_.x+c*x.x)/h,_.y=(d*_.y+c*x.y)/h,_.z=(d*_.z+c*x.z)/h)}return Pn._create(_,d)},n("ConvexHull",[Rn,{},null]),En._create=function(t){var e=new En;return e.a=t.readSingle(),e.e=t.readSingle(),e.i=t.readSingle(),e.w=t.readSingle(),e.omega=t.readSingle(),e.jdEquinox=t.readSingle(),e.t=t.readSingle(),e},n("EOE",[En,{},null]),n("EPD",[Dn,{},null]),n("EOD",[Fn,{},null]);var Nn={SUN:0,MERCURY:1,VENUS:2,MARS:3,JUPITER:4,SATURN:5,URANUS:6,NEPTUNE:7,PLUTO:8};function $n(){}function zn(){}function Bn(){this.meanLongitude=0,this.trueLongitude=0,this.tropicalLongitude=0,this.equatorialLatitude=0,this.r=0,this.eclipticRectangularCoordinates=new _,this.trueRectangularCoordinates=new _,this.apparentRectangularCoordinates=new _,this.bInTransit=!1,this.bInOccultation=!1,this.bInEclipse=!1,this.bInShadowTransit=!1,this.apparentShadowRectangularCoordinates=new _,this.meanLongitude=0,this.trueLongitude=0,this.tropicalLongitude=0,this.equatorialLatitude=0,this.r=0,this.bInTransit=!1,this.bInOccultation=!1,this.bInEclipse=!1,this.bInShadowTransit=!1}function Un(){this.satellite1=new Bn,this.satellite2=new Bn,this.satellite3=new Bn,this.satellite4=new Bn}function Vn(){}function On(){}function Gn(){}function Xn(){}function Hn(t,e,i,n){this.d=0,this.m=0,this.mdash=0,this.f=0,this.d=t,this.m=e,this.mdash=i,this.f=n}function Yn(t,e){this.a=0,this.b=0,this.a=t,this.b=e}n("EO",Nn),$n.distanceToLightTime=function(t){return.0057755183*t},$n.calculate=function(t,e){var i=new Dn,n=t,r=0,s=0,a=0,o=0;e&&(r=U.eclipticLongitude(n),s=U.eclipticLatitude(n),a=U.radiusVector(n),r=d.d2R(r),s=d.d2R(s),o=Math.cos(s));for(var l,h,u,c,_,g,f=0,m=0,p=0,w=!0,b=!0,v=0,y=0,S=0;w;){switch(e){case 0:f=H.geometricEclipticLongitude(n),m=H.geometricEclipticLatitude(n),p=U.radiusVector(n);break;case 1:f=ot.eclipticLongitude(n),m=ot.eclipticLatitude(n),p=ot.radiusVector(n);break;case 2:f=Tt.eclipticLongitude(n),m=Tt.eclipticLatitude(n),p=Tt.radiusVector(n);break;case 3:f=Vt.eclipticLongitude(n),m=Vt.eclipticLatitude(n),p=Vt.radiusVector(n);break;case 4:f=ae.eclipticLongitude(n),m=ae.eclipticLatitude(n),p=ae.radiusVector(n);break;case 5:f=Me.eclipticLongitude(n),m=Me.eclipticLatitude(n),p=Me.radiusVector(n);break;case 6:f=Ve.eclipticLongitude(n),m=Ve.eclipticLatitude(n),p=Ve.radiusVector(n);break;case 7:f=ii.eclipticLongitude(n),m=ii.eclipticLatitude(n),p=ii.radiusVector(n);break;case 8:f=hi.eclipticLongitude(n),m=hi.eclipticLatitude(n),p=hi.radiusVector(n);break;default:console.assert(!1)}if(b?b=!1:(w=Math.abs(f-v)>1e-5||Math.abs(m-y)>1e-5||Math.abs(p-S)>1e-6,v=f,y=m,S=p),w){var x=0;e?(l=d.d2R(f),h=d.d2R(m),c=p*(u=Math.cos(h))*Math.cos(l)-a*o*Math.cos(r),_=p*u*Math.sin(l)-a*o*Math.sin(r),g=p*Math.sin(h)-a*Math.sin(s),x=Math.sqrt(c*c+_*_+g*g)):x=p,n=t-$n.distanceToLightTime(x)}}l=d.d2R(f),h=d.d2R(m),c=p*(u=Math.cos(h))*Math.cos(l)-a*o*Math.cos(r),_=p*u*Math.sin(l)-a*o*Math.sin(r),g=p*Math.sin(h)-a*Math.sin(s);var T=c*c,M=_*_;i.apparentGeocentricLatitude=d.r2D(Math.atan2(g,Math.sqrt(T+M))),i.apparentGeocentricDistance=Math.sqrt(T+M+g*g),i.apparentGeocentricLongitude=d.m360(d.r2D(Math.atan2(_,c))),i.apparentLightTime=$n.distanceToLightTime(i.apparentGeocentricDistance);var C=di.eclipticAberration(i.apparentGeocentricLongitude,i.apparentGeocentricLatitude,t);i.apparentGeocentricLongitude+=C.x,i.apparentGeocentricLatitude+=C.y;var A=V.correctionInLongitude(i.apparentGeocentricLongitude,i.apparentGeocentricLatitude,t);i.apparentGeocentricLatitude+=V.correctionInLatitude(i.apparentGeocentricLongitude,t),i.apparentGeocentricLongitude+=A;var L=X.nutationInLongitude(t),I=X.trueObliquityOfEcliptic(t);i.apparentGeocentricLongitude+=d.dmS2D(0,0,L);var k=d.ec2Eq(i.apparentGeocentricLongitude,i.apparentGeocentricLatitude,I);return i.apparentGeocentricRA=k.x,i.apparentGeocentricDeclination=k.y,i},$n.semiMajorAxisFromPerihelionDistance=function(t,e){return t/(1-e)},$n.meanMotionFromSemiMajorAxis=function(t){return.9856076686/(t*Math.sqrt(t))},$n.calculateRectangularJD=function(t,e){var i=t,n=d.d2R(e.omega),r=d.d2R(e.w),s=d.d2R(e.i),a=Math.sin(n),o=Math.cos(n),l=Math.cos(s),h=Math.sin(s),u=o,c=1*a,_=0*a,g=-a*l,f=o*l*1-0*h,m=o*l*0+1*h,p=Math.sqrt(u*u+g*g),w=Math.sqrt(c*c+f*f),b=Math.sqrt(_*_+m*m),v=Math.atan2(u,g),y=Math.atan2(c,f),S=Math.atan2(_,m),x=e.n*(i-e.t);e.meanAnnomolyOut=x;var T=ui.calculate(x,e.e);T=d.d2R(T);var M=2*Math.atan(Math.sqrt((1+e.e)/(1-e.e))*Math.tan(T/2)),C=e.a*(1-e.e*Math.cos(T)),A=C*p*Math.sin(v+r+M),L=C*w*Math.sin(y+r+M),I=C*b*Math.sin(S+r+M);return wn.create(A,I,L)},$n.calculateRectangular=function(t,e){var i=d.d2R(t.omega),n=d.d2R(t.w),r=d.d2R(t.i),s=Math.sin(i),a=Math.cos(i),o=Math.cos(r),l=Math.sin(r),h=a,u=1*s,c=0*s,_=-s*o,g=a*o*1-0*l,f=a*o*0+1*l,m=Math.sqrt(h*h+_*_),p=Math.sqrt(u*u+g*g),w=Math.sqrt(c*c+f*f),b=Math.atan2(h,_),v=Math.atan2(u,g),y=Math.atan2(c,f),S=(t.n,e),x=ui.calculate(S,t.e);x=d.d2R(x);var T=2*Math.atan(Math.sqrt((1+t.e)/(1-t.e))*Math.tan(x/2)),M=t.a*(1-t.e*Math.cos(x)),C=M*m*Math.sin(b+n+T),A=M*p*Math.sin(v+n+T),L=M*w*Math.sin(y+n+T);return wn.create(C,L,A)},$n.calculateElements=function(t,e){var i=X.meanObliquityOfEcliptic(e.jdEquinox),n=t,r=new Fn;i=d.d2R(i);for(var s=d.d2R(e.omega),a=d.d2R(e.w),o=d.d2R(e.i),l=Math.sin(i),h=Math.cos(i),u=Math.sin(s),c=Math.cos(s),_=Math.cos(o),g=Math.sin(o),f=c,m=u*h,p=u*l,w=-u*_,b=c*_*h-g*l,v=c*_*l+g*h,y=Math.sqrt(f*f+w*w),S=Math.sqrt(m*m+b*b),x=Math.sqrt(p*p+v*v),T=Math.atan2(f,w),M=Math.atan2(m,b),C=Math.atan2(p,v),A=$n.meanMotionFromSemiMajorAxis(e.a),L=H.equatorialRectangularCoordinatesAnyEquinox(t,e.jdEquinox),I=0;I<2;I++){var k=A*(n-e.t),P=ui.calculate(k,e.e);P=d.d2R(P);var R=2*Math.atan(Math.sqrt((1+e.e)/(1-e.e))*Math.tan(P/2)),E=e.a*(1-e.e*Math.cos(P)),D=E*y*Math.sin(T+a+R),F=E*S*Math.sin(M+a+R),N=E*x*Math.sin(C+a+R);if(!I){r.heliocentricRectangularEquatorial.x=D,r.heliocentricRectangularEquatorial.y=F,r.heliocentricRectangularEquatorial.z=N;var $=s+R,z=Math.cos($),B=Math.sin($);r.heliocentricRectangularEcliptical.x=E*(c*z-u*B*_),r.heliocentricRectangularEcliptical.y=E*(u*z+c*B*_),r.heliocentricRectangularEcliptical.z=E*g*B,r.heliocentricEclipticLongitude=Math.atan2(F,D),r.heliocentricEclipticLongitude=d.m24(d.r2D(r.heliocentricEclipticLongitude)/15),r.heliocentricEclipticLatitude=Math.asin(N/E),r.heliocentricEclipticLatitude=d.r2D(r.heliocentricEclipticLatitude)}var U=L.x+D,V=L.y+F,O=L.z+N,G=Math.atan2(V,U);G=d.r2D(G);var Y=Math.atan2(O,Math.sqrt(U*U+V*V));Y=d.r2D(Y);var j=Math.sqrt(U*U+V*V+O*O);if(I){r.astrometricGeocenticRA=d.m24(G/15),r.astrometricGeocentricDeclination=Y,r.astrometricGeocentricDistance=j,r.astrometricGeocentricLightTime=$n.distanceToLightTime(j);var W=Math.sqrt(L.x*L.x+L.y*L.y+L.z*L.z);r.elongation=Math.acos((W*W+j*j-E*E)/(2*W*j)),r.elongation=d.r2D(r.elongation),r.phaseAngle=Math.acos((E*E+j*j-W*W)/(2*E*j)),r.phaseAngle=d.r2D(r.phaseAngle)}else r.trueGeocentricRA=d.m24(G/15),r.trueGeocentricDeclination=Y,r.trueGeocentricDistance=j,r.trueGeocentricLightTime=$n.distanceToLightTime(j);I||(n=t-r.trueGeocentricLightTime)}return r},$n.instantaneousVelocity=function(t,e){return 42.1219*Math.sqrt(1/t-1/(2*e))},$n.velocityAtPerihelion=function(t,e){return 29.7847/Math.sqrt(e)*Math.sqrt((1+t)/(1-t))},$n.velocityAtAphelion=function(t,e){return 29.7847/Math.sqrt(e)*Math.sqrt((1-t)/(1+t))},$n.lengthOfEllipse=function(t,e){var i=e*Math.sqrt(1-t*t);return d.PI()*(3*(e+i)-Math.sqrt((e+3*i)*(3*e+i)))},$n.cometMagnitude=function(t,e,i,n){return t+5*a.log10(e)+i*a.log10(n)},$n.minorPlanetMagnitude=function(t,e,i,n,r){r=d.d2R(r);var s=Math.exp(-3.33*Math.pow(Math.tan(r/2),.63)),o=Math.exp(-1.87*Math.pow(Math.tan(r/2),1.22));return t+5*a.log10(n*e)-2.5*a.log10((1-i)*s+i*o)},n("ELL",[$n,{},null]),zn.calculate=function(t){var e=(t-2451545)/365250,i=e*e,n=i*e,r=n*e,s=r*e,a=d.m360(280.4664567+360007.6982779*e+.03032028*i+n/49931-r/15300-s/2e6),o=H.apparentEclipticLongitude(t),l=H.apparentEclipticLatitude(t),h=X.trueObliquityOfEcliptic(t),u=d.ec2Eq(o,l,h);h=d.d2R(h);var c=a-.0057183-15*u.x+d.dmS2D(0,0,X.nutationInLongitude(t))*Math.cos(h);return c>180&&(c=-(360-c)),4*c},n("EOT",[zn,{},null]),n("GMD",[Bn,{},null]),n("GMDS",[Un,{},null]),Vn.calculate=function(t){for(var e=H.geometricEclipticLongitude(t),i=d.d2R(e),n=H.geometricEclipticLatitude(t),r=d.d2R(n),s=U.radiusVector(t),a=5,o=0,l=$n.distanceToLightTime(a),h=t-l,u=!0,c=0,_=0,g=0,f=0,m=0,p=0,w=0,b=0;u;)f=ae.eclipticLongitude(h),m=d.d2R(f),p=ae.eclipticLatitude(h),w=d.d2R(p),c=(b=ae.radiusVector(h))*Math.cos(w)*Math.cos(m)+s*Math.cos(i),_=b*Math.cos(w)*Math.sin(m)+s*Math.sin(i),g=b*Math.sin(w)+s*Math.sin(r),a=Math.sqrt(c*c+_*_+g*g),l=$n.distanceToLightTime(a),(u=Math.abs(l-o)>2e-6)&&(h=t-l,o=l);var v=Vn.calculateHelper(t,i,r,s);Vn.fillInPhenomenaDetails(v.satellite1),Vn.fillInPhenomenaDetails(v.satellite2),Vn.fillInPhenomenaDetails(v.satellite3),Vn.fillInPhenomenaDetails(v.satellite4),h=t-l,f=ae.eclipticLongitude(h),m=d.d2R(f),p=ae.eclipticLatitude(h),w=d.d2R(p),c=(b=ae.radiusVector(h))*Math.cos(w)*Math.cos(m),_=b*Math.cos(w)*Math.sin(m),g=b*Math.sin(w),a=Math.sqrt(c*c+_*_+g*g);var y=$n.distanceToLightTime(a),S=Vn.calculateHelper(t+y-l,i,r,0);return Vn.fillInPhenomenaDetails(S.satellite1),Vn.fillInPhenomenaDetails(S.satellite2),Vn.fillInPhenomenaDetails(S.satellite3),Vn.fillInPhenomenaDetails(S.satellite4),v.satellite1.bInEclipse=S.satellite1.bInOccultation,v.satellite2.bInEclipse=S.satellite2.bInOccultation,v.satellite3.bInEclipse=S.satellite3.bInOccultation,v.satellite4.bInEclipse=S.satellite4.bInOccultation,v.satellite1.bInShadowTransit=S.satellite1.bInTransit,v.satellite2.bInShadowTransit=S.satellite2.bInTransit,v.satellite3.bInShadowTransit=S.satellite3.bInTransit,v.satellite4.bInShadowTransit=S.satellite4.bInTransit,v.satellite1.apparentShadowRectangularCoordinates=S.satellite1.apparentRectangularCoordinates,v.satellite2.apparentShadowRectangularCoordinates=S.satellite2.apparentRectangularCoordinates,v.satellite3.apparentShadowRectangularCoordinates=S.satellite3.apparentRectangularCoordinates,v.satellite4.apparentShadowRectangularCoordinates=S.satellite4.apparentRectangularCoordinates,v},Vn.calculateHelper=function(t,e,i,n){for(var r=new Un,s=5,a=0,o=$n.distanceToLightTime(s),l=0,h=0,u=0,c=0,g=0,f=0,m=0,p=0,w=t-o,b=!0;b;)c=ae.eclipticLongitude(w),g=d.d2R(c),f=ae.eclipticLatitude(w),m=d.d2R(f),l=(p=ae.radiusVector(w))*Math.cos(m)*Math.cos(g)+n*Math.cos(e),h=p*Math.cos(m)*Math.sin(g)+n*Math.sin(e),u=p*Math.sin(m)+n*Math.sin(i),s=Math.sqrt(l*l+h*h+u*u),o=$n.distanceToLightTime(s),(b=Math.abs(o-a)>2e-6)&&(w=t-o,a=o);var v=Math.atan2(h,l),y=Math.atan(u/Math.sqrt(l*l+h*h)),S=t-2443000.5-o,x=106.07719+203.48895579*S,T=d.d2R(x),M=175.73161+101.374724735*S,C=d.d2R(M),A=120.55883+50.317609207*S,L=d.d2R(A),I=84.44459+21.571071177*S,k=d.d2R(I),P=d.d2R(d.m360(97.0881+.16138586*S)),R=d.d2R(d.m360(154.8663+.04726307*S)),E=d.d2R(d.m360(188.184+.00712734*S)),D=d.d2R(d.m360(335.2868+.00184*S)),F=312.3346-.13279386*S,N=d.d2R(F),$=100.4411-.03263064*S,z=d.d2R($),B=119.1942-.00717703*S,U=d.d2R(B),V=322.6186-.00175934*S,O=d.d2R(V),G=.33033*Math.sin(d.d2R(163.679+.0010512*S))+.03439*Math.sin(d.d2R(34.486-.0161731*S)),X=d.d2R(199.6766+.1737919*S),H=d.d2R(316.5182-208e-8*S),Y=d.d2R(30.23756+.0830925701*S+G),j=d.d2R(31.97853+.0334597339*S),W=d.d2R(13.469942),q=.47259*Math.sin(2*(T-C))+-.03478*Math.sin(E-D)+.01081*Math.sin(C-2*L+E)+.00738*Math.sin(X)+.00713*Math.sin(C-2*L+R)+-.00674*Math.sin(P+E-2*W-2*Y)+.00666*Math.sin(C-2*L+D)+.00445*Math.sin(T-E)+-.00354*Math.sin(T-C)+-.00317*Math.sin(2*H-2*W)+.00265*Math.sin(T-D)+-.00186*Math.sin(Y)+.00162*Math.sin(R-E)+.00158*Math.sin(4*(T-C))+-.00155*Math.sin(T-L)+-.00138*Math.sin(H+U-2*W-2*Y)+-.00115*Math.sin(2*(T-2*C+z))+89e-5*Math.sin(R-D)+85e-5*Math.sin(T+E-2*W-2*Y)+83e-5*Math.sin(z-U)+53e-5*Math.sin(H-z),Z=1.06476*Math.sin(2*(C-L))+.04256*Math.sin(T-2*C+E)+.03581*Math.sin(C-E)+.02395*Math.sin(T-2*C+D)+.01984*Math.sin(C-D)+-.01778*Math.sin(X)+.01654*Math.sin(C-R)+.01334*Math.sin(C-2*L+R)+.01294*Math.sin(E-D)+-.01142*Math.sin(C-L)+-.01057*Math.sin(Y)+-.00775*Math.sin(2*(H-W))+.00524*Math.sin(2*(T-C))+-.0046*Math.sin(T-L)+.00316*Math.sin(H-2*Y+U-2*W)+-.00203*Math.sin(P+E-2*W-2*Y)+.00146*Math.sin(H-U)+-.00145*Math.sin(2*Y)+.00125*Math.sin(H-O)+-.00115*Math.sin(T-2*L+E)+-94e-5*Math.sin(2*(C-z))+86e-5*Math.sin(2*(T-2*C+z))+-86e-5*Math.sin(5*j-2*Y+d.d2R(52.225))+-78e-5*Math.sin(C-k)+-64e-5*Math.sin(3*L-7*k+4*D)+64e-5*Math.sin(P-D)+-63e-5*Math.sin(T-2*L+D)+58e-5*Math.sin(U-O)+56e-5*Math.sin(2*(H-W-Y))+56e-5*Math.sin(2*(C-k))+55e-5*Math.sin(2*(T-L))+52e-5*Math.sin(3*L-7*k+E+3*D)+-43e-5*Math.sin(T-E)+41e-5*Math.sin(5*(C-L))+41e-5*Math.sin(D-W)+32e-5*Math.sin(z-U)+32e-5*Math.sin(2*(L-Y-W)),K=.1649*Math.sin(L-E)+.09081*Math.sin(L-D)+-.06907*Math.sin(C-L)+.03784*Math.sin(E-D)+.01846*Math.sin(2*(L-k))+-.0134*Math.sin(Y)+-.01014*Math.sin(2*(H-W))+.00704*Math.sin(C-2*L+E)+-.0062*Math.sin(C-2*L+R)+-.00541*Math.sin(L-k)+.00381*Math.sin(C-2*L+D)+.00235*Math.sin(H-U)+.00198*Math.sin(H-O)+.00176*Math.sin(X)+.0013*Math.sin(3*(L-k))+.00125*Math.sin(T-L)+-.00119*Math.sin(5*j-2*Y+d.d2R(52.225))+.00109*Math.sin(T-C)+-.001*Math.sin(3*L-7*k+4*D)+91e-5*Math.sin(U-O)+8e-4*Math.sin(3*L-7*k+E+3*D)+-75e-5*Math.sin(2*C-3*L+E)+72e-5*Math.sin(P+E-2*W-2*Y)+69e-5*Math.sin(D-W)+-58e-5*Math.sin(2*L-3*k+D)+-57e-5*Math.sin(L-2*k+D)+56e-5*Math.sin(L+E-2*W-2*Y)+-52e-5*Math.sin(C-2*L+P)+-5e-4*Math.sin(R-E)+48e-5*Math.sin(L-2*k+E)+-45e-5*Math.sin(2*C-3*L+D)+-41e-5*Math.sin(R-D)+-38e-5*Math.sin(2*Y)+-37e-5*Math.sin(E-D+U-O)+-32e-5*Math.sin(3*L-7*k+2*E+2*D)+3e-4*Math.sin(4*(L-k))+29e-5*Math.sin(L+D-2*W-2*Y)+-28e-5*Math.sin(U+H-2*W-2*Y)+26e-5*Math.sin(L-W-Y)+24e-5*Math.sin(C-3*L+2*k)+21e-5*Math.sin(L-W-Y)+-21e-5*Math.sin(L-R)+17e-5*Math.sin(2*(L-E)),J=.84287*Math.sin(k-D)+.03431*Math.sin(D-E)+-.03305*Math.sin(2*(H-W))+-.03211*Math.sin(Y)+-.01862*Math.sin(k-E)+.01186*Math.sin(H-O)+.00623*Math.sin(k+D-2*Y-2*W)+.00387*Math.sin(2*(k-D))+-.00284*Math.sin(5*j-2*Y+d.d2R(52.225))+-.00234*Math.sin(2*(H-D))+-.00223*Math.sin(L-k)+-.00208*Math.sin(k-W)+.00178*Math.sin(H+O-2*D)+.00134*Math.sin(D-W)+.00125*Math.sin(2*(k-Y-W))+-.00117*Math.sin(2*Y)+-.00112*Math.sin(2*(L-k))+.00107*Math.sin(3*L-7*k+4*D)+.00102*Math.sin(k-Y-W)+96e-5*Math.sin(2*k-H-O)+87e-5*Math.sin(2*(H-O))+-85e-5*Math.sin(3*L-7*k+E+3*D)+85e-5*Math.sin(L-2*k+D)+-81e-5*Math.sin(2*(k-H))+71e-5*Math.sin(k+D-2*W-3*Y)+61e-5*Math.sin(T-k)+-56e-5*Math.sin(H-U)+-54e-5*Math.sin(L-2*k+E)+51e-5*Math.sin(C-k)+42e-5*Math.sin(2*(H-Y-W))+39e-5*Math.sin(2*(D-O))+36e-5*Math.sin(H+W-D-O)+35e-5*Math.sin(2*j-Y+d.d2R(188.37))+-35e-5*Math.sin(k-D+2*W-2*H)+-32e-5*Math.sin(k+D-2*W-Y)+3e-4*Math.sin(2*j-2*Y+d.d2R(149.15))+29e-5*Math.sin(3*L-7*k+2*E+2*D)+28e-5*Math.sin(k-D+2*H-2*W)+-28e-5*Math.sin(2*(k-O))+-27e-5*Math.sin(E-D+U-O)+-26e-5*Math.sin(5*j-3*Y+d.d2R(188.37))+25e-5*Math.sin(O-U)+-25e-5*Math.sin(C-3*L+2*k)+-23e-5*Math.sin(3*(L-k))+21e-5*Math.sin(2*k-2*W-3*Y)+-21e-5*Math.sin(2*L-3*k+D)+19e-5*Math.sin(k-D-Y)+-19e-5*Math.sin(2*k-E-D)+-18e-5*Math.sin(k-D+Y)+-16e-5*Math.sin(k+E-2*W-2*Y);r.satellite1.meanLongitude=d.m360(x),r.satellite1.trueLongitude=d.m360(x+q);var Q=d.d2R(r.satellite1.trueLongitude);r.satellite2.meanLongitude=d.m360(M),r.satellite2.trueLongitude=d.m360(M+Z);var tt=d.d2R(r.satellite2.trueLongitude);r.satellite3.meanLongitude=d.m360(A),r.satellite3.trueLongitude=d.m360(A+K);var et=d.d2R(r.satellite3.trueLongitude);r.satellite4.meanLongitude=d.m360(I),r.satellite4.trueLongitude=d.m360(I+J);var it=d.d2R(r.satellite4.trueLongitude),nt=Math.atan(6393e-7*Math.sin(Q-N)+1825e-7*Math.sin(Q-z)+329e-7*Math.sin(Q-U)+-311e-7*Math.sin(Q-H)+93e-7*Math.sin(Q-O)+75e-7*Math.sin(3*Q-4*C-1.9927*q+z)+46e-7*Math.sin(Q+H-2*W-2*Y));r.satellite1.equatorialLatitude=d.r2D(nt);var rt=Math.atan(.0081004*Math.sin(tt-z)+4512e-7*Math.sin(tt-U)+-3284e-7*Math.sin(tt-H)+116e-6*Math.sin(tt-O)+272e-7*Math.sin(T-2*L+1.0146*Z+z)+-144e-7*Math.sin(tt-N)+143e-7*Math.sin(tt+H-2*W-2*Y)+35e-7*Math.sin(tt-H+Y)+-28e-7*Math.sin(T-2*L+1.0146*Z+U));r.satellite2.equatorialLatitude=d.r2D(rt);var st=Math.atan(.0032402*Math.sin(et-U)+-.0016911*Math.sin(et-H)+6847e-7*Math.sin(et-O)+-2797e-7*Math.sin(et-z)+321e-7*Math.sin(et+H-2*W-2*Y)+51e-7*Math.sin(et-H+Y)+-45e-7*Math.sin(et-H-Y)+-45e-7*Math.sin(et+H-2*W)+37e-7*Math.sin(et+H-2*W-3*Y)+3e-6*Math.sin(2*C-3*et+4.03*K+z)+-21e-7*Math.sin(2*C-3*et+4.03*K+U));r.satellite3.equatorialLatitude=d.r2D(st);var at=Math.atan(-.0076579*Math.sin(it-H)+.0044134*Math.sin(it-O)+-5112e-7*Math.sin(it-U)+773e-7*Math.sin(it+H-2*W-2*Y)+104e-7*Math.sin(it-H+Y)+-102e-7*Math.sin(it-H-Y)+88e-7*Math.sin(it+H-2*W-3*Y)+-38e-7*Math.sin(it+H-2*W-Y));r.satellite4.equatorialLatitude=d.r2D(at),r.satellite1.r=5.90569*(-.0041339*Math.cos(2*(T-C))+-387e-7*Math.cos(T-E)+-214e-7*Math.cos(T-D)+17e-6*Math.cos(T-C)+-131e-7*Math.cos(4*(T-C))+106e-7*Math.cos(T-L)+-66e-7*Math.cos(T+E-2*W-2*Y)+1),r.satellite2.r=9.39657*(.0093848*Math.cos(T-C)+-3116e-7*Math.cos(C-E)+-1744e-7*Math.cos(C-D)+-1442e-7*Math.cos(C-R)+553e-7*Math.cos(C-L)+523e-7*Math.cos(T-L)+-29e-6*Math.cos(2*(T-C))+164e-7*Math.cos(2*(C-z))+107e-7*Math.cos(T-2*L+E)+-102e-7*Math.cos(C-P)+-91e-7*Math.cos(2*(T-L))+1),r.satellite3.r=14.98832*(-.0014388*Math.cos(L-E)+-7919e-7*Math.cos(L-D)+6342e-7*Math.cos(C-L)+-1761e-7*Math.cos(2*(L-k))+294e-7*Math.cos(L-k)+-156e-7*Math.cos(3*(L-k))+156e-7*Math.cos(T-L)+-153e-7*Math.cos(T-C)+7e-6*Math.cos(2*C-3*L+E)+-51e-7*Math.cos(L+E-2*W-2*Y)+1),r.satellite4.r=26.36273*(-.0073546*Math.cos(k-D)+1621e-7*Math.cos(k-E)+974e-7*Math.cos(L-k)+-543e-7*Math.cos(k+D-2*W-2*Y)+-271e-7*Math.cos(2*(k-D))+182e-7*Math.cos(k-W)+177e-7*Math.cos(2*(L-k))+-167e-7*Math.cos(2*k-H-O)+167e-7*Math.cos(H-O)+-155e-7*Math.cos(2*(k-W-Y))+142e-7*Math.cos(2*(k-H))+105e-7*Math.cos(T-k)+92e-7*Math.cos(C-k)+-89e-7*Math.cos(k-W-Y)+-62e-7*Math.cos(k+D-2*W-3*Y)+48e-7*Math.cos(2*(k-O))+1);var ot=(t-2433282.423)/36525,lt=d.d2R(1.3966626*ot+3088e-7*ot*ot);Q+=lt,r.satellite1.tropicalLongitude=d.m360(d.r2D(Q)),tt+=lt,r.satellite2.tropicalLongitude=d.m360(d.r2D(tt)),et+=lt,r.satellite3.tropicalLongitude=d.m360(d.r2D(et)),it+=lt,r.satellite4.tropicalLongitude=d.m360(d.r2D(it)),H+=lt;var ht=3.120262+(t-2415020.5)/36525*6e-4,ut=d.d2R(ht),ct=r.satellite1.r*Math.cos(Q-H)*Math.cos(nt),_t=r.satellite2.r*Math.cos(tt-H)*Math.cos(rt),dt=r.satellite3.r*Math.cos(et-H)*Math.cos(st),gt=r.satellite4.r*Math.cos(it-H)*Math.cos(at),ft=r.satellite1.r*Math.sin(Q-H)*Math.cos(nt),mt=r.satellite2.r*Math.sin(tt-H)*Math.cos(rt),pt=r.satellite3.r*Math.sin(et-H)*Math.cos(st),wt=r.satellite4.r*Math.sin(it-H)*Math.cos(at),bt=r.satellite1.r*Math.sin(nt),vt=r.satellite2.r*Math.sin(rt),yt=r.satellite3.r*Math.sin(st),St=r.satellite4.r*Math.sin(at),xt=d.d2R(wi.jupiterLongitudeAscendingNode(t)),Tt=d.d2R(wi.jupiterInclination(t)),Mt=0,Ct=0,At=0,Lt=new _,It=Vn.rotations(0,0,1,ut,H,Tt,xt,v,y,Lt);Mt=It[0],Ct=It[1],At=It[2];var kt=Math.atan2(Mt,At);Mt=(It=Vn.rotations(ct,ft,bt,ut,H,Tt,xt,v,y,r.satellite1.eclipticRectangularCoordinates))[0],Ct=It[1],At=It[2],r.satellite1.trueRectangularCoordinates.x=Mt*Math.cos(kt)-At*Math.sin(kt),r.satellite1.trueRectangularCoordinates.y=Mt*Math.sin(kt)+At*Math.cos(kt),r.satellite1.trueRectangularCoordinates.z=Ct,Mt=(It=Vn.rotations(_t,mt,vt,ut,H,Tt,xt,v,y,r.satellite2.eclipticRectangularCoordinates))[0],Ct=It[1],At=It[2],r.satellite2.trueRectangularCoordinates.x=Mt*Math.cos(kt)-At*Math.sin(kt),r.satellite2.trueRectangularCoordinates.y=Mt*Math.sin(kt)+At*Math.cos(kt),r.satellite2.trueRectangularCoordinates.z=Ct,Mt=(It=Vn.rotations(dt,pt,yt,ut,H,Tt,xt,v,y,r.satellite3.eclipticRectangularCoordinates))[0],Ct=It[1],At=It[2],r.satellite3.trueRectangularCoordinates.x=Mt*Math.cos(kt)-At*Math.sin(kt),r.satellite3.trueRectangularCoordinates.y=Mt*Math.sin(kt)+At*Math.cos(kt),r.satellite3.trueRectangularCoordinates.z=Ct,Mt=(It=Vn.rotations(gt,wt,St,ut,H,Tt,xt,v,y,r.satellite4.eclipticRectangularCoordinates))[0],Ct=It[1],At=It[2],r.satellite4.trueRectangularCoordinates.x=Mt*Math.cos(kt)-At*Math.sin(kt),r.satellite4.trueRectangularCoordinates.y=Mt*Math.sin(kt)+At*Math.cos(kt),r.satellite4.trueRectangularCoordinates.z=Ct,r.satellite1.apparentRectangularCoordinates.x=r.satellite1.trueRectangularCoordinates.x+Math.abs(r.satellite1.trueRectangularCoordinates.z)/17295*Math.sqrt(1-r.satellite1.trueRectangularCoordinates.x/r.satellite1.r*(r.satellite1.trueRectangularCoordinates.x/r.satellite1.r)),r.satellite1.apparentRectangularCoordinates.y=r.satellite1.trueRectangularCoordinates.y,r.satellite1.apparentRectangularCoordinates.z=r.satellite1.trueRectangularCoordinates.z,r.satellite2.apparentRectangularCoordinates.x=r.satellite2.trueRectangularCoordinates.x+Math.abs(r.satellite2.trueRectangularCoordinates.z)/21819*Math.sqrt(1-r.satellite2.trueRectangularCoordinates.x/r.satellite2.r*(r.satellite2.trueRectangularCoordinates.x/r.satellite2.r)),r.satellite2.apparentRectangularCoordinates.y=r.satellite2.trueRectangularCoordinates.y,r.satellite2.apparentRectangularCoordinates.z=r.satellite2.trueRectangularCoordinates.z,r.satellite3.apparentRectangularCoordinates.x=r.satellite3.trueRectangularCoordinates.x+Math.abs(r.satellite3.trueRectangularCoordinates.z)/27558*Math.sqrt(1-r.satellite3.trueRectangularCoordinates.x/r.satellite3.r*(r.satellite3.trueRectangularCoordinates.x/r.satellite3.r)),r.satellite3.apparentRectangularCoordinates.y=r.satellite3.trueRectangularCoordinates.y,r.satellite3.apparentRectangularCoordinates.z=r.satellite3.trueRectangularCoordinates.z,r.satellite4.apparentRectangularCoordinates.x=r.satellite4.trueRectangularCoordinates.x+Math.abs(r.satellite4.trueRectangularCoordinates.z)/36548*Math.sqrt(1-r.satellite4.trueRectangularCoordinates.x/r.satellite4.r*(r.satellite4.trueRectangularCoordinates.x/r.satellite4.r)),r.satellite4.apparentRectangularCoordinates.y=r.satellite4.trueRectangularCoordinates.y,r.satellite4.apparentRectangularCoordinates.z=r.satellite4.trueRectangularCoordinates.z;var Pt=s/(s+r.satellite1.trueRectangularCoordinates.z/2095);return r.satellite1.apparentRectangularCoordinates.x*=Pt,r.satellite1.apparentRectangularCoordinates.y*=Pt,Pt=s/(s+r.satellite2.trueRectangularCoordinates.z/2095),r.satellite2.apparentRectangularCoordinates.x*=Pt,r.satellite2.apparentRectangularCoordinates.y*=Pt,Pt=s/(s+r.satellite3.trueRectangularCoordinates.z/2095),r.satellite3.apparentRectangularCoordinates.x*=Pt,r.satellite3.apparentRectangularCoordinates.y*=Pt,Pt=s/(s+r.satellite4.trueRectangularCoordinates.z/2095),r.satellite4.apparentRectangularCoordinates.x*=Pt,r.satellite4.apparentRectangularCoordinates.y*=Pt,r},Vn.rotations=function(t,e,i,n,r,s,a,o,l,h){var u=r-a,c=t,_=e*Math.cos(n)-i*Math.sin(n),d=e*Math.sin(n)+i*Math.cos(n),g=c*Math.cos(u)-_*Math.sin(u),f=c*Math.sin(u)+_*Math.cos(u),m=d,p=g,w=f*Math.cos(s)-m*Math.sin(s),b=f*Math.sin(s)+m*Math.cos(s),v=p*Math.cos(a)-w*Math.sin(a),y=p*Math.sin(a)+w*Math.cos(a),S=b,x=1/2095;h.x=v*x,h.y=y*x,h.z=S*x;var T=v*Math.sin(o)-y*Math.cos(o),M=v*Math.cos(o)+y*Math.sin(o),C=S;return[T,C*Math.sin(l)+M*Math.cos(l),C*Math.cos(l)-M*Math.sin(l)]},Vn.fillInPhenomenaDetails=function(t){var e=1.071374*t.apparentRectangularCoordinates.y;e*e+t.apparentRectangularCoordinates.x*t.apparentRectangularCoordinates.x<1?t.apparentRectangularCoordinates.z<0?(t.bInTransit=!0,t.bInOccultation=!1):(t.bInTransit=!1,t.bInOccultation=!0):(t.bInTransit=!1,t.bInOccultation=!1)},n("GM",[Vn,{},null]),On.rhoSinThetaPrime=function(t,e){t=d.d2R(t);var i=Math.atan(.99664719*Math.tan(t));return.99664719*Math.sin(i)+e/6378149*Math.sin(t)},On.rhoCosThetaPrime=function(t,e){t=d.d2R(t);var i=Math.atan(.99664719*Math.tan(t));return Math.cos(i)+e/6378149*Math.cos(t)},On.radiusOfParallelOfLatitude=function(t){t=d.d2R(t);var e=Math.sin(t);return 6378.14*Math.cos(t)/Math.sqrt(1-.0066943847614084*e*e)},On.radiusOfCurvature=function(t){t=d.d2R(t);var e=Math.sin(t);return 6335.4422767778715/Math.pow(1-.0066943847614084*e*e,1.5)},On.distanceBetweenPoints=function(t,e,i,n){var r=((t=d.d2R(t))+(i=d.d2R(i)))/2,s=(t-i)/2,a=((e=d.d2R(e))-(n=d.d2R(n)))/2,o=Math.sin(s),l=Math.cos(s),h=Math.cos(r),u=Math.sin(r),c=Math.sin(a),_=Math.cos(a),g=o*o*_*_+h*h*c*c,f=l*l*_*_+u*u*c*c,m=Math.atan(Math.sqrt(g/f)),p=Math.sqrt(g*f)/m,w=.00335281317789691;return 2*m*6378.14*(1+w*((3*p-1)/(2*f))*u*u*l*l-w*((3*p+1)/(2*g))*h*h*o*o)},n("CAAGlobe",[On,{},null]),Gn.phaseAngle=function(t,e,i){return d.m360(d.r2D(Math.acos((t*t+i*i-e*e)/(2*t*i))))},Gn.phaseAngle2=function(t,e,i,n,r,s){return i=d.d2R(i),n=d.d2R(n),r=d.d2R(r),d.m360(d.r2D(Math.acos((t-e*Math.cos(i)*Math.cos(n-r))/s)))},Gn.phaseAngleRectangular=function(t,e,i,n,r,s){n=d.d2R(n),r=d.d2R(r);var a=Math.cos(n);return d.m360(d.r2D(Math.acos((t*a*Math.cos(r)+e*a*Math.sin(r)+i*Math.sin(n))/s)))},Gn.illuminatedFraction=function(t){return t=d.d2R(t),(1+Math.cos(t))/2},Gn.illuminatedFraction2=function(t,e,i){return((t+i)*(t+i)-e*e)/(4*t*i)},Gn.mercuryMagnitudeMuller=function(t,e,i){var n=i-50;return 1.16+5*a.log10(t*e)+.02838*n+1023e-7*n*n},Gn.venusMagnitudeMuller=function(t,e,i){return 5*a.log10(t*e)-4+.01322*i+4.247e-7*i*i*i},Gn.marsMagnitudeMuller=function(t,e,i){return 5*a.log10(t*e)-1.3+.01486*i},Gn.jupiterMagnitudeMuller=function(t,e){return 5*a.log10(t*e)-8.93},Gn.saturnMagnitudeMuller=function(t,e,i,n){n=d.d2R(n);var r=Math.sin(n);return 5*a.log10(t*e)-8.68+.044*Math.abs(i)-2.6*Math.sin(Math.abs(n))+1.25*r*r},Gn.uranusMagnitudeMuller=function(t,e){return 5*a.log10(t*e)-6.85},Gn.neptuneMagnitudeMuller=function(t,e){return 5*a.log10(t*e)-7.05},Gn.mercuryMagnitudeAA=function(t,e,i){var n=i*i,r=n*i;return 5*a.log10(t*e)-.42+.038*i-273e-6*n+2e-6*r},Gn.venusMagnitudeAA=function(t,e,i){var n=i*i,r=n*i;return 5*a.log10(t*e)-4.4+9e-4*i+239e-6*n-65e-8*r},Gn.marsMagnitudeAA=function(t,e,i){return 5*a.log10(t*e)-1.52+.016*i},Gn.jupiterMagnitudeAA=function(t,e,i){return 5*a.log10(t*e)-9.4+.005*i},Gn.saturnMagnitudeAA=function(t,e,i,n){n=d.d2R(n);var r=Math.sin(n);return 5*a.log10(t*e)-8.88+.044*Math.abs(i)-2.6*Math.sin(Math.abs(n))+1.25*r*r},Gn.uranusMagnitudeAA=function(t,e){return 5*a.log10(t*e)-7.19},Gn.neptuneMagnitudeAA=function(t,e){return 5*a.log10(t*e)-6.87},Gn.plutoMagnitudeAA=function(t,e){return 5*a.log10(t*e)-1},n("IFR",[Gn,{},null]),Xn.interpolate=function(t,e,i,n){return i+t/2*(i-e+(n-i)+t*(e+n-2*i))},Xn.interpolate2=function(t,e,i,n,r,s){var a=n-i,o=r-n,l=o-a,h=l-(a-(i-e)),u=s-r-o-l,c=u-h,_=t*t,d=_*t;return n+t*((a+o)/2-(h+u)/12)+_*(l/2-c/24)+d*((h+u)/12)+d*t*(c/24)},Xn.interpolateToHalves=function(t,e,i,n){return(9*(e+i)-t-n)/16},Xn.lagrangeInterpolate=function(t,e,i,n){for(var r=0,s=1;s<=e;s++){for(var a=1,o=1;o<=e;o++)o!==s&&(a=a*(t-i[o-1])/(i[s-1]-i[o-1]));r+=a*n[s-1]}return r},Xn.zero=function(t,e,i){for(var n=e-t,r=i-e,s=t+i-2*e,a=!0,o=0,l=o;a;)l=-2*e/(n+r+s*o),(a=Math.abs(l-o)>1e-12)&&(o=l);return l},Xn.zeroB=function(t,e,i,n,r){for(var s=i-e,a=n-i,o=a-s,l=o-(s-(e-t)),h=r-n-a-o,u=h-l,c=!0,_=0,d=_;c;){var g=_*_,f=g*_;d=(-24*i+g*(u-12*o)-2*f*(l+h)-f*_*u)/(2*(6*s+6*a-l-h)),(c=Math.abs(d-_)>1e-12)&&(_=d)}return d},Xn.zero2=function(t,e,i){for(var n=e-t,r=i-e,s=t+i-2*e,a=!0,o=0,l=o;a;){var h=-(2*e+o*(n+r+s*o))/(n+r+2*s*o);l=o+h,(a=Math.abs(h)>1e-12)&&(o=l)}return l},Xn.zero2B=function(t,e,i,n,r){for(var s=i-e,a=n-i,o=a-s,l=o-(s-(e-t)),h=r-n-a-o,u=(h-l)/24,c=(l+h)/12,_=o/2-u,d=(s+a)/2-c,g=!0,f=0,m=f;g;){var p=f*f,w=p*f,b=-(u*(w*f)+c*w+_*p+d*f+i)/(4*u*w+3*c*p+2*_*f+d);m=f+b,(g=Math.abs(b)>1e-12)&&(f=m)}return m},n("INTP",[Xn,{},null]),n("MoonCoefficient1",[Hn,{},null]),n("MoonCoefficient2",[Yn,{},null]);const jn=[new Hn(0,0,1,0),new Hn(2,0,-1,0),new Hn(2,0,0,0),new Hn(0,0,2,0),new Hn(0,1,0,0),new Hn(0,0,0,2),new Hn(2,0,-2,0),new Hn(2,-1,-1,0),new Hn(2,0,1,0),new Hn(2,-1,0,0),new Hn(0,1,-1,0),new Hn(1,0,0,0),new Hn(0,1,1,0),new Hn(2,0,0,-2),new Hn(0,0,1,2),new Hn(0,0,1,-2),new Hn(4,0,-1,0),new Hn(0,0,3,0),new Hn(4,0,-2,0),new Hn(2,1,-1,0),new Hn(2,1,0,0),new Hn(1,0,-1,0),new Hn(1,1,0,0),new Hn(2,-1,1,0),new Hn(2,0,2,0),new Hn(4,0,0,0),new Hn(2,0,-3,0),new Hn(0,1,-2,0),new Hn(2,0,-1,2),new Hn(2,-1,-2,0),new Hn(1,0,1,0),new Hn(2,-2,0,0),new Hn(0,1,2,0),new Hn(0,2,0,0),new Hn(2,-2,-1,0),new Hn(2,0,1,-2),new Hn(2,0,0,2),new Hn(4,-1,-1,0),new Hn(0,0,2,2),new Hn(3,0,-1,0),new Hn(2,1,1,0),new Hn(4,-1,-2,0),new Hn(0,2,-1,0),new Hn(2,2,-1,0),new Hn(2,1,-2,0),new Hn(2,-1,0,-2),new Hn(4,0,1,0),new Hn(0,0,4,0),new Hn(4,-1,0,0),new Hn(1,0,-2,0),new Hn(2,1,0,-2),new Hn(0,0,2,-2),new Hn(1,1,1,0),new Hn(3,0,-2,0),new Hn(4,0,-3,0),new Hn(2,-1,2,0),new Hn(0,2,1,0),new Hn(1,1,-1,0),new Hn(2,0,3,0),new Hn(2,0,-1,-2)],Wn=[new Yn(6288774,-20905355),new Yn(1274027,-3699111),new Yn(658314,-2955968),new Yn(213618,-569925),new Yn(-185116,48888),new Yn(-114332,-3149),new Yn(58793,246158),new Yn(57066,-152138),new Yn(53322,-170733),new Yn(45758,-204586),new Yn(-40923,-129620),new Yn(-34720,108743),new Yn(-30383,104755),new Yn(15327,10321),new Yn(-12528,0),new Yn(10980,79661),new Yn(10675,-34782),new Yn(10034,-23210),new Yn(8548,-21636),new Yn(-7888,24208),new Yn(-6766,30824),new Yn(-5163,-8379),new Yn(4987,-16675),new Yn(4036,-12831),new Yn(3994,-10445),new Yn(3861,-11650),new Yn(3665,14403),new Yn(-2689,-7003),new Yn(-2602,0),new Yn(2390,10056),new Yn(-2348,6322),new Yn(2236,-9884),new Yn(-2120,5751),new Yn(-2069,0),new Yn(2048,-4950),new Yn(-1773,4130),new Yn(-1595,0),new Yn(1215,-3958),new Yn(-1110,0),new Yn(-892,3258),new Yn(-810,2616),new Yn(759,-1897),new Yn(-713,-2117),new Yn(-700,2354),new Yn(691,0),new Yn(596,0),new Yn(549,-1423),new Yn(537,-1117),new Yn(520,-1571),new Yn(-487,-1739),new Yn(-399,0),new Yn(-381,-4421),new Yn(351,0),new Yn(-340,0),new Yn(330,0),new Yn(327,0),new Yn(-323,1165),new Yn(299,0),new Yn(294,0),new Yn(0,8752)],qn=[new Hn(0,0,0,1),new Hn(0,0,1,1),new Hn(0,0,1,-1),new Hn(2,0,0,-1),new Hn(2,0,-1,1),new Hn(2,0,-1,-1),new Hn(2,0,0,1),new Hn(0,0,2,1),new Hn(2,0,1,-1),new Hn(0,0,2,-1),new Hn(2,-1,0,-1),new Hn(2,0,-2,-1),new Hn(2,0,1,1),new Hn(2,1,0,-1),new Hn(2,-1,-1,1),new Hn(2,-1,0,1),new Hn(2,-1,-1,-1),new Hn(0,1,-1,-1),new Hn(4,0,-1,-1),new Hn(0,1,0,1),new Hn(0,0,0,3),new Hn(0,1,-1,1),new Hn(1,0,0,1),new Hn(0,1,1,1),new Hn(0,1,1,-1),new Hn(0,1,0,-1),new Hn(1,0,0,-1),new Hn(0,0,3,1),new Hn(4,0,0,-1),new Hn(4,0,-1,1),new Hn(0,0,1,-3),new Hn(4,0,-2,1),new Hn(2,0,0,-3),new Hn(2,0,2,-1),new Hn(2,-1,1,-1),new Hn(2,0,-2,1),new Hn(0,0,3,-1),new Hn(2,0,2,1),new Hn(2,0,-3,-1),new Hn(2,1,-1,1),new Hn(2,1,0,1),new Hn(4,0,0,1),new Hn(2,-1,1,1),new Hn(2,-2,0,-1),new Hn(0,0,1,3),new Hn(2,1,1,-1),new Hn(1,1,0,-1),new Hn(1,1,0,1),new Hn(0,1,-2,-1),new Hn(2,1,-1,-1),new Hn(1,0,1,1),new Hn(2,-1,-2,-1),new Hn(0,1,2,1),new Hn(4,0,-2,-1),new Hn(4,-1,-1,-1),new Hn(1,0,1,-1),new Hn(4,0,1,-1),new Hn(1,0,-1,-1),new Hn(4,-1,0,-1),new Hn(2,-2,0,1)],Zn=[5128122,280602,277693,173237,55413,46271,32573,17198,9266,8822,8216,4324,4200,-3359,2463,2211,2065,-1870,1828,-1794,-1749,-1565,-1491,-1475,-1410,-1344,-1335,1107,1021,833,777,671,607,596,491,-451,439,422,421,-366,-351,331,315,302,-283,-229,223,223,-220,-220,-185,181,-177,176,166,-164,132,-119,115,107];function Kn(){}function Jn(){}function Qn(){}function tr(t,e,i,n,r){this.d=0,this.m=0,this.f=0,this.c=0,this.t=0,this.d=t,this.m=e,this.f=i,this.c=n,this.t=r}Kn.meanLongitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=n*e;return d.m360(218.3164477+481267.88123421*e-.0015786*i+n/538841-r/65194e3)},Kn.meanElongation=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=n*e;return d.m360(297.8501921+445267.1114034*e-.0018819*i+n/545868-r/113065e3)},Kn.meanAnomaly=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=n*e;return d.m360(134.9633964+477198.8675055*e+.0087414*i+n/69699-r/14712e3)},Kn.argumentOfLatitude=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=n*e;return d.m360(93.272095+483202.0175233*e-.0036539*i-n/3526e3+r/86331e4)},Kn.meanLongitudeAscendingNode=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=n*e;return d.m360(125.0445479-1934.1362891*e+.0020754*i+n/467441-r/60616e3)},Kn.meanLongitudePerigee=function(t){var e=(t-2451545)/36525,i=e*e,n=i*e,r=n*e;return d.m360(83.3532465+4069.0137287*e-.01032*i-n/80053+r/18999e3)},Kn.trueLongitudeAscendingNode=function(t){var e=Kn.meanLongitudeAscendingNode(t),i=Kn.meanElongation(t);i=d.d2R(i);var n=U.sunMeanAnomaly(t);n=d.d2R(n);var r=Kn.meanAnomaly(t);r=d.d2R(r);var s=Kn.argumentOfLatitude(t);return s=d.d2R(s),e-=1.4979*Math.sin(2*(i-s)),e-=.15*Math.sin(n),e-=.1226*Math.sin(2*i),e+=.1176*Math.sin(2*s),e-=.0801*Math.sin(2*(r-s)),d.m360(e)},Kn.eclipticLongitude=function(t){var e=Kn.meanLongitude(t),i=e;e=d.d2R(e);var n=Kn.meanElongation(t);n=d.d2R(n);var r=U.sunMeanAnomaly(t);r=d.d2R(r);var s=Kn.meanAnomaly(t);s=d.d2R(s);var a=Kn.argumentOfLatitude(t);a=d.d2R(a);var o=U.eccentricity(t),l=(t-2451545)/36525,h=d.m360(119.75+131.849*l);h=d.d2R(h);var u=d.m360(53.09+479264.29*l);u=d.d2R(u);var c=d.m360(313.45+481266.484*l);c=d.d2R(c);var _=jn.length;console.assert(Wn.length===_);for(var g=0,f=0;f<_;f++){var m=Wn[f].a*Math.sin(jn[f].d*n+jn[f].m*r+jn[f].mdash*s+jn[f].f*a);jn[f].m&&(m*=o),g+=m}g+=3958*Math.sin(h),g+=1962*Math.sin(e-a),g+=318*Math.sin(u);var p=X.nutationInLongitude(t);return d.m360(i+g/1e6+p/3600)},Kn.eclipticLatitude=function(t){var e=Kn.meanLongitude(t);e=d.d2R(e);var i=Kn.meanElongation(t);i=d.d2R(i);var n=U.sunMeanAnomaly(t);n=d.d2R(n);var r=Kn.meanAnomaly(t);r=d.d2R(r);var s=Kn.argumentOfLatitude(t);s=d.d2R(s);var a=U.eccentricity(t),o=(t-2451545)/36525,l=d.m360(119.75+131.849*o);l=d.d2R(l);var h=d.m360(53.09+479264.29*o);h=d.d2R(h);var u=d.m360(313.45+481266.484*o);u=d.d2R(u);var c=qn.length;console.assert(Zn.length===c);for(var _=0,g=0;g<c;g++){var f=Zn[g]*Math.sin(qn[g].d*i+qn[g].m*n+qn[g].mdash*r+qn[g].f*s);qn[g].m&&(f*=a),_+=f}return _-=2235*Math.sin(e),_+=382*Math.sin(u),_+=175*Math.sin(l-s),_+=175*Math.sin(l+s),_+=127*Math.sin(e-r),(_-=115*Math.sin(e+r))/1e6},Kn.radiusVector=function(t){var e=Kn.meanLongitude(t);e=d.d2R(e);var i=Kn.meanElongation(t);i=d.d2R(i);var n=U.sunMeanAnomaly(t);n=d.d2R(n);var r=Kn.meanAnomaly(t);r=d.d2R(r);var s=Kn.argumentOfLatitude(t);s=d.d2R(s);var a=U.eccentricity(t),o=(t-2451545)/36525,l=d.m360(119.75+131.849*o);l=d.d2R(l);var h=d.m360(53.09+479264.29*o);h=d.d2R(h);var u=d.m360(313.45+481266.484*o);u=d.d2R(u);var c=jn.length;console.assert(Wn.length===c);for(var _=0,g=0;g<c;g++){var f=Wn[g].b*Math.cos(jn[g].d*i+jn[g].m*n+jn[g].mdash*r+jn[g].f*s);jn[g].m&&(f*=a),_+=f}return 385000.56+_/1e3},Kn.radiusVectorToHorizontalParallax=function(t){return d.r2D(Math.asin(6378.14/t))},Kn.horizontalParallaxToRadiusVector=function(t){return 6378.14/Math.sin(d.d2R(t))},n("CAAMoon",[Kn,{},null]),Jn.geocentricElongation=function(t,e,i,n){return t=d.d2R(15*t),i=d.d2R(15*i),e=d.d2R(e),n=d.d2R(n),d.r2D(Math.acos(Math.sin(n)*Math.sin(e)+Math.cos(n)*Math.cos(e)*Math.cos(i-t)))},Jn.phaseAngle=function(t,e,i){return t=d.d2R(t),d.m360(d.r2D(Math.atan2(i*Math.sin(t),e-i*Math.cos(t))))},Jn.illuminatedFraction=function(t){return t=d.d2R(t),(1+Math.cos(t))/2},Jn.positionAngle=function(t,e,i,n){return t=d.h2R(t),i=d.h2R(i),e=d.d2R(e),n=d.d2R(n),d.m360(d.r2D(Math.atan2(Math.cos(e)*Math.sin(t-i),Math.sin(e)*Math.cos(n)-Math.cos(e)*Math.sin(n)*Math.cos(t-i))))},n("MIFR",[Jn,{},null]),Qn.k=function(t){return 13.4223*(t-2000.05)},Qn.passageThroNode=function(t){var e=t/1342.23,i=e*e,n=i*e,r=n*e,s=d.m360(183.638+331.73735682*t+.0014852*i+209e-8*n-1e-8*r),a=d.m360(17.4006+26.8203725*t+1186e-7*i+6e-8*n),o=d.m360(38.3776+355.52747313*t+.0123499*i+14627e-9*n-69e-9*r),l=d.m360(123.9767-1.44098956*t+.0020608*i+214e-8*n-16e-9*r),h=d.m360(299.75+132.85*e-.009173*i),u=d.m360(l+272.75-2.3*e),c=1-.002516*e-74e-7*i,_=2*(s=d.d2R(s)),g=_*_;a=d.d2R(a);var f=2*(o=d.d2R(o));return l=d.d2R(l),h=d.d2R(h),u=d.d2R(u),2451565.1619+27.212220817*t+2762e-7*i+21e-9*n-88e-12*r-.4721*Math.sin(o)-.1649*Math.sin(_)-.0868*Math.sin(_-o)+.0084*Math.sin(_+o)-.0083*c*Math.sin(_-a)-.0039*c*Math.sin(_-a-o)+.0034*Math.sin(f)-.0031*Math.sin(_-f)+.003*c*Math.sin(_+a)+.0028*c*Math.sin(a-o)+.0026*c*Math.sin(a)+.0025*Math.sin(g)+.0024*Math.sin(s)+.0022*c*Math.sin(a+o)+.0017*Math.sin(l)+.0014*Math.sin(g-o)+5e-4*c*Math.sin(_+a-o)+4e-4*c*Math.sin(_-a+o)-3e-4*c*Math.sin(_-a*a)+3e-4*c*Math.sin(g-a)+3e-4*Math.sin(h)+3e-4*Math.sin(u)},n("CAAMoonNodes",[Qn,{},null]),n("MPAC",[tr,{},null]);const er=[new tr(2,0,0,-1.6769,0),new tr(4,0,0,.4589,0),new tr(6,0,0,-.1856,0),new tr(8,0,0,.0883,0),new tr(2,-1,0,-.0773,19e-5),new tr(0,1,0,.0502,-13e-5),new tr(10,0,0,-.046,0),new tr(4,-1,0,.0422,-11e-5),new tr(6,-1,0,-.0256,0),new tr(12,0,0,.0253,0),new tr(1,0,0,.0237,0),new tr(8,-1,0,.0162,0),new tr(14,0,0,-.0145,0),new tr(0,0,2,.0129,0),new tr(3,0,0,-.0112,0),new tr(10,-1,0,-.0104,0),new tr(16,0,0,.0086,0),new tr(12,-1,0,.0069,0),new tr(5,0,0,.0066,0),new tr(2,0,2,-.0053,0),new tr(18,0,0,-.0052,0),new tr(14,-1,0,-.0046,0),new tr(7,0,0,-.0041,0),new tr(2,1,0,.004,0),new tr(20,0,0,.0032,0),new tr(1,1,0,-.0032,0),new tr(16,-1,0,.0031,0),new tr(4,1,0,-.0029,0),new tr(9,0,0,.0027,0),new tr(4,0,2,.0027,0),new tr(2,-2,0,-.0027,0),new tr(4,-2,0,.0024,0),new tr(6,-2,0,-.0021,0),new tr(22,0,0,-.0021,0),new tr(18,-1,0,-.0021,0),new tr(6,1,0,.0019,0),new tr(11,0,0,-.0018,0),new tr(8,1,0,-.0014,0),new tr(4,0,-2,-.0014,0),new tr(6,0,2,-.0014,0),new tr(3,1,0,.0014,0),new tr(5,1,0,-.0014,0),new tr(13,0,0,.0013,0),new tr(20,-1,0,.0013,0),new tr(3,2,0,.0011,0),new tr(4,-2,2,-.0011,0),new tr(1,2,0,-.0011,0),new tr(22,-1,0,-9e-4,0),new tr(0,0,4,-8e-4,0),new tr(6,0,-2,8e-4,0),new tr(2,1,-2,8e-4,0),new tr(0,2,0,7e-4,0),new tr(0,-1,2,7e-4,0),new tr(2,0,4,7e-4,0),new tr(0,-2,2,-6e-4,0),new tr(2,2,-2,-6e-4,0),new tr(24,0,0,6e-4,0),new tr(4,0,-4,5e-4,0),new tr(2,2,0,5e-4,0),new tr(1,-1,0,-4e-4,0)],ir=[new tr(2,0,0,.4392,0),new tr(4,0,0,.0684,0),new tr(0,1,0,.0456,-11e-5),new tr(2,-1,0,.0426,-11e-5),new tr(0,0,2,.0212,0),new tr(1,0,0,-.0189,0),new tr(6,0,0,.0144,0),new tr(4,-1,0,.0113,0),new tr(2,0,2,.0047,0),new tr(1,1,0,.0036,0),new tr(8,0,0,.0035,0),new tr(6,-1,0,.0034,0),new tr(2,0,-2,-.0034,0),new tr(2,-2,0,.0022,0),new tr(3,0,0,-.0017,0),new tr(4,0,2,.0013,0),new tr(8,-1,0,.0011,0),new tr(4,-2,0,.001,0),new tr(10,0,0,9e-4,0),new tr(3,1,0,7e-4,0),new tr(0,2,0,6e-4,0),new tr(2,1,0,5e-4,0),new tr(2,2,0,5e-4,0),new tr(6,0,2,4e-4,0),new tr(6,-2,0,4e-4,0),new tr(10,-1,0,4e-4,0),new tr(5,0,0,-4e-4,0),new tr(4,0,-2,-4e-4,0),new tr(0,1,2,3e-4,0),new tr(12,0,0,3e-4,0),new tr(2,-1,2,3e-4,0),new tr(1,-1,0,-3e-4,0)],nr=[new tr(2,0,0,63.224,0),new tr(4,0,0,-6.99,0),new tr(2,-1,0,2.834,0),new tr(2,-1,0,0,-.0071),new tr(6,0,0,1.927,0),new tr(1,0,0,-1.263,0),new tr(8,0,0,-.702,0),new tr(0,1,0,.696,0),new tr(0,1,0,0,-.0017),new tr(0,0,2,-.69,0),new tr(4,-1,0,-.629,0),new tr(4,-1,0,0,.0016),new tr(2,0,-2,-.392,0),new tr(10,0,0,.297,0),new tr(6,-1,0,.26,0),new tr(3,0,0,.201,0),new tr(2,1,0,-.161,0),new tr(1,1,0,.157,0),new tr(12,0,0,-.138,0),new tr(8,-1,0,-.127,0),new tr(2,0,2,.104,0),new tr(2,-2,0,.104,0),new tr(5,0,0,-.079,0),new tr(14,0,0,.068,0),new tr(10,-1,0,.067,0),new tr(4,1,0,.054,0),new tr(12,-1,0,-.038,0),new tr(4,-2,0,-.038,0),new tr(7,0,0,.037,0),new tr(4,0,2,-.037,0),new tr(16,0,0,-.035,0),new tr(3,1,0,-.03,0),new tr(1,-1,0,.029,0),new tr(6,1,0,-.025,0),new tr(0,2,0,.023,0),new tr(14,-1,0,.023,0),new tr(2,2,0,-.023,0),new tr(6,-2,0,.022,0),new tr(2,-1,-2,-.021,0),new tr(9,0,0,-.02,0),new tr(18,0,0,.019,0),new tr(6,0,2,.017,0),new tr(0,-1,2,.014,0),new tr(16,-1,0,-.014,0),new tr(4,0,-20,.013,0),new tr(8,1,0,.012,0),new tr(11,0,0,.011,0),new tr(5,1,0,.01,0),new tr(20,0,0,-.01,0)],rr=[new tr(2,0,0,-9.147,0),new tr(1,0,0,-.841,0),new tr(0,0,2,.697,0),new tr(0,1,0,-.656,.0016),new tr(4,0,0,.355,0),new tr(2,-1,0,.159,0),new tr(1,1,0,.127,0),new tr(4,-1,0,.065,0),new tr(6,0,0,.052,0),new tr(2,1,0,.043,0),new tr(2,0,2,.031,0),new tr(2,0,-2,-.023,0),new tr(2,-2,0,.022,0),new tr(2,2,0,.019,0),new tr(0,2,0,-.016,0),new tr(6,-1,0,.014,0),new tr(8,0,0,.01,0)];function sr(){}function ar(){}function or(){}function lr(){this.lambda=0,this.beta=0,this.semidiameter=0,this.lambda=0,this.beta=0,this.semidiameter=0}sr.k=function(t){return 13.2555*(t-1999.97)},sr.meanPerigee=function(t){var e=t/1325.55,i=e*e,n=i*e;return 2451534.6698+27.55454989*t-6691e-7*i-1098e-9*n+n*e*5.2e-9},sr.meanApogee=function(t){return sr.meanPerigee(t)},sr.truePerigee=function(t){var e=sr.meanPerigee(t),i=t/1325.55,n=i*i,r=n*i,s=r*i,a=d.m360(171.9179+335.9106046*t-.0100383*n-1156e-8*r+55e-9*s);a=d.d2R(a);var o=d.m360(347.3477+27.1577721*t-813e-6*n-1e-6*r);o=d.d2R(o);var l=d.m360(316.6109+364.5287911*t-.0125053*n-148e-7*r);l=d.d2R(l);for(var h=er.length,u=0,c=0;c<h;c++)u+=er[c].c*Math.sin(a*er[c].d+o*er[c].m+l*er[c].f+i*er[c].t);return e+u},sr.trueApogee=function(t){var e=sr.meanApogee(t),i=t/1325.55,n=i*i,r=n*i,s=r*i,a=d.m360(171.9179+335.9106046*t-.0100383*n-1156e-8*r+55e-9*s);a=d.d2R(a);var o=d.m360(347.3477+27.1577721*t-813e-6*n-1e-6*r);o=d.d2R(o);var l=d.m360(316.6109+364.5287911*t-.0125053*n-148e-7*r);l=d.d2R(l);for(var h=ir.length,u=0,c=0;c<h;c++)u+=(ir[c].c+i*ir[c].t)*Math.sin(a*ir[c].d+o*ir[c].m+l*ir[c].f);return e+u},sr.perigeeParallax=function(t){var e=t/1325.55,i=e*e,n=i*e,r=n*e,s=d.m360(171.9179+335.9106046*t-.0100383*i-1156e-8*n+55e-9*r);s=d.d2R(s);var a=d.m360(347.3477+27.1577721*t-813e-6*i-1e-6*n);a=d.d2R(a);var o=d.m360(316.6109+364.5287911*t-.0125053*i-148e-7*n);o=d.d2R(o);for(var l=nr.length,h=3629.215,u=0;u<l;u++)h+=(nr[u].c+e*nr[u].t)*Math.cos(s*nr[u].d+a*nr[u].m+o*nr[u].f);return h/3600},sr.apogeeParallax=function(t){var e=t/1325.55,i=e*e,n=i*e,r=n*e,s=d.m360(171.9179+335.9106046*t-.0100383*i-1156e-8*n+55e-9*r);s=d.d2R(s);var a=d.m360(347.3477+27.1577721*t-813e-6*i-1e-6*n);a=d.d2R(a);var o=d.m360(316.6109+364.5287911*t-.0125053*i-148e-7*n);o=d.d2R(o);for(var l=rr.length,h=3245.251,u=0;u<l;u++)h+=(rr[u].c+e*rr[u].t)*Math.cos(s*rr[u].d+a*rr[u].m+o*rr[u].f);return h/3600},n("CAAMoonPerigeeApogee",[sr,{},null]),ar.k=function(t){return 12.3685*(t-2e3)},ar.meanPhase=function(t){var e=t/1236.85,i=e*e,n=i*e;return 2451550.09766+29.530588861*t+15437e-8*i-15e-8*n+n*e*7.3e-10},ar.truePhase=function(t){var e=ar.meanPhase(t),i=t/1236.85,n=i*i,r=n*i,s=r*i,a=1-.002516*i-74e-7*n,o=a*a,l=d.m360(2.5534+29.1053567*t-14e-7*n-11e-8*r);l=d.d2R(l);var h=d.m360(201.5643+385.81693528*t+.0107582*n+1238e-8*r-58e-9*s);h=d.d2R(h);var u=d.m360(160.7108+390.67050284*t-.0016118*n-227e-8*r+1e-8*s);u=d.d2R(u);var c=d.m360(124.7746-1.56375588*t+.0020672*n+215e-8*r);c=d.d2R(c);var _=d.m360(299.77+.107408*t-.009173*n);_=d.d2R(_);var g=d.m360(251.88+.016321*t);g=d.d2R(g);var f=d.m360(251.83+26.651886*t);f=d.d2R(f);var m=d.m360(349.42+36.412478*t);m=d.d2R(m);var p=d.m360(84.66+18.206239*t);p=d.d2R(p);var w=d.m360(141.74+53.303771*t);w=d.d2R(w);var b=d.m360(207.14+2.453732*t);b=d.d2R(b);var v=d.m360(154.84+7.30686*t);v=d.d2R(v);var y=d.m360(34.52+27.261239*t);y=d.d2R(y);var S=d.m360(207.19+.121824*t);S=d.d2R(S);var x=d.m360(291.34+1.844379*t);x=d.d2R(x);var T=d.m360(161.72+24.198154*t);T=d.d2R(T);var M=d.m360(239.56+25.513099*t);M=d.d2R(M);var C=d.m360(331.55+3.592518*t);C=d.d2R(C);var A=t-Math.floor(t);if(A<0&&(A=1+A),A)if(.25===A||.75===A){e+=-.62801*Math.sin(h)+.17172*a*Math.sin(l)+-.01183*a*Math.sin(h+l)+.00862*Math.sin(2*h)+.00804*Math.sin(2*u)+.00454*a*Math.sin(h-l)+.00204*o*Math.sin(2*l)+-.0018*Math.sin(h-2*u)+-7e-4*Math.sin(h+2*u)+-4e-4*Math.sin(3*h)+-34e-5*a*Math.sin(2*h-l)+32e-5*a*Math.sin(l+2*u)+32e-5*a*Math.sin(l-2*u)+-28e-5*o*Math.sin(h+2*l)+27e-5*a*Math.sin(2*h+l)+-17e-5*Math.sin(c)+-5e-5*Math.sin(h-l-2*u)+4e-5*Math.sin(2*h+2*u)+-4e-5*Math.sin(h+l+2*u)+4e-5*Math.sin(h-2*l)+3e-5*Math.sin(h+l-2*u)+3e-5*Math.sin(3*l)+2e-5*Math.sin(2*h-2*u)+2e-5*Math.sin(h-l+2*u)+-2e-5*Math.sin(3*h+l);var L=.00306-38e-5*a*Math.cos(l)+26e-5*Math.cos(h)-2e-5*Math.cos(h-l)+2e-5*Math.cos(h+l)+2e-5*Math.cos(2*u);.25===A?e+=L:e-=L}else.5===A?e+=-.40614*Math.sin(h)+.17302*a*Math.sin(l)+.01614*Math.sin(2*h)+.01043*Math.sin(2*u)+.00734*a*Math.sin(h-l)+-.00514*a*Math.sin(h+l)+.00209*o*Math.sin(2*l)+-.00111*Math.sin(h-2*u)+-57e-5*Math.sin(h+2*u)+56e-5*a*Math.sin(2*h+l)+-42e-5*Math.sin(3*h)+42e-5*a*Math.sin(l+2*u)+38e-5*a*Math.sin(l-2*u)+-24e-5*a*Math.sin(2*h-l)+-17e-5*Math.sin(c)+-7e-5*Math.sin(h+2*l)+4e-5*Math.sin(2*h-2*u)+4e-5*Math.sin(3*l)+3e-5*Math.sin(h+l-2*u)+3e-5*Math.sin(2*h+2*u)+-3e-5*Math.sin(h+l+2*u)+3e-5*Math.sin(h-l+2*u)+-2e-5*Math.sin(h-l-2*u)+-2e-5*Math.sin(3*h+l)+2e-5*Math.sin(4*h):console.assert(!1);else e+=-.4072*Math.sin(h)+.17241*a*Math.sin(l)+.01608*Math.sin(2*h)+.01039*Math.sin(2*u)+.00739*a*Math.sin(h-l)+-.00514*a*Math.sin(h+l)+.00208*o*Math.sin(2*l)+-.00111*Math.sin(h-2*u)+-57e-5*Math.sin(h+2*u)+56e-5*a*Math.sin(2*h+l)+-42e-5*Math.sin(3*h)+42e-5*a*Math.sin(l+2*u)+38e-5*a*Math.sin(l-2*u)+-24e-5*a*Math.sin(2*h-l)+-17e-5*Math.sin(c)+-7e-5*Math.sin(h+2*l)+4e-5*Math.sin(2*h-2*u)+4e-5*Math.sin(3*l)+3e-5*Math.sin(h+l-2*u)+3e-5*Math.sin(2*h+2*u)+-3e-5*Math.sin(h+l+2*u)+3e-5*Math.sin(h-l+2*u)+-2e-5*Math.sin(h-l-2*u)+-2e-5*Math.sin(3*h+l)+2e-5*Math.sin(4*h);return e+(325e-6*Math.sin(_)+165e-6*Math.sin(g)+164e-6*Math.sin(f)+126e-6*Math.sin(m)+11e-5*Math.sin(p)+62e-6*Math.sin(w)+6e-5*Math.sin(b)+56e-6*Math.sin(v)+47e-6*Math.sin(y)+42e-6*Math.sin(S)+4e-5*Math.sin(x)+37e-6*Math.sin(T)+35e-6*Math.sin(M)+23e-6*Math.sin(C))},n("CAAMoonPhases",[ar,{},null]),or.meanGreenwichSiderealTime=function(e){var i=new h;i.setJD(e,h.afterPapalReformJD(e));var n=i.get(),r=t.ss.truncate(n[0]),s=t.ss.truncate(n[1]),a=t.ss.truncate(n[2]),o=t.ss.truncate(n[3]),l=t.ss.truncate(n[4]),u=n[5];i.set(r,s,a,0,0,0,i.inGregorianCalendar());var c=(i.julian()-2451545)/36525,_=c*c,g=100.46061837+36000.770053608*c+387933e-9*_-_*c/3871e4;return g+=1.00273790935*(15*o+.25*l+.00416666666666667*u),g=d.d2H(g),d.m24(g)},or.apparentGreenwichSiderealTime=function(t){var e=X.meanObliquityOfEcliptic(t)+X.nutationInObliquity(t)/3600,i=X.nutationInLongitude(t),n=or.meanGreenwichSiderealTime(t)+i*Math.cos(d.d2R(e))/54e3;return d.m24(n)},n("CAASidereal",[or,{},null]),n("CAATopocentricEclipticDetails",[lr,{},null]);const hr=Math.sin(d.d2R(d.dmS2D(0,0,8.794)));function ur(){}function cr(){this.DE=0,this.DS=0,this.geometricw1=0,this.geometricw2=0,this.apparentw1=0,this.apparentw2=0,this.p=0,this.DE=0,this.DS=0,this.geometricw1=0,this.geometricw2=0,this.apparentw1=0,this.apparentw2=0,this.p=0}function _r(){}function dr(){this.DE=0,this.DS=0,this.w=0,this.p=0,this.x=0,this.k=0,this.q=0,this.d=0,this.DE=0,this.DS=0,this.w=0,this.p=0,this.x=0,this.k=0,this.q=0,this.d=0}function gr(){}function fr(){this.p=0,this.b0=0,this.l0=0,this.p=0,this.b0=0,this.l0=0}function mr(){}function pr(){}function wr(){this.bValid=!1,this.rise=0,this.transit=0,this.set=0,this.bValid=!1,this.rise=0,this.transit=0,this.set=0}function br(){}function vr(){this.b=0,this.bdash=0,this.p=0,this.a=0,this.b=0,this.deltaU=0,this.b=0,this.bdash=0,this.p=0,this.a=0,this.b=0,this.deltaU=0}function yr(){}function Sr(){}function xr(){this._switchedTime=new Date(1990,0,0,0,0,0,0),this._state=!1,this._targetState=this._state,this._delayTime=1e3}ur.equatorial2TopocentricDelta=function(t,e,i,n,r,s,a){var o=On.rhoSinThetaPrime(r,s),l=On.rhoCosThetaPrime(r,s),h=or.apparentGreenwichSiderealTime(a);e=d.d2R(e);var u=Math.cos(e),_=Math.asin(hr/i),g=d.h2R(h-n/15-t),f=Math.cos(g),m=Math.sin(g),p=new c;return p.x=d.r2H(-_*l*m/u),p.y=d.r2D(-_*(o*u-l*f*Math.sin(e))),p},ur.equatorial2Topocentric=function(t,e,i,n,r,s,a){var o=On.rhoSinThetaPrime(r,s),l=On.rhoCosThetaPrime(r,s),h=or.apparentGreenwichSiderealTime(a);e=d.d2R(e);var u=Math.cos(e),_=Math.asin(hr/i),g=Math.sin(_),f=d.h2R(h-n/15-t),m=Math.cos(f),p=Math.sin(f),w=Math.atan2(-l*g*p,u-l*g*m),b=new c;return b.x=d.m24(t+d.r2H(w)),b.y=d.r2D(Math.atan2((Math.sin(e)-o*g)*Math.cos(w),u-l*g*m)),b},ur.ecliptic2Topocentric=function(t,e,i,n,r,s,a,o,l){var h=On.rhoSinThetaPrime(a,o),u=On.rhoCosThetaPrime(a,o);t=d.d2R(t),e=d.d2R(e),r=d.d2R(r),s=d.d2R(s),a=d.d2R(a),i=d.d2R(i);var c=Math.sin(r),_=Math.cos(r),g=Math.cos(e),f=Math.sin(e),m=or.apparentGreenwichSiderealTime(l);m=d.h2R(m);var p=Math.sin(m),w=Math.asin(hr/n),b=Math.sin(w),v=Math.cos(t)*g-u*b*Math.cos(m),y=new lr;y.lambda=Math.atan2(Math.sin(t)*g-b*(h*c+u*_*p),v);var S=Math.cos(y.lambda);return y.beta=Math.atan(S*(f-b*(h*_-u*c*p))/v),y.semidiameter=Math.asin(S*Math.cos(y.beta)*Math.sin(i)/v),y.semidiameter=d.r2D(y.semidiameter),y.lambda=d.m360(d.r2D(y.lambda)),y.beta=d.r2D(y.beta),y},ur.parallaxToDistance=function(t){return hr/Math.sin(d.d2R(t))},ur.distanceToParallax=function(t){var e=Math.asin(hr/t);return d.r2D(e)},n("CAAParallax",[ur,{},null]),n("CAAPhysicalJupiterDetails",[cr,{},null]),_r.calculate=function(t){var e=new cr,i=t-2433282.5,n=i/36525,r=268+.1061*n,s=d.d2R(r),a=64.5-.0164*n,o=d.d2R(a),l=d.m360(17.71+877.90003539*i),h=d.m360(16.838+870.27003539*i),u=U.eclipticLongitude(t),c=d.d2R(u),_=U.eclipticLatitude(t),g=d.d2R(_),f=U.radiusVector(t),m=ae.eclipticLongitude(t),p=d.d2R(m),w=ae.eclipticLatitude(t),b=d.d2R(w),v=ae.radiusVector(t),y=v*Math.cos(b)*Math.cos(p)-f*Math.cos(c),S=v*Math.cos(b)*Math.sin(p)-f*Math.sin(c),x=v*Math.sin(b)-f*Math.sin(g),T=Math.sqrt(y*y+S*S+x*x);m-=.01299*T/(v*v),p=d.d2R(m),y=v*Math.cos(b)*Math.cos(p)-f*Math.cos(c),S=v*Math.cos(b)*Math.sin(p)-f*Math.sin(c),x=v*Math.sin(b)-f*Math.sin(g),T=Math.sqrt(y*y+S*S+x*x);var M=X.meanObliquityOfEcliptic(t),C=d.d2R(M),A=Math.atan2(Math.cos(C)*Math.sin(p)-Math.sin(C)*Math.tan(b),Math.cos(p)),L=Math.asin(Math.cos(C)*Math.sin(b)+Math.sin(C)*Math.cos(b)*Math.sin(p));e.DS=d.r2D(Math.asin(-Math.sin(o)*Math.sin(L)-Math.cos(o)*Math.cos(L)*Math.cos(s-A)));var I=S*Math.cos(C)-x*Math.sin(C),k=S*Math.sin(C)+x*Math.cos(C),P=Math.atan2(I,y),R=d.r2D(P),E=Math.atan2(k,Math.sqrt(y*y+I*I)),D=d.r2D(E),F=Math.atan2(Math.sin(o)*Math.cos(E)*Math.cos(s-P)-Math.sin(E)*Math.cos(o),Math.cos(E)*Math.sin(s-P));e.DE=d.r2D(Math.asin(-Math.sin(o)*Math.sin(E)-Math.cos(o)*Math.cos(E)*Math.cos(s-P))),e.geometricw1=d.m360(l-d.r2D(F)-5.07033*T),e.geometricw2=d.m360(h-d.r2D(F)-5.02626*T);var N=57.2958*(2*v*T+f*f-v*v-T*T)/(4*v*T);Math.sin(p-c)>0?(e.apparentw1=d.m360(e.geometricw1+N),e.apparentw2=d.m360(e.geometricw2+N)):(e.apparentw1=d.m360(e.geometricw1-N),e.apparentw2=d.m360(e.geometricw2-N));var $=X.nutationInLongitude(t),z=X.nutationInObliquity(t);M+=z/3600,C=d.d2R(M),R+=.005693*(Math.cos(P)*Math.cos(c)*Math.cos(C)+Math.sin(P)*Math.sin(c))/Math.cos(E),R=d.m360(R),P=d.d2R(R),D+=.005693*(Math.cos(c)*Math.cos(C)*(Math.tan(C)*Math.cos(E)-Math.sin(P)*Math.sin(E))+Math.cos(P)*Math.sin(E)*Math.sin(c)),E=d.d2R(D);var B=X.nutationInRightAscension(R/15,D,M,$,z),V=R+B/3600,O=d.d2R(V),G=X.nutationInDeclination(R/15,D,M,$,z),H=D+G/3600,Y=d.d2R(H),j=r+(B=X.nutationInRightAscension(r/15,a,M,$,z))/3600,W=d.d2R(j),q=a+(G=X.nutationInDeclination(r/15,a,M,$,z))/3600,Z=d.d2R(q);return e.p=d.m360(d.r2D(Math.atan2(Math.cos(Z)*Math.sin(W-O),Math.sin(Z)*Math.cos(Y)-Math.cos(Z)*Math.sin(Y)*Math.cos(W-O)))),e},n("CAAPhysicalJupiter",[_r,{},null]),n("CAAPhysicalMarsDetails",[dr,{},null]),gr.calculate=function(t){for(var e=new dr,i=(t-2451545)/36525,n=352.9065+1.1733*i,r=d.d2R(n),s=63.2818-.00394*i,a=d.d2R(s),o=U.eclipticLongitude(t),l=d.d2R(o),h=U.eclipticLatitude(t),u=d.d2R(h),c=U.radiusVector(t),_=0,g=0,f=0,m=0,p=0,w=!0,b=0,v=0,y=0,S=0,x=0,T=0;w;){var M=t-g;v=Vt.eclipticLongitude(M),y=d.d2R(v),S=Vt.eclipticLatitude(M),x=d.d2R(S),f=(T=Vt.radiusVector(M))*Math.cos(x)*Math.cos(y)-c*Math.cos(l),m=T*Math.cos(x)*Math.sin(y)-c*Math.sin(l),p=T*Math.sin(x)-c*Math.sin(u),b=Math.sqrt(f*f+m*m+p*p),g=$n.distanceToLightTime(b),(w=Math.abs(g-_)>2e-6)&&(_=g)}var C=Math.atan2(m,f),A=d.r2D(C),L=Math.atan2(p,Math.sqrt(f*f+m*m)),I=d.r2D(L);e.DE=d.r2D(Math.asin(-Math.sin(a)*Math.sin(L)-Math.cos(a)*Math.cos(L)*Math.cos(r-C)));var k=49.5581+.7721*i,P=d.d2R(k),R=v-.00697/T,E=d.d2R(R),D=S-Math.cos(y-P)/T*225e-6,F=d.d2R(D);e.DS=d.r2D(Math.asin(-Math.sin(a)*Math.sin(F)-Math.cos(a)*Math.cos(F)*Math.cos(r-E)));var N=d.m360(11.504+350.89200025*(t-g-2433282.5)),$=X.meanObliquityOfEcliptic(t),z=d.d2R($),B=d.ec2Eq(n,s,$),V=d.h2R(B.x),O=d.d2R(B.y),G=m*Math.cos(z)-p*Math.sin(z),Y=m*Math.sin(z)+p*Math.cos(z),j=Math.atan2(G,f),W=d.r2H(j),q=Math.atan2(Y,Math.sqrt(f*f+G*G)),Z=d.r2D(q),K=Math.atan2(Math.sin(O)*Math.cos(q)*Math.cos(V-j)-Math.sin(q)*Math.cos(O),Math.cos(q)*Math.sin(V-j));e.w=d.m360(N-d.r2D(K));var J=X.nutationInLongitude(t),Q=X.nutationInObliquity(t);A+=.005693*Math.cos(l-C)/Math.cos(L),I+=.005693*Math.sin(l-C)*Math.sin(L),n+=J/3600,r=d.d2R(n),A+=J/3600,C=d.d2R(A),$+=Q/3600,z=d.d2R(z);var tt=d.ec2Eq(n,s,$),et=d.h2R(tt.x),it=d.d2R(tt.y),nt=d.ec2Eq(A,I,$),rt=d.h2R(nt.x),st=d.d2R(nt.y);e.p=d.m360(d.r2D(Math.atan2(Math.cos(it)*Math.sin(et-rt),Math.sin(it)*Math.cos(st)-Math.cos(it)*Math.sin(st)*Math.cos(et-rt))));var at=H.geometricEclipticLongitude(t),ot=H.geometricEclipticLatitude(t),lt=d.ec2Eq(at,ot,$);return e.x=Jn.positionAngle(lt.x,lt.y,W,Z),e.d=9.36/b,e.k=Gn.illuminatedFraction2(T,c,b),e.q=(1-e.k)*e.d,e},n("CAAPhysicalMars",[gr,{},null]),n("CAAPhysicalSunDetails",[fr,{},null]),mr.calculate=function(t){var e=d.m360(360*(t-2398220)/25.38),i=7.25,n=73.6667+1.3958333*(t-2396758)/36525,r=U.eclipticLongitude(t),s=U.radiusVector(t),a=r+180-d.dmS2D(0,0,20.4898/s),o=a+d.dmS2D(0,0,X.nutationInLongitude(t)),l=X.trueObliquityOfEcliptic(t);l=d.d2R(l),a=d.d2R(a),o=d.d2R(o),n=d.d2R(n),i=d.d2R(i),e=d.d2R(e);var h=Math.atan(-Math.cos(a)*Math.tan(l)),u=Math.atan(-Math.cos(a-n)*Math.tan(i)),c=new fr;c.p=d.r2D(h+u),c.b0=d.r2D(Math.asin(Math.sin(a-n)*Math.sin(i)));var _=Math.atan(Math.tan(a-n)*Math.cos(i));return c.l0=d.m360(d.r2D(_-e)),c},mr.timeOfStartOfRotation=function(t){var e=2398140.227+27.2752316*t,i=d.m360(281.96+26.882476*t);return i=d.d2R(i),e+(.1454*Math.sin(i)-.0085*Math.sin(2*i)-.0141*Math.cos(2*i))},n("CAAPhysicalSun",[mr,{},null]),pr.precessEquatorial=function(t,e,i,n){var r=(i-2451545)/36525,s=r*r,a=(n-i)/36525,o=a*a,l=o*a;t=d.h2R(t),e=d.d2R(e);var h=(2306.2181+1.39656*r-139e-6*s)*a+(.30188-344e-7*r)*o+.017988*l;h=d.d2R(d.dmS2D(0,0,h));var u=(2306.2181+1.39656*r-138e-6*s)*a+(1.09468+66e-6*r)*o+.018203*l;u=d.d2R(d.dmS2D(0,0,u));var _=(2004.3109-.8533*r-217e-6*s)*a-(.42665+217e-6*r)*o-.041833*l;_=d.d2R(d.dmS2D(0,0,_));var g=Math.cos(e)*Math.sin(t+h),f=Math.cos(_)*Math.cos(e)*Math.cos(t+h)-Math.sin(_)*Math.sin(e),m=Math.sin(_)*Math.cos(e)*Math.cos(t+h)+Math.cos(_)*Math.sin(e),p=new c;return p.x=d.r2H(Math.atan2(g,f)+u),p.x<0&&(p.x+=24),p.y=d.r2D(Math.asin(m)),p},pr.precessEquatorialFK4=function(t,e,i,n){var r=(i-2415020.3135)/36524.2199,s=(n-i)/36524.2199,a=s*s,o=a*s;t=d.h2R(t),e=d.d2R(e);var l=(2304.25+1.396*r)*s+.302*a+.018*o;l=d.d2R(d.dmS2D(0,0,l));var h=.791*a+.001*o;h=d.d2R(d.dmS2D(0,0,h)),h+=l;var u=(2004.682-.853*r)*s-.426*a-.042*o;u=d.d2R(d.dmS2D(0,0,u));var _=Math.cos(e)*Math.sin(t+l),g=Math.cos(u)*Math.cos(e)*Math.cos(t+l)-Math.sin(u)*Math.sin(e),f=Math.sin(u)*Math.cos(e)*Math.cos(t+l)+Math.cos(u)*Math.sin(e),m=new c;return m.x=d.r2H(Math.atan2(_,g)+h),m.x<0&&(m.x+=24),m.y=d.r2D(Math.asin(f)),m},pr.precessEcliptic=function(t,e,i,n){var r=(i-2451545)/36525,s=r*r,a=(n-i)/36525,o=a*a,l=o*a;t=d.d2R(t),e=d.d2R(e);var h=(47.0029-.06603*r+598e-6*s)*a+(598e-6*r-.03302)*o+6e-5*l;h=d.d2R(d.dmS2D(0,0,h));var u=629554.9824+3289.4789*r+.60622*s-(869.8089+.50491*r)*a+.03536*o;u=d.d2R(d.dmS2D(0,0,u));var _=(5029.0966+2.22226*r-42e-6*s)*a+(1.11113-42e-6*r)*o-6e-6*l;_=d.d2R(d.dmS2D(0,0,_));var g=Math.cos(h)*Math.cos(e)*Math.sin(u-t)-Math.sin(h)*Math.sin(e),f=Math.cos(e)*Math.cos(u-t),m=Math.cos(h)*Math.sin(e)+Math.sin(h)*Math.cos(e)*Math.sin(u-t),p=new c;return p.x=d.r2D(_+u-Math.atan2(g,f)),p.x<0&&(p.x+=360),p.y=d.r2D(Math.asin(m)),p},pr.equatorialPMToEcliptic=function(t,e,i,n,r,s){s=d.d2R(s),t=d.h2R(t),e=d.d2R(e),i=d.d2R(i);var a=Math.cos(i),o=Math.sin(s),l=new c;return l.x=(r*o*Math.cos(t)+n*Math.cos(e)*(Math.cos(s)*Math.cos(e)+o*Math.sin(e)*Math.sin(t)))/(a*a),l.y=(r*(Math.cos(s)*Math.cos(e)+o*Math.sin(e)*Math.sin(t))-n*o*Math.cos(t)*Math.cos(e))/a,l},pr.adjustPositionUsingUniformProperMotion=function(t,e,i,n,r){var s=new c;return s.x=e+n*t/3600,s.y=i+r*t/3600,s},pr.adjustPositionUsingMotionInSpace=function(t,e,i,n,r,s,a){e/=977792,s/=13751,a/=206265,n=d.h2R(n),r=d.d2R(r);var o=t*Math.cos(r)*Math.cos(n),l=t*Math.cos(r)*Math.sin(n),h=t*Math.sin(r),u=o/t*e-h*a*Math.cos(n)-l*s,_=l/t*e-h*a*Math.sin(n)+o*s;o+=i*u,l+=i*_,h+=i*(h/t*e+t*a*Math.cos(r));var g=new c;return g.x=d.r2H(Math.atan2(l,o)),g.x<0&&(g.x+=24),g.y=d.r2D(Math.atan2(h,Math.sqrt(o*o+l*l))),g},n("CAAPrecession",[pr,{},null]),n("CAARiseTransitSetDetails",[wr,{},null]),br.rise=function(t,e,i,n,r,s,a,o,l,h){var u=new wr;u.bValid=!1;var c=or.apparentGreenwichSiderealTime(t);c*=15;var _=fi.deltaT(t),g=d.d2R(r),f=d.d2R(l),m=d.d2R(h),p=(Math.sin(m)-Math.sin(f)*Math.sin(g))/(Math.cos(f)*Math.cos(g));if(p>1||p<-1)return u;var w=Math.acos(p),b=(15*n+o-c)/360,v=b-(w=d.r2D(w))/360,y=b+w/360;b>1?b-=1:b<0&&(b+=1),v>1?v-=1:v<0&&(v+=1),y>1?y-=1:y<0&&(y+=1);for(var S=0;S<2;S++){var x=c+360.985647*v;x=d.m360(x);var T=v+_/86400,M=Xn.interpolate(T,e,n,s),C=Xn.interpolate(T,i,r,a),A=x-o-15*M,L=d.eq2H(A/15,C,l),I=(L.y-h)/(360*Math.cos(d.d2R(C))*Math.cos(f)*Math.sin(d.d2R(A)));v+=I,x=c+360.985647*b,T=b+_/86400,(A=(x=d.m360(x))-o-15*(M=Xn.interpolate(T,e,n,s)))<-180&&(A+=360),b+=I=-A/360,x=c+360.985647*y,x=d.m360(x),T=y+_/86400,M=Xn.interpolate(T,e,n,s),C=Xn.interpolate(T,i,r,a),A=x-o-15*M,y+=I=((L=d.eq2H(A/15,C,l)).y-h)/(360*Math.cos(d.d2R(C))*Math.cos(f)*Math.sin(d.d2R(A)))}return u.bValid=!0,u.rise=24*v,u.set=24*y,u.transit=24*b,u},n("CAARiseTransitSet",[br,{},null]),n("CAASaturnRingDetails",[vr,{},null]),yr.calculate=function(t){var e=new vr,i=(t-2451545)/36525,n=i*i,r=28.075216-.012998*i+4e-6*n,s=d.d2R(r),a=169.50847+1.394681*i+412e-6*n,o=d.d2R(a),l=U.eclipticLongitude(t),h=U.eclipticLatitude(t);l+=V.correctionInLongitude(l,h,t);var u=d.d2R(l);h+=V.correctionInLatitude(l,t);for(var c=d.d2R(h),_=U.radiusVector(t),g=9,f=0,m=$n.distanceToLightTime(g),p=t-m,w=!0,b=0,v=0,y=0,S=0,x=0,T=0;w;){S=Me.eclipticLongitude(p),x=Me.eclipticLatitude(p),S+=V.correctionInLongitude(S,x,p),x+=V.correctionInLatitude(S,p);var M=d.d2R(S),C=d.d2R(x);b=(T=Me.radiusVector(p))*Math.cos(C)*Math.cos(M)-_*Math.cos(u),v=T*Math.cos(C)*Math.sin(M)-_*Math.sin(u),y=T*Math.sin(C)-_*Math.sin(c),g=Math.sqrt(b*b+v*v+y*y),m=$n.distanceToLightTime(g),(w=Math.abs(m-f)>2e-6)&&(p=t-m,f=m)}var A=Math.atan2(v,b),L=Math.atan2(y,Math.sqrt(b*b+v*v));e.b=Math.asin(Math.sin(s)*Math.cos(L)*Math.sin(A-o)-Math.cos(s)*Math.sin(L)),e.a=375.35/g,e.b=e.a*Math.sin(Math.abs(e.b)),e.b=d.r2D(e.b);var I=113.6655+.8771*i,k=d.d2R(I),P=S-.01759/T,R=d.d2R(P),E=x-764e-6*Math.cos(R-k)/T,D=d.d2R(E);e.bdash=d.r2D(Math.asin(Math.sin(s)*Math.cos(D)*Math.sin(R-o)-Math.cos(s)*Math.sin(D)));var F=Math.atan2(Math.sin(s)*Math.sin(D)+Math.cos(s)*Math.cos(D)*Math.sin(R-o),Math.cos(D)*Math.cos(R-o)),N=Math.atan2(Math.sin(s)*Math.sin(L)+Math.cos(s)*Math.cos(L)*Math.sin(A-o),Math.cos(L)*Math.cos(A-o));e.deltaU=d.r2D(Math.abs(F-N));var $=X.trueObliquityOfEcliptic(t),z=X.nutationInLongitude(t),B=a-90,O=90-r;A+=d.d2R(.005693*Math.cos(u-A)/Math.cos(L)),L+=d.d2R(.005693*Math.sin(u-A)*Math.sin(L)),A=d.r2D(A),A+=z/3600,A=d.m360(A),B+=z/3600,B=d.m360(B),L=d.r2D(L);var G=d.ec2Eq(A,L,$),H=d.h2R(G.x),Y=d.d2R(G.y),j=d.ec2Eq(B,O,$),W=d.h2R(j.x),q=d.d2R(j.y);return e.p=d.r2D(Math.atan2(Math.cos(q)*Math.sin(W-H),Math.sin(q)*Math.cos(Y)-Math.cos(q)*Math.sin(Y)*Math.cos(W-H))),e},n("CAASaturnRings",[yr,{},null]),Sr.combinedMagnitude=function(t,e){var i=.4*(e-t);return e-2.5*a.log10(Math.pow(10,i)+1)},Sr.combinedMagnitude2=function(t,e){for(var i=0,n=0;n<t;n++)i+=Math.pow(10,-.4*e[n]);return-2.5*a.log10(i)},Sr.brightnessRatio=function(t,e){var i=.4*(e-t);return Math.pow(10,i)},Sr.magnitudeDifference=function(t){return 2.5*a.log10(t)},n("CAAStellarMagnitudes",[Sr,{},null]),xr.create=function(t,e){var i=new xr;return i._state=t,i._targetState=t,i._delayTime=e,i};var Tr={get_state:function(){return this._targetState!==this._state?(t.ss.now()-this._switchedTime>this._delayTime&&(this._state=this._targetState),!0):this._state},set_state:function(t){return this._switchedTime=new Date(1990,0,0,0,0,0,0),this._state=t,this._targetState=this._state,t},get_targetState:function(){return this._targetState},set_targetState:function(e){return this._targetState!==e&&(this._switchedTime=t.ss.now(),this._targetState=e),e},get_opacity:function(){if(this._targetState!==this._state){var e=t.ss.now()-this._switchedTime;if(!(e>this._delayTime)){var i=e/this._delayTime;return this._targetState?i:1-i}this._state=this._targetState}return this._state?1:0},get_delayTime:function(){return this._delayTime},set_delayTime:function(t){return this._delayTime=t,t}};n("BlendState",[xr,Tr,null]);var Mr=!1;function Cr(t){Mr=!!t}var Ar=null,Lr=null,Ir=null,kr=null,Pr=null,Rr=null,Er=null,Dr=null,Fr=null,Nr={wwtFlagship:0,localhost:1,neverProxy:2,tryNoProxy:3,proxy:4},$r={asIfAbsolute:0,originRelative:1};function zr(){switch(this._origin_protocol="undefined"==typeof window?"https:":window.location.protocol,this._force_https="https:"===this._origin_protocol,this._origin_domain="undefined"==typeof window?"":window.location.hostname,this._domain_handling={},this._domain_handling["worldwidetelescope.org"]=Nr.wwtFlagship,this._domain_handling["www.worldwidetelescope.org"]=Nr.wwtFlagship,this._domain_handling["cdn.worldwidetelescope.org"]=Nr.wwtFlagship,this._domain_handling["content.worldwidetelescope.org"]=Nr.wwtFlagship,this._domain_handling["beta.worldwidetelescope.org"]=Nr.wwtFlagship,this._domain_handling["beta-cdn.worldwidetelescope.org"]=Nr.wwtFlagship,this._domain_handling["wwtstaging.azurewebsites.net"]=Nr.wwtFlagship,this._domain_handling["wwtfiles.blob.core.windows.net"]=Nr.neverProxy,this._domain_handling["wwttiles.blob.core.windows.net"]=Nr.neverProxy,this._domain_handling["web.wwtassets.org"]=Nr.neverProxy,this._domain_handling["data1.wwtassets.org"]=Nr.neverProxy,this._domain_handling.localhost=Nr.localhost,this._domain_handling["127.0.0.1"]=Nr.localhost,this._origin_domain){case"worldwidetelescope.org":case"www.worldwidetelescope.org":case"cdn.worldwidetelescope.org":default:this._core_static_baseurl=this._origin_protocol+"//cdn.worldwidetelescope.org",this._core_dynamic_baseurl=this._origin_protocol+"//worldwidetelescope.org";break;case"beta.worldwidetelescope.org":case"beta-cdn.worldwidetelescope.org":this._core_static_baseurl=this._origin_protocol+"//beta-cdn.worldwidetelescope.org",this._core_dynamic_baseurl=this._origin_protocol+"//beta.worldwidetelescope.org"}this._engine_asset_baseurl=this._origin_protocol+"//web.wwtassets.org/engine/assets",this._flagship_static_lcpaths={},this._flagship_static_lcpaths["/wwtweb/2massoct.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/bingdemtile.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/bingdemtile2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/catalog.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/catalog2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/dem.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/dembath.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/demmars.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/demtile.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/dss.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/dsstoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/dusttoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/earthblend.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/earthmerbath.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/fixedaltitudedemtile.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/g360.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/galex4far.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/galex4near.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/galextoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/gettile.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/gettour.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/gettourfile.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/gettours.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/glimpse.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/halphatoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/hirise.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/hirisedem2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/hirisedem3.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/jupiter.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/mandel.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/mandel1.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/mars.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/marsdem.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/marshirise.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/marsmoc.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/martiantile.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/martiantile2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/mipsgal.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/moondem.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/moonoct.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/moontoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/moontoastdem.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/postmars.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/postmarsdem.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/postmarsdem2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/rasstoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/sdsstoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/sdsstoast2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/sdsstoast2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/thumbnail.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/tiles.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/tiles2.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/tilesthumb.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/twomasstoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/tychooct.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/veblend.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/vlsstoast.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/wmap.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/wmsmoon.aspx"]=!0,this._flagship_static_lcpaths["/wwtweb/wmstoast.aspx"]=!0}n("URLRewriteMode",$r),r("URLRewriteMode",$r),n("URLHelpers",[zr,{overrideAssetBaseurl:function(t){this._engine_asset_baseurl=t},rewrite:function(e,i){var n,r,s,a,o=e.toLowerCase();if(t.ss.startsWith(o,"http://"))n="http:",r=e.substring(7);else if(t.ss.startsWith(o,"https://"))n="https:",r=e.substring(8);else if(t.ss.startsWith(o,"//"))n="",r=e.substring(2);else{if(t.ss.startsWith(o,"blob:"))return e;switch(i){case $r.asIfAbsolute:default:n="",r=e;break;case $r.originRelative:return e=new URL(e,window.location.href).toString(),this.rewrite(e,0)}}if(Mr)return e;var l=r.indexOf("/");l<0?(s=r,a="/"):(s=r.substring(0,l),a=r.substring(l));var h=s.toLowerCase(),u=a.toLowerCase().split("?")[0];switch(t.ss.keyExists(this._domain_handling,h)||(t.ss.startsWith(h,"localhost:")||t.ss.startsWith(h,"127.0.0.1:")?this._domain_handling[h]=Nr.localhost:this._domain_handling[h]=Nr.tryNoProxy),this._domain_handling[h]){case Nr.localhost:return e;case Nr.neverProxy:case Nr.tryNoProxy:default:return this._force_https&&"https:"!==n?"https://"+s+a:e;case Nr.proxy:return n||(e="http://"+e),e=t.ss.replaceString(t.ss.replaceString(encodeURIComponent(e),"%7B","{"),"%7D","}"),this._core_dynamic_baseurl+"/webserviceproxy.aspx?targeturl="+e;case Nr.wwtFlagship:var c=!1;return(t.ss.startsWith(u,"/data/")||t.ss.keyExists(this._flagship_static_lcpaths,u)||t.ss.startsWith(u,"/content/")||t.ss.startsWith(u,"/engine/assets/"))&&(c=!0),c?this._core_static_baseurl+a:this._core_dynamic_baseurl+a}},activateProxy:function(e){if(Mr)return null;var i,n,r=e.toLowerCase(),s=(i=t.ss.startsWith(r,"http://")?e.substring(7):t.ss.startsWith(r,"https://")?e.substring(8):t.ss.startsWith(r,"//")?e.substring(2):e).indexOf("/");n=s<0?i:i.substring(0,s).toLowerCase(),t.ss.keyExists(this._domain_handling,n)||(t.ss.startsWith(n,"localhost:")||t.ss.startsWith(n,"127.0.0.1:")?this._domain_handling[n]=Nr.localhost:this._domain_handling[n]=Nr.tryNoProxy);var a=this._domain_handling[n];return a===Nr.wwtFlagship||a===Nr.neverProxy||a===Nr.localhost?null:(this._domain_handling[n]=Nr.proxy,this.rewrite(e,0))},engineAssetUrl:function(e){return t.ss.format("{0}/{1}",this._engine_asset_baseurl,e)},coreDynamicUrl:function(e){return t.ss.format("{0}/{1}",this._core_dynamic_baseurl,e)},coreStaticUrl:function(e){return t.ss.format("{0}/{1}",this._core_static_baseurl,e)}},null]),zr.singleton=new zr;var Br=new Un,Ur=new Dn,Vr=new cr,Or=0;function Gr(t,e,i,n,r){this.RA=0,this.dec=0,this.distance=0,this.shadow=!1,this.eclipsed=!1,this.RA=t,this.dec=e,this.distance=i,this.shadow=n,this.eclipsed=r}function Xr(t,e,i,n,r){this.bValid=!1,this.rise=0,this.transit=0,this.set=0,this.bNeverRises=!1,this.bValid=t,this.rise=e,this.transit=i,this.set=n,this.bNeverRises=r}function Hr(){}n("AstroRaDec",[Gr,{},null]),n("RiseSetDetails",[Xr,{},null]),Hr.getPlanet=function(t,e,i,n,r){var s=e;if(n=-n,s<9){var a=$n.calculate(t,e);return new Gr((_=ur.equatorial2Topocentric(a.apparentGeocentricRA,a.apparentGeocentricDeclination,a.apparentGeocentricDistance,n,i,r,t)).x,_.y,a.apparentGeocentricDistance,!1,!1)}if(9===s){var o=Kn.eclipticLatitude(t),l=Kn.eclipticLongitude(t),h=Kn.radiusVector(t)/149598e3,u=X.trueObliquityOfEcliptic(t),c=d.ec2Eq(l,o,u);return new Gr((_=ur.equatorial2Topocentric(c.x,c.y,h,n,i,r,t)).x,_.y,h,!1,!1)}if(t!==Or){Ur=$n.calculate(t,4),Vr=_r.calculate(t);var _=ur.equatorial2Topocentric(Ur.apparentGeocentricRA,Ur.apparentGeocentricDeclination,Ur.apparentGeocentricDistance,n,i,r,t);Ur.apparentGeocentricRA=_.x,Ur.apparentGeocentricDeclination=_.y,Br=Vn.calculate(t),Or=t}var g,f,m=954501e-9,p=Math.atan(m/Ur.apparentGeocentricDistance*.5)/3.1415927*180,w=p/Math.cos(Ur.apparentGeocentricDeclination/180*3.1415927)/15,b=0,v=0,y=0,S=!1,x=!1;switch(s){case 10:b=Br.satellite1.apparentRectangularCoordinates.x,v=Br.satellite1.apparentRectangularCoordinates.y,y=Br.satellite1.apparentRectangularCoordinates.z,x=Br.satellite1.bInEclipse,S=Br.satellite1.bInShadowTransit;break;case 11:b=Br.satellite2.apparentRectangularCoordinates.x,v=Br.satellite2.apparentRectangularCoordinates.y,y=Br.satellite2.apparentRectangularCoordinates.z,x=Br.satellite2.bInEclipse,S=Br.satellite2.bInShadowTransit;break;case 12:b=Br.satellite3.apparentRectangularCoordinates.x,v=Br.satellite3.apparentRectangularCoordinates.y,y=Br.satellite3.apparentRectangularCoordinates.z,x=Br.satellite3.bInEclipse,S=Br.satellite3.bInShadowTransit;break;case 13:b=Br.satellite4.apparentRectangularCoordinates.x,v=Br.satellite4.apparentRectangularCoordinates.y,y=Br.satellite4.apparentRectangularCoordinates.z,x=Br.satellite4.bInEclipse,S=Br.satellite4.bInShadowTransit;break;case 14:b=Br.satellite1.apparentShadowRectangularCoordinates.x,v=Br.satellite1.apparentShadowRectangularCoordinates.y,y=.9*Br.satellite1.apparentShadowRectangularCoordinates.z,S=Br.satellite1.bInShadowTransit;break;case 15:b=Br.satellite2.apparentShadowRectangularCoordinates.x,v=Br.satellite2.apparentShadowRectangularCoordinates.y,y=.9*Br.satellite2.apparentShadowRectangularCoordinates.z,S=Br.satellite2.bInShadowTransit;break;case 16:b=Br.satellite3.apparentShadowRectangularCoordinates.x,v=Br.satellite3.apparentShadowRectangularCoordinates.y,y=.9*Br.satellite3.apparentShadowRectangularCoordinates.z,S=Br.satellite3.bInShadowTransit;break;case 17:b=Br.satellite4.apparentShadowRectangularCoordinates.x,v=Br.satellite4.apparentShadowRectangularCoordinates.y,y=.9*Br.satellite4.apparentShadowRectangularCoordinates.z,S=Br.satellite4.bInShadowTransit}var T=Vr.p/180*3.1415927;return g=b*Math.cos(T)-v*Math.sin(T),f=b*Math.sin(T)+v*Math.cos(T),b=g,v=f,new Gr(Ur.apparentGeocentricRA-b*w,Ur.apparentGeocentricDeclination+v*p,Ur.apparentGeocentricDistance+y*m/2,S,x)},Hr.getJulianDay=function(e,i,n){return h.dateToJD(t.ss.truncate(e),t.ss.truncate(i),n,!0)},Hr.eclipticToJ2000=function(t,e,i){var n=d.ec2Eq(t,e,X.trueObliquityOfEcliptic(i));return new Gr(n.x,n.y,0,!1,!1)},Hr.galacticToJ2000=function(t,e){var i=d.g2Eq(t,e);return new Gr(i.x,i.y,0,!1,!1)},Hr.j2000ToGalactic=function(t,e){var i=d.eq2G(t,e);return new Gr(i.x,i.y,0,!1,!1)},Hr.getRiseTrinsitSet=function(t,e,i,n,r,s,o,l,h,u){var c=-.5667;switch(u){case 0:c=-.5667;break;case 1:c=-.8333;break;case 2:c=.125}var _=br.rise(t,n,r,s,o,l,h,i,e,c),d=!1;return _.bValid||(d=a.sign(e)!==a.sign(o)),new Xr(_.bValid,_.rise,_.transit,_.set,d)},n("AstroCalc",[Hr,{},null]);const Yr={ACTIVE_ATTRIBUTE_MAX_LENGTH:35722,ACTIVE_ATTRIBUTES:35721,ACTIVE_TEXTURE:34016,ACTIVE_UNIFORM_MAX_LENGTH:35719,ACTIVE_UNIFORMS:35718,ALIASED_LINE_WIDTH_RANGE:33902,ALIASED_POINT_SIZE_RANGE:33901,ALPHA:6406,ALPHA_BITS:3413,ALWAYS:519,ARRAY_BUFFER:34962,ARRAY_BUFFER_BINDING:34964,ATTACHED_SHADERS:35717,BACK:1029,BLEND:3042,BLEND_COLOR:32773,BLEND_DST_ALPHA:32970,BLEND_DST_RGB:32968,BLEND_EQUATION:32777,BLEND_EQUATION_ALPHA:34877,BLEND_EQUATION_RGB:32777,BLEND_SRC_ALPHA:32971,BLEND_SRC_RGB:32969,BLUE_BITS:3412,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,BUFFER_SIZE:34660,BUFFER_USAGE:34661,BYTE:5120,CCW:2305,CLAMP_TO_EDGE:33071,COLOR_ATTACHMENT0:36064,COLOR_BUFFER_BIT:16384,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,COMPILE_STATUS:35713,COMPRESSED_TEXTURE_FORMATS:34467,CONSTANT_ALPHA:32771,CONSTANT_COLOR:32769,CULL_FACE:2884,CULL_FACE_MODE:2885,CURRENT_PROGRAM:35725,CURRENT_VERTEX_ATTRIB:34342,CW:2304,DECR:7683,DECR_WRAP:34056,DELETE_STATUS:35712,DEPTH_ATTACHMENT:36096,DEPTH_BITS:3414,DEPTH_BUFFER_BIT:256,DEPTH_CLEAR_VALUE:2931,DEPTH_COMPONENT:6402,DEPTH_COMPONENT16:33189,DEPTH_FUNC:2932,DEPTH_RANGE:2928,DEPTH_STENCIL:34041,DEPTH_STENCIL_ATTACHMENT:33306,DEPTH_TEST:2929,DEPTH_WRITEMASK:2930,DITHER:3024,DONT_CARE:4352,DST_ALPHA:772,DST_COLOR:774,DYNAMIC_DRAW:35048,ELEMENT_ARRAY_BUFFER:34963,ELEMENT_ARRAY_BUFFER_BINDING:34965,EQUAL:514,EXTENSIONS:7939,FASTEST:4353,FLOAT:5126,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,FRAGMENT_SHADER:35632,FRAMEBUFFER:36160,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_BINDING:36006,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_UNSUPPORTED:36061,FRONT:1028,FRONT_AND_BACK:1032,FRONT_FACE:2886,FUNC_ADD:32774,FUNC_REVERSE_SUBTRACT:32779,FUNC_SUBTRACT:32778,GENERATE_MIPMAP_HINT:33170,GEQUAL:518,GREATER:516,GREEN_BITS:3411,HIGH_FLOAT:36338,HIGH_INT:36341,IMPLEMENTATION_COLOR_READ_FORMAT:35739,IMPLEMENTATION_COLOR_READ_TYPE:35738,INCR:7682,INCR_WRAP:34055,INFO_LOG_LENGTH:35716,INT:5124,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,INVALID_ENUM:1280,INVALID_FRAMEBUFFER_OPERATION:1286,INVALID_OPERATION:1282,INVALID_VALUE:1281,INVERT:5386,KEEP:7680,LEQUAL:515,LESS:513,LINE_LOOP:2,LINE_STRIP:3,LINE_WIDTH:2849,LINEAR:9729,LINEAR_MIPMAP_LINEAR:9987,LINEAR_MIPMAP_NEAREST:9985,LINES:1,LINK_STATUS:35714,LOW_FLOAT:36336,LOW_INT:36339,LUMINANCE:6409,LUMINANCE_ALPHA:6410,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_CUBE_MAP_TEXTURE_SIZE:34076,MAX_FRAGMENT_UNIFORM_VECTORS:36349,MAX_RENDERBUFFER_SIZE:34024,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_TEXTURE_SIZE:3379,MAX_VARYING_VECTORS:36348,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VIEWPORT_DIMS:3386,MEDIUM_FLOAT:36337,MEDIUM_INT:36340,MIRRORED_REPEAT:33648,NEAREST:9728,NEAREST_MIPMAP_LINEAR:9986,NEAREST_MIPMAP_NEAREST:9984,NEVER:512,NICEST:4354,NO_ERROR:0,NONE:0,NOTEQUAL:517,NUM_COMPRESSED_TEXTURE_FORMATS:34466,ONE:1,ONE_MINUS_CONSTANT_ALPHA:32772,ONE_MINUS_CONSTANT_COLOR:32770,ONE_MINUS_DST_ALPHA:773,ONE_MINUS_DST_COLOR:775,ONE_MINUS_SRC_ALPHA:771,ONE_MINUS_SRC_COLOR:769,OUT_OF_MEMORY:1285,PACK_ALIGNMENT:3333,POINTS:0,POLYGON_OFFSET_FACTOR:32824,POLYGON_OFFSET_FILL:32823,POLYGON_OFFSET_UNITS:10752,RED_BITS:3410,RENDERBUFFER:36161,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_BINDING:36007,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_STENCIL_SIZE:36181,RENDERBUFFER_WIDTH:36162,RENDERER:7937,REPEAT:10497,REPLACE:7681,RGB:6407,RGB8:32849,RGB5_A1:32855,RGB565:36194,RGBA:6408,RGBA8:32856,RGBA16I:36232,RED_INTEGER:36244,RED:6403,R32F:33326,R16I:33331,RGBA4:32854,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_BUFFERS:32936,SAMPLE_COVERAGE:32928,SAMPLE_COVERAGE_INVERT:32939,SAMPLE_COVERAGE_VALUE:32938,SAMPLER_2D:35678,SAMPLER_CUBE:35680,SAMPLES:32937,SCISSOR_BOX:3088,SCISSOR_TEST:3089,SHADER_COMPILER:36346,SHADER_SOURCE_LENGTH:35720,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,SHORT:5122,SRC_ALPHA:770,SRC_ALPHA_SATURATE:776,SRC_COLOR:768,STATIC_DRAW:35044,STENCIL_ATTACHMENT:36128,STENCIL_BACK_FAIL:34817,STENCIL_BACK_FUNC:34816,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,STENCIL_BITS:3415,STENCIL_BUFFER_BIT:1024,STENCIL_CLEAR_VALUE:2961,STENCIL_FAIL:2964,STENCIL_FUNC:2962,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_TEST:2960,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STREAM_DRAW:35040,SUBPIXEL_BITS:3408,TEXTURE:5890,TEXTURE_2D:3553,TEXTURE_BINDING_2D:32873,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP:34067,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,UNPACK_FLIP_Y_WEBGL:37440,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE0:33984,TEXTURE1:33985,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE2:33986,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE3:33987,TEXTURE30:34014,TEXTURE31:34015,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TRIANGLE_FAN:6,TRIANGLE_STRIP:5,TRIANGLES:4,UNPACK_ALIGNMENT:3317,UNSIGNED_BYTE:5121,UNSIGNED_INT:5125,UNSIGNED_SHORT:5123,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,VALIDATE_STATUS:35715,VENDOR:7936,VERSION:7938,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_SHADER:35633,VIEWPORT:2978,ZERO:0};function jr(t){this.buffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this.buffer),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,t,Yr.STATIC_DRAW)}function Wr(t){this.buffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this.buffer),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,t,Yr.STATIC_DRAW)}function qr(){}function Zr(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function Kr(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function Jr(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function Qr(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function ts(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function es(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function is(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function ns(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t}function rs(){this.imageElement=null,this.texture2d=null,this._downloading=!1,this._ready=!1,this._errored=!1,this.URL=""}n("ShortIndexBuffer",[jr,{},null]),n("IndexBuffer",[Wr,{dispose:function(){Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),Hi.deleteBuffer(this.buffer),this.buffer=null}},null,t.ss.IDisposable]),n("VertexBufferBase",[qr,{dispose:function(){Hi.bindBuffer(Yr.ARRAY_BUFFER,null),Hi.deleteBuffer(this.vertexBuffer),this.vertexBuffer=null}},null,t.ss.IDisposable]),n("PositionVertexBuffer",[Zr,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(3*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.x,i[n++]=s.y,i[n++]=s.z}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),Kr.create=function(t){var e=new Kr(t.length);return e._verts$1=t,e.unlock(),e},n("PositionTextureVertexBuffer",[Kr,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(5*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.position.x,i[n++]=s.position.y,i[n++]=s.position.z,i[n++]=s.tu,i[n++]=s.tv}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),Jr.create=function(t){var e=new Jr(t.length);return e._verts$1=t,e.unlock(),e},n("PositionNormalTexturedVertexBuffer",[Jr,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(8*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.x,i[n++]=s.y,i[n++]=s.z,i[n++]=s.nx,i[n++]=s.ny,i[n++]=s.nz,i[n++]=s.tu,i[n++]=s.tv}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),Qr.create=function(t){var e=new Qr(t.length);return e._verts$1=t,e.unlock(),e},n("PositionNormalTexturedTangentVertexBuffer",[Qr,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(11*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.x,i[n++]=s.y,i[n++]=s.z,i[n++]=s.nx,i[n++]=s.ny,i[n++]=s.nz,i[n++]=s.tanx,i[n++]=s.tany,i[n++]=s.tanz,i[n++]=s.tu,i[n++]=s.tv}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),ts.create=function(t){var e=new ts(t.length);return e._verts$1=t,e},n("KeplerVertexBuffer",[ts,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(19*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.ABC.x,i[n++]=s.ABC.y,i[n++]=s.ABC.z,i[n++]=s.abc1.x,i[n++]=s.abc1.y,i[n++]=s.abc1.z,i[n++]=s.pointSize,i[n++]=s.color.r/255,i[n++]=s.color.g/255,i[n++]=s.color.b/255,i[n++]=s.color.a/255,i[n++]=s.w,i[n++]=s.e,i[n++]=s.n,i[n++]=s.t,i[n++]=s.a,i[n++]=s.z,i[n++]=s.orbitPos,i[n++]=s.orbits}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),n("TimeSeriesLineVertexBuffer",[es,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(9*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.position.x,i[n++]=s.position.y,i[n++]=s.position.z,i[n++]=s.get_color().r/255,i[n++]=s.get_color().g/255,i[n++]=s.get_color().b/255,i[n++]=s.get_color().a/255,i[n++]=s.tu,i[n++]=s.tv}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),n("TimeSeriesPointVertexBuffer",[is,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(10*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.position.x,i[n++]=s.position.y,i[n++]=s.position.z,i[n++]=s.get_color().r/255,i[n++]=s.get_color().g/255,i[n++]=s.get_color().b/255,i[n++]=s.get_color().a/255,i[n++]=s.tu,i[n++]=s.tv,i[n++]=s.pointSize}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)},dispose:function(){Hi.bindBuffer(Yr.ARRAY_BUFFER,null),Hi.deleteBuffer(this.vertexBuffer),this.vertexBuffer=null}},qr]),n("PositionColoredVertexBuffer",[ns,{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(7*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.position.x,i[n++]=s.position.y,i[n++]=s.position.z,i[n++]=s.color.r/255,i[n++]=s.color.g/255,i[n++]=s.color.b/255,i[n++]=s.color.a/255}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),n("PositionColoredTexturedVertexBuffer",[function(t){this.count=0,this._verts$1=null,qr.call(this),this.count=t},{lock:function(){return this._verts$1=new Array(this.count),this._verts$1},unlock:function(){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var e=new Float32Array(9*this.count),i=e,n=0,r=t.ss.enumerate(this._verts$1);r.moveNext();){var s=r.current;i[n++]=s.position.x,i[n++]=s.position.y,i[n++]=s.position.z,i[n++]=s.color.r/255,i[n++]=s.color.g/255,i[n++]=s.color.b/255,i[n++]=s.color.a/255,i[n++]=s.tu,i[n++]=s.tv}Hi.bufferData(Yr.ARRAY_BUFFER,e,Yr.STATIC_DRAW)}},qr]),rs.empty=null,rs.getEmpty=function(){return null==rs.empty&&(rs.empty=Hi.createTexture(),Hi.bindTexture(Yr.TEXTURE_2D,rs.empty),Hi.texImage2D(Yr.TEXTURE_2D,0,Yr.RGBA,1,1,0,Yr.RGBA,Yr.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),Hi.bindTexture(Yr.TEXTURE_2D,null)),rs.empty},rs.fromUrl=function(t){var e=new rs;return e.load(t),e},rs.isPowerOfTwo=function(t){return!(t&t-1)},rs.fitPowerOfTwo=function(t){t--;for(var e=1;e<32;e<<=1)t|=t>>e;return t+1};var ss={cleanUp:function(){this.imageElement=null,Hi.deleteTexture(this.texture2d)},dispose:function(){this.cleanUp()},load:function(t){var e=this;if(this.URL=t,"undefined"!=typeof document&&!this._downloading){this._downloading=!0,this.imageElement=document.createElement("img");var i=this.imageElement;this.imageElement.addEventListener("load",(function(t){e._ready=!0,e._downloading=!1,e._errored=!1,e.makeTexture()}),!1),this.imageElement.addEventListener("error",(function(t){if(!e.imageElement.hasAttribute("proxyattempt")){e.imageElement.setAttribute("proxyattempt",!0);var i=zr.singleton.activateProxy(e.URL);if(null!=i)return void(e.imageElement.src=i)}e._downloading=!1,e._ready=!1,e._errored=!0}),!1),i.crossOrigin="anonymous",this.imageElement.src=this.URL}},makeTexture:function(){if(null!=Hi)try{this.texture2d=Hi.createTexture(),Hi.bindTexture(Yr.TEXTURE_2D,this.texture2d);var t=this.imageElement;if(1==(!rs.isPowerOfTwo(this.imageElement.height)|!rs.isPowerOfTwo(this.imageElement.width))){var e=document.createElement("canvas");e.height=rs.fitPowerOfTwo(t.height),e.width=rs.fitPowerOfTwo(t.width),e.getContext("2d").drawImage(t,0,0,e.width,e.height),t=e}Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_S,Yr.CLAMP_TO_EDGE),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_T,Yr.CLAMP_TO_EDGE),Hi.texImage2D(Yr.TEXTURE_2D,0,Yr.RGBA,Yr.RGBA,Yr.UNSIGNED_BYTE,t),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MIN_FILTER,Yr.LINEAR_MIPMAP_NEAREST),Hi.generateMipmap(Yr.TEXTURE_2D),Hi.bindTexture(Yr.TEXTURE_2D,null)}catch(t){this._errored=!0}}};function as(){}n("Texture",[rs,ss,null,t.ss.IDisposable]),as.tesselateSimplePoly=function(t){var e=[];return(new as).process(t,e),e};var os={_isLeftOfHalfSpace:function(t,e,i){t.normalize(),e.normalize();var n=wn.cross(t,e);return wn.dot(n,i)>0},_insideTriangle:function(t,e,i,n){return!!this._isLeftOfHalfSpace(t,e,n)&&!!this._isLeftOfHalfSpace(e,i,n)&&!!this._isLeftOfHalfSpace(i,t,n)},_canClipEar:function(t,e,i,n,r,s){var a,o,l=t[s[e]].copy(),h=t[s[i]].copy(),u=t[s[n]].copy(),c=wn.subtractVectors(h,l);c.normalize();var _=wn.subtractVectors(h,u);_.normalize();var d=wn.cross(c,_),g=h.copy();if(g.normalize(),wn.dot(d,g)>0)return!1;for(a=0;a<r;a++)if(a!==e&&a!==i&&a!==n&&(o=t[s[a]].copy(),this._insideTriangle(l,h,u,o)))return!1;return!0},process:function(t,e){var i=t.length;if(t.length<3)return!1;for(var n=new Array(t.length),r=0;r<i;r++)n[r]=r;for(var s=i,a=2*s,o=s-1;s>2;){if(0>=a--)return!1;var l=o;s<=l&&(l=0),s<=(o=l+1)&&(o=0);var h=o+1;if(s<=h&&(h=0),this._canClipEar(t,l,o,h,s,n)){var u,c;for(e.push(n[l]),e.push(n[o]),e.push(n[h]),u=o,c=o+1;c<s;u++,c++)n[u]=n[c];a=2*--s}}return!0}};function ls(){}function hs(){}function us(){}function cs(){}function _s(){}function ds(){}function gs(){}function fs(){}function ms(){}function ps(){}function ws(){}function bs(){}function vs(){}function ys(){}function Ss(){}function xs(){}n("Tessellator",[as,os,null]),ls.vertLoc=0,ls.initialized=!1,ls._prog=null,ls.init=function(t){var e=t.gl;ls._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(ls._frag,"        precision highp float;\n        uniform vec4 lineColor;\n\n        void main(void) {\n            gl_FragColor = lineColor;\n        }\n    "),e.compileShader(ls._frag),e.getShaderParameter(ls._frag,Yr.COMPILE_STATUS),ls._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(ls._vert,"        attribute vec3 aVertexPosition;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n        }\n    "),e.compileShader(ls._vert),e.getShaderParameter(ls._vert,Yr.COMPILE_STATUS),ls._prog=e.createProgram(),e.attachShader(ls._prog,ls._vert),e.attachShader(ls._prog,ls._frag),e.linkProgram(ls._prog),e.getProgramParameter(ls._prog,Yr.LINK_STATUS),e.useProgram(ls._prog),ls.vertLoc=e.getAttribLocation(ls._prog,"aVertexPosition"),ls.lineColorLoc=e.getUniformLocation(ls._prog,"lineColor"),ls.projMatLoc=e.getUniformLocation(ls._prog,"uPMatrix"),ls.mvMatLoc=e.getUniformLocation(ls._prog,"uMVMatrix"),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),ls.initialized=!0},ls.use=function(t,e,i,n){var r=t.gl;if(null!=r){ls.initialized||ls.init(t),r.useProgram(ls._prog);var s=yn.multiplyMatrix(t.get_world(),t.get_view());r.uniformMatrix4fv(ls.mvMatLoc,!1,s.floatArray()),r.uniformMatrix4fv(ls.projMatLoc,!1,t.get_projection().floatArray()),r.uniform4f(ls.lineColorLoc,i.r/255,i.g/255,i.b/255,1),t.space||!n?r.disable(Yr.DEPTH_TEST):r.enable(Yr.DEPTH_TEST),r.disableVertexAttribArray(0),r.disableVertexAttribArray(1),r.disableVertexAttribArray(2),r.disableVertexAttribArray(3),r.enableVertexAttribArray(ls.vertLoc),r.bindBuffer(Yr.ARRAY_BUFFER,e),r.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),r.vertexAttribPointer(ls.vertLoc,3,Yr.FLOAT,!1,0,0),r.lineWidth(1),r.enable(Yr.BLEND),r.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("SimpleLineShader",[ls,{},null]),hs.vertLoc=0,hs.initialized=!1,hs._prog=null,hs.init=function(t){var e=t.gl;hs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(hs._frag,"       precision highp float;\n       uniform vec4 lineColor;\n\n       void main(void) {\n           gl_FragColor = lineColor;\n       }\n    "),e.compileShader(hs._frag),e.getShaderParameter(hs._frag,Yr.COMPILE_STATUS),hs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(hs._vert,"        attribute vec3 aVertexPosition;\n\n        void main(void) {\n            gl_Position = vec4(aVertexPosition, 1.0);\n        }\n    "),e.compileShader(hs._vert),e.getShaderParameter(hs._vert,Yr.COMPILE_STATUS),hs._prog=e.createProgram(),e.attachShader(hs._prog,hs._vert),e.attachShader(hs._prog,hs._frag),e.linkProgram(hs._prog),e.getProgramParameter(hs._prog,Yr.LINK_STATUS),e.useProgram(hs._prog),hs.vertLoc=e.getAttribLocation(hs._prog,"aVertexPosition"),hs.lineColorLoc=e.getUniformLocation(hs._prog,"lineColor"),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),hs.initialized=!0},hs.use=function(t,e,i,n){var r=t.gl;null!=r&&(hs.initialized||hs.init(t),r.useProgram(hs._prog),yn.multiplyMatrix(t.get_world(),t.get_view()),r.uniform4f(hs.lineColorLoc,i.r/255,i.g/255,i.b/255,1),t.space||!n?r.disable(Yr.DEPTH_TEST):r.enable(Yr.DEPTH_TEST),r.disableVertexAttribArray(0),r.disableVertexAttribArray(1),r.disableVertexAttribArray(2),r.disableVertexAttribArray(3),r.enableVertexAttribArray(hs.vertLoc),r.bindBuffer(Yr.ARRAY_BUFFER,e),r.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),r.vertexAttribPointer(hs.vertLoc,3,Yr.FLOAT,!1,0,0),r.lineWidth(1),r.enable(Yr.BLEND),r.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA))},n("SimpleLineShader2D",[hs,{},null]),us.vertLoc=0,us.colorLoc=0,us.initialized=!1,us._prog=null,us.init=function(t){var e=t.gl;us._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(us._frag,"        precision highp float;\n        uniform vec4 lineColor;\n        varying lowp vec4 vColor;\n\n        void main(void) {\n            gl_FragColor = lineColor * vColor;\n        }\n    "),e.compileShader(us._frag),e.getShaderParameter(us._frag,Yr.COMPILE_STATUS),us._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(us._vert,"        attribute vec3 aVertexPosition;\n        attribute vec4 aVertexColor;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        varying lowp vec4 vColor;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vColor = aVertexColor;\n        }\n    "),e.compileShader(us._vert),e.getShaderParameter(us._vert,Yr.COMPILE_STATUS),us._prog=e.createProgram(),e.attachShader(us._prog,us._vert),e.attachShader(us._prog,us._frag),e.linkProgram(us._prog),e.getProgramParameter(us._prog,Yr.LINK_STATUS),e.useProgram(us._prog),us.vertLoc=e.getAttribLocation(us._prog,"aVertexPosition"),us.colorLoc=e.getAttribLocation(us._prog,"aVertexColor"),us.lineColorLoc=e.getUniformLocation(us._prog,"lineColor"),us.projMatLoc=e.getUniformLocation(us._prog,"uPMatrix"),us.mvMatLoc=e.getUniformLocation(us._prog,"uMVMatrix"),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),us.initialized=!0},us.use=function(t,e,i){var n=t.gl;if(null!=n){us.initialized||us.init(t),n.useProgram(us._prog);var r=yn.multiplyMatrix(t.get_world(),t.get_view());n.uniformMatrix4fv(us.mvMatLoc,!1,r.floatArray()),n.uniformMatrix4fv(us.projMatLoc,!1,t.get_projection().floatArray()),n.uniform4f(us.lineColorLoc,i.r/255,i.g/255,i.b/255,1),t.space?n.disable(Yr.DEPTH_TEST):n.enable(Yr.DEPTH_TEST),n.disableVertexAttribArray(0),n.disableVertexAttribArray(1),n.disableVertexAttribArray(2),n.disableVertexAttribArray(3),n.bindBuffer(Yr.ARRAY_BUFFER,e),n.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),n.enableVertexAttribArray(us.vertLoc),n.enableVertexAttribArray(us.colorLoc),n.vertexAttribPointer(us.vertLoc,3,Yr.FLOAT,!1,28,0),n.vertexAttribPointer(us.colorLoc,4,Yr.FLOAT,!1,28,12),n.lineWidth(1),n.enable(Yr.BLEND),n.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("OrbitLineShader",[us,{},null]),cs.vertLoc=0,cs.colorLoc=0,cs.timeLoc=0,cs.initialized=!1,cs._prog=null,cs.init=function(t){var e=t.gl;cs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(cs._frag,"        precision highp float;\n        uniform vec4 lineColor;\n        varying lowp vec4 vColor;\n\n        void main(void)\n        {\n            gl_FragColor = lineColor * vColor;\n        }\n    "),e.compileShader(cs._frag),e.getShaderParameter(cs._frag,Yr.COMPILE_STATUS),cs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(cs._vert,"        attribute vec3 aVertexPosition;\n        attribute vec4 aVertexColor;\n        attribute vec2 aTime;\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform float jNow;\n        uniform float decay;\n\n        varying lowp vec4 vColor;\n\n        void main(void)\n        {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            float dAlpha = 1.0;\n\n            if (decay > 0.0)\n            {\n                    dAlpha = 1.0 - ((jNow - aTime.y) / decay);\n                    if (dAlpha > 1.0 )\n                    {\n                        dAlpha = 1.0;\n                    }\n            }\n\n            if (jNow < aTime.x && decay > 0.0)\n            {\n                vColor = vec4(1, 1, 1, 1);\n            }\n            else\n            {\n                vColor = vec4(aVertexColor.r, aVertexColor.g, aVertexColor.b, dAlpha * aVertexColor.a);\n            }\n        }\n    "),e.compileShader(cs._vert),e.getShaderParameter(cs._vert,Yr.COMPILE_STATUS),cs._prog=e.createProgram(),e.attachShader(cs._prog,cs._vert),e.attachShader(cs._prog,cs._frag),e.linkProgram(cs._prog),e.getProgramParameter(cs._prog,Yr.LINK_STATUS),e.useProgram(cs._prog),cs.vertLoc=e.getAttribLocation(cs._prog,"aVertexPosition"),cs.colorLoc=e.getAttribLocation(cs._prog,"aVertexColor"),cs.timeLoc=e.getAttribLocation(cs._prog,"aTime"),cs.lineColorLoc=e.getUniformLocation(cs._prog,"lineColor"),cs.projMatLoc=e.getUniformLocation(cs._prog,"uPMatrix"),cs.mvMatLoc=e.getUniformLocation(cs._prog,"uMVMatrix"),cs.jNowLoc=e.getUniformLocation(cs._prog,"jNow"),cs.decayLoc=e.getUniformLocation(cs._prog,"decay"),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),cs.initialized=!0},cs.use=function(t,e,i,n,r,s){var a=t.gl;if(null!=a){cs.initialized||cs.init(t),a.useProgram(cs._prog);var o=yn.multiplyMatrix(t.get_world(),t.get_view());a.uniformMatrix4fv(cs.mvMatLoc,!1,o.floatArray()),a.uniformMatrix4fv(cs.projMatLoc,!1,t.get_projection().floatArray()),a.uniform4f(cs.lineColorLoc,i.r/255,i.g/255,i.b/255,1),a.uniform1f(cs.jNowLoc,r),a.uniform1f(cs.decayLoc,s),n?a.enable(Yr.DEPTH_TEST):a.disable(Yr.DEPTH_TEST),a.disableVertexAttribArray(0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.bindBuffer(Yr.ARRAY_BUFFER,e),a.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),a.enableVertexAttribArray(cs.vertLoc),a.enableVertexAttribArray(cs.colorLoc),a.vertexAttribPointer(cs.vertLoc,3,Yr.FLOAT,!1,36,0),a.vertexAttribPointer(cs.colorLoc,4,Yr.FLOAT,!1,36,12),a.vertexAttribPointer(cs.timeLoc,2,Yr.FLOAT,!1,36,28),a.lineWidth(1),a.enable(Yr.BLEND),a.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("LineShaderNormalDates",[cs,{},null]),_s.vertLoc=0,_s.colorLoc=0,_s.pointSizeLoc=0,_s.timeLoc=0,_s.initialized=!1,_s._prog=null,_s.init=function(t){var e=t.gl;_s._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(_s._frag,"        precision mediump float;\n        uniform vec4 lineColor;\n        varying lowp vec4 vColor;\n        uniform sampler2D uSampler;\n\n        void main(void)\n        {\n            vec4 texColor;\n            texColor = texture2D(uSampler, gl_PointCoord);\n            gl_FragColor = lineColor * vColor * texColor;\n        }\n    "),e.compileShader(_s._frag),e.getShaderParameter(_s._frag,Yr.COMPILE_STATUS),_s._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(_s._vert,"        attribute vec3 aVertexPosition;\n        attribute vec4 aVertexColor;\n        attribute vec2 aTime;\n        attribute float aPointSize;\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform float jNow;\n        uniform vec3 cameraPosition;\n        uniform float decay;\n        uniform float scale;\n        uniform float minSize;\n        uniform float sky;\n        uniform float showFarSide;\n\n        varying lowp vec4 vColor;\n\n        void main(void)\n        {\n            float dotCam = dot( normalize(cameraPosition-aVertexPosition), normalize(aVertexPosition));\n            float dist = distance(aVertexPosition, cameraPosition);\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            float dAlpha = 1.0;\n\n            if ( decay > 0.0)\n            {\n                    dAlpha = 1.0 - ((jNow - aTime.y) / decay);\n                    if (dAlpha > 1.0 )\n                    {\n                        dAlpha = 1.0;\n                    }\n            }\n\n            if ( showFarSide == 0.0 && (dotCam * sky) < 0.0 || (jNow < aTime.x && decay > 0.0))\n            {\n                vColor = vec4(0.0, 0.0, 0.0, 0.0);\n            }\n            else\n            {\n                vColor = vec4(aVertexColor.r, aVertexColor.g, aVertexColor.b, dAlpha);\n            }\n\n            float lSize = scale;\n\n            if (scale < 0.0)\n            {\n                lSize = -scale;\n                dist = 1.0;\n            }\n\n            gl_PointSize = max(minSize, (lSize * ( aPointSize ) / dist));\n        }\n    "),e.compileShader(_s._vert),e.getShaderParameter(_s._vert,Yr.COMPILE_STATUS),e.getShaderInfoLog(_s._vert),_s._prog=e.createProgram(),e.attachShader(_s._prog,_s._vert),e.attachShader(_s._prog,_s._frag),e.linkProgram(_s._prog),e.getProgramParameter(_s._prog,Yr.LINK_STATUS),e.useProgram(_s._prog),_s.vertLoc=e.getAttribLocation(_s._prog,"aVertexPosition"),_s.colorLoc=e.getAttribLocation(_s._prog,"aVertexColor"),_s.pointSizeLoc=e.getAttribLocation(_s._prog,"aPointSize"),_s.timeLoc=e.getAttribLocation(_s._prog,"aTime"),_s.projMatLoc=e.getUniformLocation(_s._prog,"uPMatrix"),_s.mvMatLoc=e.getUniformLocation(_s._prog,"uMVMatrix"),_s.sampLoc=e.getUniformLocation(_s._prog,"uSampler"),_s.jNowLoc=e.getUniformLocation(_s._prog,"jNow"),_s.decayLoc=e.getUniformLocation(_s._prog,"decay"),_s.lineColorLoc=e.getUniformLocation(_s._prog,"lineColor"),_s.cameraPosLoc=e.getUniformLocation(_s._prog,"cameraPosition"),_s.scaleLoc=e.getUniformLocation(_s._prog,"scale"),_s.skyLoc=e.getUniformLocation(_s._prog,"sky"),_s.showFarSideLoc=e.getUniformLocation(_s._prog,"showFarSide"),_s.minSizeLoc=e.getUniformLocation(_s._prog,"minSize"),e.enable(Yr.BLEND),_s.initialized=!0},_s.use=function(t,e,i,n,r,s,a,o,l,h,u,c){null==i&&(i=rs.getEmpty());var _=t.gl;if(null!=_){_s.initialized||_s.init(t),_.useProgram(_s._prog);var d=yn.multiplyMatrix(t.get_world(),t.get_view());_.uniformMatrix4fv(_s.mvMatLoc,!1,d.floatArray()),_.uniformMatrix4fv(_s.projMatLoc,!1,t.get_projection().floatArray()),_.uniform1i(_s.sampLoc,0),_.uniform1f(_s.jNowLoc,s),_.uniform1f(_s.decayLoc,a),_.uniform4f(_s.lineColorLoc,n.r/255,n.g/255,n.b/255,n.a/255),_.uniform3f(_s.cameraPosLoc,o.x,o.y,o.z),_.uniform1f(_s.scaleLoc,l),_.uniform1f(_s.minSizeLoc,h),_.uniform1f(_s.showFarSideLoc,u?1:0),_.uniform1f(_s.skyLoc,c?-1:1),r?_.enable(Yr.DEPTH_TEST):_.disable(Yr.DEPTH_TEST),_.disableVertexAttribArray(0),_.disableVertexAttribArray(1),_.disableVertexAttribArray(2),_.disableVertexAttribArray(3),_.bindBuffer(Yr.ARRAY_BUFFER,e),_.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),_.enableVertexAttribArray(_s.vertLoc),_.enableVertexAttribArray(_s.colorLoc),_.enableVertexAttribArray(_s.pointSizeLoc),_.enableVertexAttribArray(_s.timeLoc),_.vertexAttribPointer(_s.vertLoc,3,Yr.FLOAT,!1,40,0),_.vertexAttribPointer(_s.colorLoc,4,Yr.FLOAT,!1,40,12),_.vertexAttribPointer(_s.pointSizeLoc,1,Yr.FLOAT,!1,40,36),_.vertexAttribPointer(_s.timeLoc,2,Yr.FLOAT,!1,40,28),_.activeTexture(Yr.TEXTURE0),_.bindTexture(Yr.TEXTURE_2D,i),_.lineWidth(1),_.enable(Yr.BLEND),_.blendFunc(Yr.SRC_ALPHA,Yr.ONE)}},n("TimeSeriesPointSpriteShader",[_s,{},null]),ds.abcLoc=0,ds.abcLoc1=0,ds.pointSizeLoc=0,ds.colorLoc=0,ds.weLoc=0,ds.nTLoc=0,ds.azLoc=0,ds.orbitLoc=0,ds.initialized=!1,ds._prog=null,ds.init=function(t){var e=t.gl;ds._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(ds._frag,"        precision mediump float;\n        uniform vec4 lineColor;\n        varying lowp vec4 vColor;\n        uniform sampler2D uSampler;\n\n        void main(void)\n        {\n            vec4 texColor;\n            texColor = texture2D(uSampler, gl_PointCoord);\n            gl_FragColor = lineColor * vColor * texColor;\n        }\n    "),e.compileShader(ds._frag),e.getShaderParameter(ds._frag,Yr.COMPILE_STATUS),ds._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(ds._vert,"        attribute vec3 ABC;\n        attribute vec3 abc;\n        attribute float PointSize;\n        attribute vec4 Color;\n        attribute vec2 we;\n        attribute vec2 nT;\n        attribute vec2 az;\n        attribute vec2 orbit;\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform float jNow;\n        uniform vec3 cameraPosition;\n        uniform float MM;\n        uniform float scaling;\n        uniform float minSize;\n        uniform float opacity;\n        varying lowp vec4 vColor;\n\n        void main(void)\n        {\n            float M = nT.x * (jNow - nT.y) * 0.01745329251994;\n            float e = we.y;\n            float a = az.x;\n            float PI = 3.1415926535897932384;\n            float w = we.x* 0.01745329251994;\n            float F = 1.0;\n\n            if (M < 0.0)\n                F = -1.0;\n\n            M = abs(M) / (2.0 * PI);\n            M = (M - float(int(M)))*2.0 *PI *F;\n\n            if (MM != 0.0)\n            {\n                M = MM + (1.0- orbit.x) *2.0 *PI;\n                if (M > (2.0*PI))\n                    M = M - (2.0*PI);\n            }\n\n            if (M < 0.0)\n                M += 2.0 *PI;\n\n            F = 1.0;\n            if (M > PI)\n                F = -1.0;\n\n            if (M > PI)\n                M = 2.0 *PI - M;\n\n            float E = PI / 2.0;\n            float scale = PI / 4.0;\n\n            for (int i =0; i<23; i++)\n            {\n                float R = E - e *sin(E);\n                if (M > R)\n                    E += scale;\n                else\n                    E -= scale;\n                scale /= 2.0;\n            }\n\n            E = E * F;\n\n            float v = 2.0 * atan(sqrt((1.0 + e) / (1.0 -e )) * tan(E/2.0));\n            float r = a * (1.0-e * cos(E));\n\n            vec4 pnt;\n            pnt.x = r * abc.x * sin(ABC.x + w + v);\n            pnt.z = r * abc.y * sin(ABC.y + w + v);\n            pnt.y = r * abc.z * sin(ABC.z + w + v);\n            pnt.w = 1.0;\n\n            float dist = distance(pnt.xyz, cameraPosition.xyz);\n            gl_Position = uPMatrix * uMVMatrix * pnt;\n            vColor.a = opacity * (1.0-(orbit.x));\n            vColor.r = Color.r;\n            vColor.g = Color.g;\n            vColor.b = Color.b;\n            gl_PointSize = max(minSize, scaling * (PointSize / dist));\n        }\n    "),e.compileShader(ds._vert),e.getShaderParameter(ds._vert,Yr.COMPILE_STATUS),e.getShaderInfoLog(ds._vert),ds._prog=e.createProgram(),e.attachShader(ds._prog,ds._vert),e.attachShader(ds._prog,ds._frag),e.linkProgram(ds._prog),e.getProgramParameter(ds._prog,Yr.LINK_STATUS),e.useProgram(ds._prog),ds.abcLoc1=e.getAttribLocation(ds._prog,"abc"),ds.abcLoc=e.getAttribLocation(ds._prog,"ABC"),ds.pointSizeLoc=e.getAttribLocation(ds._prog,"PointSize"),ds.colorLoc=e.getAttribLocation(ds._prog,"Color"),ds.weLoc=e.getAttribLocation(ds._prog,"we"),ds.nTLoc=e.getAttribLocation(ds._prog,"nT"),ds.azLoc=e.getAttribLocation(ds._prog,"az"),ds.orbitLoc=e.getAttribLocation(ds._prog,"orbit"),ds.projMatLoc=e.getUniformLocation(ds._prog,"uPMatrix"),ds.mvMatLoc=e.getUniformLocation(ds._prog,"uMVMatrix"),ds.jNowLoc=e.getUniformLocation(ds._prog,"jNow"),ds.cameraPosLoc=e.getUniformLocation(ds._prog,"cameraPosition"),ds.mmLoc=e.getUniformLocation(ds._prog,"MM"),ds.scaleLoc=e.getUniformLocation(ds._prog,"scaling"),ds.minSizeLoc=e.getUniformLocation(ds._prog,"minSize"),ds.lineColorLoc=e.getUniformLocation(ds._prog,"lineColor"),ds.opacityLoc=e.getUniformLocation(ds._prog,"opacity"),ds.sampLoc=e.getUniformLocation(ds._prog,"uSampler"),e.enable(Yr.BLEND),ds.initialized=!0},ds.use=function(t,e,i,n,r,s,a,o,l,h,u,c){null==n&&(n=rs.getEmpty());var _=t.gl;null!=_&&(ds.initialized||ds.init(t),_.useProgram(ds._prog),_.uniformMatrix4fv(ds.mvMatLoc,!1,e.floatArray()),_.uniformMatrix4fv(ds.projMatLoc,!1,t.get_projection().floatArray()),_.uniform1i(ds.sampLoc,0),_.uniform1f(ds.jNowLoc,o),_.uniform1f(ds.mmLoc,l),_.uniform4f(ds.lineColorLoc,r.r/255,r.g/255,r.b/255,r.a/255),_.uniform1f(ds.opacityLoc,s),_.uniform3f(ds.cameraPosLoc,h.x,h.y,h.z),_.uniform1f(ds.scaleLoc,u),_.uniform1f(ds.minSizeLoc,c),a?_.enable(Yr.DEPTH_TEST):_.disable(Yr.DEPTH_TEST),_.disableVertexAttribArray(0),_.disableVertexAttribArray(1),_.disableVertexAttribArray(2),_.disableVertexAttribArray(3),_.bindBuffer(Yr.ARRAY_BUFFER,i),_.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),_.enableVertexAttribArray(ds.abcLoc),_.enableVertexAttribArray(ds.abcLoc1),_.enableVertexAttribArray(ds.colorLoc),_.enableVertexAttribArray(ds.pointSizeLoc),_.enableVertexAttribArray(ds.weLoc),_.enableVertexAttribArray(ds.nTLoc),_.enableVertexAttribArray(ds.azLoc),_.enableVertexAttribArray(ds.orbitLoc),_.enableVertexAttribArray(ds.weLoc),_.vertexAttribPointer(ds.abcLoc,3,Yr.FLOAT,!1,76,0),_.vertexAttribPointer(ds.abcLoc1,3,Yr.FLOAT,!1,76,12),_.vertexAttribPointer(ds.pointSizeLoc,1,Yr.FLOAT,!1,76,24),_.vertexAttribPointer(ds.colorLoc,4,Yr.FLOAT,!1,76,28),_.vertexAttribPointer(ds.weLoc,2,Yr.FLOAT,!1,76,44),_.vertexAttribPointer(ds.nTLoc,2,Yr.FLOAT,!1,76,52),_.vertexAttribPointer(ds.azLoc,2,Yr.FLOAT,!1,76,60),_.vertexAttribPointer(ds.orbitLoc,2,Yr.FLOAT,!1,76,68),_.activeTexture(Yr.TEXTURE0),_.bindTexture(Yr.TEXTURE_2D,n),_.lineWidth(1),_.enable(Yr.BLEND),_.blendFunc(Yr.SRC_ALPHA,Yr.ONE))},n("KeplerPointSpriteShader",[ds,{},null]),gs.angleLoc=0,gs.initialized=!1,gs._prog=null,gs.init=function(t){var e=t.gl;gs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(gs._frag,"        precision mediump float;\n        varying lowp vec4 vColor;\n\n        void main(void)\n        {\n            gl_FragColor = vColor;\n        }\n    "),e.compileShader(gs._frag),e.getShaderParameter(gs._frag,Yr.COMPILE_STATUS),gs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(gs._vert,"        attribute vec3 Angle;\n        uniform mat4 matWVP;\n        uniform mat4 matPosition;\n        uniform vec3 positionNow;\n        uniform float semiMajorAxis;\n        uniform float eccentricity;\n        uniform vec4 color;\n        uniform float eccentricAnomaly;\n        varying lowp vec4 vColor;\n\n        void main(void)\n        {\n            float fade = (1.0 - Angle.x);\n            float PI = 3.1415927;\n            float E = eccentricAnomaly - Angle.x * 2.0 * PI;\n            vec2 semiAxes = vec2(1.0, sqrt(1.0 - eccentricity * eccentricity)) * semiMajorAxis;\n            vec2 planePos = semiAxes * vec2(cos(E) - eccentricity, sin(E));\n\n            if (Angle.x == 0.0)\n                gl_Position =  matPosition * vec4(positionNow, 1.0);\n            else\n                gl_Position = matWVP * vec4(planePos.x, planePos.y, 0.0, 1.0);\n\n            vColor = vec4(color.rgb, fade * color.a);\n        }\n    "),e.compileShader(gs._vert),e.getShaderParameter(gs._vert,Yr.COMPILE_STATUS),e.getShaderInfoLog(gs._vert),gs._prog=e.createProgram(),e.attachShader(gs._prog,gs._vert),e.attachShader(gs._prog,gs._frag),e.linkProgram(gs._prog),e.getProgramParameter(gs._prog,Yr.LINK_STATUS),e.useProgram(gs._prog),gs.angleLoc=e.getAttribLocation(gs._prog,"Angle"),gs.matWVPLoc=e.getUniformLocation(gs._prog,"matWVP"),gs.matPositionLoc=e.getUniformLocation(gs._prog,"matPosition"),gs.positionNowLoc=e.getUniformLocation(gs._prog,"positionNow"),gs.colorLoc=e.getUniformLocation(gs._prog,"color"),gs.semiMajorAxisLoc=e.getUniformLocation(gs._prog,"semiMajorAxis"),gs.eccentricityLoc=e.getUniformLocation(gs._prog,"eccentricity"),gs.eccentricAnomalyLoc=e.getUniformLocation(gs._prog,"eccentricAnomaly"),e.enable(Yr.BLEND),gs.initialized=!0},gs.use=function(t,e,i,n,r,s,a,o){var l=t.gl;if(null!=l){gs.initialized||gs.init(t),l.useProgram(gs._prog);var h=yn.multiplyMatrix(yn.multiplyMatrix(a,t.get_view()),t.get_projection()),u=yn.multiplyMatrix(yn.multiplyMatrix(t.get_world(),t.get_view()),t.get_projection());l.uniformMatrix4fv(gs.matWVPLoc,!1,u.floatArray()),l.uniformMatrix4fv(gs.matPositionLoc,!1,h.floatArray()),l.uniform3f(gs.positionNowLoc,o.x,o.y,o.z),l.uniform4f(gs.colorLoc,r.r/255,r.g/255,r.b/255,r.a/255),l.uniform1f(gs.semiMajorAxisLoc,e),l.uniform1f(gs.eccentricityLoc,i),l.uniform1f(gs.eccentricAnomalyLoc,n),l.disable(Yr.DEPTH_TEST),l.disableVertexAttribArray(0),l.disableVertexAttribArray(1),l.disableVertexAttribArray(2),l.disableVertexAttribArray(3),l.enableVertexAttribArray(gs.angleLoc),l.vertexAttribPointer(gs.angleLoc,3,Yr.FLOAT,!1,0,0),l.lineWidth(1),l.enable(Yr.BLEND),l.blendFunc(Yr.SRC_ALPHA,Yr.ONE)}},n("EllipseShader",[gs,{},null]),fs.vertLoc=0,fs.normalLoc=0,fs.textureLoc=0,fs.initialized=!1,fs._prog=null,fs.sunPosition=wn.create(-1,-1,-1),fs.minLightingBrightness=1,fs.atmosphereColor=Oi.fromArgb(0,0,0,0),fs.init=function(t){var e=t.gl;fs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(fs._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        uniform sampler2D uSampler;\n        uniform float opacity;\n        uniform vec3 uSunPosition;\n        uniform float uMinBrightness;\n        uniform vec3 uAtmosphereColor;\n\n        void main(void) {\n            vec3 normal = normalize(vNormal);\n            vec3 camVN = normalize(vCamVector);\n            vec3 cam = normalize(vec3(0.0,0.0,-1.0));\n            float dt = uMinBrightness + pow(max(0.0,- dot(normal,uSunPosition)),0.5);\n            float atm = max(0.0, 1.0 - 2.5 * dot(cam,camVN)) + 0.3 * dt;\n            atm = (dt > uMinBrightness) ? atm : 0.0;\n            if ( uMinBrightness == 1.0 ) { dt = 1.0; atm= 0.0; }\n            vec4 col = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n            gl_FragColor = col * opacity;\n            gl_FragColor.rgb *= dt;\n            gl_FragColor.rgb += atm * uAtmosphereColor;\n        }\n    "),e.compileShader(fs._frag),e.getShaderParameter(fs._frag,Yr.COMPILE_STATUS)||e.getShaderInfoLog(fs._frag),fs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(fs._vert,"        attribute vec3 aVertexPosition;\n        attribute vec3 aNormal;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vCamVector = normalize((mat3(uMVMatrix) * aVertexPosition).xyz);\n            vec3 normalT = normalize(mat3(uMVMatrix) * aNormal);\n            vTextureCoord = aTextureCoord;\n            vNormal = normalT;\n        }\n    "),e.compileShader(fs._vert),e.getShaderParameter(fs._vert,Yr.COMPILE_STATUS)||e.getShaderInfoLog(fs._vert),fs._prog=e.createProgram(),e.attachShader(fs._prog,fs._vert),e.attachShader(fs._prog,fs._frag),e.linkProgram(fs._prog),e.getProgramParameter(fs._prog,Yr.LINK_STATUS),e.useProgram(fs._prog),fs.vertLoc=e.getAttribLocation(fs._prog,"aVertexPosition"),fs.normalLoc=e.getAttribLocation(fs._prog,"aNormal"),fs.textureLoc=e.getAttribLocation(fs._prog,"aTextureCoord"),fs.projMatLoc=e.getUniformLocation(fs._prog,"uPMatrix"),fs.mvMatLoc=e.getUniformLocation(fs._prog,"uMVMatrix"),fs.sampLoc=e.getUniformLocation(fs._prog,"uSampler"),fs.sunLoc=e.getUniformLocation(fs._prog,"uSunPosition"),fs.minBrightnessLoc=e.getUniformLocation(fs._prog,"uMinBrightness"),fs.opacityLoc=e.getUniformLocation(fs._prog,"opacity"),fs.atmosphereColorLoc=e.getUniformLocation(fs._prog,"uAtmosphereColor"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),fs.initialized=!0},fs.use=function(t,e,i,n,r,s,a){null==n&&(n=rs.getEmpty());var o=t.gl;if(null!=o){fs.initialized||fs.init(t),o.useProgram(fs._prog);var l=yn.multiplyMatrix(t.get_world(),t.get_view());o.uniform1f(fs.opacityLoc,r),o.uniform1f(fs.minBrightnessLoc,t.lighting?fs.minLightingBrightness:1),t.lighting?o.uniform3f(fs.atmosphereColorLoc,fs.atmosphereColor.r/255,fs.atmosphereColor.g/255,fs.atmosphereColor.b/255):o.uniform3f(fs.atmosphereColorLoc,0,0,0),o.uniformMatrix4fv(fs.mvMatLoc,!1,l.floatArray()),o.uniformMatrix4fv(fs.projMatLoc,!1,t.get_projection().floatArray()),fs.sunPosition.normalize();var h=t.get_view().clone();h.set_m41(0),h.set_m42(0),h.set_m43(0),h.set_m44(1);var u=wn._transformCoordinate(fs.sunPosition,h);u.normalize(),o.uniform3f(fs.sunLoc,u.x,u.y,u.z),o.uniform1i(fs.sampLoc,0),t.space||s?o.disable(Yr.DEPTH_TEST):o.enable(Yr.DEPTH_TEST),o.disableVertexAttribArray(0),o.disableVertexAttribArray(1),o.disableVertexAttribArray(2),o.disableVertexAttribArray(3),o.bindBuffer(Yr.ARRAY_BUFFER,e),o.enableVertexAttribArray(fs.vertLoc),o.enableVertexAttribArray(fs.normalLoc),o.enableVertexAttribArray(fs.textureLoc),o.vertexAttribPointer(fs.vertLoc,3,Yr.FLOAT,!1,a,0),o.vertexAttribPointer(fs.normalLoc,3,Yr.FLOAT,!1,a,12),o.vertexAttribPointer(fs.textureLoc,2,Yr.FLOAT,!1,a,a-8),o.activeTexture(Yr.TEXTURE0),o.bindTexture(Yr.TEXTURE_2D,n),o.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,i),o.enable(Yr.BLEND),s?o.blendFunc(Yr.SRC_ALPHA,Yr.ONE):o.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("ModelShader",[fs,{},null]),ms.vertLoc=0,ms.normalLoc=0,ms.textureLoc=0,ms.initialized=!1,ms._prog=null,ms.sunPosition=wn.create(-1,-1,-1),ms.minLightingBrightness=1,ms.atmosphereColor=Oi.fromArgb(0,0,0,0),ms.init=function(t){var e=t.gl;ms._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(ms._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        uniform sampler2D uSampler;\n        uniform float opacity;\n        uniform vec3 uSunPosition;\n        uniform float uMinBrightness;\n        uniform vec3 uAtmosphereColor;\n\n        void main(void) {\n            vec3 normal = normalize(vNormal);\n            vec3 camVN = normalize(vCamVector);\n            vec3 cam = normalize(vec3(0.0,0.0,-1.0));\n            float dt = uMinBrightness + pow(max(0.0,- dot(normal,uSunPosition)),0.5);\n            float atm = max(0.0, 1.0 - 2.5 * dot(cam,camVN)) + 0.3 * dt;\n            atm = (dt > uMinBrightness) ? atm : 0.0;\n            if ( uMinBrightness == 1.0 ) { dt = 1.0; atm= 0.0; }\n            vec4 col = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n            gl_FragColor = col * opacity;\n            gl_FragColor.rgb *= dt;\n            gl_FragColor.rgb += atm * uAtmosphereColor;\n        }\n    "),e.compileShader(ms._frag),e.getShaderParameter(ms._frag,Yr.COMPILE_STATUS)||e.getShaderInfoLog(ms._frag),ms._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(ms._vert,"        attribute vec3 aVertexPosition;\n        attribute vec3 aNormal;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vCamVector = normalize((mat3(uMVMatrix) * aVertexPosition).xyz);\n            vec3 normalT = normalize(mat3(uMVMatrix) * aNormal);\n            vTextureCoord = aTextureCoord;\n            vNormal = normalT;\n        }\n    "),e.compileShader(ms._vert),e.getShaderParameter(ms._vert,Yr.COMPILE_STATUS)||e.getShaderInfoLog(ms._vert),ms._prog=e.createProgram(),e.attachShader(ms._prog,ms._vert),e.attachShader(ms._prog,ms._frag),e.linkProgram(ms._prog),e.getProgramParameter(ms._prog,Yr.LINK_STATUS),e.useProgram(ms._prog),ms.vertLoc=e.getAttribLocation(ms._prog,"aVertexPosition"),ms.normalLoc=e.getAttribLocation(ms._prog,"aNormal"),ms.textureLoc=e.getAttribLocation(ms._prog,"aTextureCoord"),ms.projMatLoc=e.getUniformLocation(ms._prog,"uPMatrix"),ms.mvMatLoc=e.getUniformLocation(ms._prog,"uMVMatrix"),ms.sampLoc=e.getUniformLocation(ms._prog,"uSampler"),ms.sunLoc=e.getUniformLocation(ms._prog,"uSunPosition"),ms.minBrightnessLoc=e.getUniformLocation(ms._prog,"uMinBrightness"),ms.opacityLoc=e.getUniformLocation(ms._prog,"opacity"),ms.atmosphereColorLoc=e.getUniformLocation(ms._prog,"uAtmosphereColor"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),ms.initialized=!0},ms.use=function(t,e,i,n,r,s,a){null==n&&(n=rs.getEmpty());var o=t.gl;if(null!=o){ms.initialized||ms.init(t),o.useProgram(ms._prog);var l=yn.multiplyMatrix(t.get_world(),t.get_view());o.uniform1f(ms.opacityLoc,r),o.uniform1f(ms.minBrightnessLoc,t.lighting?ms.minLightingBrightness:1),t.lighting?o.uniform3f(ms.atmosphereColorLoc,ms.atmosphereColor.r/255,ms.atmosphereColor.g/255,ms.atmosphereColor.b/255):o.uniform3f(ms.atmosphereColorLoc,0,0,0),o.uniformMatrix4fv(ms.mvMatLoc,!1,l.floatArray()),o.uniformMatrix4fv(ms.projMatLoc,!1,t.get_projection().floatArray()),ms.sunPosition.normalize();var h=t.get_view().clone();h.set_m41(0),h.set_m42(0),h.set_m43(0),h.set_m44(1);var u=wn._transformCoordinate(ms.sunPosition,h);u.normalize(),o.uniform3f(ms.sunLoc,-u.x,-u.y,-u.z),o.uniform1i(ms.sampLoc,0),t.space||s?o.disable(Yr.DEPTH_TEST):o.enable(Yr.DEPTH_TEST),o.disableVertexAttribArray(0),o.disableVertexAttribArray(1),o.disableVertexAttribArray(2),o.disableVertexAttribArray(3),o.bindBuffer(Yr.ARRAY_BUFFER,e),o.enableVertexAttribArray(ms.vertLoc),o.enableVertexAttribArray(ms.normalLoc),o.enableVertexAttribArray(ms.textureLoc),o.vertexAttribPointer(ms.vertLoc,3,Yr.FLOAT,!1,a,0),o.vertexAttribPointer(ms.normalLoc,3,Yr.FLOAT,!1,a,12),o.vertexAttribPointer(ms.textureLoc,2,Yr.FLOAT,!1,a,a-8),o.activeTexture(Yr.TEXTURE0),o.bindTexture(Yr.TEXTURE_2D,n),o.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,i),o.enable(Yr.BLEND),s?o.blendFunc(Yr.SRC_ALPHA,Yr.ONE):o.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("ModelShaderTan",[ms,{},null]),ps.vertLoc=0,ps.textureLoc=0,ps.initialized=!1,ps._prog=null,ps.sunPosition=wn.create(-1,-1,-1),ps.minLightingBrightness=1,ps.atmosphereColor=Oi.fromArgb(0,0,0,0),ps.init=function(t){var e=t.gl;ps._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(ps._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        uniform sampler2D uSampler;\n        uniform float opacity;\n        uniform vec3 uSunPosition;\n        uniform float uMinBrightness;\n        uniform vec3 uAtmosphereColor;\n\n        void main(void) {\n            vec3 normal = normalize(vNormal);\n            vec3 camVN = normalize(vCamVector);\n            vec3 cam = normalize(vec3(0.0,0.0,-1.0));\n            float dt = uMinBrightness + pow(max(0.0,- dot(normal,uSunPosition)),0.5);\n            float atm = max(0.0, 1.0 - 2.5 * dot(cam,camVN)) + 0.3 * dt;\n            atm = (dt > uMinBrightness) ? atm : 0.0;\n            if ( uMinBrightness == 1.0 ) { dt = 1.0; atm = 0.0; }\n            vec4 col = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n            gl_FragColor = col * opacity;\n            gl_FragColor.rgb *= dt;\n            gl_FragColor.rgb += atm * uAtmosphereColor;\n        }\n    "),e.compileShader(ps._frag),e.getShaderParameter(ps._frag,Yr.COMPILE_STATUS)||e.getShaderInfoLog(ps._frag),ps._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(ps._vert,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform vec3 uCenterScreen;\n        uniform vec3 uCenterWorld;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        void main(void) {\n            vec3 normal;\n\n            if (length(uCenterWorld) > 0.00001) {\n                gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 0.0) + vec4(uCenterScreen, 1.0);\n                vCamVector = normalize((mat3(uMVMatrix) * (aVertexPosition + uCenterWorld)).xyz);\n                normal = normalize(aVertexPosition + uCenterWorld);\n            } else {\n                gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n                vCamVector = normalize((mat3(uMVMatrix) * aVertexPosition).xyz);\n                normal = normalize(aVertexPosition);\n            }\n\n            vec3 normalT = normalize(mat3(uMVMatrix) * normal);\n            vTextureCoord = aTextureCoord;\n            vNormal = normalT;\n        }\n    "),e.compileShader(ps._vert),e.getShaderParameter(ps._vert,Yr.COMPILE_STATUS)||e.getShaderInfoLog(ps._vert),ps._prog=e.createProgram(),e.attachShader(ps._prog,ps._vert),e.attachShader(ps._prog,ps._frag),e.linkProgram(ps._prog),e.getProgramParameter(ps._prog,Yr.LINK_STATUS),e.useProgram(ps._prog),ps.vertLoc=e.getAttribLocation(ps._prog,"aVertexPosition"),ps.textureLoc=e.getAttribLocation(ps._prog,"aTextureCoord"),ps.projMatLoc=e.getUniformLocation(ps._prog,"uPMatrix"),ps.mvMatLoc=e.getUniformLocation(ps._prog,"uMVMatrix"),ps.sampLoc=e.getUniformLocation(ps._prog,"uSampler"),ps.centerScreenLoc=e.getUniformLocation(ps._prog,"uCenterScreen"),ps.centerWorldLoc=e.getUniformLocation(ps._prog,"uCenterWorld"),ps.sunLoc=e.getUniformLocation(ps._prog,"uSunPosition"),ps.minBrightnessLoc=e.getUniformLocation(ps._prog,"uMinBrightness"),ps.opacityLoc=e.getUniformLocation(ps._prog,"opacity"),ps.atmosphereColorLoc=e.getUniformLocation(ps._prog,"uAtmosphereColor"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),ps.initialized=!0},ps.use=function(t,e,i,n,r,s,a){null==n&&(n=rs.getEmpty());var o=t.gl;if(null!=o){ps.initialized||ps.init(t),o.useProgram(ps._prog);var l=yn.multiplyMatrix(t.get_world(),t.get_view());if(o.uniform1f(ps.opacityLoc,r),o.uniform1f(ps.minBrightnessLoc,t.lighting?ps.minLightingBrightness:1),t.lighting?o.uniform3f(ps.atmosphereColorLoc,ps.atmosphereColor.r/255,ps.atmosphereColor.g/255,ps.atmosphereColor.b/255):o.uniform3f(ps.atmosphereColorLoc,0,0,0),o.uniform3f(ps.centerWorldLoc,a.x,a.y,a.z),a.lengthSq()>.001){var h=yn.multiplyMatrix(l,t.get_projection()).transform(a);o.uniform3f(ps.centerScreenLoc,h.x,h.y,h.z)}else o.uniform3f(ps.centerScreenLoc,0,0,0);o.uniformMatrix4fv(ps.mvMatLoc,!1,l.floatArray()),o.uniformMatrix4fv(ps.projMatLoc,!1,t.get_projection().floatArray()),ps.sunPosition.normalize();var u=t.get_view().clone();u.set_m41(0),u.set_m42(0),u.set_m43(0),u.set_m44(1);var c=wn._transformCoordinate(ps.sunPosition,u);c.normalize(),o.uniform3f(ps.sunLoc,-c.x,-c.y,-c.z),o.uniform1i(ps.sampLoc,0),t.space||s?o.disable(Yr.DEPTH_TEST):o.enable(Yr.DEPTH_TEST),o.disableVertexAttribArray(0),o.disableVertexAttribArray(1),o.disableVertexAttribArray(2),o.disableVertexAttribArray(3),o.bindBuffer(Yr.ARRAY_BUFFER,e),o.enableVertexAttribArray(ps.vertLoc),o.enableVertexAttribArray(ps.textureLoc),o.vertexAttribPointer(ps.vertLoc,3,Yr.FLOAT,!1,20,0),o.vertexAttribPointer(ps.textureLoc,2,Yr.FLOAT,!1,20,12),o.activeTexture(Yr.TEXTURE0),o.bindTexture(Yr.TEXTURE_2D,n),o.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,i),o.enable(Yr.BLEND),s?o.blendFunc(Yr.SRC_ALPHA,Yr.ONE):o.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("TileShader",[ps,{},null]),ws.vertLoc=0,ws.textureLoc=0,ws.initialized=!1,ws._prog=null,ws.blankValue=0,ws.bScale=1,ws.bZero=0,ws.min=0,ws.max=0,ws.transparentBlack=!1,ws.containsBlanks=!1,ws.scaleType=0,ws.init=function(t){var e=t.gl;if(ws._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(ws._frag,'        #version 300 es\n\n        precision mediump float;\n        in vec2 vTextureCoord;\n        in vec3 vNormal;\n        in vec3 vCamVector;\n        out vec4 fragmentColor;\n\n        uniform sampler2D uSampler;\n        uniform sampler2D colorSampler;\n        uniform float blank;\n        uniform float bzero;\n        uniform float bscale;\n        uniform float min;\n        uniform float max;\n        uniform bool containsBlanks;\n        uniform bool transparentBlack;\n        uniform int scaleType;\n        uniform float opacity;\n\n        bool isNaN(float value) {\n            // See https://stackoverflow.com/questions/9446888/best-way-to-detect-nans-in-opengl-shaders\n            // PKGW also finds that we need "value != value" on his Dell laptop running\n            // Chrome on Linux.\n            return (value != value) || !(value < 0.0 || 0.0 < value || value == 0.0);\n        }\n\n        void main(void) {\n            //FITS images are flipped on the y axis\n            vec4 color = texture(uSampler, vec2(vTextureCoord.x, 1.0 - vTextureCoord.y));\n\n            if(isNaN(color.r) || (containsBlanks && abs(blank - color.r) < 0.00000001)){\n                fragmentColor = vec4(0.0, 0.0, 0.0, 0.0);\n            } else {\n                float physicalValue = (bzero + bscale * color.r - min) / (max - min);\n                if(transparentBlack && physicalValue <= 0.0){\n                    fragmentColor = vec4(0.0, 0.0, 0.0, 0.0);\n                    return;\n                }\n\n                physicalValue = clamp(physicalValue, 0.0, 1.0);\n\n                switch(scaleType){\n                    case 1:\n                        physicalValue = log(physicalValue * 255.0 + 1.0 ) / log(256.0);\n                        break;\n                    case 2:\n                        physicalValue = physicalValue * physicalValue;\n                        break;\n                    case 3:\n                        physicalValue = sqrt(physicalValue);\n                        break;\n                }\n                vec4 colorFromColorMapper = texture(colorSampler, vec2(physicalValue, 0.5));\n                fragmentColor = vec4(colorFromColorMapper.rgb, opacity);\n            }\n        }\n    '),e.compileShader(ws._frag),!e.getShaderParameter(ws._frag,Yr.COMPILE_STATUS)){var i=e.getShaderInfoLog(ws._frag);console.log(i)}if(ws._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(ws._vert,"        #version 300 es\n\n        in vec3 aVertexPosition;\n        in vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n        uniform vec3 uCenterScreen;\n\n        out vec2 vTextureCoord;\n\n        void main(void) {\n            if(length(uCenterScreen) > 0.0000001) {\n                gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 0.0) + vec4(uCenterScreen, 1.0);\n            } else {\n                gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            }\n\n            vTextureCoord = aTextureCoord;\n        }\n    "),e.compileShader(ws._vert),!e.getShaderParameter(ws._vert,Yr.COMPILE_STATUS)){var n=e.getShaderInfoLog(ws._vert);console.log(n)}ws._prog=e.createProgram(),e.attachShader(ws._prog,ws._vert),e.attachShader(ws._prog,ws._frag),e.linkProgram(ws._prog),e.getProgramParameter(ws._prog,Yr.LINK_STATUS),e.useProgram(ws._prog),ws.vertLoc=e.getAttribLocation(ws._prog,"aVertexPosition"),ws.textureLoc=e.getAttribLocation(ws._prog,"aTextureCoord"),ws.projMatLoc=e.getUniformLocation(ws._prog,"uPMatrix"),ws.mvMatLoc=e.getUniformLocation(ws._prog,"uMVMatrix"),ws.sampLoc=e.getUniformLocation(ws._prog,"uSampler"),ws.colorLoc=e.getUniformLocation(ws._prog,"colorSampler"),ws.centerScreenLoc=e.getUniformLocation(ws._prog,"uCenterScreen"),ws.blank=e.getUniformLocation(ws._prog,"blank"),ws.bzero=e.getUniformLocation(ws._prog,"bzero"),ws.bscale=e.getUniformLocation(ws._prog,"bscale"),ws.minLoc=e.getUniformLocation(ws._prog,"min"),ws.maxLoc=e.getUniformLocation(ws._prog,"max"),ws.transparentBlackLoc=e.getUniformLocation(ws._prog,"transparentBlack"),ws.containsBlanksLoc=e.getUniformLocation(ws._prog,"containsBlanks"),ws.scalingLocation=e.getUniformLocation(ws._prog,"scaleType"),ws.opacityLoc=e.getUniformLocation(ws._prog,"opacity"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),ws.initialized=!0},ws.use=function(t,e,i,n,r,s,a){null==n&&(n=rs.getEmpty());var o=t.gl;if(null!=o){ws.initialized||ws.init(t),o.useProgram(ws._prog);var l=yn.multiplyMatrix(t.get_world(),t.get_view());if(o.uniform1f(ws.opacityLoc,r),o.uniformMatrix4fv(ws.mvMatLoc,!1,l.floatArray()),o.uniformMatrix4fv(ws.projMatLoc,!1,t.get_projection().floatArray()),a.lengthSq()>.001){var h=yn.multiplyMatrix(l,t.get_projection()).transform(a);o.uniform3f(ws.centerScreenLoc,h.x,h.y,h.z)}else o.uniform3f(ws.centerScreenLoc,0,0,0);o.uniform1i(ws.sampLoc,0),o.uniform1i(ws.colorLoc,1),o.uniform1f(ws.blank,ws.blankValue),o.uniform1f(ws.bzero,ws.bZero),o.uniform1f(ws.bscale,ws.bScale),o.uniform1f(ws.minLoc,ws.min),o.uniform1f(ws.maxLoc,ws.max),o.uniform1i(ws.transparentBlackLoc,ws.transparentBlack),o.uniform1i(ws.containsBlanksLoc,ws.containsBlanks),o.uniform1i(ws.scalingLocation,ws.scaleType),t.space||s?o.disable(Yr.DEPTH_TEST):o.enable(Yr.DEPTH_TEST),o.disableVertexAttribArray(0),o.disableVertexAttribArray(1),o.disableVertexAttribArray(2),o.disableVertexAttribArray(3),o.bindBuffer(Yr.ARRAY_BUFFER,e),o.enableVertexAttribArray(ws.vertLoc),o.enableVertexAttribArray(ws.textureLoc),o.vertexAttribPointer(ws.vertLoc,3,Yr.FLOAT,!1,20,0),o.vertexAttribPointer(ws.textureLoc,2,Yr.FLOAT,!1,20,12),o.activeTexture(Yr.TEXTURE0),o.bindTexture(Yr.TEXTURE_2D,n),o.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,i),o.enable(Yr.BLEND),s?o.blendFunc(Yr.SRC_ALPHA,Yr.ONE):o.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("FitsShader",[ws,{},null]),bs.vertLoc=0,bs.textureLoc=0,bs.initialized=!1,bs._prog=null,bs.init=function(t){var e=t.gl;bs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(bs._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n\n        uniform sampler2D uSampler;\n        uniform float opacity;\n\n        void main(void) {\n            vec4 col = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n            gl_FragColor = col * opacity;\n        }\n    "),e.compileShader(bs._frag),e.getShaderParameter(bs._frag,Yr.COMPILE_STATUS)||e.getShaderInfoLog(bs._frag),bs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(bs._vert,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vTextureCoord = aTextureCoord;\n        }\n    "),e.compileShader(bs._vert),e.getShaderParameter(bs._vert,Yr.COMPILE_STATUS)||e.getShaderInfoLog(bs._vert),bs._prog=e.createProgram(),e.attachShader(bs._prog,bs._vert),e.attachShader(bs._prog,bs._frag),e.linkProgram(bs._prog),e.getProgramParameter(bs._prog,Yr.LINK_STATUS),e.useProgram(bs._prog),bs.vertLoc=e.getAttribLocation(bs._prog,"aVertexPosition"),bs.textureLoc=e.getAttribLocation(bs._prog,"aTextureCoord"),bs.projMatLoc=e.getUniformLocation(bs._prog,"uPMatrix"),bs.mvMatLoc=e.getUniformLocation(bs._prog,"uMVMatrix"),bs.sampLoc=e.getUniformLocation(bs._prog,"uSampler"),bs.opacityLoc=e.getUniformLocation(bs._prog,"opacity"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),bs.initialized=!0},bs.use=function(t,e,i,n,r,s){null==n&&(n=rs.getEmpty());var a=t.gl;if(null!=a){bs.initialized||bs.init(t),a.useProgram(bs._prog);var o=yn.multiplyMatrix(t.get_world(),t.get_view());a.uniform1f(bs.opacityLoc,r),a.uniformMatrix4fv(bs.mvMatLoc,!1,o.floatArray()),a.uniformMatrix4fv(bs.projMatLoc,!1,t.get_projection().floatArray()),a.uniform1i(bs.sampLoc,0),t.space||s?a.disable(Yr.DEPTH_TEST):a.enable(Yr.DEPTH_TEST),a.disableVertexAttribArray(0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.bindBuffer(Yr.ARRAY_BUFFER,e),a.enableVertexAttribArray(bs.vertLoc),a.enableVertexAttribArray(bs.textureLoc),a.vertexAttribPointer(bs.vertLoc,3,Yr.FLOAT,!1,20,0),a.vertexAttribPointer(bs.textureLoc,2,Yr.FLOAT,!1,20,12),a.activeTexture(Yr.TEXTURE0),a.bindTexture(Yr.TEXTURE_2D,n),a.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,i),a.enable(Yr.BLEND),s?a.blendFunc(Yr.SRC_ALPHA,Yr.ONE):a.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("ImageShader",[bs,{},null]),vs.vertLoc=0,vs.textureLoc=0,vs.initialized=!1,vs._prog=null,vs.init=function(t){var e=t.gl;vs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(vs._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n\n        uniform sampler2D uSampler;\n        uniform float opacity;\n\n        void main(void) {\n            vec4 col = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n            gl_FragColor = col * opacity;\n        }\n    "),e.compileShader(vs._frag),e.getShaderParameter(vs._frag,Yr.COMPILE_STATUS)||e.getShaderInfoLog(vs._frag),vs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(vs._vert,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n        varying vec3 vNormal;\n        varying vec3 vCamVector;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vTextureCoord = aTextureCoord;\n        }\n    "),e.compileShader(vs._vert),e.getShaderParameter(vs._vert,Yr.COMPILE_STATUS)||e.getShaderInfoLog(vs._vert),vs._prog=e.createProgram(),e.attachShader(vs._prog,vs._vert),e.attachShader(vs._prog,vs._frag),e.linkProgram(vs._prog),e.getProgramParameter(vs._prog,Yr.LINK_STATUS),e.useProgram(vs._prog),vs.vertLoc=e.getAttribLocation(vs._prog,"aVertexPosition"),vs.textureLoc=e.getAttribLocation(vs._prog,"aTextureCoord"),vs.projMatLoc=e.getUniformLocation(vs._prog,"uPMatrix"),vs.mvMatLoc=e.getUniformLocation(vs._prog,"uMVMatrix"),vs.sampLoc=e.getUniformLocation(vs._prog,"uSampler"),vs.opacityLoc=e.getUniformLocation(vs._prog,"opacity"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),vs.initialized=!0},vs.use=function(t,e,i,n,r,s){null==n&&(n=rs.getEmpty());var a=t.gl;if(null!=a){vs.initialized||vs.init(t),a.useProgram(vs._prog);var o=yn.multiplyMatrix(t.get_world(),t.get_view());a.uniform1f(vs.opacityLoc,r),a.uniformMatrix4fv(vs.mvMatLoc,!1,o.floatArray()),a.uniformMatrix4fv(vs.projMatLoc,!1,t.get_projection().floatArray()),a.uniform1i(vs.sampLoc,0),t.space||s?a.disable(Yr.DEPTH_TEST):a.enable(Yr.DEPTH_TEST),a.disableVertexAttribArray(0),a.disableVertexAttribArray(1),a.disableVertexAttribArray(2),a.disableVertexAttribArray(3),a.bindBuffer(Yr.ARRAY_BUFFER,e),a.enableVertexAttribArray(vs.vertLoc),a.enableVertexAttribArray(vs.textureLoc),a.vertexAttribPointer(vs.vertLoc,3,Yr.FLOAT,!1,32,0),a.vertexAttribPointer(vs.textureLoc,2,Yr.FLOAT,!1,32,24),a.activeTexture(Yr.TEXTURE0),a.bindTexture(Yr.TEXTURE_2D,n),a.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,i),a.enable(Yr.BLEND),s?a.blendFunc(Yr.SRC_ALPHA,Yr.ONE):a.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("ImageShader2",[vs,{},null]),ys.vertLoc=0,ys.textureLoc=0,ys.colorLoc=0,ys.initialized=!1,ys._prog=null,ys.init=function(t){var e=t.gl;ys._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(ys._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n        varying lowp vec4 vColor;\n        uniform sampler2D uSampler;\n\n        void main(void) {\n            gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t)) * vColor;\n        }\n    "),e.compileShader(ys._frag),e.getShaderParameter(ys._frag,Yr.COMPILE_STATUS),ys._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(ys._vert,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n        attribute lowp vec4 aColor;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n        varying vec4 vColor;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vTextureCoord = aTextureCoord;\n            vColor = aColor;\n        }\n    "),e.compileShader(ys._vert),e.getShaderParameter(ys._vert,Yr.COMPILE_STATUS),ys._prog=e.createProgram(),e.attachShader(ys._prog,ys._vert),e.attachShader(ys._prog,ys._frag),e.linkProgram(ys._prog),e.getProgramParameter(ys._prog,Yr.LINK_STATUS),e.useProgram(ys._prog),ys.vertLoc=e.getAttribLocation(ys._prog,"aVertexPosition"),ys.textureLoc=e.getAttribLocation(ys._prog,"aTextureCoord"),ys.colorLoc=e.getAttribLocation(ys._prog,"aColor"),ys.projMatLoc=e.getUniformLocation(ys._prog,"uPMatrix"),ys.mvMatLoc=e.getUniformLocation(ys._prog,"uMVMatrix"),ys.sampLoc=e.getUniformLocation(ys._prog,"uSampler"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),ys.initialized=!0},ys.use=function(t,e,i){null==i&&(i=rs.getEmpty());var n=t.gl;if(null!=n){ys.initialized||ys.init(t),n.useProgram(ys._prog);var r=yn.multiplyMatrix(t.get_world(),t.get_view());n.uniformMatrix4fv(ys.mvMatLoc,!1,r.floatArray()),n.uniformMatrix4fv(ys.projMatLoc,!1,t.get_projection().floatArray()),n.uniform1i(ys.sampLoc,0),n.disable(Yr.DEPTH_TEST),n.disableVertexAttribArray(0),n.disableVertexAttribArray(1),n.disableVertexAttribArray(2),n.disableVertexAttribArray(3),n.bindBuffer(Yr.ARRAY_BUFFER,e),n.enableVertexAttribArray(ys.vertLoc),n.enableVertexAttribArray(ys.textureLoc),n.enableVertexAttribArray(ys.colorLoc),n.vertexAttribPointer(ys.vertLoc,3,Yr.FLOAT,!1,36,0),n.vertexAttribPointer(ys.colorLoc,4,Yr.FLOAT,!1,36,12),n.vertexAttribPointer(ys.textureLoc,2,Yr.FLOAT,!1,36,28),n.activeTexture(Yr.TEXTURE0),n.bindTexture(Yr.TEXTURE_2D,i),n.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),n.enable(Yr.BLEND),n.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("SpriteShader",[ys,{},null]),Ss.vertLoc=0,Ss.textureLoc=0,Ss.colorLoc=0,Ss.initialized=!1,Ss._prog=null,Ss.init=function(t){var e=t.gl;Ss._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(Ss._frag,"        precision mediump float;\n\n        varying lowp vec4 vColor;\n\n        void main(void) {\n            gl_FragColor =  vColor;\n        }\n    "),e.compileShader(Ss._frag),e.getShaderParameter(Ss._frag,Yr.COMPILE_STATUS),Ss._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(Ss._vert,"        attribute vec3 aVertexPosition;\n        attribute lowp vec4 aColor;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n        varying vec4 vColor;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vColor = aColor;\n        }\n    "),e.compileShader(Ss._vert),e.getShaderParameter(Ss._vert,Yr.COMPILE_STATUS),Ss._prog=e.createProgram(),e.attachShader(Ss._prog,Ss._vert),e.attachShader(Ss._prog,Ss._frag),e.linkProgram(Ss._prog),e.getProgramParameter(Ss._prog,Yr.LINK_STATUS),e.useProgram(Ss._prog),Ss.vertLoc=e.getAttribLocation(Ss._prog,"aVertexPosition"),Ss.colorLoc=e.getAttribLocation(Ss._prog,"aColor"),Ss.projMatLoc=e.getUniformLocation(Ss._prog,"uPMatrix"),Ss.mvMatLoc=e.getUniformLocation(Ss._prog,"uMVMatrix"),e.disable(Yr.DEPTH_TEST),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),Ss.initialized=!0},Ss.use=function(t,e){var i=t.gl;if(null!=i){Ss.initialized||Ss.init(t),i.useProgram(Ss._prog);var n=yn.multiplyMatrix(t.get_world(),t.get_view());i.uniformMatrix4fv(Ss.mvMatLoc,!1,n.floatArray()),i.uniformMatrix4fv(Ss.projMatLoc,!1,t.get_projection().floatArray()),i.uniform1i(Ss.sampLoc,0),i.disable(Yr.DEPTH_TEST),i.disableVertexAttribArray(0),i.disableVertexAttribArray(1),i.disableVertexAttribArray(2),i.disableVertexAttribArray(3),i.bindBuffer(Yr.ARRAY_BUFFER,e),i.enableVertexAttribArray(Ss.vertLoc),i.enableVertexAttribArray(Ss.textureLoc),i.enableVertexAttribArray(Ss.colorLoc),i.vertexAttribPointer(Ss.vertLoc,3,Yr.FLOAT,!1,36,0),i.vertexAttribPointer(Ss.colorLoc,4,Yr.FLOAT,!1,36,12),i.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),i.enable(Yr.BLEND),i.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("ShapeSpriteShader",[Ss,{},null]),xs.vertLoc=0,xs.textureLoc=0,xs.initialized=!1,xs._prog=null,xs.init=function(t){var e=t.gl;xs._frag=e.createShader(Yr.FRAGMENT_SHADER),e.shaderSource(xs._frag,"        precision mediump float;\n\n        varying vec2 vTextureCoord;\n\n        uniform sampler2D uSampler;\n\n        void main(void) {\n            gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n        }\n    "),e.compileShader(xs._frag),e.getShaderParameter(xs._frag,Yr.COMPILE_STATUS),xs._vert=e.createShader(Yr.VERTEX_SHADER),e.shaderSource(xs._vert,"        attribute vec3 aVertexPosition;\n        attribute vec2 aTextureCoord;\n\n        uniform mat4 uMVMatrix;\n        uniform mat4 uPMatrix;\n\n        varying vec2 vTextureCoord;\n\n        void main(void) {\n            gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n            vTextureCoord = aTextureCoord;\n        }\n    "),e.compileShader(xs._vert),e.getShaderParameter(xs._vert,Yr.COMPILE_STATUS),xs._prog=e.createProgram(),e.attachShader(xs._prog,xs._vert),e.attachShader(xs._prog,xs._frag),e.linkProgram(xs._prog),e.getProgramParameter(xs._prog,Yr.LINK_STATUS),e.useProgram(xs._prog),xs.vertLoc=e.getAttribLocation(xs._prog,"aVertexPosition"),xs.textureLoc=e.getAttribLocation(xs._prog,"aTextureCoord"),xs.projMatLoc=e.getUniformLocation(xs._prog,"uPMatrix"),xs.mvMatLoc=e.getUniformLocation(xs._prog,"uMVMatrix"),xs.sampLoc=e.getUniformLocation(xs._prog,"uSampler"),Wi(1),Zi(!0),e.enable(Yr.BLEND),e.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA),xs.initialized=!0},xs.use=function(t,e,i){null==i&&(i=rs.getEmpty());var n=t.gl;if(null!=n){xs.initialized||xs.init(t),n.useProgram(xs._prog);var r=yn.multiplyMatrix(t.get_world(),t.get_view());n.uniformMatrix4fv(xs.mvMatLoc,!1,r.floatArray()),n.uniformMatrix4fv(xs.projMatLoc,!1,t.get_projection().floatArray()),n.uniform1i(xs.sampLoc,0),t.space?n.disable(Yr.DEPTH_TEST):n.enable(Yr.DEPTH_TEST),n.disableVertexAttribArray(0),n.disableVertexAttribArray(1),n.disableVertexAttribArray(2),n.disableVertexAttribArray(3),n.bindBuffer(Yr.ARRAY_BUFFER,e),n.enableVertexAttribArray(xs.vertLoc),n.enableVertexAttribArray(xs.textureLoc),n.vertexAttribPointer(xs.vertLoc,3,Yr.FLOAT,!1,20,0),n.vertexAttribPointer(xs.textureLoc,2,Yr.FLOAT,!1,20,12),n.activeTexture(Yr.TEXTURE0),n.bindTexture(Yr.TEXTURE_2D,i),n.enable(Yr.BLEND),n.blendFunc(Yr.SRC_ALPHA,Yr.ONE_MINUS_SRC_ALPHA)}},n("TextShader",[xs,{},null]);var Ts={none:0,counterClockwise:2,clockwise:1};n("CullMode",Ts),r("CullMode",Ts);var Ms={linear:0,power:1,log:2,constant:3,stellarMagnitude:4};function Cs(){this.size=0}function As(t,e){this.startDate=0,this.endDate=0,this.startDate=t,this.endDate=e}n("PointScaleTypes",Ms),r("PointScaleTypes",Ms),n("DataItem",[Cs,{getColor:function(){return"Red"}},null]),As.empty=function(){return new As(0,0)};var Ls={copy:function(){return new As(this.startDate,this.endDate)}};function Is(){this._zBuffer=!0,this._linePoints=[],this._usingLocalCenter=!1,this.sky=!0,this.aaFix=!0,this.pure2D=!1,this.viewTransform=yn.get_identity(),this._lineBuffers=[],this._lineBufferCounts=[],this.useLocalCenters=!1}n("Dates",[As,Ls,null]);var ks={get_depthBuffered:function(){return this._zBuffer},set_depthBuffered:function(t){return this._zBuffer=t,t},addLine:function(t,e){this._linePoints.push(t),this._linePoints.push(e),this._emptyLineBuffer()},clear:function(){this._linePoints.length=0,this._emptyLineBuffer()},drawLines:function(e,i,n){if(!(this._linePoints.length<2)){this._initLineBuffer(e);var r=this._linePoints.length;if(null==e.gl){var s=wn._transformCoordinate(e.get_viewPoint(),this.viewTransform),a=e.device;a.save(),a.strokeStyle=n.toString(),a.lineWidth=2,a.globalAlpha=.25;for(var o=new wn,l=new wn,h=0;h<r;h+=2)o=e.WVP.transform(this._linePoints[h]),l=e.WVP.transform(this._linePoints[h+1]),wn.dot(this._linePoints[h],s)>.6&&(a.beginPath(),a.moveTo(o.x,o.y),a.lineTo(l.x,l.y),a.stroke());a.restore()}else for(var u=t.ss.enumerate(this._lineBuffers);u.moveNext();){var c=u.current;this.pure2D?hs.use(e,c.vertexBuffer,n,this._zBuffer):ls.use(e,c.vertexBuffer,n,this._zBuffer),e.gl.drawArrays(Yr.LINES,0,c.count)}}},_initLineBuffer:function(e){if(null!=e.gl&&!this._lineBuffers.length){var i=this._linePoints.length,n=null,r=null;if(this._localCenter=new wn,this.get_depthBuffered()){for(var s=t.ss.enumerate(this._linePoints);s.moveNext();){var a=s.current;this._localCenter.add(a)}this._localCenter.x/=i,this._localCenter.y/=i,this._localCenter.z/=i}for(var o,l=i,h=0,u=t.ss.enumerate(this._linePoints);u.moveNext();){if(a=u.current,h>=1e5||null==r){null!=n&&n.unlock();var c=Math.min(1e5,l);l-=c,r=(n=new Zr(c)).lock(),this._lineBuffers.push(n),this._lineBufferCounts.push(c),h=0}this.useLocalCenters?(o=wn.subtractVectors(a,this._localCenter),r[h]=o):r[h]=a,h++}null!=n&&n.unlock()}},_emptyLineBuffer:function(){}};function Ps(){this._zBuffer=!0,this._linePoints=[],this._lineColors=[],this.sky=!0,this.aaFix=!0,this.viewTransform=yn.get_identity(),this._lineBuffers=[],this._lineBufferCounts=[],this.useLocalCenters=!1}n("SimpleLineList",[Is,ks,null]);var Rs={get_depthBuffered:function(){return this._zBuffer},set_depthBuffered:function(t){return this._zBuffer=t,t},addLine:function(t,e,i,n){this._linePoints.push(t),this._lineColors.push(i),this._linePoints.push(e),this._lineColors.push(n),this._emptyLineBuffer()},clear:function(){this._linePoints.length=0,this._emptyLineBuffer()},drawLines:function(e,i,n){if(!(this._linePoints.length<2)){this._initLineBuffer(e),this._linePoints.length;for(var r=t.ss.enumerate(this._lineBuffers);r.moveNext();){var s=r.current;us.use(e,s.vertexBuffer,n),e.gl.drawArrays(Yr.LINES,0,s.count)}}},_initLineBuffer:function(e){if(null!=e.gl&&!this._lineBuffers.length){var i=this._linePoints.length,n=null,r=null;if(this._localCenter=new wn,this.get_depthBuffered()){for(var s=t.ss.enumerate(this._linePoints);s.moveNext();){var a=s.current;this._localCenter.add(a)}this._localCenter.x/=i,this._localCenter.y/=i,this._localCenter.z/=i}for(var o,l=i,h=0,u=0,c=t.ss.enumerate(this._linePoints);c.moveNext();){if(a=c.current,u>=1e5||null==r){null!=n&&n.unlock();var _=Math.min(1e5,l);l-=_,r=(n=new ns(_)).lock(),this._lineBuffers.push(n),this._lineBufferCounts.push(_),u=0}this.useLocalCenters?(o=wn.subtractVectors(a,this._localCenter),r[u]=new gn(o,this._lineColors[h])):r[u]=new gn(a,this._lineColors[h]),h++,u++}null!=n&&n.unlock()}},_emptyLineBuffer:function(){for(var e=t.ss.enumerate(this._lineBuffers);e.moveNext();)e.current.dispose();this._lineBuffers.length=0}};function Es(){this._zBuffer=!0,this.timeSeries=!1,this.showFarSide=!0,this.sky=!1,this.decay=0,this.useNonRotatingFrame=!1,this.jNow=0,this._linePoints=[],this._lineColors=[],this._lineDates=[],this._usingLocalCenter=!0,this._lineBuffers=[],this._lineBufferCounts=[]}n("OrbitLineList",[Ps,Rs,null]);var Ds={get_depthBuffered:function(){return this._zBuffer},set_depthBuffered:function(t){return this._zBuffer=t,t},addLine:function(t,e,i,n){this._linePoints.push(t),this._linePoints.push(e),this._lineColors.push(i),this._lineDates.push(n),this._emptyLineBuffer()},addLineNoDate:function(t,e,i){this._linePoints.push(t),this._linePoints.push(e),this._lineColors.push(i),this._lineDates.push(new As(0,0)),this._emptyLineBuffer()},clear:function(){this._linePoints.length=0,this._lineColors.length=0,this._lineDates.length=0},drawLines:function(e,i){if(!(this._linePoints.length<2||i<=0))if(null==e.gl);else{this._initLineBuffer();for(var n=t.ss.enumerate(this._lineBuffers);n.moveNext();){var r=n.current;cs.use(e,r.vertexBuffer,Oi.fromArgb(255,255,255,255),this._zBuffer,this.jNow,this.timeSeries?this.decay:0),e.gl.drawArrays(Yr.LINES,0,r.count)}}},_initLineBuffer:function(){if(!this._lineBuffers.length){for(var e,i=null,n=null,r=this._linePoints.length,s=0,a=0,o=t.ss.enumerate(this._linePoints);o.moveNext();){var l=o.current;if(a>=1e5||null==n){null!=i&&i.unlock();var h=Math.min(1e5,r);r-=h,n=(i=new es(h)).lock(),this._lineBuffers.push(i),this._lineBufferCounts.push(h),a=0}var u=t.ss.truncate(s/2);e=l,n[a]=new Us,n[a].position=e,n[a].normal=l,n[a].tu=this._lineDates[u].startDate,n[a].tv=this._lineDates[u].endDate,n[a].set_color(this._lineColors[u]),s++,a++}null!=i&&i.unlock()}},_emptyLineBuffer:function(){}};function Fs(){this._trianglePoints=[],this._triangleColors=[],this._triangleDates=[],this.timeSeries=!1,this.showFarSide=!1,this.sky=!1,this.depthBuffered=!0,this.writeZbuffer=!1,this.decay=0,this.autoTime=!0,this.jNow=0,this._dataToDraw=!1,this._triangleBuffers=[],this._triangleBufferCounts=[]}function Ns(){this._zBuffer=!0,this.timeSeries=!1,this.decay=0,this.jNow=0,this._shapes=[],this._colors=[],this._dates=[],this._buffers=[],this._bufferCounts=[]}n("LineList",[Es,Ds,null]),n("TriangleList",[Fs,{addTriangle:function(t,e,i,n,r){this._trianglePoints.push(t),this._trianglePoints.push(e),this._trianglePoints.push(i),this._triangleColors.push(n),this._triangleDates.push(r),this._emptyTriangleBuffer()},addSubdividedTriangles:function(t,e,i,n,r,s){var a,o,l;--s<0?this.addTriangle(t,e,i,n,r):(a=wn.midPointByLength(t,e),o=wn.midPointByLength(e,i),l=wn.midPointByLength(i,t),this.addSubdividedTriangles(t,a,l,n,r,s),this.addSubdividedTriangles(a,o,l,n,r,s),this.addSubdividedTriangles(a,e,o,n,r,s),this.addSubdividedTriangles(o,i,l,n,r,s))},addQuad:function(t,e,i,n,r,s){this._trianglePoints.push(t),this._trianglePoints.push(i),this._trianglePoints.push(e),this._trianglePoints.push(e),this._trianglePoints.push(i),this._trianglePoints.push(n),this._triangleColors.push(r),this._triangleDates.push(s),this._triangleColors.push(r),this._triangleDates.push(s),this._emptyTriangleBuffer()},clear:function(){this._triangleColors.length=0,this._trianglePoints.length=0,this._triangleDates.length=0,this._emptyTriangleBuffer()},_emptyTriangleBuffer:function(){},_initTriangleBuffer:function(){if(!this._triangleBuffers.length){for(var e=null,i=null,n=this._trianglePoints.length,r=0,s=0,a=t.ss.enumerate(this._trianglePoints);a.moveNext();){var o=a.current;if(s>=9e4||null==e){null!=e&&e.unlock();var l=Math.min(9e4,n);n-=l,e=new es(l),this._triangleBuffers.push(e),this._triangleBufferCounts.push(l),i=e.lock(),s=0}i[s]=new Us,i[s].position=o,i[s].normal=o;var h=t.ss.truncate(r/3);i[s].set_color(this._triangleColors[h]),i[s].tu=this._triangleDates[h].startDate,i[s].tv=this._triangleDates[h].endDate,r++,s++}null!=e&&e.unlock(),this._triangleColors.length=0,this._triangleDates.length=0,this._trianglePoints.length=0,this._dataToDraw=!0}},draw:function(e,i,n){if(!(this._trianglePoints.length<1)||this._dataToDraw)if(null==e.gl);else{this._initTriangleBuffer();for(var r=t.ss.enumerate(this._triangleBuffers);r.moveNext();){var s=r.current;cs.use(e,s.vertexBuffer,Oi.fromArgb(255,255,255,255),this.depthBuffered,this.jNow,this.timeSeries?this.decay:0),e.gl.drawArrays(Yr.TRIANGLES,0,s.count)}}}},null]);var $s={get_depthBuffered:function(){return this._zBuffer},set_depthBuffered:function(t){return this._zBuffer=t,t},addShape:function(t,e,i){this._shapes.push(t),this._colors.push(e),this._dates.push(i)},draw:function(e,i){if(!(i<=0)&&null!=e.gl){this._initBuffer();for(var n=t.ss.enumerate(this._buffers);n.moveNext();){var r=n.current;cs.use(e,r.vertexBuffer,Oi.fromArgb(255,255,255,255),this._zBuffer,this.jNow,this.timeSeries?this.decay:0),e.gl.drawArrays(Yr.TRIANGLE_FAN,0,r.count)}}},_initBuffer:function(){if(this._buffers.length!==this._shapes.length){this._buffers.length=0;for(var e=0,i=t.ss.enumerate(this._shapes);i.moveNext();){var n=i.current,r=new es(n.length),s=r.lock();this._buffers.push(r),this._bufferCounts.push(n.length);for(var a=0,o=t.ss.enumerate(n);o.moveNext();){var l=o.current;s[a]=new Us,s[a].position=l,s[a].tu=this._dates[e].startDate,s[a].tv=this._dates[e].endDate,s[a].set_color(this._colors[e]),a++}e++,null!=r&&r.unlock()}}}};function zs(t){this._points=[],this._colors=[],this._dates=[],this._sizes=[],this.timeSeries=!1,this.showFarSide=!1,this.sky=!1,this.depthBuffered=!0,this.decay=0,this.scale=1,this.autoTime=!0,this.jNow=0,this._dataToDraw=!1,this.items=[],this._imageReady=!1,this._init=!1,this.minSize=2,this._pointBuffers=[],this._pointBufferCounts=[],this._device=t}n("TriangleFanList",[Ns,$s,null]),zs.starTexture=null;var Bs={addPoint:function(t,e,i,n){this._points.push(t),this._colors.push(e._clone()),this._dates.push(i),this._sizes.push(n),this._emptyPointBuffer()},clear:function(){this._colors.length=0,this._points.length=0,this._dates.length=0,this._sizes.length=0,this._emptyPointBuffer()},_emptyPointBuffer:function(){for(var e=t.ss.enumerate(this._pointBuffers);e.moveNext();)e.current.dispose();this._pointBuffers.length=0,this._init=!1},_initBuffer:function(e){var i=this;if(!this._init){if(null==e.gl){this._starProfile=document.createElement("img"),this._starProfile.addEventListener("load",(function(t){i._imageReady=!0}),!1),this._starProfile.src=zr.singleton.engineAssetUrl("StarProfileAlpha.png"),this._worldList=new Array(this._points.length),this._transformedList=new Array(this._points.length);for(var n=0,r=t.ss.enumerate(this._points);r.moveNext();){var s=r.current,a=new Cs;a.location=s,a.tranformed=new wn,a.size=this._sizes[n],a.color=this._colors[n],this._worldList[n]=a.location,this._transformedList[n]=a.tranformed,this.items.push(a),n++}}else if(!this._pointBuffers.length){null==zs.starTexture&&(zs.starTexture=rs.fromUrl(zr.singleton.engineAssetUrl("StarProfileAlpha.png")));for(var o=null,l=null,h=this._points.length,u=(n=0,0),c=t.ss.enumerate(this._points);c.moveNext();){var _=c.current;if(u>=1e5||null==l){null!=o&&o.unlock();var d=Math.min(1e5,h);h-=d,l=(o=new is(d)).lock(),this._pointBuffers.push(o),this._pointBufferCounts.push(d),u=0}l[u]=new Vs,l[u].position=_,l[u].pointSize=this._sizes[n],l[u].tu=this._dates[n].startDate,l[u].tv=this._dates[n].endDate,l[u].set_color(this._colors[n]),n++,u++}null!=o&&o.unlock()}this._init=!0}},draw:function(e,i,n){if(this._initBuffer(e),null==e.gl){if(!this._imageReady)return;e.device.save(),e.WVP.projectArrayToScreen(this._worldList,this._transformedList);var r=e.device;r.globalAlpha=.4;for(var s=e.width,a=e.height,o=(wn.makeCopy(e.get_viewPoint()),e.get_fovScale()/100),l=t.ss.enumerate(this.items);l.moveNext();){var h=l.current;if(h.tranformed.z<1){var u=h.tranformed.x,c=h.tranformed.y,_=.1*h.size/o,d=_/2;u>-d&&u<s+d&&c>-d&&c<a+d&&(r.beginPath(),r.fillStyle=h.color.toFormat(),r.arc(u,c,_,0,2*Math.PI,!0),r.fill())}}e.device.restore()}else{var g=new wn,f=yn.multiplyMatrix(e.get_world(),e.get_view());f.invert();for(var m=wn._transformCoordinate(g,f),p=t.ss.enumerate(this._pointBuffers);p.moveNext();){var w=p.current;_s.use(e,w.vertexBuffer,zs.starTexture.texture2d,Oi.fromArgb(255*i,255,255,255),this.depthBuffered,this.jNow,this.timeSeries?this.decay:0,m,this.scale*(e.height/960),this.minSize,this.showFarSide,this.sky),e.gl.drawArrays(Yr.POINTS,0,w.count)}}},drawTextured:function(e,i,n){this._initBuffer(e);var r=new wn,s=yn.multiplyMatrix(e.get_world(),e.get_view());s.invert();for(var a=wn._transformCoordinate(r,s),o=t.ss.enumerate(this._pointBuffers);o.moveNext();){var l=o.current;_s.use(e,l.vertexBuffer,i,Oi.fromArgb(255*n,255,255,255),this.depthBuffered,this.jNow,this.decay,a,this.scale*(e.height/960),this.minSize,this.showFarSide,this.sky),e.gl.drawArrays(Yr.POINTS,0,l.count)}}};function Us(){this.position=new wn,this.normal=new wn,this.tu=0,this.tv=0}function Vs(){this.pointSize=0,this.tu=0,this.tv=0}function Os(){this.width=0,this.height=0}function Gs(){this.items=[]}function Xs(){this.tag=null,this.dropDownItems=[],this.checked=!1,this.enabled=!0,this.visible=!0}function Hs(){Xs.call(this),this.name="--------------------------------------"}function Ys(){}function js(t){this.position=0,this._data=null,this._data=t}n("PointList",[zs,Bs,null]),Us.create=function(t,e,i,n){var r=new Us;return r.position=t,r.normal=e,r.tu=i,r.tv=0,r.color=n,r},n("TimeSeriesLineVertex",[Us,{get_color:function(){return this.color},set_color:function(t){return this.color=t,t}},null]),Vs.create=function(t,e,i,n){var r=new Vs;return r.position=t,r.pointSize=e,r.tu=i,r.tv=0,r.color=n,r},n("TimeSeriesPointVertex",[Vs,{get_color:function(){return this.color},set_color:function(t){return this.color=t,t}},null]),Os.create=function(t,e){e=rs.fitPowerOfTwo(e),t=rs.fitPowerOfTwo(t);var i=new Os;return i.height=e,i.width=t,i._buffer=new Uint8Array(t*e*4),i},n("Bitmap",[Os,{setPixel:function(t,e,i,n,r,s){var a=4*(t+e*this.width);this._buffer[a++]=i,this._buffer[a++]=n,this._buffer[a++]=r,this._buffer[a++]=s},getTexture:function(){var t=Hi.createTexture();return Hi.bindTexture(Yr.TEXTURE_2D,t),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_S,Yr.CLAMP_TO_EDGE),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_T,Yr.CLAMP_TO_EDGE),Hi.texImage2D(Yr.TEXTURE_2D,0,Yr.RGBA,this.width,this.height,0,Yr.RGBA,Yr.UNSIGNED_BYTE,this._buffer),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MIN_FILTER,Yr.LINEAR_MIPMAP_NEAREST),Hi.generateMipmap(Yr.TEXTURE_2D),Hi.bindTexture(Yr.TEXTURE_2D,null),t}},null]),n("ContextMenuStrip",[Gs,{_dispose:function(){},_nonMenuClick:function(e){document.getElementById("contextmenu").style.display="none",window.removeEventListener("click",t.ss.bind("_nonMenuClick",this),!1);for(var i=document.getElementById("popoutmenu");null!=i.firstChild;)i.removeChild(i.firstChild);i.style.display="none"},_menuItemClicked:function(e){var i=e.currentTarget;i.itemTag.click(i.itemTag,new t.ss.EventArgs)},_show:function(e){for(var i=document.getElementById("contextmenu");null!=i.firstChild;)i.removeChild(i.firstChild);i.className="contextmenu",i.style.display="block",i.style.left=e.x.toString()+"px",i.style.top=e.y.toString()+"px",window.addEventListener("click",t.ss.bind("_nonMenuClick",this),!0);for(var n=t.ss.enumerate(this.items);n.moveNext();){var r=n.current;if(r.visible){var s=document.createElement("div");r.dropDownItems.length>0?s.className="contextmenuitem submenu":r.checked?s.className="contextmenuitem checkedmenu":s.className="contextmenuitem",s.innerText=r.name,s.itemTag=r,s.addEventListener("mouseover",t.ss.bind("_openSubMenu",this),!1),null!=r.click&&s.addEventListener("click",t.ss.bind("_menuItemClicked",this),!1),i.appendChild(s)}}},_openSubMenu:function(e){for(var i=e.currentTarget.itemTag,n=document.getElementById("popoutmenu");null!=n.firstChild;)n.removeChild(n.firstChild);if(n.style.display="none",i.dropDownItems.length){var r=new vn;r.x=e.currentTarget.parentNode.offsetLeft+e.currentTarget.parentNode.clientWidth,r.y=e.currentTarget.parentNode.offsetTop+e.currentTarget.offsetTop,n.className="contextmenu",n.style.display="block",n.style.left=r.x.toString()+"px",n.style.top=r.y.toString()+"px",window.addEventListener("click",t.ss.bind("_nonMenuClick",this),!0);for(var s=t.ss.enumerate(i.dropDownItems);s.moveNext();){var a=s.current;if(a.visible){var o=document.createElement("div");o.className=a.checked?"contextmenuitem checkedmenu":"contextmenuitem",o.innerText=a.name,o.itemTag=a,o.addEventListener("click",t.ss.bind("_menuItemClicked",this),!1),n.appendChild(o)}}}}},null]),Xs.create=function(t){var e=new Xs;return e.name=t,e},n("ToolStripMenuItem",[Xs,{},null]),n("ToolStripSeparator",[Hs,{},Xs]),n("TagMe",[Ys,{},null]),js.id=1;var Ws={get_position:function(){return this.position},seek:function(t){this.position=t},seekRelative:function(t){this.position+=t},get_length:function(){return this._data.length},get_endOfStream:function(){return this.position>=this.get_length()},readByte:function(){var t;return t=this._data[this.position],this.position+=1,t},readSByte:function(){var t;return t=this._data[this.position],this.position+=1,t},readBytes:function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=this._data[this.position+i];return this.position+=t,e},readRemainingI16:function(t){for(var e=new Float32Array(t),i=0;i<t;i++)e[i]=this.readInt16(!0);return e},readByteString:function(t){for(var e="",i=0;i<t;i++)e+=String.fromCharCode(this._data[this.position+i]);return this.position+=t,e},readSingle:function(){var t=new Uint8Array(4);t[0]=this._data[this.position],t[1]=this._data[this.position+1],t[2]=this._data[this.position+2],t[3]=this._data[this.position+3];var e=new Float32Array(t.buffer,0,1)[0];return this.position+=4,e},readUInt32:function(){var t=this._data[this.position]+(this._data[this.position+1]<<8)+(this._data[this.position+2]<<16)+(this._data[this.position+3]<<24);return this.position+=4,t},readUInt16:function(){var t=this._data[this.position]+(this._data[this.position+1]<<8);return this.position+=2,t},readUInt16LittleEndian:function(){var t=(this._data[this.position]<<8)+this._data[this.position+1];return this.position+=2,t},readInt16:function(t){var e=t?this.readUInt16LittleEndian():this.readUInt16();return 32768&e?-(e-1^65535):e},readInt32:function(){var t=this.readUInt32();return 2147483648&t?-(t-1^4294967295):t},readInt64:function(){return this.position+=8,js.id++},close:function(){}};function qs(t,e,i,n){this.title="Tile",this.label="Enter Text Below",this.text="",this._textElement=null,this._ignoreNextClick=!1,this.title=t,this.label=e,this.text=i}n("BinaryReader",[js,Ws,null]),n("SimpleInput",[qs,{showDialog:function(){return 1},nonMenuClick:function(t){this._ignoreNextClick||this._close(),this._ignoreNextClick=!1},show:function(e,i){var n=document.getElementById("simpleinput");document.getElementById("simplemodal").style.display="block",n.style.display="block",n.style.marginLeft=e.x.toString()+"px",n.style.marginTop=e.y.toString()+"px",this._textElement=document.getElementById("inputtext"),this._textElement.value=this.text;var r=document.getElementById("simpletitle"),s=document.getElementById("inputlabel");r.innerText=this.title,s.innerText=this.label,this._textElement.addEventListener("change",t.ss.bind("textChanged",this),!1),this._textElement.addEventListener("click",t.ss.bind("ignoreMe",this),!0);var a=document.getElementById("simpleinputok"),o=document.getElementById("simpleinputcancel");a.addEventListener("click",t.ss.bind("okClicked",this),!1),o.addEventListener("click",t.ss.bind("cancelClicked",this),!1),this._okCallback=i},okClicked:function(t){this._close(),null!=this._okCallback&&this._okCallback()},cancelClicked:function(t){this._close()},_close:function(){document.getElementById("simplemodal").style.display="none",this._textElement.removeEventListener("change",t.ss.bind("textChanged",this),!1);var e=document.getElementById("simpleinputok"),i=document.getElementById("simpleinputcancel");e.removeEventListener("click",t.ss.bind("okClicked",this),!1),i.removeEventListener("click",t.ss.bind("cancelClicked",this),!1)},ignoreMe:function(t){this._ignoreNextClick=!0},textChanged:function(t){this.text=this._textElement.value,this._ignoreNextClick=!0}},null]);var Zs={indented:1};function Ks(){this.body="<?xml version='1.0' encoding='UTF-8'?>\r\n",this.formatting=1,this._elementStack=new t.ss.Stack,this._pending=!1,this._currentName="",this._attributes={},this._value=""}n("Formatting",Zs),r("Formatting",Zs);var Js={_pushNewElement:function(t){this._writePending(!1),this._elementStack.push(t),this._pending=!0,this._currentName=t},_writePending:function(e){var i=!0;if(this._pending){for(var n=1;n<this._elementStack.count;n++)this.body+="  ";if(this.body+="<"+this._currentName,t.ss.keyCount(this._attributes)>0)for(var r=t.ss.enumerate(t.ss.keys(this._attributes));r.moveNext();){var s=r.current;this.body+=t.ss.format(' {0}="{1}"',s,this._attributes[s])}return t.ss.emptyString(this._value)?e?(this.body+=" />\r\n",i=!0):this.body+=">\r\n":(this.body+=">",i=!1,t.ss.emptyString(this._value)||(this.body+=this._value)),this._pending=!1,this._currentName="",this._value="",this._attributes={},i}return!1},_writeProcessingInstruction:function(t,e){},_writeStartElement:function(t){this._pushNewElement(t)},_writeAttributeString:function(e,i){this._attributes[e]=null!=i?t.ss.replaceString(i.toString(),"&","&amp;"):""},_writeEndElement:function(){if(this._writePending(!0))this._elementStack.pop();else{for(var e=1;e<this._elementStack.count;e++)this.body+="  ";this.body+=t.ss.format("</{0}>\r\n",this._elementStack.pop())}},_writeString:function(e){this._value=t.ss.replaceString(e,"&","&amp;")},_writeFullEndElement:function(){this._writePending(!1);for(var e=1;e<this._elementStack.count;e++)this.body+="  ";this.body+=t.ss.format("</{0}>\r\n",this._elementStack.pop())},_close:function(){},_writeElementString:function(e,i){this._writeStartElement(e),this._writeValue(t.ss.replaceString(i,"&","&amp;")),this._writeEndElement()},_writeValue:function(e){this._value=t.ss.replaceString(e,"&","&amp;")},_writeCData:function(e){this._value=t.ss.format("<![CDATA[{0}]]>",e)}};function Qs(t,e){this._ascention=0,this._declination=0,this._ascention=t+80*Math.PI%(2*Math.PI),this._declination=e}n("XmlTextWriter",[Ks,Js,null]),Qs.RC=3.1415927/180,Qs.RCRA=3.1415927/12,Qs.radius=1,Qs._rotationMatrix=null,Qs.geoTo3d=function(t,e){return wn.create(Math.cos(e*Qs.RC)*Math.cos(t*Qs.RC)*1,1*Math.sin(t*Qs.RC),Math.sin(e*Qs.RC)*Math.cos(t*Qs.RC)*1)},Qs.geoTo3dDouble=function(t,e){return wn.create(Math.cos(e*Qs.RC)*Math.cos(t*Qs.RC)*1,1*Math.sin(t*Qs.RC),Math.sin(e*Qs.RC)*Math.cos(t*Qs.RC)*1)},Qs.geoTo3dRad=function(t,e,i){return wn.create(Math.cos(e*Qs.RC)*Math.cos(t*Qs.RC)*i,Math.sin(t*Qs.RC)*i,Math.sin(e*Qs.RC)*Math.cos(t*Qs.RC)*i)},Qs.raDecTo3d=function(t,e){return wn.create(Math.cos(t*Qs.RCRA)*Math.cos(e*Qs.RC)*1,1*Math.sin(e*Qs.RC),Math.sin(t*Qs.RCRA)*Math.cos(e*Qs.RC)*1)},Qs.raDecTo3dAu=function(t,e,i){return wn.create(Math.cos(t*Qs.RCRA)*Math.cos(e*Qs.RC)*i,Math.sin(e*Qs.RC)*i,Math.sin(t*Qs.RCRA)*Math.cos(e*Qs.RC)*i)},Qs.raDecTo3dMat=function(t,e,i){return wn._transformCoordinate(wn.create(Math.cos(t*Qs.RCRA)*Math.cos(e*Qs.RC)*1,1*Math.sin(e*Qs.RC),Math.sin(t*Qs.RCRA)*Math.cos(e*Qs.RC)*1),i)},Qs.raDecTo3dPointRad=function(t,e){return t.set_dec(-t.get_dec()),wn.create(Math.cos(t.get_RA()*Qs.RCRA)*Math.cos(t.get_dec()*Qs.RC)*e,Math.sin(t.get_dec()*Qs.RC)*e,Math.sin(t.get_RA()*Qs.RCRA)*Math.cos(t.get_dec()*Qs.RC)*e)},Qs.sterographicTo3d=function(t,e,i,n,r,s,a,o,l){var h=90,u=0;if(e-=a,(t-=s)||e){var c=6371e3*(1+Math.sin(Math.abs(n)/180*Math.PI))/o,_=c*c,d=180/Math.PI;u=t?Math.atan2(e,t)*d:90*e<0?-1:1;var g=t*t+e*e;h=(_-g)/(_+g),h=Math.asin(h)*d,l||(h=-h,u=-u,r=-r)}return Qs.geoTo3dRad(h,90+u+r,i)},Qs.equitorialToHorizon=function(t,e,i){var n=Qs.mstFromUTC2(i,e.get_lng())-15*t.get_RA();n<0&&(n+=360);var r=n*Qs.RC,s=t.get_dec()*Qs.RC,a=e.get_lat()*Qs.RC,o=Math.sin(s)*Math.sin(a)+Math.cos(s)*Math.cos(a)*Math.cos(r),l=Math.asin(o),h=(Math.sin(s)-Math.sin(l)*Math.sin(a))/(Math.cos(l)*Math.cos(a)),u=new Qs(Math.acos(h),l);return Math.sin(r)>0&&u.set_az(360-u.get_az()),u},Qs.horizonToEquitorial=function(t,e,i){var n,r,s=Qs.mstFromUTC2(i,e.get_lng()),a=Qs._altAzToRaDec(t.get_alt()*Qs.RC,t.get_az()*Qs.RC,e.get_lat()*Qs.RC);return n=a.x,r=a.y,(s+=n/Qs.RC)<0&&(s+=360),s>360&&(s-=360),Qs.fromRaDec(s/15,r/Qs.RC)},Qs._altAzToRaDec=function(t,e,i){var n,r=0;return(e=Math.PI-e)<0&&(e+=2*Math.PI),(r=Math.atan2(Math.sin(e),Math.cos(e)*Math.sin(i)+Math.tan(t)*Math.cos(i)))<0&&(r+=2*Math.PI),n=Math.asin(Math.sin(i)*Math.sin(t)-Math.cos(i)*Math.cos(t)*Math.cos(e)),vn.create(r,n)},Qs.mstFromUTC2=function(e,i){var n=e.getUTCFullYear(),r=e.getUTCMonth()+1,s=e.getUTCDate(),a=e.getUTCHours(),o=e.getUTCMinutes(),l=e.getUTCSeconds()+e.getUTCMilliseconds()/1e3;1!==r&&2!==r||(n-=1,r+=12);var h,u,c,_=t.ss.truncate(n/100);if((c=280.46061837+360.98564736629*(h=2-_+Math.floor(_/4)+Math.floor(365.25*n)+Math.floor(30.6001*(r+1))-730550.5+s+(a+o/60+l/3600)/24)+387933e-9*(u=h/36525)*u-u*u*u/3871e4+i)>0)for(;c>360;)c-=360;else for(;c<0;)c+=360;return c},Qs.cartesianToSpherical=function(t){var e,i=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),n=Math.sqrt(t.x*t.x+t.z*t.z);return e=Math.asin(t.y/i),new Qs(0<t.x?Math.asin(t.z/n):0>t.x?Math.PI-Math.asin(t.z/n):0,e)},Qs.cartesianToSpherical2=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return new Qs(Math.atan2(t.z,t.x),Math.asin(t.y/e))},Qs.cartesianToSphericalSky=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=Math.atan2(t.z,t.x),n=Math.asin(-t.y/e);return vn.create(i/Math.PI*12,n/Math.PI*180)},Qs.sphericalSkyToCartesian=function(t){var e=t.x*(Math.PI/12),i=t.y*(Math.PI/180),n=Math.cos(e)*Math.cos(i),r=-Math.sin(i),s=Math.sin(e)*Math.cos(i);return wn.create(n,r,s)},Qs.cartesianToLatLng=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z),i=Math.atan2(t.z,t.x),n=Math.asin(t.y/e);return vn.create(180*i/Math.PI,180*n/Math.PI)},Qs.cartesianToSpherical3=function(t){var e=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return new Qs(Math.atan2(t.z,t.x),Math.asin(t.y/e))},Qs.sign=function(t){return t<0?-1:1},Qs.formatDMSSign=function(e,i){try{e+=.0001388888888889*Qs.sign(e);var n=t.ss.truncate(e),r=60*(e-t.ss.truncate(e)),s=60*(r-t.ss.truncate(r));if(i){var a=e>0?"+":"-";return t.ss.format("{3}{0:00;00}:{1:00}:{2:00}",n,Math.abs(t.ss.truncate(r)),Math.abs(t.ss.truncate(s)),a)}return t.ss.format("{0:00}:{1:00}:{2:00}",n,Math.abs(t.ss.truncate(r)),Math.abs(t.ss.truncate(s)))}catch(t){return""}},Qs.twoPlaces=function(t){var e=t.toString();return e.length<2&&(e="0"+e),e},Qs.formatDMS=function(e){try{e+=.0001388888888889*(e<0?-1:1);var i=Math.abs(t.ss.truncate(e)),n=60*(e-t.ss.truncate(e)),r=60*(n-t.ss.truncate(n)),s=e<0?"-":"";return t.ss.format("{3}{0}:{1}:{2}",Math.abs(i),Qs.twoPlaces(Math.abs(t.ss.truncate(n))),Qs.twoPlaces(Math.abs(t.ss.truncate(r))),s)}catch(t){return""}},Qs.formatDMSWide=function(e){try{e+=.0001388888888889*Qs.sign(e);var i=Math.abs(t.ss.truncate(e)),n=60*(e-t.ss.truncate(e)),r=60*(n-t.ss.truncate(n)),s=e<0?"-":"";return t.ss.format("{3}{0:00} : {1:00} : {2:00}",i,Math.abs(t.ss.truncate(n)),Math.abs(t.ss.truncate(r)),s)}catch(t){return""}},Qs.formatHMS=function(e){try{e+=.0001388888888889*Qs.sign(e);var i=t.ss.truncate(e),n=60*(e-t.ss.truncate(e)),r=60*(n-t.ss.truncate(n));return t.ss.format("{0:00}h{1:00}m{2:00}s",i,Math.abs(t.ss.truncate(n)),Math.abs(t.ss.truncate(r)))}catch(t){return""}},Qs.parseRA=function(e,i){((e=t.ss.trim(e).toLowerCase()).indexOf("d")>-1||e.indexOf("°")>-1)&&(i=!0),(e.indexOf("h")>-1||e.indexOf(":")>-1)&&(i=!1);var n=Qs.parse(e)/(i?15:1);return Math.max(Math.min(n,24),0)},Qs.parseDec=function(t){var e=Qs.parse(t);return Math.max(Math.min(e,90),-90)},Qs.parse=function(e){try{if(e=t.ss.trim(e).toLowerCase(),e=t.ss.replaceString(t.ss.replaceString(t.ss.replaceString(t.ss.replaceString(t.ss.replaceString(t.ss.replaceString(e,"d ","d"),"h ","h"),"m ","m"),"s ","s"),"' ","'"),'" ','"'),a.stringContains(e,[":"," ","d","h","m","s","'",'"',"°"])){var i=0,n=0,r=0,s=0,o=a.splitString(e,[":"," ","d","h","m","s","'",'"',"°"]);return o.length>0&&(t.ss.emptyString(o[0])||(i=Math.abs(parseFloat(o[0])),s=parseFloat(o[0])<0?-1:1,o[0].indexOf("-")>-1&&(s=-1))),o.length>1&&(t.ss.emptyString(o[1])||(n=parseFloat(o[1]))),o.length>2&&(t.ss.emptyString(o[2])||(r=parseFloat(o[2]))),s||(s=1),s*(i+n/60+r/3600)}var l=0;try{l=parseFloat(e)}catch(t){l=0}return l}catch(t){return 0}},Qs.fromRaDec=function(t,e){return new Qs(15*(t-12)*Qs.RC,e*Qs.RC)},Qs.fromLatLng=function(t,e){return new Qs(e*Qs.RC,t*Qs.RC)},Qs.dmsToDegrees=function(t,e,i){return t+e/60+i/3600},Qs.degreesToRadians=function(t){return.0174532925199433*t},Qs.radiansToDegrees=function(t){return 57.2957795130823*t},Qs.radiansToHours=function(t){return 3.81971863420549*t},Qs.hoursToRadians=function(t){return.261799387799149*t},Qs.hoursToDegrees=function(t){return 15*t},Qs.degreesToHours=function(t){return t/15},Qs.PI=function(){return 3.14159265358979},Qs.mapTo0To360Range=function(t){for(var e=t;e<0;)e+=360;for(;e>360;)e-=360;return e},Qs.mapTo0To24Range=function(t){for(var e=t;e<0;)e+=24;for(;e>24;)e-=24;return e},Qs.meanObliquityOfEcliptic=function(t){var e=(t-2451545)/3652500,i=e*e,n=i*e,r=n*e,s=r*e,a=s*e,o=a*e,l=o*e,h=l*e,u=h*e;return Qs.dmsToDegrees(23,26,21.448)-Qs.dmsToDegrees(0,0,4680.93)*e-Qs.dmsToDegrees(0,0,1.55)*i+Qs.dmsToDegrees(0,0,1999.25)*n-Qs.dmsToDegrees(0,0,51.38)*r-Qs.dmsToDegrees(0,0,249.67)*s-Qs.dmsToDegrees(0,0,39.05)*a+Qs.dmsToDegrees(0,0,7.12)*o+Qs.dmsToDegrees(0,0,27.87)*l+Qs.dmsToDegrees(0,0,5.79)*h+Qs.dmsToDegrees(0,0,2.45)*u},Qs.j2000toGalactic=function(t,e){var i=[Math.cos(t/180*Math.PI)*Math.cos(e/180*Math.PI),Math.sin(t/180*Math.PI)*Math.cos(e/180*Math.PI),Math.sin(e/180*Math.PI)];null==Qs._rotationMatrix&&(Qs._rotationMatrix=new Array(3),Qs._rotationMatrix[0]=[-.0548755604,-.8734370902,-.4838350155],Qs._rotationMatrix[1]=[.4941094279,-.44482963,.7469822445],Qs._rotationMatrix[2]=[-.867666149,-.1980763734,.4559837762]);for(var n=new Array(3),r=0;r<3;r++)n[r]=i[0]*Qs._rotationMatrix[r][0]+i[1]*Qs._rotationMatrix[r][1]+i[2]*Qs._rotationMatrix[r][2];var s=Math.atan2(n[1],n[0]);s<0&&(s+=2*Math.PI),s>2*Math.PI&&(s-=2*Math.PI);var a=Math.atan2(n[2],Math.sqrt(n[0]*n[0]+n[1]*n[1]));return[s/Math.PI*180,a/Math.PI*180]},Qs.galacticTo3dDouble=function(t,e){var i=Qs.galactictoJ2000(t,e);return Qs.raDecTo3dAu(i[0]/15,i[1],1)},Qs.galactictoJ2000=function(t,e){var i=[Math.cos(t/180*Math.PI)*Math.cos(e/180*Math.PI),Math.sin(t/180*Math.PI)*Math.cos(e/180*Math.PI),Math.sin(e/180*Math.PI)];null==Qs._rotationMatrix&&(Qs._rotationMatrix=new Array(3),Qs._rotationMatrix[0]=[-.0548755604,-.8734370902,-.4838350155],Qs._rotationMatrix[1]=[.4941094279,-.44482963,.7469822445],Qs._rotationMatrix[2]=[-.867666149,-.1980763734,.4559837762]);for(var n=new Array(3),r=0;r<3;r++)n[r]=i[0]*Qs._rotationMatrix[0][r]+i[1]*Qs._rotationMatrix[1][r]+i[2]*Qs._rotationMatrix[2][r];var s=Math.atan2(n[1],n[0]);s<0&&(s+=2*Math.PI),s>2*Math.PI&&(s-=2*Math.PI);var a=Math.atan2(n[2],Math.sqrt(n[0]*n[0]+n[1]*n[1]));return[s/Math.PI*180,a/Math.PI*180]};var ta={distance:function(t){var e=this.get_lat(),i=this.get_lng()*Math.cos(e*Qs.RC),n=t.get_lat(),r=t.get_lng()*Math.cos(n*Qs.RC);return Math.sqrt((e-n)*(e-n)+(i-r)*(i-r))},distance3d:function(t){var e=Qs.geoTo3dDouble(t.get_lat(),t.get_lng()),i=Qs.geoTo3dDouble(this.get_lat(),this.get_lng());return wn.subtractVectors(e,i).length()/Qs.RC},angle:function(t){var e=this.get_lat(),i=this.get_lng()*Math.cos(e*Qs.RC),n=t.get_lat(),r=t.get_lng()*Math.cos(n*Qs.RC);return Math.atan2(n-e,r-i)},get_RA:function(){return(this._ascention/Math.PI*12+12)%24},set_RA:function(t){return this._ascention=t/12*Math.PI,t},get_dec:function(){return this._declination/Qs.RC},set_dec:function(t){return this._declination=t*Qs.RC,t},get_lat:function(){return this._declination/Qs.RC},set_lat:function(t){return this._declination=t*Qs.RC,t},get_lng:function(){var t=this._ascention/Qs.RC;return t<=180?t:180-t-180},set_lng:function(t){return this._ascention=t*Qs.RC+2*Math.PI%(2*Math.PI),t},get_alt:function(){return this._declination/Qs.RC},set_alt:function(t){return this._declination=t*Qs.RC,t},get_az:function(){return this._ascention/Qs.RC},set_az:function(t){return this._ascention=t*Qs.RC,t},toString:function(){return t.ss.format("Lat: {0}, Lng: {1}",this.get_lat(),this.get_lng())}};function ea(){}n("Coordinates",[Qs,ta,null]);const ia=.785398155450821,na=7.94662735614793e-9,ra=306161699786838e-31,sa=.318309886183791;function aa(){}function oa(){}function la(){this.z=0,this.phi=0,this.sth=0,this.have_sth=!1}function ha(){this.fx=0,this.fy=0,this.face=0,aa.call(this)}function ua(){}function ca(){}function _a(){}function da(){}function ga(){}function fa(){}function ma(){}function pa(){this.addedToPrimitives=!1,this.annotationDirty=!0,this._opacity=1,this._showHoverLabel=!1}ea._mulsign=function(t,e){return ea._sign(e)*t},ea._isnan=function(t){return t!=t},ea._isinf=function(t){return Math.abs(t)===Number.POSITIVE_INFINITY},ea._sign=function(t){return t?t>0?1:-1:0},ea._atanhelper=function(t){var e=t*t,i=-188796008463073e-19;return(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=(i=i*e+.000209850076645817)*e-.00110611831486672)*e+.00370026744188713)*e-.00889896195887655)*e+.0165993297735292)*e-.0254517624932313)*e+.0337852580001353)*e-.0407629191276837)*e+.0466667150077841)*e-.0523674852303482)*e+.0587666392926674)*e-.0666573579361081)*e+.076921953831177)*e-.090908995008245)*e+.111111105648261)*e-.142857142667713)*e+.199999999996591)*e-.333333333333311)*e*t+t},ea._atan2k=function(t,e){var i=0;if(e<0&&(e=-e,i=-2),t>e){var n=e;e=t,t=-n,i+=1}return ea._atanhelper(t/e)+i*(Math.PI/2)},ea.atan2=function(t,e){var i=ea._atan2k(Math.abs(t),e);return i=ea._mulsign(i,e),!ea._isinf(e)&&e||(i=Math.PI/2-(ea._isinf(e)?ea._sign(e)*(Math.PI/2):0)),ea._isinf(t)&&(i=Math.PI/2-(ea._isinf(e)?ea._sign(e)*(1*Math.PI/4):0)),t||(i=-1===ea._sign(e)?Math.PI:0),ea._isnan(e)||ea._isnan(t)?Number.NaN:ea._mulsign(i,t)},ea.asin=function(t){return ea._mulsign(ea._atan2k(Math.abs(t),Math.sqrt((1+t)*(1-t))),t)},ea.acos=function(t){return ea._mulsign(ea._atan2k(Math.sqrt((1+t)*(1-t)),Math.abs(t)),t)+(t<0?Math.PI:0)},ea.atan=function(t){var e=0;t<0&&(t=-t,e=2),t>1&&(t=1/t,e|=1);var i=ea._atanhelper(t);return 1&e&&(i=1.5707963267949-i),2&e&&(i=-i),i},ea._sincoshelper=function(t){var e=t*t,i=-797255955009038e-32;return e*(i=(i=(i=(i=(i=(i=(i=(i=i*e+281009972710863e-29)*e-764712219118159e-27)*e+1.60590430605665e-10)*e-2.50521083763502e-8)*e+275573192239199e-20)*e-.000198412698412696)*e+.00833333333333333)*e-.166666666666667)*t+t},ea.sin=function(t){var e=t*sa,i=Math.floor(e<0?e-.5:e+.5),n=4*i;return t-=n*ia,t-=n*na,t-=n*ra,1&i&&(t=-t),ea._sincoshelper(t)},ea.cos=function(t){var e=t*sa-.5,i=1+2*Math.floor(e<0?e-.5:e+.5),n=2*i;return t-=n*ia,t-=n*na,t-=n*ra,2&i||(t=-t),ea._sincoshelper(t)},n("FastMath",[ea,{},null]),aa.ctab=[0,1,256,257,2,3,258,259,512,513,768,769,514,515,770,771,4,5,260,261,6,7,262,263,516,517,772,773,518,519,774,775,1024,1025,1280,1281,1026,1027,1282,1283,1536,1537,1792,1793,1538,1539,1794,1795,1028,1029,1284,1285,1030,1031,1286,1287,1540,1541,1796,1797,1542,1543,1798,1799,8,9,264,265,10,11,266,267,520,521,776,777,522,523,778,779,12,13,268,269,14,15,270,271,524,525,780,781,526,527,782,783,1032,1033,1288,1289,1034,1035,1290,1291,1544,1545,1800,1801,1546,1547,1802,1803,1036,1037,1292,1293,1038,1039,1294,1295,1548,1549,1804,1805,1550,1551,1806,1807,2048,2049,2304,2305,2050,2051,2306,2307,2560,2561,2816,2817,2562,2563,2818,2819,2052,2053,2308,2309,2054,2055,2310,2311,2564,2565,2820,2821,2566,2567,2822,2823,3072,3073,3328,3329,3074,3075,3330,3331,3584,3585,3840,3841,3586,3587,3842,3843,3076,3077,3332,3333,3078,3079,3334,3335,3588,3589,3844,3845,3590,3591,3846,3847,2056,2057,2312,2313,2058,2059,2314,2315,2568,2569,2824,2825,2570,2571,2826,2827,2060,2061,2316,2317,2062,2063,2318,2319,2572,2573,2828,2829,2574,2575,2830,2831,3080,3081,3336,3337,3082,3083,3338,3339,3592,3593,3848,3849,3594,3595,3850,3851,3084,3085,3340,3341,3086,3087,3342,3343,3596,3597,3852,3853,3598,3599,3854,3855],aa.utab=[0,1,4,5,16,17,20,21,64,65,68,69,80,81,84,85,256,257,260,261,272,273,276,277,320,321,324,325,336,337,340,341,1024,1025,1028,1029,1040,1041,1044,1045,1088,1089,1092,1093,1104,1105,1108,1109,1280,1281,1284,1285,1296,1297,1300,1301,1344,1345,1348,1349,1360,1361,1364,1365,4096,4097,4100,4101,4112,4113,4116,4117,4160,4161,4164,4165,4176,4177,4180,4181,4352,4353,4356,4357,4368,4369,4372,4373,4416,4417,4420,4421,4432,4433,4436,4437,5120,5121,5124,5125,5136,5137,5140,5141,5184,5185,5188,5189,5200,5201,5204,5205,5376,5377,5380,5381,5392,5393,5396,5397,5440,5441,5444,5445,5456,5457,5460,5461,16384,16385,16388,16389,16400,16401,16404,16405,16448,16449,16452,16453,16464,16465,16468,16469,16640,16641,16644,16645,16656,16657,16660,16661,16704,16705,16708,16709,16720,16721,16724,16725,17408,17409,17412,17413,17424,17425,17428,17429,17472,17473,17476,17477,17488,17489,17492,17493,17664,17665,17668,17669,17680,17681,17684,17685,17728,17729,17732,17733,17744,17745,17748,17749,20480,20481,20484,20485,20496,20497,20500,20501,20544,20545,20548,20549,20560,20561,20564,20565,20736,20737,20740,20741,20752,20753,20756,20757,20800,20801,20804,20805,20816,20817,20820,20821,21504,21505,21508,21509,21520,21521,21524,21525,21568,21569,21572,21573,21584,21585,21588,21589,21760,21761,21764,21765,21776,21777,21780,21781,21824,21825,21828,21829,21840,21841,21844,21845],aa.jrll=[2,2,2,2,3,3,3,3,4,4,4,4],aa.jpll=[1,3,5,7,0,2,4,6,1,3,5,7],aa.xoffset=[-1,-1,0,1,1,1,0,-1],aa.yoffset=[0,1,1,1,0,-1,-1,-1],n("HealpixTables",[aa,{},null]),oa.check=function(t,e){if(!t)throw new Error(e)},oa.isqrt=function(t){var e=Math.sqrt(t+.5);return t<1<<50||(e*e>t?--e:(e+1)*(e+1)<=t&&++e),e},oa.cosdist_zphi=function(t,e,i,n){return t*i+ea.cos(e-n)*Math.sqrt((1-t*t)*(1-i*i))},oa.fmodulo=function(t,e){if(t>=0)return t<e?t:t%e;var i=t%e+e;return i===e?0:i},n("HealpixUtils",[oa,{},null]),la.create=function(t){var e=new la,i=1/t.length();return e.z=t.z*i,e.phi=ea.atan2(t.y,t.x),Math.abs(e.z)>.99&&(e.sth=Math.sqrt(t.x*t.x+t.y*t.y)*i,e.have_sth=!0),e},n("Hploc",[la,{toVec3:function(){var t,e=(t=this.have_sth?this.sth:Math.sqrt((1-this.z)*(1+this.z)))*ea.cos(this.phi),i=t*ea.sin(this.phi);return wn.create(e,this.z,i)}},null]),ha._halfpi$1=Math.PI/2,ha._inv_halfpi$1=2/Math.PI,ha._twothird$1=2/3,ha.create=function(t,e,i){var n=new ha;return n.fx=t,n.fy=e,n.face=i,n},ha._fromHploc$1=function(e){var i=new ha,n=e.z,r=e.phi,s=Math.abs(n),a=oa.fmodulo(r*ha._inv_halfpi$1,4);if(s<=ha._twothird$1){var o=.5+a,l=.75*n,h=(c=o-l)===(_=o+l)?4|c:c<_?c:_+8;i.fx=oa.fmodulo(_,1),i.fy=1-oa.fmodulo(c,1),i.face=h}else{var u,c,_,d=Math.min(3,t.ss.truncate(a)),g=a-d;(c=g*(u=s<.99||!e.have_sth?Math.sqrt(3*(1-s)):e.sth/Math.sqrt((1+s)/3)))>=1&&(c=1),(_=(1-g)*u)>=1&&(_=1),n>=0?(i.fx=1-_,i.fy=1-c,i.face=d):(i.fx=c,i.fy=_,i.face=d+8)}return i},ha.fromVector=function(t){return ha._fromHploc$1(la.create(t))},n("Fxyf",[ha,{toHploc:function(){var t,e,i=new la,n=aa.jrll[this.face]-this.fx-this.fy;return n<1?(e=(t=n)*t/3,i.z=1-e,i.z>.99&&(i.sth=Math.sqrt(e*(2-e)),i.have_sth=!0)):n>3?(e=(t=4-n)*t/3,i.z=e-1,i.z<-.99&&(i.sth=Math.sqrt(e*(2-e)),i.have_sth=!0)):(t=1,i.z=2*(2-n)/3),(e=aa.jpll[this.face]*t+this.fx-this.fy)<0&&(e+=8),e>=8&&(e-=8),i.phi=t<1e-15?0:.5*ha._halfpi$1*e/t,i},toVec3:function(){return this.toHploc().toVec3()}},aa]),n("IFolder",[function(){}]),n("IThumbnail",[ua]),n("IPlace",[ca]),n("IUiController",[_a]),n("IViewMover",[da]),n("IUIServicesCallbacks",[ga]),n("ISettings",[fa]),n("IUndoStep",[ma]),pa.pointList=null,pa.lineList=null,pa.triangleFanPointList=null,pa.triangleList=null,pa.batchDirty=!0,pa.prepBatch=function(t){(null==pa.pointList||pa.batchDirty)&&(pa.pointList=new zs(t),pa.lineList=new Es,pa.triangleFanPointList=new Ns,pa.triangleList=new Fs,pa.lineList.set_depthBuffered(!1),pa.triangleList.depthBuffered=!1)},pa.drawBatch=function(t){pa.batchDirty=!1,null!=t.gl&&(null!=pa.pointList&&pa.pointList.draw(t,1,!1),null!=pa.lineList&&pa.lineList.drawLines(t,1),null!=pa.triangleFanPointList&&pa.triangleFanPointList.draw(t,1),null!=pa.triangleList&&pa.triangleList.draw(t,1,0))},pa.separation=function(t,e,i,n){e=e/180*Math.PI,n=n/180*Math.PI,t=t/12*Math.PI,i=i/12*Math.PI;var r=Math.cos(e)*Math.sin(n)-Math.sin(e)*Math.cos(n)*Math.cos(i-t),s=Math.cos(n)*Math.sin(i-t),a=Math.sin(e)*Math.sin(n)+Math.cos(e)*Math.cos(n)*Math.cos(i-t),o=Math.atan2(Math.sqrt(r*r+s*s),a);return(o=o/Math.PI*180)<0&&(o+=180),o},pa.colorToUint=function(t){return t.a<<24|t.r<<16|t.g<<8|t.b},pa.colorToUintAlpha=function(t,e){return e<<24|t.r<<16|t.g<<8|t.b};var wa={draw:function(t){},get_opacity:function(){return this._opacity},set_opacity:function(t){return pa.batchDirty=!0,this._opacity=t,t},get_id:function(){return this._id},set_id:function(t){return this._id=t,t},get_tag:function(){return this._tag},set_tag:function(t){return this._tag=t,t},get_label:function(){return this._label},set_label:function(t){return this._label=t,t},get_showHoverLabel:function(){return this._showHoverLabel},set_showHoverLabel:function(t){return this._showHoverLabel=t,t},hitTest:function(t,e,i,n,r){return!1},get_center:function(){return this.center},set_center:function(t){return this.center=t,t}};function ba(){this._fill$1=!1,this._skyRelative$1=!1,this._strokeWidth$1=1,this._radius$1=10,this._lineColor$1=Xi.get_white(),this._fillColor$1=Xi.get_white(),this._ra$1=0,this._dec$1=0,pa.call(this)}n("Annotation",[pa,wa,null]);var va={get_fill:function(){return this._fill$1},set_fill:function(t){return pa.batchDirty=!0,this._fill$1=t,t},get_skyRelative:function(){return this._skyRelative$1},set_skyRelative:function(t){return pa.batchDirty=!0,this._skyRelative$1=t,t},get_lineWidth:function(){return this._strokeWidth$1},set_lineWidth:function(t){return pa.batchDirty=!0,this._strokeWidth$1=t,t},get_radius:function(){return this._radius$1},set_radius:function(t){return pa.batchDirty=!0,this._radius$1=t,t},get_lineColor:function(){return this._lineColor$1.toString()},set_lineColor:function(t){return pa.batchDirty=!0,this._lineColor$1=Oi.load(t),t},get_fillColor:function(){return this._fillColor$1.toString()},set_fillColor:function(t){return pa.batchDirty=!0,this._fillColor$1=Oi.fromName(t),t},setCenter:function(t,e){pa.batchDirty=!0,this._ra$1=t/15,this._dec$1=e,this.center=Qs.raDecTo3d(this._ra$1,this._dec$1)},draw:function(t){var e=!0,i=this._radius$1;this._skyRelative$1&&(i/=t.get_fovScale()/3600);var n=t.WVP.transform(this.center);if(n.z<0&&(e=!1),wn.dot(t.get_viewPoint(),this.center)<.55&&(e=!1),null!=t.gl){if(pa.batchDirty||this.annotationDirty){for(var r=wn.create(0,1,0),s=wn.cross(this.center,r),a=wn.cross(this.center,s),o=this._radius$1/44,l=2*Math.PI/72,h=[],u=0;u<=72;u++){var c=Math.cos(u*l)*o,_=Math.sin(u*l)*o;h.push(wn.create(this.center.x+c*s.x+_*a.x,this.center.y+c*s.y+_*a.y,this.center.z+c*s.z+_*a.z))}if(this._strokeWidth$1>0&&h.length>1){var d=this._lineColor$1._clone();d.a=Math.round(d.a*this.get_opacity());for(var g=0;g<h.length-1;g++)pa.lineList.addLine(h[g],h[g+1],d,new As(0,1))}if(this._fill$1){var f=this._fillColor$1._clone();f.a=Math.round(f.a*this.get_opacity());var m=wn.create(this.center.x,this.center.y,this.center.z);h.splice(0,0,m),pa.triangleFanPointList.addShape(h,f,new As(0,1))}this.annotationDirty=!1}}else if(e){var p=t.device;p.save(),p.globalAlpha=this.get_opacity(),p.beginPath(),p.arc(n.x,n.y,i,0,2*Math.PI,!0),p.lineWidth=this._strokeWidth$1,p.fillStyle=this._fillColor$1.toString(),this._fill$1&&p.fill(),p.globalAlpha=1,p.strokeStyle=this._lineColor$1.toString(),p.stroke(),p.restore()}},hitTest:function(e,i,n,r,s){if(t.ss.emptyString(this.get_id()))return!1;var a=this._radius$1;return this._skyRelative$1||(a*=e.get_fovScale()/3600),pa.separation(i,n,this._ra$1,this._dec$1)<a}};function ya(){this._points$1=[],this._fill$1=!1,this._strokeWidth$1=1,this._lineColor$1=Xi.get_white(),this._fillColor$1=Xi.get_white(),pa.call(this)}n("Circle",[ba,va,pa]);var Sa={addPoint:function(t,e){pa.batchDirty=!0,this._points$1.push(Qs.raDecTo3d(t/15,e))},get_fill:function(){return this._fill$1},set_fill:function(t){return pa.batchDirty=!0,this._fill$1=t,t},get_lineWidth:function(){return this._strokeWidth$1},set_lineWidth:function(t){return pa.batchDirty=!0,this._strokeWidth$1=t,t},get_lineColor:function(){return this._lineColor$1.toString()},set_lineColor:function(t){return pa.batchDirty=!0,this._lineColor$1=Oi.fromName(t),t},get_fillColor:function(){return this._fillColor$1.toString()},set_fillColor:function(t){return pa.batchDirty=!0,this._fillColor$1=Oi.fromName(t),t},draw:function(e){if(null!=e.gl){if(pa.batchDirty||this.annotationDirty){var i=this._points$1;if(this._strokeWidth$1>0&&this._points$1.length>1){var n=this._lineColor$1._clone();n.a=Math.round(n.a*this.get_opacity());for(var r=0;r<this._points$1.length-1;r++)pa.lineList.addLine(i[r],i[r+1],n,new As(0,1));pa.lineList.addLine(i[this._points$1.length-1],i[0],n,new As(0,1))}if(this._fill$1){var s=this._fillColor$1._clone();s.a=Math.round(s.a*this.get_opacity());var a=as.tesselateSimplePoly(i);for(r=0;r<a.length;r+=3)pa.triangleList.addSubdividedTriangles(i[a[r]],i[a[r+1]],i[a[r+2]],s,new As(0,1),2)}this.annotationDirty=!1}}else{var o=e.device;o.save(),o.globalAlpha=this.get_opacity(),o.beginPath();for(var l=!0,h=t.ss.enumerate(this._points$1);h.moveNext();){var u=h.current,c=e.WVP.transform(u);if(c.z<0)return void o.restore();if(wn.dot(e.get_viewPoint(),u)<.75)return void o.restore();l?(l=!1,o.moveTo(c.x,c.y)):o.lineTo(c.x,c.y)}o.closePath(),o.lineWidth=this._strokeWidth$1,this._fill$1&&(o.fillStyle=this._fillColor$1.toString(),o.fill()),o.strokeStyle=this._lineColor$1.toString(),o.globalAlpha=1,o.stroke(),o.restore()}}};function xa(){this._points$1=[],this._strokeWidth$1=1,this._lineColor$1=Xi.get_white(),pa.call(this)}n("Poly",[ya,Sa,pa]);var Ta={addPoint:function(t,e){pa.batchDirty=!0,this._points$1.push(Qs.raDecTo3d(t/15,e))},get_lineWidth:function(){return this._strokeWidth$1},set_lineWidth:function(t){return pa.batchDirty=!0,this._strokeWidth$1=t,t},get_lineColor:function(){return this._lineColor$1.toString()},set_lineColor:function(t){return pa.batchDirty=!0,this._lineColor$1=Oi.fromName(t),t},draw:function(e){if(null!=e.gl){if(pa.batchDirty||this.annotationDirty){var i=this._points$1;if(this._strokeWidth$1>0){var n=this._lineColor$1._clone();n.a=Math.round(n.a*this.get_opacity());for(var r=0;r<this._points$1.length-1;r++)pa.lineList.addLine(i[r],i[r+1],n,new As(0,1))}this.annotationDirty=!1}}else{var s=e.device;s.save(),s.globalAlpha=this.get_opacity();for(var a=!0,o=t.ss.enumerate(this._points$1);o.moveNext();){var l=o.current,h=e.WVP.transform(l);if(h.z<0)return void s.restore();if(wn.dot(e.get_viewPoint(),l)<.75)return void s.restore();a?(a=!1,s.beginPath(),s.moveTo(h.x,h.y)):s.lineTo(h.x,h.y)}s.lineWidth=this._strokeWidth$1,s.strokeStyle=this._lineColor$1.toString(),s.stroke(),s.restore()}}};n("PolyLine",[xa,Ta,pa]);var Ma={sun:0,mercury:1,venus:2,mars:3,jupiter:4,saturn:5,uranus:6,neptune:7,pluto:8,moon:9,io:10,europa:11,ganymede:12,callisto:13,ioShadow:14,europaShadow:15,ganymedeShadow:16,callistoShadow:17,sunEclipsed:18,earth:19,custom:20,undefined:65536};n("SolarSystemObjects",Ma),r("SolarSystemObjects",Ma);var Ca={linear:0,easeIn:1,easeOut:2,easeInOut:3,exponential:4,defaultV:5};function Aa(){this.lat=0,this.lng=0,this.zoom=0,this.rotation=0,this.angle=0,this.raDec=!1,this.opacity=0,this.target=0,this.zoom=360,this.viewTarget=new wn}n("InterpolationType",Ca),r("InterpolationType",Ca),Aa.create=function(t,e,i,n,r,s){var a=new Aa;return a.lat=t,a.lng=e,a.zoom=i,a.rotation=n,a.angle=r,a.raDec=!1,a.opacity=s,a.viewTarget=wn.create(0,0,0),a.target=20,a.targetReferenceFrame="",a},Aa.logN=function(t,e){return Math.log(t)/Math.log(e)},Aa.sinh=function(t){return(Math.exp(t)-Math.exp(-t))/2},Aa.interpolate=function(t,e,i,n,r){var s=new Aa,a=Aa.easeCurve(i,n),o=Math.min(1,2*i),l=Aa.easeCurve(o,n);return s.angle=e.angle*a+t.angle*(1-a),s.rotation=e.rotation*a+t.rotation*(1-a),r?(s.lat=e.lat*l+t.lat*(1-l),s.lng=e.lng*l+t.lng*(1-l)):(s.lat=e.lat*a+t.lat*(1-a),s.lng=e.lng*a+t.lng*(1-a)),s.zoom=Math.pow(2,Aa.logN(e.zoom,2)*a+Aa.logN(t.zoom,2)*(1-a)),s.opacity=e.opacity*a+t.opacity*(1-a),s.viewTarget=wn.lerp(t.viewTarget,e.viewTarget,a),s.targetReferenceFrame=e.targetReferenceFrame,e.target===t.target?s.target=e.target:s.target=20,s},Aa.interpolateGreatCircle=function(t,e,i,n,r){var s=new Aa,a=Aa.easeCurve(i,n),o=Math.min(1,2*i);Aa.easeCurve(o,n),s.angle=e.angle*a+t.angle*(1-a),s.rotation=e.rotation*a+t.rotation*(1-a);var l=Qs.geoTo3dDouble(t.lat,t.lng),h=Qs.geoTo3dDouble(e.lat,e.lng),u=wn.slerp(l,h,a),c=Qs.cartesianToLatLng(u);return s.lat=c.y,s.lng=c.x,s.zoom=Math.pow(2,Aa.logN(e.zoom,2)*a+Aa.logN(t.zoom,2)*(1-a)),s.opacity=e.opacity*a+t.opacity*(1-a),s.viewTarget=wn.lerp(t.viewTarget,e.viewTarget,a),s.targetReferenceFrame=e.targetReferenceFrame,e.target===t.target?s.target=e.target:s.target=20,s},Aa.easeCurve=function(t,e){switch(e){case 0:default:return t;case 4:return Math.pow(t,2);case 1:return(1-t)*Aa.sinh(t/.2171424688)/100+t*t;case 2:return t*(1-Aa.sinh((1-t)/.2171424688)/100)+(1-t)*t;case 3:return t<.5?Aa.sinh(t/.1085712344)/100:1-Aa.sinh((1-t)/.1085712344)/100}};var La={copy:function(){var t=new Aa;return t.lat=this.lat,t.lng=this.lng,t.zoom=this.zoom,t.rotation=this.rotation,t.angle=this.angle,t.raDec=this.raDec,t.opacity=this.opacity,t.viewTarget=this.viewTarget.copy(),t.target=this.target,t.targetReferenceFrame=this.targetReferenceFrame,t},get_RA:function(){return(180-(this.lng-180))/360*24%24},set_RA:function(t){return this.lng=180-t/24*360-180,this.raDec=!0,t},get_dec:function(){return this.lat},set_dec:function(t){return this.lat=t,t},equals:function(e){if(t.ss.canCast(e,Aa)){var i=e;return!(Math.abs(i.angle-this.angle)>.01||Math.abs(i.lat-this.lat)>i.zoom/1e4||Math.abs(i.get_RA()-this.get_RA())>i.zoom/1e3||Math.abs(i.rotation-this.rotation)>.1||Math.abs(i.zoom-this.zoom)>Math.abs(i.zoom)/1e3)}return!1}};function Ia(){this.bits=new Array(3),this.oldBits=new Array(3),this.blendState=xr.create(!1,1e3),this.internal=!1,this.settingsOwned=!1;for(var t=0;t<3;t++)this.bits[t]=~this.bits[t],this.oldBits[t]=this.bits[t]}n("CameraParameters",[Aa,La,null]),Ia.families={},Ia.bitIDs={},Ia.buildConstellationFilters=function(){var t=Ia.get_allConstellation();t.internal=!0,Ia.families.AllConstellation=t,Ia.families.Zodiacal=Ia.get_zodiacal(),Ia.families["Ursa Major Family"]=Ia.get_ursaMajorFamily(),Ia.families["Perseus Family"]=Ia.get_perseusFamily(),Ia.families["Hercules Family"]=Ia.get_herculesFamily(),Ia.families["Orion Family"]=Ia.get_orionFamily(),Ia.families["Heavenly Waters"]=Ia.get_heavenlyWaters(),Ia.families["Bayer Family"]=Ia.get_bayerFamily(),Ia.families["La Caille Family"]=Ia.get_laCaileFamily()},Ia.saveCustomFilters=function(){var e=new t.ss.StringBuilder,i=Ia.families;for(var n in i){var r={key:n,value:i[n]};r.value.internal||(e.append(r.key),e.append(";"),e.appendLine(r.value.toString()))}},Ia.get_allConstellation=function(){var t=new Ia;return t.setAll(!0),t},Ia.get_zodiacal=function(){var t=new Ia;return t.set("ARI",!0),t.set("TAU",!0),t.set("GEM",!0),t.set("CNC",!0),t.set("LEO",!0),t.set("VIR",!0),t.set("LIB",!0),t.set("SCO",!0),t.set("SGR",!0),t.set("CAP",!0),t.set("AQR",!0),t.set("PSC",!0),t.internal=!0,t},Ia.get_ursaMajorFamily=function(){var t=new Ia;return t.set("UMA",!0),t.set("UMI",!0),t.set("DRA",!0),t.set("CVN",!0),t.set("BOO",!0),t.set("COM",!0),t.set("CRB",!0),t.set("CAM",!0),t.set("LYN",!0),t.set("LMI",!0),t.internal=!0,t},Ia.get_perseusFamily=function(){var t=new Ia;return t.set("CAS",!0),t.set("CEP",!0),t.set("AND",!0),t.set("PER",!0),t.set("PEG",!0),t.set("CET",!0),t.set("AUR",!0),t.set("LAC",!0),t.set("TRI",!0),t.internal=!0,t},Ia.get_herculesFamily=function(){var t=new Ia;return t.set("HER",!0),t.set("SGE",!0),t.set("AQL",!0),t.set("LYR",!0),t.set("CYG",!0),t.set("VUL",!0),t.set("HYA",!0),t.set("SEX",!0),t.set("CRT",!0),t.set("CRV",!0),t.set("OPH",!0),t.set("SER1",!0),t.set("SER2",!0),t.set("SCT",!0),t.set("CEN",!0),t.set("LUP",!0),t.set("CRA",!0),t.set("ARA",!0),t.set("TRA",!0),t.set("CRU",!0),t.internal=!0,t},Ia.get_orionFamily=function(){var t=new Ia;return t.set("ORI",!0),t.set("CMA",!0),t.set("CMI",!0),t.set("MON",!0),t.set("LEP",!0),t.internal=!0,t},Ia.get_heavenlyWaters=function(){var t=new Ia;return t.set("DEL",!0),t.set("EQU",!0),t.set("ERI",!0),t.set("PSA",!0),t.set("CAR",!0),t.set("PUP",!0),t.set("VEL",!0),t.set("PYX",!0),t.set("COL",!0),t.internal=!0,t},Ia.get_bayerFamily=function(){var t=new Ia;return t.set("HYA",!0),t.set("DOR",!0),t.set("VOL",!0),t.set("APS",!0),t.set("PAV",!0),t.set("GRU",!0),t.set("PHE",!0),t.set("TUC",!0),t.set("IND",!0),t.set("CHA",!0),t.set("MUS",!0),t.internal=!0,t},Ia.get_laCaileFamily=function(){var t=new Ia;return t.set("NOR",!0),t.set("CIR",!0),t.set("TEL",!0),t.set("MIC",!0),t.set("SCL",!0),t.set("FOR",!0),t.set("CAE",!0),t.set("HOR",!0),t.set("OCT",!0),t.set("MEN",!0),t.set("RET",!0),t.set("PIC",!0),t.set("ANT",!0),t.internal=!0,t},Ia.parse=function(t){var e=t.split(","),i=new Ia;try{for(var n=0;n<3;n++)i.bits[n]=parseInt(e[n])}catch(t){}return i};var ka={_saveBits:function(){for(var t=0;t<3;t++)this.oldBits[t]=this.bits[t]},_isChanged:function(){for(var t=0;t<3;t++)if(this.oldBits[t]!==this.bits[t])return!0;return!1},_checkChanged:function(){this._isChanged()&&this._fireChanged()},isEnabled:function(t){var e=Ia.bitIDs[t],i=e/32;return e%=32,this.blendState.get_state()&&!!(1<<e&this.bits[i])},isSet:function(e){this._saveBits();var i=Ia.bitIDs[e],n=t.ss.truncate(i/32);return!!(1<<(i%=32)&this.bits[n])},set:function(t,e){this._saveBits();var i=Ia.bitIDs[t],n=i/32;i%=32,this.bits[n]=e?this.bits[n]|1<<i:this.bits[n]^1<<i,this._checkChanged()},setAll:function(t){this._saveBits();for(var e=0;e<89;e++){var i=e/32,n=e%32;this.bits[i]=t?this.bits[i]|1<<n:this.bits[i]^1<<n}this._checkChanged()},setBits:function(t){this._saveBits();for(var e=0;e<3;e++)this.bits[e]=t[4*e]+(t[4*e+1]<<8)+(t[4*e+2]<<16)+(t[4*e+3]<<24);this._checkChanged()},getBits:function(){for(var t=new Array(12),e=0,i=0;i<3;i++)t[e++]=this.bits[i],t[e++]=this.bits[i]>>8,t[e++]=this.bits[i]>>16,t[e++]=this.bits[i]>>24;return t},cloneFilter:function(t){this._saveBits();for(var e=0;e<3;e++)this.bits[e]=t.bits[e];this._checkChanged()},clone:function(){var t=new Ia;return t.cloneFilter(this),t},combine:function(t){this._saveBits();for(var e=0;e<3;e++)this.bits[e]=this.bits[e]|t.bits[e];this._checkChanged()},remove:function(t){this._saveBits();for(var e=0;e<3;e++)this.bits[e]=this.bits[e]&~t.bits[e];this._checkChanged()},_fireChanged:function(){this.settingsOwned},toString:function(){return t.ss.format("{0},{1},{2}",this.bits[0],this.bits[1],this.bits[2])}};n("ConstellationFilter",[Ia,ka,null]);var Pa={linear:0,log:1,power:2,squareRoot:3,histogramEqualization:4};function Ra(){this.bZero=0,this.bScale=1,this.containsBlanks=!1,this.blankValue=Number.MIN_VALUE,this.maxVal=Number.MIN_VALUE,this.minVal=Number.MAX_VALUE,this.upperCut=Number.MIN_VALUE,this.lowerCut=Number.MAX_VALUE,this.transparentBlack=!1,this.colorMapName="viridis",this.scaleType=0,this.onMainImageLoaded=null,this.mainImageLoadedEventHasFired=!1}function Ea(e){this.magnitude=0,this.RA=0,this.dec=0,this.BMV=0,this.id=0,this.absoluteMagnitude=0,this.par=0,this.distance=0;var i=e.split("\t");if(this.id=parseInt(t.ss.replaceString(i[0],"HIP","")),this.dec=parseFloat(i[3]),this.RA=parseFloat(i[2])/15,i.length>4)try{"NULL"!==i[4].toUpperCase()&&i[4]&&(this.magnitude=parseFloat(i[4]))}catch(t){}if(i.length>5)try{this.BMV=parseFloat(i[5]),this._makeColor(this.BMV)}catch(t){}i.length>6&&(this.par=parseFloat(i[6]),this._makeDistanceAndMagnitude())}function Da(t){this.RA=0,this.dec=0,this.distance=0,this.type=0,this.eTypeBucket=0,this.size=5,this.sdssID=0,this.sdssID=t.readInt64(),this.RA=t.readSingle(),this.dec=t.readSingle(),this.distance=t.readSingle(),this.eTypeBucket=t.readByte(),this.size=t.readSingle()}function Fa(){}n("ScaleTypes",Pa),r("ScaleTypes",Pa),n("FitsProperties",[Ra,{_fireMainImageLoaded:function(t){null==this.onMainImageLoaded||this.mainImageLoadedEventHasFired||(this.mainImageLoadedEventHasFired=!0,this.onMainImageLoaded(t))}},null]),n("Star",[Ea,{get_name:function(){return"HIP"+this.id.toString()},get_coordinates:function(){return Qs.fromRaDec(this.RA,this.dec)},stars:function(t,e){var i=t.split("\t");if(this.id=parseInt(i[0]),this.RA=parseFloat(i[1])/15,this.dec=parseFloat(i[2]),i.length>3)try{this.magnitude=parseFloat(i[3])}catch(t){}if(i.length>4)try{this.col=Oi.load(i[4])}catch(t){}},_makeDistanceAndMagnitude:function(){this.distance=1/(this.par/1e3),this.absoluteMagnitude=this.magnitude-5*(a.logN(this.distance,10)-1),this.distance*=206264.806},_makeColor:function(t){var e=4294967295;t<=-.32?e=4288854271:t<=-.31?e=4288919807:t<=-.3?e=4288985855:t<=-.28?e=4289182975:t<=-.26?e=4289314303:t<=-.24?e=4289445887:t<=-.2?e=4289708799:t<=-.16?e=4290037503:t<=-.14?e=4290169087:t<=-.12?e=4290366207:t<=-.09?e=4290563583:t<=-.06?e=4290892031:t<=0?e=4291483391:t<=.06?e=4292009215:t<=.14?e=4292732159:t<=.19?e=4293126399:t<=.31?e=4294111999:t<=.36?e=4294571775:t<=.43?e=4294965756:t<=.54?e=4294964979:t<=.59?e=4294964203:t<=.63?e=4294963687:t<=.66?e=4294963169:t<=.74?e=4294962909:t<=.82?e=4294961877:t<=.92?e=4294960324:t<=1.15?e=68719468472:t<=1.3?e=4294958516:t<=1.41?e=4294955933:t<=1.48?e=4294954385:t<=1.52?e=4294953351:t<=1.55?e=4294952319:t<=1.56?e=4294951287:t<=1.61?e=4294950257:t<=1.72?e=4294948966:t<=1.84?e=4294947419:t<=2&&(e=4294946129),this.col=Oi.fromInt(e)}},null]),Da._eTypeBuckets=[-3,-.186,-.168,-.158,-.15,-.143,-.137,-.13,-.123,-.115,-.104,-.089,-.068,-.042,-.011,.024,.064,.111,.169,.252,3],Da.getEType=function(t){for(var e=0,i=Da._eTypeBuckets.length-1;i-e>1;){var n=(e+i)/2;t>Da._eTypeBuckets[n]?e=n:i=n}return e},n("Galaxy",[Da,{},null]),Fa.kilometersPerAu=149598e3,Fa.auPerParsec=206264.806,Fa.auPerLightYear=63239.6717,Fa.ssmUnitConversion=370,Fa.gamma=function(e,i){return Math.min(255,t.ss.truncate(255*Math.pow(e/255,1/i)+.5))},Fa.getNamesStringFromArray=function(e){for(var i="",n="",r=t.ss.enumerate(e);r.moveNext();)i+=n,i+=r.current,n=";";return i},Fa.solarSystemToMeters=function(t){return 149598e3*t*370},Fa.metersToSolarSystemDistance=function(t){return t/370*149598e3},Fa.metersToZoom=function(t){return(t/1e3/370-1e-6)/4*9},Fa.formatDistance=function(e){if(e<.1){var i=149598e3*e;if(i<10){var n=t.ss.truncate(1e3*i);return t.ss.format("{0} m",n)}return i=t.ss.truncate(i),t.ss.format("{0} km",i)}if(e<10){var r=t.ss.truncate(10*e)/10;return t.ss.format("{0} au",r)}if(e<6323.96717)return r=t.ss.truncate(e),t.ss.format("{0} au",r);if(e<632396.717){var s=t.ss.truncate(10*e/63239.6717)/10;return t.ss.format("{0} ly",s)}if(e<63239671700)return s=t.ss.truncate(e/63239.6717),t.ss.format("{0} ly",s);if(e<206264806e4){var a=t.ss.truncate(10*e/206264806e3)/10;return t.ss.format("{0} Mpc",a)}return e<206264806e6?(a=t.ss.truncate(e/206264806e3),t.ss.format("{0} Mpc",a)):(a=t.ss.truncate(10*e/206264806e6)/10,t.ss.format("{0} Gpc",a))},Fa.formatDecimalHours=function(e){t.ss.now().getTimezoneOffset();for(var i=e-0+.0083333334;i>24;)i-=24;for(;i<0;)i+=24;var n=t.ss.truncate(i),r=t.ss.truncate(60*i-60*n),s=t.ss.truncate(3600*i-(3600*n+60*r));return t.ss.format("{0}:{1}",n,r,s)},Fa.splitString=function(t,e){for(var i=[],n=0,r=0,s=0,a=0;r<t.length;){if("("===t.substr(r,1)&&n++,")"===t.substr(r,1)&&n--,r===t.length-1){if(t.substr(r,1)===e)return i.push(t.substr(a,s)),i.push(""),i;s++}r===t.length-1||t.substr(r,1)===e&&"\t"===e||!n&&t.substr(r,1)===e?(i.push(t.substr(a,s)),a=r+1,s=0):s++,r++}return i},Fa.split=function(t,e){for(var i=[],n=0,r=0,s=0;n<t.length;)n===t.length-1&&r++,n===t.length-1||e.indexOf(t.substr(n,1))>-1?(i.push(t.substr(s,r)),s=n+1,r=0):r++,n++;return i},Fa._beep=function(){},n("UiTools",[Fa,{},null]);var Na={pending:0,received:1,error:2};function $a(t){this._state=0,this.responseType="",this._triedOnce=!1,this._url=t}n("StateType",Na),r("StateType",Na);var za={send:function(){"undefined"!=typeof navigator&&(this._CORS(),this.set_state(Na.pending))},get_message:function(){return this._message},get_state:function(){return this._state},set_state:function(t){return this._state=t,null!=this.onStateChange&&this.onStateChange(),t},_loadData:function(t){this._data=t,this.set_state(Na.received)},_loadBlob:function(t){this._blobdata=t,this.set_state(Na.received)},_error:function(){this._message=t.ss.format("Error encountered loading {0}",this._url),this.set_state(Na.error)},_timeOut:function(){this._message=t.ss.format("Timeout encountered loading {0}",this._url),this.set_state(Na.error)},_CORS:function(){var t=this;this._xhr=new XMLHttpRequest;try{this._xhr.open("GET",this._url),null!=this.responseType&&(this._xhr.responseType=this.responseType),this._xhr.onreadystatechange=function(){if(4===t._xhr.readyState)if(t._xhr.status)t._xhr.status>=400?(t._message=t._xhr.statusText,t.set_state(Na.error)):t.responseType?t._loadBlob(t._xhr.response):t._loadData(t._xhr.responseText);else if(!t._triedOnce){t._triedOnce=!0,t._xhr.onreadystatechange=null;var e=zr.singleton.activateProxy(t._url);null!==e?(t._url=e,t._CORS()):(t._message=t._xhr.statusText,t.set_state(Na.error))}},this._xhr.send()}catch(t){throw this._message=t.message,this.set_state(Na.error),t}},getText:function(){return this._data},getBlob:function(){return this._blobdata},getXml:function(){return(new DOMParser).parseFromString(this._data,"text/xml")}};function Ba(){this.colors=[]}n("WebFile",[$a,za,null]),Ba.colorTextures={},Ba.fromArgbList=function(e){for(var i=new Ba,n=t.ss.enumerate(e);n.moveNext();){var r=n.current;i.colors.push(Oi.fromArgb(r[0],r[1],r[2],r[3]))}return i},Ba.fromStringList=function(e){for(var i=new Ba,n=t.ss.enumerate(e);n.moveNext();){var r=n.current;i.colors.push(Oi.load(r))}return i},Ba.fromNamedColormap=function(t){if(null==t)return null;switch(t.toLowerCase()){case"viridis":return Ba.viridis;case"plasma":return Ba.plasma;case"inferno":return Ba.inferno;case"magma":return Ba.magma;case"cividis":return Ba.cividis;case"greys":return Ba.greys;case"gray":return Ba.gray;case"purples":return Ba.purples;case"blues":return Ba.blues;case"greens":return Ba.greens;case"oranges":return Ba.oranges;case"reds":return Ba.reds;case"rdylbu":return Ba.rdYlBu}return null},Ba._getTextureFromName=function(t,e){var i=Ba.colorTextures[e];if(null==i){var n=Ba.fromNamedColormap(e);null!=n&&(i=Ba._initColorTexture(t,n),Ba.colorTextures[e.toLowerCase()]=i)}return i},Ba.bindColorMapTexture=function(t,e){var i=Ba._getTextureFromName(t,e);null==i&&(i=Ba._getTextureFromName(t,"gray")),t.activeTexture(Yr.TEXTURE1),t.bindTexture(Yr.TEXTURE_2D,i)},Ba._initColorTexture=function(t,e){var i=t.createTexture();t.activeTexture(Yr.TEXTURE1),t.bindTexture(Yr.TEXTURE_2D,i),t.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_S,Yr.CLAMP_TO_EDGE),t.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_T,Yr.CLAMP_TO_EDGE);var n=Ba._extractColorArray(e.colors);return t.texImage2D(Yr.TEXTURE_2D,0,Yr.RGB8,n.length/3,1,0,Yr.RGB,Yr.UNSIGNED_BYTE,n),t.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MIN_FILTER,Yr.NEAREST),t.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MAG_FILTER,Yr.NEAREST),i},Ba._extractColorArray=function(e){for(var i=0,n=new Uint8Array(3*e.length),r=t.ss.enumerate(e);r.moveNext();){var s=r.current;n[i++]=s.r,n[i++]=s.g,n[i++]=s.b}return n};var Ua={findClosestColor:function(e){var i;return e<=0?this.colors[0]:e>=1?this.colors[this.colors.length-1]:(i=t.ss.truncate(e*this.colors.length),this.colors[i])}};function Va(){this.copyright="",this.creditsUrl="",this._validWcs=!1,this.keywords=[],this.description="",this.scaleX=0,this.scaleY=0,this.centerX=0,this.centerY=0,this.rotation=0,this.referenceX=0,this.referenceY=0,this.sizeX=0,this.sizeY=0,this.cd1_1=0,this.cd1_2=0,this.cd2_1=0,this.cd2_2=0,this.hasRotation=!1,this.hasSize=!1,this.hasScale=!1,this.hasLocation=!1,this.hasPixel=!1,this.filename="",this._colorCombine=!1}n("ColorMapContainer",[Ba,Ua,null]),Ba.viridis=Ba.fromStringList(["#440154","#440256","#450457","#450559","#46075a","#46085c","#460a5d","#460b5e","#470d60","#470e61","#471063","#471164","#471365","#481467","#481668","#481769","#48186a","#481a6c","#481b6d","#481c6e","#481d6f","#481f70","#482071","#482173","#482374","#482475","#482576","#482677","#482878","#482979","#472a7a","#472c7a","#472d7b","#472e7c","#472f7d","#46307e","#46327e","#46337f","#463480","#453581","#453781","#453882","#443983","#443a83","#443b84","#433d84","#433e85","#423f85","#424086","#424186","#414287","#414487","#404588","#404688","#3f4788","#3f4889","#3e4989","#3e4a89","#3e4c8a","#3d4d8a","#3d4e8a","#3c4f8a","#3c508b","#3b518b","#3b528b","#3a538b","#3a548c","#39558c","#39568c","#38588c","#38598c","#375a8c","#375b8d","#365c8d","#365d8d","#355e8d","#355f8d","#34608d","#34618d","#33628d","#33638d","#32648e","#32658e","#31668e","#31678e","#31688e","#30698e","#306a8e","#2f6b8e","#2f6c8e","#2e6d8e","#2e6e8e","#2e6f8e","#2d708e","#2d718e","#2c718e","#2c728e","#2c738e","#2b748e","#2b758e","#2a768e","#2a778e","#2a788e","#29798e","#297a8e","#297b8e","#287c8e","#287d8e","#277e8e","#277f8e","#27808e","#26818e","#26828e","#26828e","#25838e","#25848e","#25858e","#24868e","#24878e","#23888e","#23898e","#238a8d","#228b8d","#228c8d","#228d8d","#218e8d","#218f8d","#21908d","#21918c","#20928c","#20928c","#20938c","#1f948c","#1f958b","#1f968b","#1f978b","#1f988b","#1f998a","#1f9a8a","#1e9b8a","#1e9c89","#1e9d89","#1f9e89","#1f9f88","#1fa088","#1fa188","#1fa187","#1fa287","#20a386","#20a486","#21a585","#21a685","#22a785","#22a884","#23a983","#24aa83","#25ab82","#25ac82","#26ad81","#27ad81","#28ae80","#29af7f","#2ab07f","#2cb17e","#2db27d","#2eb37c","#2fb47c","#31b57b","#32b67a","#34b679","#35b779","#37b878","#38b977","#3aba76","#3bbb75","#3dbc74","#3fbc73","#40bd72","#42be71","#44bf70","#46c06f","#48c16e","#4ac16d","#4cc26c","#4ec36b","#50c46a","#52c569","#54c568","#56c667","#58c765","#5ac864","#5cc863","#5ec962","#60ca60","#63cb5f","#65cb5e","#67cc5c","#69cd5b","#6ccd5a","#6ece58","#70cf57","#73d056","#75d054","#77d153","#7ad151","#7cd250","#7fd34e","#81d34d","#84d44b","#86d549","#89d548","#8bd646","#8ed645","#90d743","#93d741","#95d840","#98d83e","#9bd93c","#9dd93b","#a0da39","#a2da37","#a5db36","#a8db34","#aadc32","#addc30","#b0dd2f","#b2dd2d","#b5de2b","#b8de29","#bade28","#bddf26","#c0df25","#c2df23","#c5e021","#c8e020","#cae11f","#cde11d","#d0e11c","#d2e21b","#d5e21a","#d8e219","#dae319","#dde318","#dfe318","#e2e418","#e5e419","#e7e419","#eae51a","#ece51b","#efe51c","#f1e51d","#f4e61e","#f6e620","#f8e621","#fbe723","#fde725"]),Ba.plasma=Ba.fromStringList(["#0d0887","#100788","#130789","#16078a","#19068c","#1b068d","#1d068e","#20068f","#220690","#240691","#260591","#280592","#2a0593","#2c0594","#2e0595","#2f0596","#310597","#330597","#350498","#370499","#38049a","#3a049a","#3c049b","#3e049c","#3f049c","#41049d","#43039e","#44039e","#46039f","#48039f","#4903a0","#4b03a1","#4c02a1","#4e02a2","#5002a2","#5102a3","#5302a3","#5502a4","#5601a4","#5801a4","#5901a5","#5b01a5","#5c01a6","#5e01a6","#6001a6","#6100a7","#6300a7","#6400a7","#6600a7","#6700a8","#6900a8","#6a00a8","#6c00a8","#6e00a8","#6f00a8","#7100a8","#7201a8","#7401a8","#7501a8","#7701a8","#7801a8","#7a02a8","#7b02a8","#7d03a8","#7e03a8","#8004a8","#8104a7","#8305a7","#8405a7","#8606a6","#8707a6","#8808a6","#8a09a5","#8b0aa5","#8d0ba5","#8e0ca4","#8f0da4","#910ea3","#920fa3","#9410a2","#9511a1","#9613a1","#9814a0","#99159f","#9a169f","#9c179e","#9d189d","#9e199d","#a01a9c","#a11b9b","#a21d9a","#a31e9a","#a51f99","#a62098","#a72197","#a82296","#aa2395","#ab2494","#ac2694","#ad2793","#ae2892","#b02991","#b12a90","#b22b8f","#b32c8e","#b42e8d","#b52f8c","#b6308b","#b7318a","#b83289","#ba3388","#bb3488","#bc3587","#bd3786","#be3885","#bf3984","#c03a83","#c13b82","#c23c81","#c33d80","#c43e7f","#c5407e","#c6417d","#c7427c","#c8437b","#c9447a","#ca457a","#cb4679","#cc4778","#cc4977","#cd4a76","#ce4b75","#cf4c74","#d04d73","#d14e72","#d24f71","#d35171","#d45270","#d5536f","#d5546e","#d6556d","#d7566c","#d8576b","#d9586a","#da5a6a","#da5b69","#db5c68","#dc5d67","#dd5e66","#de5f65","#de6164","#df6263","#e06363","#e16462","#e26561","#e26660","#e3685f","#e4695e","#e56a5d","#e56b5d","#e66c5c","#e76e5b","#e76f5a","#e87059","#e97158","#e97257","#ea7457","#eb7556","#eb7655","#ec7754","#ed7953","#ed7a52","#ee7b51","#ef7c51","#ef7e50","#f07f4f","#f0804e","#f1814d","#f1834c","#f2844b","#f3854b","#f3874a","#f48849","#f48948","#f58b47","#f58c46","#f68d45","#f68f44","#f79044","#f79143","#f79342","#f89441","#f89540","#f9973f","#f9983e","#f99a3e","#fa9b3d","#fa9c3c","#fa9e3b","#fb9f3a","#fba139","#fba238","#fca338","#fca537","#fca636","#fca835","#fca934","#fdab33","#fdac33","#fdae32","#fdaf31","#fdb130","#fdb22f","#fdb42f","#fdb52e","#feb72d","#feb82c","#feba2c","#febb2b","#febd2a","#febe2a","#fec029","#fdc229","#fdc328","#fdc527","#fdc627","#fdc827","#fdca26","#fdcb26","#fccd25","#fcce25","#fcd025","#fcd225","#fbd324","#fbd524","#fbd724","#fad824","#fada24","#f9dc24","#f9dd25","#f8df25","#f8e125","#f7e225","#f7e425","#f6e626","#f6e826","#f5e926","#f5eb27","#f4ed27","#f3ee27","#f3f027","#f2f227","#f1f426","#f1f525","#f0f724","#f0f921"]),Ba.inferno=Ba.fromStringList(["#000004","#010005","#010106","#010108","#02010a","#02020c","#02020e","#030210","#040312","#040314","#050417","#060419","#07051b","#08051d","#09061f","#0a0722","#0b0724","#0c0826","#0d0829","#0e092b","#10092d","#110a30","#120a32","#140b34","#150b37","#160b39","#180c3c","#190c3e","#1b0c41","#1c0c43","#1e0c45","#1f0c48","#210c4a","#230c4c","#240c4f","#260c51","#280b53","#290b55","#2b0b57","#2d0b59","#2f0a5b","#310a5c","#320a5e","#340a5f","#360961","#380962","#390963","#3b0964","#3d0965","#3e0966","#400a67","#420a68","#440a68","#450a69","#470b6a","#490b6a","#4a0c6b","#4c0c6b","#4d0d6c","#4f0d6c","#510e6c","#520e6d","#540f6d","#550f6d","#57106e","#59106e","#5a116e","#5c126e","#5d126e","#5f136e","#61136e","#62146e","#64156e","#65156e","#67166e","#69166e","#6a176e","#6c186e","#6d186e","#6f196e","#71196e","#721a6e","#741a6e","#751b6e","#771c6d","#781c6d","#7a1d6d","#7c1d6d","#7d1e6d","#7f1e6c","#801f6c","#82206c","#84206b","#85216b","#87216b","#88226a","#8a226a","#8c2369","#8d2369","#8f2469","#902568","#922568","#932667","#952667","#972766","#982766","#9a2865","#9b2964","#9d2964","#9f2a63","#a02a63","#a22b62","#a32c61","#a52c60","#a62d60","#a82e5f","#a92e5e","#ab2f5e","#ad305d","#ae305c","#b0315b","#b1325a","#b3325a","#b43359","#b63458","#b73557","#b93556","#ba3655","#bc3754","#bd3853","#bf3952","#c03a51","#c13a50","#c33b4f","#c43c4e","#c63d4d","#c73e4c","#c83f4b","#ca404a","#cb4149","#cc4248","#ce4347","#cf4446","#d04545","#d24644","#d34743","#d44842","#d54a41","#d74b3f","#d84c3e","#d94d3d","#da4e3c","#db503b","#dd513a","#de5238","#df5337","#e05536","#e15635","#e25734","#e35933","#e45a31","#e55c30","#e65d2f","#e75e2e","#e8602d","#e9612b","#ea632a","#eb6429","#eb6628","#ec6726","#ed6925","#ee6a24","#ef6c23","#ef6e21","#f06f20","#f1711f","#f1731d","#f2741c","#f3761b","#f37819","#f47918","#f57b17","#f57d15","#f67e14","#f68013","#f78212","#f78410","#f8850f","#f8870e","#f8890c","#f98b0b","#f98c0a","#f98e09","#fa9008","#fa9207","#fa9407","#fb9606","#fb9706","#fb9906","#fb9b06","#fb9d07","#fc9f07","#fca108","#fca309","#fca50a","#fca60c","#fca80d","#fcaa0f","#fcac11","#fcae12","#fcb014","#fcb216","#fcb418","#fbb61a","#fbb81d","#fbba1f","#fbbc21","#fbbe23","#fac026","#fac228","#fac42a","#fac62d","#f9c72f","#f9c932","#f9cb35","#f8cd37","#f8cf3a","#f7d13d","#f7d340","#f6d543","#f6d746","#f5d949","#f5db4c","#f4dd4f","#f4df53","#f4e156","#f3e35a","#f3e55d","#f2e661","#f2e865","#f2ea69","#f1ec6d","#f1ed71","#f1ef75","#f1f179","#f2f27d","#f2f482","#f3f586","#f3f68a","#f4f88e","#f5f992","#f6fa96","#f8fb9a","#f9fc9d","#fafda1","#fcffa4"]),Ba.magma=Ba.fromStringList(["#000004","#010005","#010106","#010108","#020109","#02020b","#02020d","#03030f","#030312","#040414","#050416","#060518","#06051a","#07061c","#08071e","#090720","#0a0822","#0b0924","#0c0926","#0d0a29","#0e0b2b","#100b2d","#110c2f","#120d31","#130d34","#140e36","#150e38","#160f3b","#180f3d","#19103f","#1a1042","#1c1044","#1d1147","#1e1149","#20114b","#21114e","#221150","#241253","#251255","#271258","#29115a","#2a115c","#2c115f","#2d1161","#2f1163","#311165","#331067","#341069","#36106b","#38106c","#390f6e","#3b0f70","#3d0f71","#3f0f72","#400f74","#420f75","#440f76","#451077","#471078","#491078","#4a1079","#4c117a","#4e117b","#4f127b","#51127c","#52137c","#54137d","#56147d","#57157e","#59157e","#5a167e","#5c167f","#5d177f","#5f187f","#601880","#621980","#641a80","#651a80","#671b80","#681c81","#6a1c81","#6b1d81","#6d1d81","#6e1e81","#701f81","#721f81","#732081","#752181","#762181","#782281","#792282","#7b2382","#7c2382","#7e2482","#802582","#812581","#832681","#842681","#862781","#882781","#892881","#8b2981","#8c2981","#8e2a81","#902a81","#912b81","#932b80","#942c80","#962c80","#982d80","#992d80","#9b2e7f","#9c2e7f","#9e2f7f","#a02f7f","#a1307e","#a3307e","#a5317e","#a6317d","#a8327d","#aa337d","#ab337c","#ad347c","#ae347b","#b0357b","#b2357b","#b3367a","#b5367a","#b73779","#b83779","#ba3878","#bc3978","#bd3977","#bf3a77","#c03a76","#c23b75","#c43c75","#c53c74","#c73d73","#c83e73","#ca3e72","#cc3f71","#cd4071","#cf4070","#d0416f","#d2426f","#d3436e","#d5446d","#d6456c","#d8456c","#d9466b","#db476a","#dc4869","#de4968","#df4a68","#e04c67","#e24d66","#e34e65","#e44f64","#e55064","#e75263","#e85362","#e95462","#ea5661","#eb5760","#ec5860","#ed5a5f","#ee5b5e","#ef5d5e","#f05f5e","#f1605d","#f2625d","#f2645c","#f3655c","#f4675c","#f4695c","#f56b5c","#f66c5c","#f66e5c","#f7705c","#f7725c","#f8745c","#f8765c","#f9785d","#f9795d","#f97b5d","#fa7d5e","#fa7f5e","#fa815f","#fb835f","#fb8560","#fb8761","#fc8961","#fc8a62","#fc8c63","#fc8e64","#fc9065","#fd9266","#fd9467","#fd9668","#fd9869","#fd9a6a","#fd9b6b","#fe9d6c","#fe9f6d","#fea16e","#fea36f","#fea571","#fea772","#fea973","#feaa74","#feac76","#feae77","#feb078","#feb27a","#feb47b","#feb67c","#feb77e","#feb97f","#febb81","#febd82","#febf84","#fec185","#fec287","#fec488","#fec68a","#fec88c","#feca8d","#fecc8f","#fecd90","#fecf92","#fed194","#fed395","#fed597","#fed799","#fed89a","#fdda9c","#fddc9e","#fddea0","#fde0a1","#fde2a3","#fde3a5","#fde5a7","#fde7a9","#fde9aa","#fdebac","#fcecae","#fceeb0","#fcf0b2","#fcf2b4","#fcf4b6","#fcf6b8","#fcf7b9","#fcf9bb","#fcfbbd","#fcfdbf"]),Ba.cividis=Ba.fromStringList(["#00224e","#00234f","#002451","#002553","#002554","#002656","#002758","#002859","#00285b","#00295d","#002a5f","#002a61","#002b62","#002c64","#002c66","#002d68","#002e6a","#002e6c","#002f6d","#00306f","#003070","#003170","#003171","#013271","#053371","#083370","#0c3470","#0f3570","#123570","#143670","#163770","#18376f","#1a386f","#1c396f","#1e3a6f","#203a6f","#213b6e","#233c6e","#243c6e","#263d6e","#273e6e","#293f6e","#2a3f6d","#2b406d","#2d416d","#2e416d","#2f426d","#31436d","#32436d","#33446d","#34456c","#35456c","#36466c","#38476c","#39486c","#3a486c","#3b496c","#3c4a6c","#3d4a6c","#3e4b6c","#3f4c6c","#404c6c","#414d6c","#424e6c","#434e6c","#444f6c","#45506c","#46516c","#47516c","#48526c","#49536c","#4a536c","#4b546c","#4c556c","#4d556c","#4e566c","#4f576c","#50576c","#51586d","#52596d","#535a6d","#545a6d","#555b6d","#555c6d","#565c6d","#575d6d","#585e6d","#595e6e","#5a5f6e","#5b606e","#5c616e","#5d616e","#5e626e","#5e636f","#5f636f","#60646f","#61656f","#62656f","#636670","#646770","#656870","#656870","#666970","#676a71","#686a71","#696b71","#6a6c71","#6b6d72","#6c6d72","#6c6e72","#6d6f72","#6e6f73","#6f7073","#707173","#717274","#727274","#727374","#737475","#747475","#757575","#767676","#777776","#777777","#787877","#797977","#7a7a78","#7b7a78","#7c7b78","#7d7c78","#7e7c78","#7e7d78","#7f7e78","#807f78","#817f78","#828079","#838179","#848279","#858279","#868379","#878478","#888578","#898578","#8a8678","#8b8778","#8c8878","#8d8878","#8e8978","#8f8a78","#908b78","#918b78","#928c78","#928d78","#938e78","#948e77","#958f77","#969077","#979177","#989277","#999277","#9a9376","#9b9476","#9c9576","#9d9576","#9e9676","#9f9775","#a09875","#a19975","#a29975","#a39a74","#a49b74","#a59c74","#a69c74","#a79d73","#a89e73","#a99f73","#aaa073","#aba072","#aca172","#ada272","#aea371","#afa471","#b0a571","#b1a570","#b3a670","#b4a76f","#b5a86f","#b6a96f","#b7a96e","#b8aa6e","#b9ab6d","#baac6d","#bbad6d","#bcae6c","#bdae6c","#beaf6b","#bfb06b","#c0b16a","#c1b26a","#c2b369","#c3b369","#c4b468","#c5b568","#c6b667","#c7b767","#c8b866","#c9b965","#cbb965","#ccba64","#cdbb63","#cebc63","#cfbd62","#d0be62","#d1bf61","#d2c060","#d3c05f","#d4c15f","#d5c25e","#d6c35d","#d7c45c","#d9c55c","#dac65b","#dbc75a","#dcc859","#ddc858","#dec958","#dfca57","#e0cb56","#e1cc55","#e2cd54","#e4ce53","#e5cf52","#e6d051","#e7d150","#e8d24f","#e9d34e","#ead34c","#ebd44b","#edd54a","#eed649","#efd748","#f0d846","#f1d945","#f2da44","#f3db42","#f5dc41","#f6dd3f","#f7de3e","#f8df3c","#f9e03a","#fbe138","#fce236","#fde334","#fee434","#fee535","#fee636","#fee838"]),Ba.greys=Ba.fromStringList(["#ffffff","#ffffff","#fefefe","#fefefe","#fdfdfd","#fdfdfd","#fcfcfc","#fcfcfc","#fbfbfb","#fbfbfb","#fafafa","#fafafa","#f9f9f9","#f9f9f9","#f8f8f8","#f8f8f8","#f7f7f7","#f7f7f7","#f7f7f7","#f6f6f6","#f6f6f6","#f5f5f5","#f5f5f5","#f4f4f4","#f4f4f4","#f3f3f3","#f3f3f3","#f2f2f2","#f2f2f2","#f1f1f1","#f1f1f1","#f0f0f0","#f0f0f0","#efefef","#eeeeee","#eeeeee","#ededed","#ececec","#ececec","#ebebeb","#eaeaea","#e9e9e9","#e9e9e9","#e8e8e8","#e7e7e7","#e7e7e7","#e6e6e6","#e5e5e5","#e4e4e4","#e4e4e4","#e3e3e3","#e2e2e2","#e1e1e1","#e1e1e1","#e0e0e0","#dfdfdf","#dfdfdf","#dedede","#dddddd","#dcdcdc","#dcdcdc","#dbdbdb","#dadada","#dadada","#d9d9d9","#d8d8d8","#d7d7d7","#d6d6d6","#d5d5d5","#d4d4d4","#d4d4d4","#d3d3d3","#d2d2d2","#d1d1d1","#d0d0d0","#cfcfcf","#cecece","#cdcdcd","#cccccc","#cccccc","#cbcbcb","#cacaca","#c9c9c9","#c8c8c8","#c7c7c7","#c6c6c6","#c5c5c5","#c5c5c5","#c4c4c4","#c3c3c3","#c2c2c2","#c1c1c1","#c0c0c0","#bfbfbf","#bebebe","#bebebe","#bdbdbd","#bbbbbb","#bababa","#b9b9b9","#b8b8b8","#b6b6b6","#b5b5b5","#b4b4b4","#b3b3b3","#b2b2b2","#b0b0b0","#afafaf","#aeaeae","#adadad","#ababab","#aaaaaa","#a9a9a9","#a8a8a8","#a7a7a7","#a5a5a5","#a4a4a4","#a3a3a3","#a2a2a2","#a0a0a0","#9f9f9f","#9e9e9e","#9d9d9d","#9c9c9c","#9a9a9a","#999999","#989898","#979797","#959595","#949494","#939393","#929292","#919191","#909090","#8f8f8f","#8e8e8e","#8d8d8d","#8c8c8c","#8a8a8a","#898989","#888888","#878787","#868686","#858585","#848484","#838383","#828282","#818181","#7f7f7f","#7e7e7e","#7d7d7d","#7c7c7c","#7b7b7b","#7a7a7a","#797979","#787878","#777777","#767676","#757575","#737373","#727272","#717171","#707070","#6f6f6f","#6e6e6e","#6d6d6d","#6c6c6c","#6b6b6b","#6a6a6a","#696969","#686868","#676767","#666666","#656565","#646464","#636363","#626262","#616161","#606060","#5f5f5f","#5e5e5e","#5d5d5d","#5c5c5c","#5b5b5b","#5a5a5a","#585858","#575757","#565656","#555555","#545454","#535353","#525252","#515151","#505050","#4e4e4e","#4d4d4d","#4b4b4b","#4a4a4a","#484848","#474747","#464646","#444444","#434343","#414141","#404040","#3f3f3f","#3d3d3d","#3c3c3c","#3a3a3a","#393939","#383838","#363636","#353535","#333333","#323232","#303030","#2f2f2f","#2e2e2e","#2c2c2c","#2b2b2b","#292929","#282828","#272727","#252525","#242424","#232323","#222222","#212121","#1f1f1f","#1e1e1e","#1d1d1d","#1c1c1c","#1b1b1b","#1a1a1a","#181818","#171717","#161616","#151515","#141414","#131313","#111111","#101010","#0f0f0f","#0e0e0e","#0d0d0d","#0c0c0c","#0a0a0a","#090909","#080808","#070707","#060606","#050505","#030303","#020202","#010101","#000000"]),Ba.gray=Ba.fromStringList(["#000000","#010101","#020202","#030303","#040404","#050505","#060606","#070707","#080808","#090909","#0a0a0a","#0b0b0b","#0c0c0c","#0d0d0d","#0e0e0e","#0f0f0f","#101010","#111111","#121212","#131313","#141414","#151515","#161616","#171717","#181818","#191919","#1a1a1a","#1b1b1b","#1c1c1c","#1d1d1d","#1e1e1e","#1f1f1f","#202020","#212121","#222222","#232323","#242424","#252525","#262626","#272727","#282828","#292929","#2a2a2a","#2b2b2b","#2c2c2c","#2d2d2d","#2e2e2e","#2f2f2f","#303030","#313131","#323232","#333333","#343434","#353535","#363636","#373737","#383838","#393939","#3a3a3a","#3b3b3b","#3c3c3c","#3d3d3d","#3e3e3e","#3f3f3f","#404040","#414141","#424242","#434343","#444444","#454545","#464646","#474747","#484848","#494949","#4a4a4a","#4b4b4b","#4c4c4c","#4d4d4d","#4e4e4e","#4f4f4f","#505050","#515151","#525252","#535353","#545454","#555555","#565656","#575757","#585858","#595959","#5a5a5a","#5b5b5b","#5c5c5c","#5d5d5d","#5e5e5e","#5f5f5f","#606060","#616161","#626262","#636363","#646464","#656565","#666666","#676767","#686868","#696969","#6a6a6a","#6b6b6b","#6c6c6c","#6d6d6d","#6e6e6e","#6f6f6f","#707070","#717171","#727272","#737373","#747474","#757575","#767676","#777777","#787878","#797979","#7a7a7a","#7b7b7b","#7c7c7c","#7d7d7d","#7e7e7e","#7f7f7f","#808080","#818181","#828282","#838383","#848484","#858585","#868686","#878787","#888888","#898989","#8a8a8a","#8b8b8b","#8c8c8c","#8d8d8d","#8e8e8e","#8f8f8f","#909090","#919191","#929292","#939393","#949494","#959595","#969696","#979797","#989898","#999999","#9a9a9a","#9b9b9b","#9c9c9c","#9d9d9d","#9e9e9e","#9f9f9f","#a0a0a0","#a1a1a1","#a2a2a2","#a3a3a3","#a4a4a4","#a5a5a5","#a6a6a6","#a7a7a7","#a8a8a8","#a9a9a9","#aaaaaa","#ababab","#acacac","#adadad","#aeaeae","#afafaf","#b0b0b0","#b1b1b1","#b2b2b2","#b3b3b3","#b4b4b4","#b5b5b5","#b6b6b6","#b7b7b7","#b8b8b8","#b9b9b9","#bababa","#bbbbbb","#bcbcbc","#bdbdbd","#bebebe","#bfbfbf","#c0c0c0","#c1c1c1","#c2c2c2","#c3c3c3","#c4c4c4","#c5c5c5","#c6c6c6","#c7c7c7","#c8c8c8","#c9c9c9","#cacaca","#cbcbcb","#cccccc","#cdcdcd","#cecece","#cfcfcf","#d0d0d0","#d1d1d1","#d2d2d2","#d3d3d3","#d4d4d4","#d5d5d5","#d6d6d6","#d7d7d7","#d8d8d8","#d9d9d9","#dadada","#dbdbdb","#dcdcdc","#dddddd","#dedede","#dfdfdf","#e0e0e0","#e1e1e1","#e2e2e2","#e3e3e3","#e4e4e4","#e5e5e5","#e6e6e6","#e7e7e7","#e8e8e8","#e9e9e9","#eaeaea","#ebebeb","#ececec","#ededed","#eeeeee","#efefef","#f0f0f0","#f1f1f1","#f2f2f2","#f3f3f3","#f4f4f4","#f5f5f5","#f6f6f6","#f7f7f7","#f8f8f8","#f9f9f9","#fafafa","#fbfbfb","#fcfcfc","#fdfdfd","#fefefe","#ffffff"]),Ba.purples=Ba.fromStringList(["#fcfbfd","#fcfbfd","#fbfafc","#fbfafc","#faf9fc","#faf9fc","#faf8fb","#f9f8fb","#f9f7fb","#f8f7fb","#f8f7fa","#f8f6fa","#f7f6fa","#f7f5fa","#f6f5f9","#f6f4f9","#f5f4f9","#f5f4f9","#f5f3f8","#f4f3f8","#f4f2f8","#f3f2f8","#f3f1f7","#f3f1f7","#f2f0f7","#f2f0f7","#f1f0f6","#f1eff6","#f1eff6","#f0eef6","#f0eef5","#efedf5","#efedf5","#eeecf5","#eeecf4","#edebf4","#ecebf4","#eceaf3","#ebe9f3","#eae9f3","#eae8f2","#e9e8f2","#e8e7f2","#e8e6f2","#e7e6f1","#e6e5f1","#e6e5f1","#e5e4f0","#e4e3f0","#e4e3f0","#e3e2ef","#e2e2ef","#e2e1ef","#e1e0ee","#e0e0ee","#e0dfee","#dfdfed","#dedeed","#dedded","#ddddec","#dcdcec","#dcdcec","#dbdbec","#dadaeb","#dadaeb","#d9d9ea","#d8d8ea","#d7d7e9","#d6d6e9","#d5d5e9","#d4d4e8","#d3d3e8","#d2d2e7","#d1d2e7","#d0d1e6","#cfd0e6","#cecfe5","#cecee5","#cdcde4","#cccce4","#cbcbe3","#cacae3","#c9c9e2","#c8c8e2","#c7c8e1","#c6c7e1","#c5c6e1","#c4c5e0","#c3c4e0","#c2c3df","#c1c2df","#c0c1de","#bfc0de","#bebfdd","#bebedd","#bdbedc","#bcbddc","#bbbbdb","#babadb","#b9b9da","#b8b8d9","#b7b7d9","#b6b6d8","#b5b5d7","#b4b4d7","#b3b3d6","#b2b2d5","#b1b1d5","#b0afd4","#afaed4","#aeadd3","#aeacd2","#adabd2","#acaad1","#aba9d0","#aaa8d0","#a9a7cf","#a8a6cf","#a7a4ce","#a6a3cd","#a5a2cd","#a4a1cc","#a3a0cb","#a29fcb","#a19eca","#a09dca","#9f9cc9","#9e9bc8","#9e9ac8","#9d99c7","#9c98c7","#9b97c6","#9a96c6","#9995c6","#9894c5","#9793c5","#9692c4","#9591c4","#9490c3","#9390c3","#928fc3","#918ec2","#908dc2","#8f8cc1","#8e8bc1","#8e8ac0","#8d89c0","#8c88bf","#8b87bf","#8a86bf","#8986be","#8885be","#8784bd","#8683bd","#8582bc","#8481bc","#8380bb","#827fbb","#817ebb","#807dba","#807cba","#7f7bb9","#7e79b8","#7d78b7","#7d77b7","#7c75b6","#7b74b5","#7b72b4","#7a71b4","#7970b3","#796eb2","#786db2","#776cb1","#776ab0","#7669af","#7567af","#7566ae","#7465ad","#7363ad","#7262ac","#7261ab","#715faa","#705eaa","#705ca9","#6f5ba8","#6e5aa8","#6e58a7","#6d57a6","#6c55a5","#6c54a5","#6b53a4","#6a51a3","#6950a3","#694fa2","#684da1","#674ca1","#674ba0","#66499f","#65489f","#65479e","#64459e","#63449d","#63439c","#62429c","#61409b","#613f9a","#603e9a","#5f3c99","#5e3b98","#5e3a98","#5d3897","#5c3797","#5c3696","#5b3495","#5a3395","#5a3294","#593093","#582f93","#582e92","#572c92","#562b91","#552a90","#552890","#54278f","#53268f","#53258e","#52238d","#51228d","#51218c","#50208c","#4f1f8b","#4f1d8b","#4e1c8a","#4d1b89","#4d1a89","#4c1888","#4c1788","#4b1687","#4a1587","#4a1486","#491285","#481185","#481084","#470f84","#460d83","#460c83","#450b82","#440a82","#440981","#430780","#420680","#42057f","#41047f","#40027e","#40017e","#3f007d"]),Ba.blues=Ba.fromStringList(["#f7fbff","#f6faff","#f5fafe","#f5f9fe","#f4f9fe","#f3f8fe","#f2f8fd","#f2f7fd","#f1f7fd","#f0f6fd","#eff6fc","#eef5fc","#eef5fc","#edf4fc","#ecf4fb","#ebf3fb","#eaf3fb","#eaf2fb","#e9f2fa","#e8f1fa","#e7f1fa","#e7f0fa","#e6f0f9","#e5eff9","#e4eff9","#e3eef9","#e3eef8","#e2edf8","#e1edf8","#e0ecf8","#dfecf7","#dfebf7","#deebf7","#ddeaf7","#dceaf6","#dce9f6","#dbe9f6","#dae8f6","#d9e8f5","#d9e7f5","#d8e7f5","#d7e6f5","#d6e6f4","#d6e5f4","#d5e5f4","#d4e4f4","#d3e4f3","#d3e3f3","#d2e3f3","#d1e2f3","#d0e2f2","#d0e1f2","#cfe1f2","#cee0f2","#cde0f1","#cddff1","#ccdff1","#cbdef1","#cadef0","#caddf0","#c9ddf0","#c8dcf0","#c7dcef","#c7dbef","#c6dbef","#c4daee","#c3daee","#c2d9ee","#c1d9ed","#bfd8ed","#bed8ec","#bdd7ec","#bcd7eb","#bad6eb","#b9d6ea","#b8d5ea","#b7d4ea","#b5d4e9","#b4d3e9","#b3d3e8","#b2d2e8","#b0d2e7","#afd1e7","#aed1e7","#add0e6","#abd0e6","#aacfe5","#a9cfe5","#a8cee4","#a6cee4","#a5cde3","#a4cce3","#a3cce3","#a1cbe2","#a0cbe2","#9fcae1","#9dcae1","#9cc9e1","#9ac8e0","#99c7e0","#97c6df","#95c5df","#94c4df","#92c4de","#91c3de","#8fc2de","#8dc1dd","#8cc0dd","#8abfdd","#89bedc","#87bddc","#85bcdc","#84bcdb","#82bbdb","#81badb","#7fb9da","#7db8da","#7cb7da","#7ab6d9","#79b5d9","#77b5d9","#75b4d8","#74b3d8","#72b2d8","#71b1d7","#6fb0d7","#6dafd7","#6caed6","#6aaed6","#69add5","#68acd5","#66abd4","#65aad4","#64a9d3","#63a8d3","#61a7d2","#60a7d2","#5fa6d1","#5da5d1","#5ca4d0","#5ba3d0","#5aa2cf","#58a1cf","#57a0ce","#56a0ce","#549fcd","#539ecd","#529dcc","#519ccc","#4f9bcb","#4e9acb","#4d99ca","#4b98ca","#4a98c9","#4997c9","#4896c8","#4695c8","#4594c7","#4493c7","#4292c6","#4191c6","#4090c5","#3f8fc5","#3e8ec4","#3d8dc4","#3c8cc3","#3b8bc2","#3a8ac2","#3989c1","#3888c1","#3787c0","#3686c0","#3585bf","#3484bf","#3383be","#3282be","#3181bd","#3080bd","#2f7fbc","#2e7ebc","#2d7dbb","#2c7cba","#2b7bba","#2a7ab9","#2979b9","#2777b8","#2676b8","#2575b7","#2474b7","#2373b6","#2272b6","#2171b5","#2070b4","#206fb4","#1f6eb3","#1e6db2","#1d6cb1","#1c6bb0","#1c6ab0","#1b69af","#1a68ae","#1967ad","#1966ad","#1865ac","#1764ab","#1663aa","#1562a9","#1561a9","#1460a8","#135fa7","#125ea6","#125da6","#115ca5","#105ba4","#0f5aa3","#0e59a2","#0e58a2","#0d57a1","#0c56a0","#0b559f","#0a549e","#0a539e","#09529d","#08519c","#08509b","#084f99","#084e98","#084d96","#084c95","#084b93","#084a91","#084990","#08488e","#08478d","#08468b","#08458a","#084488","#084387","#084285","#084184","#084082","#083e81","#083d7f","#083c7d","#083b7c","#083a7a","#083979","#083877","#083776","#083674","#083573","#083471","#083370","#08326e","#08316d","#08306b"]),Ba.greens=Ba.fromStringList(["#f7fcf5","#f6fcf4","#f6fcf4","#f5fbf3","#f5fbf2","#f4fbf2","#f4fbf1","#f3faf0","#f2faf0","#f2faef","#f1faee","#f1faee","#f0f9ed","#f0f9ec","#eff9ec","#eff9eb","#eef8ea","#edf8ea","#edf8e9","#ecf8e8","#ecf8e8","#ebf7e7","#ebf7e7","#eaf7e6","#e9f7e5","#e9f7e5","#e8f6e4","#e8f6e3","#e7f6e3","#e7f6e2","#e6f5e1","#e5f5e1","#e5f5e0","#e4f5df","#e3f4de","#e2f4dd","#e1f3dc","#e0f3db","#dff3da","#def2d9","#ddf2d8","#dcf2d7","#dbf1d6","#dbf1d5","#daf0d4","#d9f0d3","#d8f0d2","#d7efd1","#d6efd0","#d5efcf","#d4eece","#d3eecd","#d2edcc","#d1edcb","#d0edca","#cfecc9","#ceecc8","#cdecc7","#ccebc6","#cbebc5","#cbeac4","#caeac3","#c9eac2","#c8e9c1","#c7e9c0","#c6e8bf","#c4e8bd","#c3e7bc","#c2e7bb","#c1e6ba","#c0e6b9","#bee5b8","#bde5b6","#bce4b5","#bbe4b4","#bae3b3","#b8e3b2","#b7e2b1","#b6e2af","#b5e1ae","#b4e1ad","#b2e0ac","#b1e0ab","#b0dfaa","#afdfa8","#aedea7","#acdea6","#abdda5","#aadda4","#a9dca3","#a8dca2","#a7dba0","#a5db9f","#a4da9e","#a3da9d","#a2d99c","#a0d99b","#9fd899","#9ed798","#9cd797","#9bd696","#99d595","#98d594","#97d492","#95d391","#94d390","#92d28f","#91d28e","#90d18d","#8ed08b","#8dd08a","#8bcf89","#8ace88","#88ce87","#87cd86","#86cc85","#84cc83","#83cb82","#81ca81","#80ca80","#7fc97f","#7dc87e","#7cc87c","#7ac77b","#79c67a","#78c679","#76c578","#75c477","#73c476","#72c375","#70c274","#6ec173","#6dc072","#6bc072","#6abf71","#68be70","#66bd6f","#65bd6f","#63bc6e","#62bb6d","#60ba6c","#5eb96b","#5db96b","#5bb86a","#5ab769","#58b668","#56b567","#55b567","#53b466","#52b365","#50b264","#4eb264","#4db163","#4bb062","#4aaf61","#48ae60","#46ae60","#45ad5f","#43ac5e","#42ab5d","#40aa5d","#3fa95c","#3fa85b","#3ea75a","#3da65a","#3ca559","#3ba458","#3aa357","#39a257","#38a156","#37a055","#369f54","#359e53","#349d53","#339c52","#329b51","#319a50","#309950","#2f984f","#2f974e","#2e964d","#2d954d","#2c944c","#2b934b","#2a924a","#29914a","#289049","#278f48","#268e47","#258d47","#248c46","#238b45","#228a44","#218944","#208843","#1f8742","#1e8741","#1d8640","#1c8540","#1a843f","#19833e","#18823d","#17813d","#16803c","#157f3b","#147e3a","#137d39","#127c39","#117b38","#107a37","#0e7936","#0d7836","#0c7735","#0b7734","#0a7633","#097532","#087432","#077331","#067230","#05712f","#03702e","#026f2e","#016e2d","#006d2c","#006c2c","#006b2b","#00692a","#00682a","#006729","#006529","#006428","#006328","#006227","#006027","#005f26","#005e26","#005c25","#005b25","#005a24","#005924","#005723","#005622","#005522","#005321","#005221","#005120","#005020","#004e1f","#004d1f","#004c1e","#004a1e","#00491d","#00481d","#00471c","#00451c","#00441b"]),Ba.oranges=Ba.fromStringList(["#fff5eb","#fff5ea","#fff4e9","#fff4e8","#fff3e7","#fff3e6","#fff2e6","#fff2e5","#fff1e4","#fff1e3","#fff0e2","#fff0e1","#ffefe0","#ffefdf","#ffeede","#ffeedd","#feeddc","#feeddc","#feeddb","#feecda","#feecd9","#feebd8","#feebd7","#feead6","#feead5","#fee9d4","#fee9d3","#fee8d2","#fee8d2","#fee7d1","#fee7d0","#fee6cf","#fee6ce","#fee5cc","#fee5cb","#fee4ca","#fee3c8","#fee2c7","#fee2c6","#fee1c4","#fee0c3","#fee0c1","#fedfc0","#fedebf","#fedebd","#feddbc","#fedcbb","#fedcb9","#fddbb8","#fddab6","#fdd9b5","#fdd9b4","#fdd8b2","#fdd7b1","#fdd7af","#fdd6ae","#fdd5ad","#fdd5ab","#fdd4aa","#fdd3a9","#fdd3a7","#fdd2a6","#fdd1a4","#fdd1a3","#fdd0a2","#fdcfa0","#fdce9e","#fdcd9c","#fdcb9b","#fdca99","#fdc997","#fdc895","#fdc794","#fdc692","#fdc590","#fdc48f","#fdc38d","#fdc28b","#fdc189","#fdc088","#fdbf86","#fdbe84","#fdbd83","#fdbb81","#fdba7f","#fdb97d","#fdb87c","#fdb77a","#fdb678","#fdb576","#fdb475","#fdb373","#fdb271","#fdb170","#fdb06e","#fdaf6c","#fdae6a","#fdad69","#fdac67","#fdab66","#fda965","#fda863","#fda762","#fda660","#fda55f","#fda45d","#fda35c","#fda25a","#fda159","#fda057","#fd9f56","#fd9e54","#fd9d53","#fd9c51","#fd9b50","#fd9a4e","#fd994d","#fd984b","#fd974a","#fd9649","#fd9547","#fd9446","#fd9344","#fd9243","#fd9141","#fd9040","#fd8f3e","#fd8e3d","#fd8c3b","#fc8b3a","#fc8a39","#fc8937","#fb8836","#fb8735","#fb8634","#fa8532","#fa8331","#f98230","#f9812e","#f9802d","#f87f2c","#f87e2b","#f87d29","#f77b28","#f77a27","#f67925","#f67824","#f67723","#f57622","#f57520","#f5741f","#f4721e","#f4711c","#f3701b","#f36f1a","#f36e19","#f26d17","#f26c16","#f26b15","#f16913","#f16813","#f06712","#ef6612","#ee6511","#ee6410","#ed6310","#ec620f","#eb610f","#eb600e","#ea5f0e","#e95e0d","#e85d0c","#e75c0c","#e75b0b","#e65a0b","#e5590a","#e4580a","#e45709","#e35608","#e25508","#e15407","#e15307","#e05206","#df5106","#de5005","#de4e05","#dd4d04","#dc4c03","#db4b03","#db4a02","#da4902","#d94801","#d84801","#d64701","#d54601","#d34601","#d14501","#d04501","#ce4401","#cd4401","#cb4302","#c94202","#c84202","#c64102","#c54102","#c34002","#c14002","#c03f02","#be3f02","#bd3e02","#bb3d02","#b93d02","#b83c02","#b63c02","#b53b02","#b33b02","#b13a03","#b03903","#ae3903","#ad3803","#ab3803","#a93703","#a83703","#a63603","#a53603","#a43503","#a23503","#a13403","#a03403","#9f3303","#9e3303","#9c3203","#9b3203","#9a3103","#993103","#973003","#963003","#952f03","#942f03","#932f03","#912e04","#902e04","#8f2d04","#8e2d04","#8c2c04","#8b2c04","#8a2b04","#892b04","#882a04","#862a04","#852904","#842904","#832804","#812804","#802704","#7f2704"]),Ba.reds=Ba.fromStringList(["#fff5f0","#fff4ef","#fff4ee","#fff3ed","#fff2ec","#fff2eb","#fff1ea","#fff0e9","#fff0e8","#ffefe8","#ffeee7","#ffeee6","#ffede5","#ffece4","#ffece3","#ffebe2","#feeae1","#feeae0","#fee9df","#fee8de","#fee8dd","#fee7dc","#fee7db","#fee6da","#fee5d9","#fee5d8","#fee4d8","#fee3d7","#fee3d6","#fee2d5","#fee1d4","#fee1d3","#fee0d2","#fedfd0","#fedecf","#fedccd","#fedbcc","#fedaca","#fed9c9","#fed8c7","#fdd7c6","#fdd5c4","#fdd4c2","#fdd3c1","#fdd2bf","#fdd1be","#fdd0bc","#fdcebb","#fdcdb9","#fdccb8","#fdcbb6","#fdcab5","#fdc9b3","#fdc7b2","#fdc6b0","#fdc5ae","#fcc4ad","#fcc3ab","#fcc2aa","#fcc1a8","#fcbfa7","#fcbea5","#fcbda4","#fcbca2","#fcbba1","#fcb99f","#fcb89e","#fcb79c","#fcb69b","#fcb499","#fcb398","#fcb296","#fcb095","#fcaf93","#fcae92","#fcad90","#fcab8f","#fcaa8d","#fca98c","#fca78b","#fca689","#fca588","#fca486","#fca285","#fca183","#fca082","#fc9e80","#fc9d7f","#fc9c7d","#fc9b7c","#fc997a","#fc9879","#fc9777","#fc9576","#fc9474","#fc9373","#fc9272","#fc9070","#fc8f6f","#fc8e6e","#fc8d6d","#fc8b6b","#fc8a6a","#fc8969","#fc8767","#fc8666","#fc8565","#fc8464","#fc8262","#fc8161","#fc8060","#fc7f5f","#fb7d5d","#fb7c5c","#fb7b5b","#fb7a5a","#fb7858","#fb7757","#fb7656","#fb7555","#fb7353","#fb7252","#fb7151","#fb7050","#fb6e4e","#fb6d4d","#fb6c4c","#fb6b4b","#fb694a","#fa6849","#fa6648","#fa6547","#f96346","#f96245","#f96044","#f85f43","#f85d42","#f75c41","#f75b40","#f7593f","#f6583e","#f6563d","#f6553c","#f5533b","#f5523a","#f4503a","#f44f39","#f44d38","#f34c37","#f34a36","#f34935","#f24734","#f24633","#f14432","#f14331","#f14130","#f0402f","#f03f2e","#f03d2d","#ef3c2c","#ee3a2c","#ed392b","#ec382b","#eb372a","#ea362a","#e93529","#e83429","#e63328","#e53228","#e43027","#e32f27","#e22e27","#e12d26","#e02c26","#de2b25","#dd2a25","#dc2924","#db2824","#da2723","#d92523","#d82422","#d72322","#d52221","#d42121","#d32020","#d21f20","#d11e1f","#d01d1f","#cf1c1f","#ce1a1e","#cc191e","#cb181d","#ca181d","#c9181d","#c8171c","#c7171c","#c5171c","#c4161c","#c3161b","#c2161b","#c1161b","#bf151b","#be151a","#bd151a","#bc141a","#bb141a","#b91419","#b81419","#b71319","#b61319","#b51318","#b31218","#b21218","#b11218","#b01217","#af1117","#ad1117","#ac1117","#ab1016","#aa1016","#a91016","#a81016","#a60f15","#a50f15","#a30f15","#a10e15","#9f0e14","#9d0d14","#9c0d14","#9a0c14","#980c13","#960b13","#940b13","#920a13","#900a12","#8e0912","#8c0912","#8a0812","#880811","#860811","#840711","#820711","#800610","#7e0610","#7c0510","#7a0510","#79040f","#77040f","#75030f","#73030f","#71020e","#6f020e","#6d010e","#6b010e","#69000d","#67000d"]),Ba.rdYlBu=Ba.fromStringList(["#a50026","#a70226","#a90426","#ab0626","#ad0826","#af0926","#b10b26","#b30d26","#b50f26","#b71126","#b91326","#bb1526","#bd1726","#be1827","#c01a27","#c21c27","#c41e27","#c62027","#c82227","#ca2427","#cc2627","#ce2827","#d02927","#d22b27","#d42d27","#d62f27","#d83128","#d93429","#da362a","#db382b","#dc3b2c","#dd3d2d","#de402e","#e0422f","#e14430","#e24731","#e34933","#e44c34","#e54e35","#e65036","#e75337","#e95538","#ea5739","#eb5a3a","#ec5c3b","#ed5f3c","#ee613e","#ef633f","#f16640","#f26841","#f36b42","#f46d43","#f47044","#f57245","#f57547","#f57748","#f67a49","#f67c4a","#f67f4b","#f7814c","#f7844e","#f8864f","#f88950","#f88c51","#f98e52","#f99153","#f99355","#fa9656","#fa9857","#fa9b58","#fb9d59","#fba05b","#fba35c","#fca55d","#fca85e","#fcaa5f","#fdad60","#fdaf62","#fdb164","#fdb366","#fdb567","#fdb769","#fdb96b","#fdbb6d","#fdbd6f","#fdbf71","#fdc173","#fdc374","#fdc576","#fdc778","#fec87a","#feca7c","#fecc7e","#fece7f","#fed081","#fed283","#fed485","#fed687","#fed889","#feda8a","#fedc8c","#fede8e","#fee090","#fee192","#fee294","#fee496","#fee597","#fee699","#fee79b","#fee99d","#feea9f","#feeba1","#feeca2","#feeda4","#feefa6","#fff0a8","#fff1aa","#fff2ac","#fff3ad","#fff5af","#fff6b1","#fff7b3","#fff8b5","#fffab7","#fffbb9","#fffcba","#fffdbc","#fffebe","#feffc0","#fdfec2","#fcfec5","#fbfdc7","#fafdc9","#f8fccb","#f7fcce","#f6fbd0","#f5fbd2","#f3fbd4","#f2fad6","#f1fad9","#f0f9db","#eff9dd","#edf8df","#ecf8e2","#ebf7e4","#eaf7e6","#e9f6e8","#e7f6eb","#e6f5ed","#e5f5ef","#e4f4f1","#e2f4f4","#e1f3f6","#e0f3f8","#def2f7","#dcf1f7","#daf0f6","#d8eff6","#d6eef5","#d4edf4","#d1ecf4","#cfebf3","#cdeaf3","#cbe9f2","#c9e8f2","#c7e7f1","#c5e6f0","#c3e5f0","#c1e4ef","#bfe3ef","#bde2ee","#bbe1ed","#b9e0ed","#b6dfec","#b4deec","#b2ddeb","#b0dcea","#aedbea","#acdae9","#aad8e9","#a8d6e8","#a6d5e7","#a3d3e6","#a1d1e5","#9fd0e4","#9dcee3","#9bcce2","#99cae1","#97c9e0","#94c7df","#92c5de","#90c3dd","#8ec2dc","#8cc0db","#8abeda","#87bdd9","#85bbd9","#83b9d8","#81b7d7","#7fb6d6","#7db4d5","#7ab2d4","#78b0d3","#76afd2","#74add1","#72abd0","#70a9cf","#6ea6ce","#6da4cc","#6ba2cb","#69a0ca","#679ec9","#659bc8","#6399c7","#6297c6","#6095c4","#5e93c3","#5c90c2","#5a8ec1","#588cc0","#578abf","#5588be","#5385bd","#5183bb","#4f81ba","#4d7fb9","#4b7db8","#4a7ab7","#4878b6","#4676b5","#4574b3","#4471b2","#436fb1","#426cb0","#416aaf","#4167ad","#4065ac","#3f62ab","#3e60aa","#3e5ea8","#3d5ba7","#3c59a6","#3b56a5","#3a54a4","#3a51a2","#394fa1","#384ca0","#374a9f","#36479e","#36459c","#35429b","#34409a","#333d99","#333b97","#323896","#313695"]);var Oa={get_copyright:function(){return this.copyright},set_copyright:function(t){return this.copyright=t,t},get_creditsUrl:function(){return this.creditsUrl},set_creditsUrl:function(t){return this.creditsUrl=t,t},get_validWcs:function(){return this._validWcs},set_validWcs:function(t){return this._validWcs=t,t},get_keywords:function(){return this.keywords.length||this.keywords.push("Image File"),this.keywords},set_keywords:function(t){return this.keywords=t,t},get_description:function(){return this.description},set_description:function(t){return this.description=t,t},get_scaleX:function(){return this.scaleX},set_scaleX:function(t){return this.scaleX=t,t},get_scaleY:function(){return this.scaleY},set_scaleY:function(t){return this.scaleY=t,t},get_centerX:function(){return this.centerX},set_centerX:function(t){return this.centerX=t,t},get_viewCenterX:function(){return this.centerX+(this.get_sizeX()/2-this.get_referenceX())*this.get_scaleX()},get_centerY:function(){return this.centerY},set_centerY:function(t){return this.centerY=t,t},get_viewCenterY:function(){return this.centerY+(this.get_sizeY()/2-this.get_referenceY())*this.get_scaleY()},get_rotation:function(){return this.rotation},set_rotation:function(t){return this.rotation=t,t},get_referenceX:function(){return this.referenceX},set_referenceX:function(t){return this.referenceX=t,t},get_referenceY:function(){return this.referenceY},set_referenceY:function(t){return this.referenceY=t,t},get_sizeX:function(){return this.sizeX},set_sizeX:function(t){return this.sizeX=t,t},get_sizeY:function(){return this.sizeY},set_sizeY:function(t){return this.sizeY=t,t},get_cd1_1:function(){return this.cd1_1},set_cd1_1:function(t){return this.cd1_1=t,t},get_cd1_2:function(){return this.cd1_2},set_cd1_2:function(t){return this.cd1_2=t,t},get_cd2_1:function(){return this.cd2_1},set_cd2_1:function(t){return this.cd2_1=t,t},get_cd2_2:function(){return this.cd2_2},set_cd2_2:function(t){return this.cd2_2=t,t},adjustScale:function(t,e){t!==this.sizeX&&(this.scaleX*=this.sizeX/t,this.referenceX/=this.sizeX/t,this.sizeX=t),e!==this.sizeY&&(this.scaleY*=this.sizeY/e,this.referenceY/=this.sizeY/e,this.sizeY=e)},calculateScaleFromCD:function(){this.scaleX=Math.sqrt(this.cd1_1*this.cd1_1+this.cd2_1*this.cd2_1)*(this.cd1_1*this.cd2_2-this.cd1_2*this.cd2_1)<0?-1:1,this.scaleY=Math.sqrt(this.cd1_2*this.cd1_2+this.cd2_2*this.cd2_2)},calculateRotationFromCD:function(){var t=this.cd1_1*this.cd2_2-this.cd1_2*this.cd2_1<0?-1:1,e=Math.atan2(-t*this.cd1_2,this.cd2_2);this.rotation=e/Math.PI*180},get_filename:function(){return this.filename},set_filename:function(t){return this.filename=t,t},get_colorCombine:function(){return this._colorCombine},set_colorCombine:function(t){return this._colorCombine=t,t},getBitmap:function(){return null}};function Ga(t,e,i,n){this.errored=!1,this.numAxis=0,this.histogramMaxCount=0,this.sourceBlob=null,this.header={},this.position=0,this.bufferSize=1,this._parseSuccessful$1=!1,Va.call(this),this.dataset=t,this.fitsProperties=t.get_fitsProperties(),this._callBack$1=n,this.filename=e,null!=i?this._readFromBlob$1(i):this.getFile(e)}n("WcsImage",[Va,Oa,null]),Ga.naN=NaN;var Xa={getFile:function(e){this._webFile$1=new $a(e),this._webFile$1.responseType="blob",this._webFile$1.onStateChange=t.ss.bind("fileStateChange",this),this._webFile$1.send()},fileStateChange:function(){if(2===this._webFile$1.get_state())this.errored=!0,null!=this._callBack$1&&this._callBack$1(this);else if(1===this._webFile$1.get_state()){var t=this._webFile$1.getBlob();this._readFromBlob$1(t)}},_readFromBlob$1:function(t){var e=this;this.sourceBlob=t;var i=new FileReader;i.onloadend=function(t){e.readFromBin(new DataView(i.result)),e.errored=!e._parseSuccessful$1,null!=e._callBack$1&&e._callBack$1(e)},i.readAsArrayBuffer(t)},_readByteString$1:function(t,e){for(var i="",n=0;n<e;n++)i+=String.fromCharCode(t.getUint8(this.position)),this.position++;return i},_validateFitsSimple$1:function(e){var i=this._readByteString$1(e,8),n=t.ss.trimEnd(i);return this.position-=8,"SIMPLE"===n.toUpperCase()},readFromBin:function(e){if(this._validateFitsSimple$1(e)){for(var i=!1;!i;)for(var n=0;n<36;n++){var r=this._readByteString$1(e,80);if(!i){var s=t.ss.trimEnd(r.substring(0,8)),a=r.substring(10).split("/");if("END"===s.toUpperCase()){for(i=!0,n++,r=this._readByteString$1(e,80);t.ss.whitespace(r);)n++,r=this._readByteString$1(e,80);"XTENSION"===(s=t.ss.trimEnd(r.substring(0,8))).toUpperCase()?i=!1:this.position-=80}else this._addKeyword$1(s,a)}}if(i){this.numAxis=parseInt(this.header.NAXIS),t.ss.keyExists(this.header,"BLANK")&&(this.fitsProperties.blankValue=parseFloat(this.header.BLANK),this.fitsProperties.containsBlanks=!0),t.ss.keyExists(this.header,"BZERO")&&(this.fitsProperties.bZero=parseFloat(this.header.BZERO)),t.ss.keyExists(this.header,"BSCALE")&&(this.fitsProperties.bScale=parseFloat(this.header.BSCALE)),this.axisSize=new Array(this.numAxis);for(var o=0;o<this.numAxis;o++)this.axisSize[o]=parseInt(this.header[t.ss.format("NAXIS{0}",o+1)]),this.bufferSize*=this.axisSize[o];var l=parseInt(this.header.BITPIX);this.readDataUnit(e,l),this.numAxis>1&&(this.sizeX=this.axisSize[0],this.sizeY=this.axisSize[1],this.histogram=this.computeHistogram(256),this.histogramMaxCount=this.histogram[256]),this.computeWcs(),this._parseSuccessful$1=!0}else console.log("Unable to parse requested FITS file.")}else console.log("The requested file is not a valid FITS file.")},_addKeyword$1:function(e,i){if("CONTINUE"!==e&&"COMMENT"!==e&&"HISTORY"!==e&&!t.ss.emptyString(e))try{t.ss.keyExists(this.header,e)?this.header[e]=t.ss.trim(i[0]):this.header[e.toUpperCase()]=t.ss.trim(i[0])}catch(t){}},readDataUnit:function(t,e){switch(this.dataUnit=new Float32Array(this.bufferSize),e){case-64:this.readDataUnitFloat64(t);break;case-32:this.readDataUnitFloat32(t);break;case 8:this.readDataUnitUint8(t);break;case 16:this.readDataUnitInt16(t);break;case 32:this.readDataUnitInt32(t);break;case 64:console.log("64 bit integer FITS are not yet supported")}},readDataUnitFloat64:function(t){for(var e=0;this.position<t.byteLength;){this.dataUnit[e]=t.getFloat64(this.position,!1);var i=this.dataUnit[e]*this.fitsProperties.bScale+this.fitsProperties.bZero;this.fitsProperties.minVal>i&&(this.fitsProperties.minVal=i),this.fitsProperties.maxVal<i&&(this.fitsProperties.maxVal=i),e++,this.position+=8}this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal},readDataUnitFloat32:function(t){for(var e=0;this.position<t.byteLength;){this.dataUnit[e]=t.getFloat32(this.position,!1);var i=this.dataUnit[e]*this.fitsProperties.bScale+this.fitsProperties.bZero;this.fitsProperties.minVal>i&&(this.fitsProperties.minVal=i),this.fitsProperties.maxVal<i&&(this.fitsProperties.maxVal=i),e++,this.position+=4}this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal},readDataUnitUint8:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getUint8(this.position),this.fitsProperties.minVal>this.dataUnit[e]&&(this.fitsProperties.minVal=this.dataUnit[e]),this.fitsProperties.maxVal<this.dataUnit[e]&&(this.fitsProperties.maxVal=this.dataUnit[e]),e++,this.position+=1;this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal},readDataUnitInt16:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getInt16(this.position,!1),this.fitsProperties.minVal>this.dataUnit[e]&&(this.fitsProperties.minVal=this.dataUnit[e]),this.fitsProperties.maxVal<this.dataUnit[e]&&(this.fitsProperties.maxVal=this.dataUnit[e]),e++,this.position+=2;this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal},readDataUnitInt32:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getInt32(this.position,!1),this.fitsProperties.minVal>this.dataUnit[e]&&(this.fitsProperties.minVal=this.dataUnit[e]),this.fitsProperties.maxVal<this.dataUnit[e]&&(this.fitsProperties.maxVal=this.dataUnit[e]),e++,this.position+=4;this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal},computeWcs:function(){t.ss.keyExists(this.header,"CROTA2")&&(this.rotation=parseFloat(t.ss.trim(this.header.CROTA2)),this.hasRotation=!0),t.ss.keyExists(this.header,"CDELT1")&&(this.scaleX=parseFloat(t.ss.trim(this.header.CDELT1)),t.ss.keyExists(this.header,"CDELT2")&&(this.scaleY=parseFloat(t.ss.trim(this.header.CDELT2)),this.hasScale=!0)),t.ss.keyExists(this.header,"CRPIX1")&&(this.referenceX=parseFloat(t.ss.trim(this.header.CRPIX1))-.5,t.ss.keyExists(this.header,"CRPIX2")&&(this.referenceY=parseFloat(t.ss.trim(this.header.CRPIX2))-.5,this.hasPixel=!0));var e=!1,i=!1;if(t.ss.keyExists(this.header,"CTYPE1")&&(this.header.CTYPE1.indexOf("GLON-")>-1&&(e=!0,i=!0),this.header.CTYPE2.indexOf("GLAT-")>-1&&(e=!0,i=!0),this.header.CTYPE1.indexOf("-TAN")>-1&&(i=!0),this.header.CTYPE1.indexOf("-SIN")>-1&&(i=!0)),!i)throw new Error("Only TAN projected images are supported: ");if(this.hasSize=!0,t.ss.keyExists(this.header,"CRVAL1")&&(this.centerX=parseFloat(t.ss.trim(this.header.CRVAL1)),t.ss.keyExists(this.header,"CRVAL2")&&(this.centerY=parseFloat(t.ss.trim(this.header.CRVAL2)),this.hasLocation=!0)),e){var n=Qs.galactictoJ2000(this.centerX,this.centerY);this.centerX=n[0],this.centerY=n[1]}t.ss.keyExists(this.header,"CD1_1")&&t.ss.keyExists(this.header,"CD1_2")&&t.ss.keyExists(this.header,"CD2_1")&&t.ss.keyExists(this.header,"CD2_2")&&(this.cd1_1=parseFloat(t.ss.trim(this.header.CD1_1)),this.cd1_2=parseFloat(t.ss.trim(this.header.CD1_2)),this.cd2_1=parseFloat(t.ss.trim(this.header.CD2_1)),this.cd2_2=parseFloat(t.ss.trim(this.header.CD2_2)),this.hasRotation||this.calculateRotationFromCD(),this.hasScale||this.calculateScaleFromCD(),this.hasScale=!0,this.hasRotation=!0),this.set_validWcs(this.hasScale&&this.hasRotation&&this.hasPixel&&this.hasLocation)},applyDisplaySettings:function(){t.ss.keyExists(this.header,"DATAMIN")&&(this.fitsProperties.lowerCut=parseFloat(t.ss.trim(this.header.DATAMIN)),this.fitsProperties.minVal=this.fitsProperties.lowerCut),t.ss.keyExists(this.header,"DATAMAX")&&(this.fitsProperties.upperCut=parseFloat(t.ss.trim(this.header.DATAMAX)),this.fitsProperties.maxVal=this.fitsProperties.upperCut),t.ss.keyExists(this.header,"PXCUTMIN")&&(this.fitsProperties.lowerCut=parseFloat(t.ss.trim(this.header.PXCUTMIN))),t.ss.keyExists(this.header,"PXCUTMAX")&&(this.fitsProperties.upperCut=parseFloat(t.ss.trim(this.header.PXCUTMAX)))},computeHistogram:function(e){for(var i=new Array(e+1),n=0;n<e+1;n++)i[n]=0;this.populateHistogram(i);for(var r=1,s=t.ss.enumerate(i);s.moveNext();){var a=s.current;a>r&&(r=a)}return i[e]=r,i},populateHistogram:function(e){for(var i=e.length,n=(this.fitsProperties.maxVal-this.fitsProperties.minVal)/i,r=0;r<this.dataUnit.length;r++)this.dataUnit[r]!==Ga.naN&&e[Math.min(i-1,t.ss.truncate((this.fitsProperties.bZero+this.fitsProperties.bScale*this.dataUnit[r]-this.fitsProperties.minVal)/n))]++},drawHistogram:function(t){t.clearRect(0,0,255,150),t.beginPath(),t.strokeStyle="rgba(255,255,255,255)";for(var e=Math.log(this.histogramMaxCount),i=0;i<this.histogram.length;i++){var n=Math.log(this.histogram[i])/e;n<0&&(n=0),t.moveTo(i,150),t.lineTo(i,150-150*n),t.stroke()}}};n("FitsImage",[Ga,Xa,Va]);var Ha={byteT:0,int16T:1,int32T:2,floatT:3,doubleT:4,none:5};function Ya(){}function ja(t,e){this._min$1=0,this._max$1=0,this._factor$1=0,this._logFactor$1=0,Ya.call(this),this._min$1=t,this._max$1=e,this._factor$1=e-t}function Wa(t,e){this._min$1=0,this._max$1=0,this._factor$1=0,this._logFactor$1=0,Ya.call(this),this._min$1=t,this._max$1=e,this._factor$1=e-t,this._logFactor$1=255/Math.log(255)}function qa(t,e){this._min$1=0,this._max$1=0,this._factor$1=0,this._powFactor$1=0,Ya.call(this),this._min$1=t,this._max$1=e,this._factor$1=e-t,this._powFactor$1=255/Math.pow(255,2)}function Za(t,e){this._min$1=0,this._max$1=0,this._factor$1=0,this._sqrtFactor$1=0,Ya.call(this),this._min$1=t,this._max$1=e,this._factor$1=e-t,this._sqrtFactor$1=255/Math.sqrt(255)}function Ka(e,i,n){this._min$1=0,this._max$1=0,this._factor$1=0,this._maxHistogramValue$1=1,Ya.call(this),this._min$1=i,this._max$1=n,this._factor$1=n-i,this._histogram$1=e.computeHistogram(1e4),this._maxHistogramValue$1=this._histogram$1[1e4],this._lookup$1=new Array(1e4);for(var r=t.ss.truncate(e.get_sizeX()*e.get_sizeY()),s=0,a=0;a<1e4;a++)s+=this._histogram$1[a],this._lookup$1[a]=Math.min(255,255*s/r)+.5}function Ja(t,e,i,n){this.dataType=Ha.none,this._color$2=!1,this.isTiledFits=!1,Ga.call(this,t,e,i,n)}n("DataTypes",Ha),r("DataTypes",Ha),n("ScaleMap",[Ya,{},null]),n("ScaleLinear",[ja,{map:function(e){return Math.min(255,Math.max(0,t.ss.truncate((e-this._min$1)/this._factor$1*255)))}},Ya]),n("ScaleLog",[Wa,{map:function(e){return Math.min(255,Math.max(0,t.ss.truncate(Math.log((e-this._min$1)/this._factor$1*255)*this._logFactor$1)))}},Ya]),n("ScalePow",[qa,{map:function(e){return Math.min(255,Math.max(0,t.ss.truncate(Math.pow((e-this._min$1)/this._factor$1*255,2)*this._powFactor$1)))}},Ya]),n("ScaleSqrt",[Za,{map:function(e){return Math.min(255,Math.max(0,t.ss.truncate(Math.sqrt((e-this._min$1)/this._factor$1*255)*this._sqrtFactor$1)))}},Ya]),n("HistogramEqualization",[Ka,{map:function(e){return this._lookup$1[Math.min(9999,Math.max(0,t.ss.truncate((e-this._min$1)/this._factor$1*9999)))]}},Ya]),Ja.createTiledFits=function(t,e,i){var n=new Ja(t,e,null,i);return n.isTiledFits=!0,n};var Qa={readFromBin:function(t){Ga.prototype.readFromBin.call(this,t),3===this.numAxis&&3===this.axisSize[2]&&(this._color$2=!0)},readDataUnit:function(t,e){var i=new js(new Uint8Array(t.buffer));switch(i.position=this.position,e){case-64:this.dataType=Ha.doubleT,this._readDataUnitFloat64$2(i);break;case-32:this.dataType=Ha.floatT,this._readDataUnitFloat32$2(i);break;case 8:this.dataType=Ha.byteT,this._readDataUnitUint8$2(i);break;case 16:this.dataType=Ha.int16T,this._readDataUnitInt16$2(i);break;case 32:this.dataType=Ha.int32T,this._readDataUnitInt32$2(i)}this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal},_readDataUnitUint8$2:function(t){var e=new Array(this.bufferSize);this._dataBuffer$2=e;for(var i=0;i<this.bufferSize;i++)e[i]=t.readByte(),this.fitsProperties.minVal>e[i]&&(this.fitsProperties.minVal=e[i]),this.fitsProperties.maxVal<e[i]&&(this.fitsProperties.maxVal=e[i])},_readDataUnitInt16$2:function(t){var e=new Array(this.bufferSize);this._dataBuffer$2=e;for(var i=0;i<this.bufferSize;i++)e[i]=256*t.readSByte()+t.readByte(),this.fitsProperties.minVal>e[i]&&(this.fitsProperties.minVal=e[i]),this.fitsProperties.maxVal<e[i]&&(this.fitsProperties.maxVal=e[i])},_readDataUnitInt32$2:function(t){var e=new Array(this.bufferSize);this._dataBuffer$2=e;for(var i=0;i<this.bufferSize;i++)e[i]=(t.readSByte()<<24)+(t.readSByte()<<16)+(t.readSByte()<<8)+t.readByte(),this.fitsProperties.minVal>e[i]&&(this.fitsProperties.minVal=e[i]),this.fitsProperties.maxVal<e[i]&&(this.fitsProperties.maxVal=e[i])},_readDataUnitFloat32$2:function(t){var e=new Array(this.bufferSize);this._dataBuffer$2=e;for(var i=new Uint8Array(4),n=0;n<this.bufferSize;n++)i[3]=t.readByte(),i[2]=t.readByte(),i[1]=t.readByte(),i[0]=t.readByte(),e[n]=new Float32Array(i.buffer,0,1)[0],this.fitsProperties.minVal>e[n]&&(this.fitsProperties.minVal=e[n]),this.fitsProperties.maxVal<e[n]&&(this.fitsProperties.maxVal=e[n])},_readDataUnitFloat64$2:function(t){var e=new Array(this.bufferSize),i=new Uint8Array(8);this._dataBuffer$2=e;for(var n=0;n<this.bufferSize;n++)i[7]=t.readByte(),i[6]=t.readByte(),i[5]=t.readByte(),i[4]=t.readByte(),i[3]=t.readByte(),i[2]=t.readByte(),i[1]=t.readByte(),i[0]=t.readByte(),e[n]=new Float64Array(i.buffer,0,1)[0],this.fitsProperties.minVal>e[n]&&(this.fitsProperties.minVal=e[n]),this.fitsProperties.maxVal<e[n]&&(this.fitsProperties.maxVal=e[n])},getBitmap:function(){return this.fitsProperties.upperCut||this.fitsProperties.lowerCut||(this.fitsProperties.lowerCut=this.fitsProperties.minVal,this.fitsProperties.upperCut=this.fitsProperties.maxVal),this.getScaledBitmap(this.fitsProperties.lowerCut,this.fitsProperties.upperCut,this.fitsProperties.scaleType,0,this.fitsProperties.colorMapName)},getScaledBitmap:function(t,e,i,n,r){var s;this.fitsProperties.scaleType=i,this.fitsProperties.lowerCut=t,this.fitsProperties.upperCut=e,this.fitsProperties.colorMapName=r;var a=Ba.fromNamedColormap(r);switch(i){case 0:default:s=new ja(t,e);break;case 1:s=new Wa(t,e);break;case 2:s=new qa(t,e);break;case 3:s=new Za(t,e);break;case 4:s=new Ka(this,t,e)}try{switch(this.dataType){case Ha.byteT:return this._getBitmapByte$2(t,e,s,0,a);case Ha.int16T:return this.getBitmapShort(t,e,s,0,a);case Ha.int32T:return this._getBitmapInt$2(t,e,s,0,a);case Ha.floatT:return this._getBitmapFloat$2(t,e,s,0,a);case Ha.doubleT:return this._getBitmapDouble$2(t,e,s,0,a);case Ha.none:default:return Os.create(100,100)}}catch(t){return Os.create(10,10)}},_setPixelWithColorMap$2:function(e,i,n,r,s){if(null!=s){var a=r/255;if(Number.isNaN(a))e.setPixel(i,n,0,0,0,0);else{var o=s.findClosestColor(a);e.setPixel(i,n,t.ss.truncate(o.r),t.ss.truncate(o.g),t.ss.truncate(o.b),this.fitsProperties.transparentBlack&&!r?0:255)}}else e.setPixel(i,n,r,r,r,this.fitsProperties.transparentBlack&&!r?0:255)},_getBitmapByte$2:function(t,e,i,n,r){for(var s=this._dataBuffer$2,a=this.axisSize[0],o=this.axisSize[0]*this.axisSize[1]*n,l=Os.create(this.axisSize[0],this.axisSize[1]),h=0;h<this.axisSize[1];h++)for(var u=this.axisSize[1]-1-h,c=0;c<this.axisSize[0];c++)if(this._color$2){var _=s[c+u*a],d=s[c+u*a+o],g=s[c+u*a+2*o];if(this.fitsProperties.containsBlanks&&_===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var f=i.map(_),m=i.map(d),p=i.map(g);l.setPixel(c,h,f,m,p,255)}}else{var w=s[c+u*a+o];if(this.fitsProperties.containsBlanks&&w===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var b=i.map(w);this._setPixelWithColorMap$2(l,c,h,b,r)}}return l},_getBitmapDouble$2:function(t,e,i,n,r){for(var s=this._dataBuffer$2,a=this.axisSize[0],o=this.axisSize[0]*this.axisSize[1]*n,l=Os.create(this.axisSize[0],this.axisSize[1]),h=0;h<this.axisSize[1];h++)for(var u=this.axisSize[1]-1-h,c=0;c<this.axisSize[0];c++)if(this._color$2){var _=s[c+u*a],d=s[c+u*a+o],g=s[c+u*a+2*o];if(this.fitsProperties.containsBlanks&&_===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var f=i.map(_),m=i.map(d),p=i.map(g);l.setPixel(c,h,f,m,p,255)}}else{var w=s[c+u*a+o];if(this.fitsProperties.containsBlanks&&w===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var b=i.map(w);this._setPixelWithColorMap$2(l,c,h,b,r)}}return l},_getBitmapFloat$2:function(t,e,i,n,r){for(var s=this._dataBuffer$2,a=this.axisSize[0],o=this.axisSize[0]*this.axisSize[1]*n,l=Os.create(this.axisSize[0],this.axisSize[1]),h=0;h<this.axisSize[1];h++)for(var u=this.axisSize[1]-1-h,c=0;c<this.axisSize[0];c++)if(this._color$2){var _=s[c+u*a],d=s[c+u*a+o],g=s[c+u*a+2*o];if(this.fitsProperties.containsBlanks&&_===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var f=i.map(_),m=i.map(d),p=i.map(g);l.setPixel(c,h,f,m,p,255)}}else{var w=s[c+u*a+o];if(this.fitsProperties.containsBlanks&&w===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var b=i.map(w);this._setPixelWithColorMap$2(l,c,h,b,r)}}return l},_getBitmapInt$2:function(t,e,i,n,r){for(var s=this._dataBuffer$2,a=this.axisSize[0],o=this.axisSize[0]*this.axisSize[1]*n,l=Os.create(this.axisSize[0],this.axisSize[1]),h=0;h<this.axisSize[1];h++)for(var u=this.axisSize[1]-1-h,c=0;c<this.axisSize[0];c++)if(this._color$2){var _=s[c+u*a],d=s[c+u*a+o],g=s[c+u*a+2*o];if(this.fitsProperties.containsBlanks&&_===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var f=i.map(_),m=i.map(d),p=i.map(g);l.setPixel(c,h,f,m,p,255)}}else{var w=s[c+u*a+o];if(this.fitsProperties.containsBlanks&&w===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var b=i.map(w);this._setPixelWithColorMap$2(l,c,h,b,r)}}return l},getBitmapShort:function(t,e,i,n,r){for(var s=this._dataBuffer$2,a=this.axisSize[0],o=this.axisSize[0]*this.axisSize[1]*n,l=Os.create(this.axisSize[0],this.axisSize[1]),h=0;h<this.axisSize[1];h++)for(var u=this.axisSize[1]-1-h,c=0;c<this.axisSize[0];c++)if(this._color$2){var _=s[c+u*a],d=s[c+u*a+o],g=s[c+u*a+2*o];if(this.fitsProperties.containsBlanks&&_===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var f=i.map(_),m=i.map(d),p=i.map(g);l.setPixel(c,h,f,m,p,255)}}else{var w=s[c+u*a+o];if(this.fitsProperties.containsBlanks&&w===this.fitsProperties.blankValue)l.setPixel(c,h,0,0,0,0);else{var b=i.map(w);this._setPixelWithColorMap$2(l,c,h,b,r)}}return l},computeWcs:function(){this.isTiledFits||Ga.prototype.computeWcs.call(this)},populateHistogram:function(t){switch(this.dataType){case Ha.byteT:this._populateHistogramByte$2(t);break;case Ha.int16T:this._populateHistogramInt16$2(t);break;case Ha.int32T:this._populateHistogramInt32$2(t);break;case Ha.floatT:this._populateHistogramFloat$2(t);break;case Ha.doubleT:this._populateHistogramDouble$2(t)}},_populateHistogramDouble$2:function(e){for(var i=e.length,n=this._dataBuffer$2,r=(this.fitsProperties.maxVal-this.fitsProperties.minVal)/i,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;Number.isNaN(a)||e[Math.min(i-1,t.ss.truncate((a-this.fitsProperties.minVal)/r))]++}},_populateHistogramFloat$2:function(e){for(var i=e.length,n=this._dataBuffer$2,r=(this.fitsProperties.maxVal-this.fitsProperties.minVal)/i,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;a!==Ga.naN&&e[Math.min(i-1,t.ss.truncate((a-this.fitsProperties.minVal)/r))]++}},_populateHistogramInt32$2:function(e){for(var i=e.length,n=this._dataBuffer$2,r=(this.fitsProperties.maxVal-this.fitsProperties.minVal)/i,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;e[Math.min(i-1,t.ss.truncate((a-this.fitsProperties.minVal)/r))]++}},_populateHistogramInt16$2:function(e){for(var i=e.length,n=this._dataBuffer$2,r=(this.fitsProperties.maxVal-this.fitsProperties.minVal)/i,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;e[Math.min(i-1,t.ss.truncate((a-this.fitsProperties.minVal)/r))]++}},_populateHistogramByte$2:function(e){for(var i=e.length,n=this._dataBuffer$2,r=(this.fitsProperties.maxVal-this.fitsProperties.minVal)/i,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;e[Math.min(i-1,t.ss.truncate((a-this.fitsProperties.minVal)/r))]++}}};function to(t,e,i){Ga.call(this,t,e,null,i)}function eo(){this._renderTriangleLists=new Array(4),this._indexBuffers=new Array(4),this.level=0,this.tileX=0,this.tileY=0,this.texture=null,this.texture2d=null,this.isCatalogTile=!1,this.readyToRender=!1,this.inViewFrustum=!0,this.globalCenter=wn.zero,this.children=[null,null,null,null],this.parent=null,this.localCenter=new wn,this.renderedAtOrBelowGeneration=0,this._demScaleFactor=6371e3,this.demIndex=0,this.demAverage=0,this.demReady=!1,this.texReady=!1,this.demTile=!1,this.demDownloading=!1,this.renderedGeneration=0,this.accomidation=0,this.accessCount=0,this.downloading=!1,this.geometryCreated=!1,this._isHdTile=!1,this.demSize=1089,this._topLeftScreen=new wn,this._bottomRightScreen=new wn,this._topRightScreen=new wn,this._bottomLeftScreen=new wn,this.sphereRadius=0,this.sphereCenter=new wn,this.radius=1,this.triangleCount=0,this.requestHits=0,this.requestPending=!1,this.errored=!1,this._key=null,this._tileId=null,this._vertexCount=0,this.renderChildPart=null,this.renderChildPart=new Array(4);for(var t=0;t<4;t++)this.renderChildPart[t]=xr.create(!1,500)}n("FitsImageJs",[Ja,Qa,Ga]),n("FitsImageTile",[to,{readDataUnitFloat64:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getFloat64(this.position,!1),e++,this.position+=8},readDataUnitFloat32:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getFloat32(this.position,!1),e++,this.position+=4},readDataUnitUint8:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getUint8(this.position),e++,this.position+=1},readDataUnitInt16:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getInt16(this.position,!1),e++,this.position+=2},readDataUnitInt32:function(t){for(var e=0;this.position<t.byteLength;)this.dataUnit[e]=t.getInt32(this.position,!1),e++,this.position+=4},computeWcs:function(){}},Ga]),eo.currentRenderGeneration=0,eo.tileTargetX=-1,eo.tileTargetY=-1,eo.tileTargetLevel=-1,eo.tilesInView=0,eo.trianglesRendered=0,eo.tilesTouched=0,eo.frustumList=null,Wi(1),eo.callCount=0,eo.useAccomidation=!0,Zi(!0),eo.maxLevel=20,eo.meshComplexity=50,eo.imageQuality=50,eo.lastDeepestLevel=0,eo.deepestLevel=0,eo.RC=3.1415927/180,eo.getFrustumList=function(){try{return eo.frustumList}catch(t){return null}},eo.get_subDivisions=function(){return 32};var io={getIndexBuffer:function(t,e){return this._indexBuffers[t]},isPointInTile:function(t,e){return!1},getSurfacePointAltitude:function(t,e,i){return 0},makeTexture:function(){if(null!=Hi)try{if(this.texture2d=Hi.createTexture(),Hi.bindTexture(Yr.TEXTURE_2D,this.texture2d),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_S,Yr.CLAMP_TO_EDGE),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_T,Yr.CLAMP_TO_EDGE),this.dataset.get_extension().toLowerCase().indexOf("fits")>-1&&Ji)Hi.texImage2D(Yr.TEXTURE_2D,0,Yr.R32F,t.ss.truncate(this.fitsImage.get_sizeX()),t.ss.truncate(this.fitsImage.get_sizeY()),0,Yr.RED,Yr.FLOAT,this.fitsImage.dataUnit),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MIN_FILTER,Yr.NEAREST),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MAG_FILTER,Yr.NEAREST);else{var e=this.texture;if(1==(!rs.isPowerOfTwo(this.texture.height)|!rs.isPowerOfTwo(this.texture.width))){var i=document.createElement("canvas");i.height=rs.fitPowerOfTwo(e.height),i.width=rs.fitPowerOfTwo(e.width),i.getContext("2d").drawImage(e,0,0,i.width,i.height),e=i}Hi.texImage2D(Yr.TEXTURE_2D,0,Yr.RGBA,Yr.RGBA,Yr.UNSIGNED_BYTE,e),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MIN_FILTER,Yr.LINEAR_MIPMAP_NEAREST),Hi.generateMipmap(Yr.TEXTURE_2D)}Hi.bindTexture(Yr.TEXTURE_2D,null)}catch(t){this.errored=!0}},addVertex:function(t,e,i){return t[e++]=i.position.x,t[e++]=i.position.y,t[e++]=i.position.z,t[e++]=i.tu,t[e++]=i.tv,e},geoTo3dWithAlt:function(t,e,i,n){if(t=Math.max(Math.min(90,t),-90),e=Math.max(Math.min(180,e),-180),!qi||null==this.demData)return this.geoTo3d(t,e,i);n&&(e-=180);var r=this.demData[this.demIndex];return this.geoTo3dWithAltitude(t,e,r,i)},geoTo3dWithAltitude:function(t,e,i,n){var r=1+i/this.get__demScaleFactor(),s=wn.create(Math.cos(e*eo.RC)*Math.cos(t*eo.RC)*r,Math.sin(t*eo.RC)*r,Math.sin(e*eo.RC)*Math.cos(t*eo.RC)*r);return n&&s.subtract(this.localCenter),s},get__demScaleFactor:function(){return this._demScaleFactor},set__demScaleFactor:function(t){return this._demScaleFactor=t,t},requestImage:function(){var t=this;if(this.dataset.get_extension().toLowerCase().indexOf("fits")>-1)this.downloading||this.readyToRender||(this.downloading=!0,this.fitsImage=Ji?new to(this.dataset,this.get_URL(),(function(e){t.downloading=!1,t.errored=t.fitsImage.errored,en(t.get_key(),!0),t.fitsImage.errored||(t.level||(t.dataset.get_fitsProperties()._fireMainImageLoaded(t.fitsImage),t.fitsImage.applyDisplaySettings()),t.texReady=!0,t.readyToRender=t.texReady&&(t.demReady||!t.demTile),t.requestPending=!1,t.makeTexture())})):Ja.createTiledFits(this.dataset,this.get_URL(),(function(e){t.level||t.dataset.get_fitsProperties()._fireMainImageLoaded(t.fitsImage),t.texReady=!0,t.downloading=!1,t.errored=t.fitsImage.errored,t.readyToRender=t.texReady&&(t.demReady||!t.demTile),t.requestPending=!1,en(t.get_key(),!0),t.texture2d=e.getBitmap().getTexture()})));else{if(null!=this.get_dataset().get_wcsImage())return this.texReady=!0,this.downloading=!1,this.errored=!1,this.readyToRender=!0,this.requestPending=!1,void en(this.get_key(),!0);if(!this.downloading&&!this.readyToRender){this.downloading=!0,this.texture=document.createElement("img");var e=this.texture;this.texture.addEventListener("load",(function(e){t.texReady=!0,t.downloading=!1,t.errored=!1,t.readyToRender=t.texReady&&(t.demReady||!t.demTile),t.requestPending=!1,en(t.get_key(),!0),t.makeTexture()}),!1),this.texture.addEventListener("error",(function(e){if(!t.texture.hasAttribute("proxyattempt")){t.texture.setAttribute("proxyattempt",!0);var i=zr.singleton.activateProxy(t.texture.src);if(null!=i)return void(t.texture.src=i)}t.downloading=!1,t.readyToRender=!1,t.errored=!0,t.requestPending=!1,en(t.get_key(),!0)}),!1),e.crossOrigin="anonymous",this.texture.src=this.get_URL()}}},createDemFromParent:function(){return!1},_loadDemData:function(){if(null==this.demFile)return this.createDemFromParent();if(this.demData=this.demFile,1089!==this.demFile.length&&513!==this.demFile.length)return this.createDemFromParent();for(var e=t.ss.enumerate(this.demData);e.moveNext();)e.current;return this.demAverage/=this.demData.length,!0},requestDem:function(){var t=this;if(!this.readyToRender&&!this.demDownloading){this.demTile=!0,this.demDownloading=!0,eo.callCount++;var e=new XMLHttpRequest;e.addEventListener("load",(function(i){t.demReady=!0,t.demDownloading=!1,t.readyToRender=t.texReady&&(t.demReady||!t.demTile),t.requestPending=!1;try{t.demFile=new Float32Array(e.response)}catch(t){}en(t.get_key(),!0)}),!1),e.addEventListener("error",(function(e){t.demDownloading=!1,t.demReady=!1,t.readyToRender=!1,t.errored=!0,t.requestPending=!1,en(t.get_key(),!0)}),!1),e.open("GET",this.get_demURL(),!0),e.responseType="arraybuffer",e.send()}},draw3D:function(t,e){if(this.renderedGeneration=eo.currentRenderGeneration,eo.tilesTouched++,this.accessCount=nn++,this.errored)return!1;if(this.inViewFrustum=!0,!this.readyToRender)return tn(this),!1;var i=0,n=0;(this.dataset.get_mercator()||this.dataset.get_bottomsUp())&&(n=1);for(var r=!1,s=!1,a=0;a<2;a++)for(var o=0;o<2;o++)this.level<this.dataset.get_levels()?(null==this.children[i]&&(this.children[i]=rn(this.level+1,2*this.tileX+(o+0)%2,2*this.tileY+(a+n)%2,this.dataset,this)),this.children[i].isTileInFrustum(t.get_frustum())?(this.inViewFrustum=!0,this.children[i].isTileBigEnough(t)?(this.renderChildPart[i].set_targetState(!this.children[i].draw3D(t,e)),this.renderChildPart[i].get_targetState()&&(s=!0)):this.renderChildPart[i].set_targetState(!0)):this.renderChildPart[i].set_targetState(this.renderChildPart[i].set_state(!1)),this.renderChildPart[i].get_targetState(),this.renderChildPart[i].get_state()):this.renderChildPart[i].set_state(!0),this.renderChildPart[i].get_state()&&(r=!0),i++;if((s||r)&&(this.renderedAtOrBelowGeneration=eo.currentRenderGeneration,null!=this.parent&&(this.parent.renderedAtOrBelowGeneration=this.renderedAtOrBelowGeneration)),!r)return!0;if(!this.createGeometry(t))return!1;eo.tilesInView++,this.accomidation=this._computeAccomidation();for(var l=0;l<4;l++)this.renderChildPart[l].get_targetState()&&this.renderPart(t,l,e/100,!1);return!0},_computeAccomidation:function(){var t=0;if(!eo.useAccomidation)return 0;var e=sn(this.level,this.tileX,this.tileY+1,this.dataset,this);(null==e||e.renderedAtOrBelowGeneration<eo.currentRenderGeneration-2)&&(t+=1);var i=sn(this.level,this.tileX+1,this.tileY,this.dataset,this);(null==i||i.renderedAtOrBelowGeneration<eo.currentRenderGeneration-2)&&(t+=2);var n=sn(this.level,this.tileX,this.tileY-1,this.dataset,this);(null==n||n.renderedAtOrBelowGeneration<eo.currentRenderGeneration-2)&&(t+=4);var r=sn(this.level,this.tileX-1,this.tileY,this.dataset,this);return(null==r||r.renderedAtOrBelowGeneration<eo.currentRenderGeneration-2)&&(t+=8),t},renderPart:function(e,i,n,r){if(null==Hi)for(var s=e.lighting&&null!=e.get_sunPosition(),a=t.ss.enumerate(this._renderTriangleLists[i]);a.moveNext();){var o=a.current;if(o.opacity=n,s){var l=o.normal.copy();e.get_world().multiplyVector(l),l.normalize();var h=wn.dot(l,e.get_sunPosition());h=h<0?0:Math.min(1,1*h),o.lighting=h}else o.lighting=1;o.draw(e.device,e.WVP)}else Ji&&null!=this.fitsImage?(Ba.bindColorMapTexture(Hi,this.dataset.get_fitsProperties().colorMapName),ws.min=this.dataset.get_fitsProperties().lowerCut,ws.max=this.dataset.get_fitsProperties().upperCut,ws.containsBlanks=this.dataset.get_fitsProperties().containsBlanks,ws.blankValue=this.dataset.get_fitsProperties().blankValue,ws.bZero=this.dataset.get_fitsProperties().bZero,ws.bScale=this.dataset.get_fitsProperties().bScale,ws.scaleType=this.dataset.get_fitsProperties().scaleType,ws.transparentBlack=this.dataset.get_fitsProperties().transparentBlack,ws.use(e,this._vertexBuffer,this.getIndexBuffer(i,this.accomidation),this.texture2d,n,!1,this.globalCenter)):ps.use(e,this._vertexBuffer,this.getIndexBuffer(i,this.accomidation),this.texture2d,n,!1,this.globalCenter),e.gl.drawElements(Yr.TRIANGLES,3*this.triangleCount,Yr.UNSIGNED_SHORT,0)},cleanUp:function(e){if(this.readyToRender=!1,this.demData=null,this.demFile=null,this.demDownloading=!1,this.texReady=!1,this.demReady=!1,this.errored=!1,null!=this.texture&&(this.texture=null),this._renderTriangleLists=new Array(4),this.geometryCreated=!1,e&&null!=this.parent&&(this.parent.removeChild(this),this.parent=null),null!=Hi){for(var i=t.ss.enumerate(this._indexBuffers);i.moveNext();){var n=i.current;Hi.deleteBuffer(n)}this._indexBuffers=new Array(4),null!=this._vertexBuffer&&(Hi.deleteBuffer(this._vertexBuffer),this._vertexBuffer=null),null!=this.texture2d&&(Hi.deleteTexture(this.texture2d),this.texture2d=null)}},removeChild:function(t){for(var e=0;e<4;e++)if(this.children[e]===t)return void(this.children[e]=null)},createGeometry:function(t){return!(qi&&this.demReady&&null==this.demData&&!this._loadDemData()||qi&&null==this.demData||(this.readyToRender=!0,0))},calcSphere:function(){var t=new Array(4);t[0]=this.topLeft,t[1]=this.bottomRight,t[2]=this.topRight,t[3]=this.bottomLeft;var e=Rn.findEnclosingSphere(t);this.sphereCenter=e.center,this.sphereRadius=e.radius},isTileBigEnough:function(t){if(this.level>1){var e=t.WVP;e._transformTo(this.topLeft,this._topLeftScreen),e._transformTo(this.bottomRight,this._bottomRightScreen),e._transformTo(this.topRight,this._topRightScreen),e._transformTo(this.bottomLeft,this._bottomLeftScreen);var i=this._topLeftScreen;i.subtract(this._topRightScreen);var n=i.length(),r=this._bottomLeftScreen;r.subtract(this._bottomRightScreen);var s=r.length(),a=this._bottomLeftScreen;a.subtract(this._topLeftScreen);var o=a.length(),l=this._bottomRightScreen;l.subtract(this._topRightScreen);var h=l.length();if(Math.max(Math.max(h,o),Math.max(s,n))<300)return!1;eo.deepestLevel=this.level>eo.deepestLevel?this.level:eo.deepestLevel}return!0},isTileInFrustum:function(t){this.level<2&&(!this.dataset.get_projection()||this.dataset.get_projection()),this.inViewFrustum=!1;for(var e=new Cn(this.sphereCenter.x,this.sphereCenter.y,this.sphereCenter.z,1),i=0;i<6;i++)if(t[i].dot(e)<-this.sphereRadius)return!1;return this.inViewFrustum=!0,!0},get_sphereRadius:function(){return this.sphereRadius},get_sphereCenter:function(){return this.sphereCenter},geoTo3d:function(t,e,i){return 3===this.dataset.get_dataSetType()?wn.create(-Math.cos(e*eo.RC)*Math.cos(t*eo.RC)*this.radius,Math.sin(t*eo.RC)*this.radius,Math.sin(e*eo.RC)*Math.cos(t*eo.RC)*this.radius):(e-=180,wn.create(Math.cos(e*eo.RC)*Math.cos(t*eo.RC)*this.radius,Math.sin(t*eo.RC)*this.radius,Math.sin(e*eo.RC)*Math.cos(t*eo.RC)*this.radius))},onCreateVertexBuffer:function(t,e){},get_dataset:function(){return this.dataset},set_dataset:function(t){return this.dataset=t,t},get_key:function(){return null==this._key&&(this._key=Bi(this.dataset,this.level,this.tileX,this.tileY,this.parent)),this._key},get_URL:function(){var e=zr.singleton.rewrite(this.dataset.get_url(),0),i=e;if(e.indexOf("{1}")>-1)return this.dataset.get_projection()||t.ss.emptyString(this.dataset.get_quadTreeTileMap())?t.ss.format(e,this.dataset.get_imageSetID(),this.level,this.tileX,this.tileY):((i=t.ss.format(e,this.getServerID(),this.getTileID())).indexOf("virtualearth.net")>-1&&(i+="&n=z"),i);i=t.ss.replaceString(i,"{X}",this.tileX.toString()),i=t.ss.replaceString(i,"{Y}",this.tileY.toString());var n=0;(i=t.ss.replaceString(i,"{L}",this.level.toString())).indexOf("{S:0}")>-1&&(n=0,i=t.ss.replaceString(i,"{S:0}","{S}")),i.indexOf("{S:1}")>-1&&(n=1,i=t.ss.replaceString(i,"{S:1}","{S}")),i.indexOf("{S:2}")>-1&&(n=2,i=t.ss.replaceString(i,"{S:2}","{S}")),i.indexOf("{S:3}")>-1&&(n=3,i=t.ss.replaceString(i,"{S:3}","{S}")),i.indexOf("a{S}")>-1&&(i=t.ss.replaceString(i,"a{S}","r{S}")),i.indexOf("h{S}")>-1&&(i=t.ss.replaceString(i,"h{S}","r{S}")),i.indexOf("//r{S}.ortho.tiles.virtualearth.net")>-1&&(i=t.ss.replaceString(i,"//r{S}.ortho.tiles.virtualearth.net","//ecn.t{S}.tiles.virtualearth.net"));var r,s=this.getTileID();return r=s.length?s.substr(s.length-1,1):n.toString(),i=t.ss.replaceString(i,"{Q}",s),(i=t.ss.replaceString(i,"{S}",r)).indexOf("virtualearth.net")>-1&&(i+="&n=z"),i},get_demURL:function(){var e=zr.singleton.rewrite(this.dataset.get_demUrl(),0);if(this.dataset.get_projection()||Mr||(zr.singleton.coreStaticUrl("wwtweb/demtile.aspx?q={0},{1},{2},M"),t.ss.emptyString(e)),e.indexOf("{1}")>-1)return t.ss.format(e+"&new",this.level,this.tileX,this.tileY);var i=e;i=t.ss.replaceString(i,"{X}",this.tileX.toString()),i=t.ss.replaceString(i,"{Y}",this.tileY.toString());var n=0;(i=t.ss.replaceString(i,"{L}",this.level.toString())).indexOf("{S:0}")>-1&&(n=0,i=t.ss.replaceString(i,"{S:0}","{S}")),i.indexOf("{S:1}")>-1&&(n=1,i=t.ss.replaceString(i,"{S:1}","{S}")),i.indexOf("{S:2}")>-1&&(n=2,i=t.ss.replaceString(i,"{S:2}","{S}")),i.indexOf("{S:3}")>-1&&(n=3,i=t.ss.replaceString(i,"{S:3}","{S}"));var r,s=this.getTileID();return r=s.length?s.substr(s.length-1,1):n.toString(),i=t.ss.replaceString(i,"{Q}",s),t.ss.replaceString(i,"{S}",r)},getServerID:function(){return(1&this.tileX)+((1&this.tileY)<<1)},getTileID:function(){if(null!=this._tileId)return this._tileId;var e=this.level,i=this.tileX,n=this.tileY;1===this.dataset.get_projection()&&e++;var r=this.dataset.get_quadTreeTileMap();if(t.ss.emptyString(r))return this._tileId="0",this._tileId;for(var s=new t.ss.StringBuilder,a=e;a>0;--a){var o=1<<a-1,l=0;i&o&&(l=1),n&o&&(l+=2),s.append(r.substr(l,1))}return this._tileId=s.toString(),this._tileId},get_vertexCount:function(){return this._vertexCount},set_vertexCount:function(t){return this._vertexCount=t,t}};function no(){this.a=new cn,this.b=new cn,this.c=new cn,this.normal=new wn,this.opacity=1,this.expansionInPixels=.6,this.tileLevel=0,this._ta=new wn,this._tb=new wn,this._tc=new wn,this._expandedS0=new vn,this._expandedS1=new vn,this._expandedS2=new vn,this.lighting=1}n("Tile",[eo,io,null]),no.width=1024,no.height=768,no._contractionInPixels=-.5,no.trianglesRendered=0,no.trianglesCulled=0,no.renderingOn=!0,no._factor=1,no.cullInside=!0,no._hw=0,no._qw=0,no._hh=0,no._qh=0,no.create=function(t,e,i,n,r){var s=new no;return s.a=t.copy(),s.b=e.copy(),s.c=i.copy(),s._texture=n,s.tileLevel=r,s.makeNormal(),s},no.createWithMiter=function(t,e,i,n,r,s){var a=new no;return a.expansionInPixels=s,a.a=t.copy(),a.b=e.copy(),a.c=i.copy(),a._texture=n,a.tileLevel=r,a.makeNormal(),a},no._getMiterPoint=function(t,e,i,n){var r=vn.subtract(e,t),s=vn.subtract(i,t);r.normalize(),s.normalize();var a=vn.create(r.x+s.x,r.y+s.y);a.normalize();var o=vn.create(r.x-s.x,r.y-s.y).get_length()/2,l=Math.min(2,n/o);return a.extend(l),vn.create(t.x-a.x,t.y-a.y)},no._miterPoint=function(t,e,i,n,r,s,a){var o=i-t,l=n-e,h=r-t,u=s-e,c=Math.sqrt(o*o+l*l);c&&(o/=c,l/=c),(c=Math.sqrt(h*h+u*u))&&(h/=c,u/=c);var _=o+h,d=l+u;(c=Math.sqrt(_*_+d*d))&&(_/=c,d/=c);var g=o-h,f=l-u,m=(c=Math.sqrt(g*g+f*f))/2,p=Math.min(2,a/m);return _*=p,d*=p,vn.create(t-_,e-d)},no._miterPointOut=function(t,e,i,n,r,s,a,o){var l=n-e,h=r-i,u=s-e,c=a-i,_=Math.sqrt(l*l+h*h);_&&(l/=_,h/=_),(_=Math.sqrt(u*u+c*c))&&(u/=_,c/=_);var d=l+u,g=h+c;(_=Math.sqrt(d*d+g*g))&&(d/=_,g/=_);var f=l-u,m=h-c,p=(_=Math.sqrt(f*f+m*m))/2,w=Math.min(2,o/p);d*=w,g*=w,t.x=e-d,t.y=i-g};var ro={makeNormal:function(){var t=this.a.position.copy(),e=this.b.position.copy(),i=this.c.position.copy();t.normalize(),e.normalize(),i.normalize();var n=t.x+e.x+i.x,r=t.y+e.y+i.y,s=t.z+e.z+i.z;this.normal=wn.create(n/3,r/3,s/3),this.normal.normalize()},_checkBackface:function(){var t=wn.subtractVectors(this._ta,this._tb),e=wn.subtractVectors(this._ta,this._tc),i=wn.cross(t,e);return i.normalize(),i.z>=0},draw:function(t,e){null!=t&&(e._transformTo(this.a.position,this._ta),e._transformTo(this.b.position,this._tb),e._transformTo(this.c.position,this._tc),this._checkBackface()!==no.cullInside?this._drawTriangle(t,this._texture,this._ta.x,this._ta.y,this._tb.x,this._tb.y,this._tc.x,this._tc.y,this.a.tu,this.a.tv,this.b.tu,this.b.tv,this.c.tu,this.c.tv):no.trianglesCulled++)},_drawTriangle:function(t,e,i,n,r,s,a,o,l,h,u,c,_,d){if(!this.intersects(0,no.width,0,no.height,i,n,r,s,a,o))return!1;no._miterPointOut(this._expandedS0,i,n,r,s,a,o,this.expansionInPixels),no._miterPointOut(this._expandedS1,r,s,i,n,a,o,this.expansionInPixels),no._miterPointOut(this._expandedS2,a,o,r,s,i,n,this.expansionInPixels),i=this._expandedS0.x,n=this._expandedS0.y,r=this._expandedS1.x,s=this._expandedS1.y,a=this._expandedS2.x,o=this._expandedS2.y,t.save(),no.renderingOn&&(t.beginPath(),t.moveTo(i,n),t.lineTo(r,s),t.lineTo(a,o),t.closePath(),t.clip());var g=l*(d-c)-u*d+_*c+(u-_)*h,f=-(h*(a-r)-c*a+d*r+(c-d)*i)/g,m=(c*o+h*(s-o)-d*s+(d-c)*n)/g,p=(l*(a-r)-u*a+_*r+(u-_)*i)/g,w=-(u*o+l*(s-o)-_*s+(_-u)*n)/g,b=(l*(d*r-c*a)+h*(u*a-_*r)+(_*c-u*d)*i)/g,v=(l*(d*s-c*o)+h*(u*o-_*s)+(_*c-u*d)*n)/g;return t.transform(f,m,p,w,b,v),no.renderingOn&&(t.globalAlpha=this.opacity,this.lighting<1&&(t.globalAlpha=1,t.fillStyle="Black",t.fillRect(0,0,no.width,no.height),t.globalAlpha=this.lighting*this.opacity),t.drawImage(e,0,0)),t.restore(),!0},intersects:function(t,e,i,n,r,s,a,o,l,h){if(r>t&&r<e&&s>i&&s<n)return!0;if(a>t&&a<e&&o>i&&o<n)return!0;if(l>t&&l<e&&h>i&&h<n)return!0;var u=4*no.height;return!(this.tileLevel<4&&(Math.abs(r-a)>u||Math.abs(s-o)>u||Math.abs(l-a)>u||Math.abs(h-o)>u||Math.abs(r-l)>u||Math.abs(s-h)>u))&&(this.lineRectangleIntersect(t,e,i,n,r,s,a,o)||this.lineRectangleIntersect(t,e,i,n,a,o,l,h)||this.lineRectangleIntersect(t,e,i,n,l,h,r,s))},lineRectangleIntersect:function(t,e,i,n,r,s,a,o){var l,h,u,c,_,d,g,f;return d=s-(_=(o-s)/(a-r))*r,_>0?(l=_*t+d,h=_*e+d):(l=_*e+d,h=_*t+d),s<o?(u=s,c=o):(u=o,c=s),(g=l>u?l:u)<(f=h<c?h:c)&&!(f<i||g>n)}};function so(){this._tileDegrees$1=0,this._topDown$1=!0,this._subDivisionLevel$1=1,eo.call(this)}n("RenderTriangle",[no,ro,null]),so.create=function(t,e,i,n,r){var s=new so;return s.parent=r,s.level=t,s.tileX=e,s.tileY=i,s.dataset=n,s._topDown$1=!n.get_bottomsUp(),s.computeBoundingSphere(),s};var ao={computeBoundingSphere:function(){if(this._topDown$1){this._tileDegrees$1=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level);var t=90-this.tileY*this._tileDegrees$1,e=90-(this.tileY+1)*this._tileDegrees$1,i=this.tileX*this._tileDegrees$1-180,n=(this.tileX+1)*this._tileDegrees$1-180,r=(t+e)/2,s=(i+n)/2;this.sphereCenter=this.geoTo3d(r,s,!1),this.topLeft=this.geoTo3d(t,i,!1),this.bottomRight=this.geoTo3d(e,n,!1),this.topRight=this.geoTo3d(t,n,!1),this.bottomLeft=this.geoTo3d(e,i,!1);var a=this.geoTo3d(t,i,!1);a.subtract(this.sphereCenter),this.sphereRadius=a.length(),this._tileDegrees$1=n-i}else this.computeBoundingSphereBottomsUp()},computeBoundingSphereBottomsUp:function(){var t=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level),e=(this.tileY+1)*t-90,i=this.tileY*t-90,n=this.tileX*t-180,r=(this.tileX+1)*t-180,s=(e+i)/2,a=(n+r)/2;this.sphereCenter=this.geoTo3d(s,a,!1),this.topLeft=this.geoTo3d(e,n,!1),this.bottomRight=this.geoTo3d(i,r,!1),this.topRight=this.geoTo3d(e,r,!1),this.bottomLeft=this.geoTo3d(i,n,!1);var o=this.topLeft;o.subtract(this.sphereCenter),this.sphereRadius=o.length(),t=r-n},createGeometry:function(e){eo.prototype.createGeometry.call(this,e),null==e.gl?this.dataset.get_dataSetType()&&1!==this.dataset.get_dataSetType()||(this._subDivisionLevel$1=Math.max(2,2*(4-this.level))):this._subDivisionLevel$1=32;try{for(var i=0;i<4;i++)this._renderTriangleLists[i]=[];if(!this._topDown$1)return this._createGeometryBottomsUp$1(e);var n,r,s=0,a=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level),o=90-this.tileY*a,l=90-(this.tileY+1)*a,h=this.tileX*a-180,u=(this.tileX+1)*a-180,c=u-h,_=l-o;this.topLeft=this.geoTo3d(o,h,!1),this.bottomRight=this.geoTo3d(l,u,!1),this.topRight=this.geoTo3d(o,u,!1),this.bottomLeft=this.geoTo3d(l,h,!1);var d,g,f=new Array((this._subDivisionLevel$1+1)*(this._subDivisionLevel$1+1)),m=1/this._subDivisionLevel$1;for(g=0;g<=this._subDivisionLevel$1;g++)for(n=g!==this._subDivisionLevel$1?o+m*_*g:l,d=0;d<=this._subDivisionLevel$1;d++)r=d!==this._subDivisionLevel$1?h+m*c*d:u,f[s=g*(this._subDivisionLevel$1+1)+d]=cn.createPos(this.geoTo3d(n,r,!1),d*m,g*m);this.triangleCount=this._subDivisionLevel$1*this._subDivisionLevel$1*2;var p=this._subDivisionLevel$1/2,w=0;if(null==e.gl)for(var b=0;b<2;b++)for(var v=0;v<2;v++){s=0;for(var y=p*b;y<p*(b+1);y++)for(var S=p*v;S<p*(v+1);S++){var x,T,M;x=f[y*(this._subDivisionLevel$1+1)+S],T=f[(y+1)*(this._subDivisionLevel$1+1)+S],M=f[y*(this._subDivisionLevel$1+1)+(S+1)],this._renderTriangleLists[w].push(no.create(x,M,T,this.texture,this.level)),x=f[y*(this._subDivisionLevel$1+1)+(S+1)],T=f[(y+1)*(this._subDivisionLevel$1+1)+S],M=f[(y+1)*(this._subDivisionLevel$1+1)+(S+1)],this._renderTriangleLists[w].push(no.create(x,M,T,this.texture,this.level))}w++}else{this._vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this._vertexBuffer);var C=new Float32Array(5*f.length),A=C;s=0;for(var L=t.ss.enumerate(f);L.moveNext();){var I=L.current;s=this.addVertex(A,s,I)}for(Hi.bufferData(Yr.ARRAY_BUFFER,C,Yr.STATIC_DRAW),b=0;b<2;b++)for(v=0;v<2;v++){var k=new Uint16Array(3*this.triangleCount),P=k;for(s=0,y=p*b;y<p*(b+1);y++)for(S=p*v;S<p*(v+1);S++)P[s++]=y*(this._subDivisionLevel$1+1)+S,P[s++]=(y+1)*(this._subDivisionLevel$1+1)+S,P[s++]=y*(this._subDivisionLevel$1+1)+(S+1),P[s++]=y*(this._subDivisionLevel$1+1)+(S+1),P[s++]=(y+1)*(this._subDivisionLevel$1+1)+S,P[s++]=(y+1)*(this._subDivisionLevel$1+1)+(S+1);this._indexBuffers[w]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this._indexBuffers[w]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,k,Yr.STATIC_DRAW),w++}}}catch(t){}return!0},_createGeometryBottomsUp$1:function(e){var i,n,r,s,a=0,o=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level),l=(this.tileY+1)*o-90,h=this.tileY*o-90,u=this.tileX*o-180,c=(this.tileX+1)*o-180,_=c-u,d=h-l,g=new Array((this._subDivisionLevel$1+1)*(this._subDivisionLevel$1+1)),f=1/this._subDivisionLevel$1;for(s=0;s<=this._subDivisionLevel$1;s++)for(i=s!==this._subDivisionLevel$1?l+f*d*s:h,r=0;r<=this._subDivisionLevel$1;r++)n=r!==this._subDivisionLevel$1?u+f*_*r:c,g[a=s*(this._subDivisionLevel$1+1)+r]=cn.createPos(this.geoTo3d(i,n,!1),r*f,s*f);this.triangleCount=this._subDivisionLevel$1*this._subDivisionLevel$1*2;var m=this._subDivisionLevel$1/2,p=0;if(null==e.gl)for(var w=0;w<2;w++)for(var b=0;b<2;b++){a=0;for(var v=m*w;v<m*(w+1);v++)for(var y=m*b;y<m*(b+1);y++){var S,x,T;S=g[v*(this._subDivisionLevel$1+1)+y],x=g[(v+1)*(this._subDivisionLevel$1+1)+y],T=g[v*(this._subDivisionLevel$1+1)+(y+1)],this._renderTriangleLists[p].push(no.create(S,T,x,this.texture,this.level)),S=g[v*(this._subDivisionLevel$1+1)+(y+1)],x=g[(v+1)*(this._subDivisionLevel$1+1)+y],T=g[(v+1)*(this._subDivisionLevel$1+1)+(y+1)],this._renderTriangleLists[p].push(no.create(S,T,x,this.texture,this.level))}p++}else{this._vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this._vertexBuffer);var M=new Float32Array(5*g.length),C=M;a=0;for(var A=t.ss.enumerate(g);A.moveNext();){var L=A.current;a=this.addVertex(C,a,L)}for(Hi.bufferData(Yr.ARRAY_BUFFER,M,Yr.STATIC_DRAW),w=0;w<2;w++)for(b=0;b<2;b++){var I=new Uint16Array(3*this.triangleCount),k=I;for(a=0,v=m*w;v<m*(w+1);v++)for(y=m*b;y<m*(b+1);y++)k[a++]=v*(this._subDivisionLevel$1+1)+y,k[a++]=(v+1)*(this._subDivisionLevel$1+1)+y,k[a++]=v*(this._subDivisionLevel$1+1)+(y+1),k[a++]=v*(this._subDivisionLevel$1+1)+(y+1),k[a++]=(v+1)*(this._subDivisionLevel$1+1)+y,k[a++]=(v+1)*(this._subDivisionLevel$1+1)+(y+1);this._indexBuffers[p]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this._indexBuffers[p]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,I,Yr.STATIC_DRAW),p++}}return!0}};function oo(){this.ix=0,this.iy=0,this.face=0}function lo(e,i,n,r,s){if(this.ipix=0,this.indexBuffer=new Array(4),this._vertexList$1=null,this._nside$1=0,this._tileIndex$1=0,this._face$1=0,this._faceX$1=0,this._faceY$1=0,this._step$1=0,this._subDivided$1=!1,this._catalogRows$1=[],eo.call(this),this.level=e,this.tileX=i,this.tileY=n,this.dataset=r,Zi(!1),this._nside$1=e?Math.pow(2,e+1):4,null==s)this._face$1=4*i+n,this.ipix=this._face$1;else{this.parent=s;var a=s;this._face$1=a._face$1,this._tileIndex$1=4*a._tileIndex$1+2*n+i,this.ipix=this._face$1*this._nside$1*this._nside$1/4+this._tileIndex$1,this._faceX$1=2*a._faceX$1+i,this._faceY$1=2*a._faceY$1+n}this.isCatalogTile=t.ss.keyExists(r.get_hipsProperties().get_properties(),"dataproduct_type")&&"catalog"===r.get_hipsProperties().get_properties().dataproduct_type.toLowerCase(),this._computeBoundingSphere$1()}n("EquirectangularTile",[so,ao,eo]),oo.create=function(t,e,i){var n=new oo;return n.ix=t,n.iy=e,n.face=i,n},n("Xyf",[oo,{},null]),lo._galacticMatrix$1=yn.create(-.0548755604024359,-.483835015526738,-.873437090247923,0,-.867666148981161,.455983776232537,-.198076373464674,0,.494109427943568,.746982244476371,-.444829629919504,0,0,0,0,1);var ho={get_URL:function(){return null==this._url$1?(this._url$1=this._getUrl$1(this.dataset,this.level,this.tileX,this.tileY),this._url$1):this._url$1},_computeBoundingSphere$1:function(){this._setStep$1(),this.createGeometry(null);for(var t=new Array(this._vertexList$1.length),e=0;e<this._vertexList$1.length;e++)t[e]=this._vertexList$1[e].position;this._calcSphere$1(t),this._setCorners$1()},createGeometry:function(e){if(null!=this._vertexList$1)return!0;if(this._vertexList$1=[],this._populateVertexList$1(this._vertexList$1,this._step$1),t.ss.keyExists(this.dataset.get_hipsProperties().get_properties(),"hips_frame")&&"galactic"===this.dataset.get_hipsProperties().get_properties().hips_frame)for(var i=0;i<this._vertexList$1.length;i++){var n=this._vertexList$1[i];lo._galacticMatrix$1.multiplyVector(n.position)}this.triangleCount=this._step$1*this._step$1/2;var r=new Uint16Array(3*this.triangleCount);if(!this._subDivided$1)try{this._vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this._vertexBuffer);for(var s=new Float32Array(5*this._vertexList$1.length),a=s,o=0,l=t.ss.enumerate(this._vertexList$1);l.moveNext();)n=l.current,o=this.addVertex(a,o,n);Hi.bufferData(Yr.ARRAY_BUFFER,s,Yr.STATIC_DRAW),o=0,this._vertexList$1.length,this._step$1,this._setIndexBufferForQuadrant$1(r,0,1),this._step$1>1&&(this._setIndexBufferForQuadrant$1(r,0,0),this._setIndexBufferForQuadrant$1(r,1,1),this._setIndexBufferForQuadrant$1(r,1,0))}catch(t){}return!0},_setIndexBufferForQuadrant$1:function(t,e,i){for(var n=0,r=e*this._step$1/2;r<this._step$1/2*(e+1);r++)for(var s=i*this._step$1/2;s<this._step$1/2*(i+1);s++)t[n++]=r*(this._step$1+1)+s,t[n++]=1+r*(this._step$1+1)+s,t[n++]=this._step$1+1+r*(this._step$1+1)+s,t[n++]=1+r*(this._step$1+1)+s,t[n++]=this._step$1+1+r*(this._step$1+1)+s,t[n++]=this._step$1+2+r*(this._step$1+1)+s;this._processIndexBuffer$1(t,2*e+i)},_getUrl$1:function(e,i,n,r){var s=this._getHipsFileExtension$1(),a=-1;a=i?this._face$1*this._nside$1*this._nside$1/4+this._tileIndex$1:this._face$1,new t.ss.StringBuilder;var o=1e4*Math.floor(a/1e4);return t.ss.format(e.get_url(),i.toString(),o.toString(),a.toString()+s)},_getHipsFileExtension$1:function(){return this.dataset.get_extension().toLowerCase().indexOf("png")>-1?".png":this.dataset.get_extension().toLowerCase().indexOf("jpeg")>-1||this.dataset.get_extension().toLowerCase().indexOf("jpg")>-1?".jpg":this.dataset.get_extension().toLowerCase().indexOf("tsv")>-1?".tsv":this.dataset.get_extension().toLowerCase().indexOf("fits")>-1?".fits":".jpg"},isTileBigEnough:function(t){if(1===this.dataset.get_dataSetType()){var e=180/(4*Math.pow(2,this.level));return t.get_fovScale()<e}return e=3600/(4*Math.pow(2,this.level)),t.get_fovScale()<e},_boundaries$1:function(t,e,i){var n=i*Math.pow(2,this.level),r=new Array(4),s=oo.create(t+this._faceX$1*i,e+this._faceY$1*i,this._face$1),a=.5/n,o=(s.ix+.5)/n,l=(s.iy+.5)/n;return r[0]=ha.create(o+a,l+a,s.face).toVec3(),r[1]=ha.create(o-a,l+a,s.face).toVec3(),r[2]=ha.create(o-a,l-a,s.face).toVec3(),r[3]=ha.create(o+a,l-a,s.face).toVec3(),r},_setCorners$1:function(){var t=oo.create(this.tileX,this.tileY,this._face$1),e=.5/this._nside$1,i=(t.ix+.5)/this._nside$1,n=(t.iy+.5)/this._nside$1;this.topLeft=ha.create(i+e,n+e,t.face).toVec3(),this.bottomLeft=ha.create(i-e,n+e,t.face).toVec3(),this.bottomRight=ha.create(i-e,n-e,t.face).toVec3(),this.topRight=ha.create(i+e,n-e,t.face).toVec3()},draw3D:function(t,e){if(this.isCatalogTile)return this.drawCatalogTile(t,e),!0;this.renderedGeneration=eo.currentRenderGeneration,eo.tilesTouched++,this.inViewFrustum=!0;var i=!1;if(!this.readyToRender){if(!this.errored)return tn(this),!1;if(!(this.errored&&this.level<3))return!1;i=!0}var n=this.triangleCount;eo.trianglesRendered+=n;for(var r=!1,s=!1,a=0,o=0;o<2;o++)for(var l=0;l<2;l++)this.level<this.dataset.get_levels()?(null==this.children[a]&&(this.children[a]=rn(this.level+1,l,o,this.dataset,this)),this.children[a].isTileInFrustum(t.get_frustum())?(this.inViewFrustum=!0,this.children[a].isTileBigEnough(t)||i?(this.renderChildPart[a].set_targetState(!this.children[a].draw3D(t,e)),this.renderChildPart[a].get_targetState()&&(s=!0)):this.renderChildPart[a].set_targetState(!0)):this.renderChildPart[a].set_targetState(this.renderChildPart[a].set_state(!1))):this.renderChildPart[a].set_state(!0),this.renderChildPart[a].get_state()&&(r=!0),a++;if((s||r)&&(this.renderedAtOrBelowGeneration=eo.currentRenderGeneration,null!=this.parent&&(this.parent.renderedAtOrBelowGeneration=this.renderedAtOrBelowGeneration)),!r)return!0;if(!this.createGeometry(t))return!1;if(i)return!0;eo.tilesInView++;for(var h=0;h<4;h++)this.renderChildPart[h].get_targetState()&&this.renderPart(t,h,e/100,!1);return!0},drawCatalogTile:function(t,e){this.renderedGeneration=eo.currentRenderGeneration,eo.tilesTouched++,this.inViewFrustum=!0;var i=!1;if(!this.readyToRender){if(!this.errored)return void tn(this);if(!(this.errored&&this.level<3))return;i=!0}for(var n=!1,r=0,s=0;s<2;s++)for(var a=0;a<2;a++)this.level<this.dataset.get_levels()&&(null==this.children[r]&&(this.children[r]=rn(this.level+1,a,s,this.dataset,this)),this.children[r].isTileInFrustum(t.get_frustum())?(this.inViewFrustum=!0,n=!0,this.children[r].isTileBigEnough(t)||i?this.children[r].drawCatalogTile(t,e):this.children[r].removeCatalogTile()):this.children[r].removeCatalogTile()),r++;this.level||n||i?n&&(eo.tilesInView++,this._addCatalogTile$1()):this.removeCatalogTile()},removeCatalogTile:function(){this.dataset.get_hipsProperties().get_catalogSpreadSheetLayer().removeTileRows(this.get_key(),this._catalogRows$1)},_addCatalogTile$1:function(){this.dataset.get_hipsProperties().get_catalogSpreadSheetLayer().addTileRows(this.get_key(),this._catalogRows$1)},_extractCatalogTileRows$1:function(){for(var e=!1,i=t.ss.enumerate(this._catalogData$1.getText().split("\n"));i.moveNext();){var n=i.current;if(t.ss.startsWith(n,"#")||e){if(!t.ss.startsWith(n,"#")){var r=Fa.splitString(n,this.dataset.get_hipsProperties().get_catalogSpreadSheetLayer().get__table().delimiter);this._catalogRows$1.push(r)}}else e=!0}},getDataInView:function(t,e,i){if(!this.readyToRender)if(this.errored){if(this.level>=3)return!0}else if(this.requestImage(),e)return!1;for(var n=!0,r=!1,s=0,a=0;a<2;a++)for(var o=0;o<2;o++)this.level<this.dataset.get_levels()&&(null==this.children[s]&&(this.children[s]=rn(this.level+1,o,a,this.dataset,this)),this.children[s].isTileInFrustum(t.get_frustum())&&(r=!0,n=n&&this.children[s].getDataInView(t,e,i))),s++;return r&&i.addTileRows(this.get_key(),this._catalogRows$1),n&&!this.downloading},_setStep$1:function(){if(this.isCatalogTile)this._step$1=2;else switch(this.level){case 0:case 1:case 2:case 3:case 4:this._step$1=16;break;case 5:this._step$1=8;break;case 6:this._step$1=4;break;default:this._step$1=2}},requestImage:function(){this.isCatalogTile?this.downloading||this.readyToRender||(this.downloading=!0,this._catalogData$1=new $a(this.get_URL()),this._catalogData$1.onStateChange=t.ss.bind("_loadCatalogData$1",this),this._catalogData$1.send()):eo.prototype.requestImage.call(this)},_loadCatalogData$1:function(){2===this._catalogData$1.get_state()?(this.requestPending=!1,this.downloading=!1,this.errored=!0,en(this.get_key(),!0)):1===this._catalogData$1.get_state()&&(this._extractCatalogTileRows$1(),this.texReady=!0,this.downloading=!1,this.errored=!1,this.readyToRender=!0,this.requestPending=!1,en(this.get_key(),!0))},getIndexBuffer:function(t,e){return this.indexBuffer[t]},_calcSphere$1:function(t){var e=Rn.findEnclosingSphere(t);this.sphereCenter=e.center,this.sphereRadius=e.radius},isPointInTile:function(t,e){if(!this.level)return!0;if(1===this.level){if(e>=0&&e<=90&&!this.tileX&&1===this.tileY)return!0;if(e>90&&e<=180&&1===this.tileX&&1===this.tileY)return!0;if(e<0&&e>=-90&&!this.tileX&&!this.tileY)return!0;if(e<-90&&e>=-180&&1===this.tileX&&!this.tileY)return!0}var i=Qs.geoTo3dDouble(t,e),n=this._isLeftOfHalfSpace$1(this.topLeft,this.topRight,i),r=this._isLeftOfHalfSpace$1(this.topRight,this.bottomRight,i),s=this._isLeftOfHalfSpace$1(this.bottomRight,this.bottomLeft,i),a=this._isLeftOfHalfSpace$1(this.bottomLeft,this.topLeft,i);return!!(n&&r&&s&&a)},_isLeftOfHalfSpace$1:function(t,e,i){t.normalize(),e.normalize();var n=wn.cross(t,e);return wn.dot(n,i)>0},getSurfacePointAltitude:function(e,i,n){if(this.level<eo.lastDeepestLevel)for(var r=t.ss.enumerate(this.children);r.moveNext();){var s=r.current;if(null!=s&&s.isPointInTile(e,i)){var a=s.getSurfacePointAltitude(e,i,n);if(a)return a;break}}return this._getAltitudeFromLatLng$1(e,i,n)},_getAltitudeFromLatLng$1:function(e,i,n){var r=Qs.geoTo3dDouble(e,i),s=Ui.getUVFromInnerPoint(this.topLeft,this.topRight,this.bottomLeft,this.bottomRight,r),a=Math.max(0,Math.min(16,16*s.x)),o=Math.max(0,Math.min(16,16*s.y)),l=Math.max(0,Math.min(15,t.ss.truncate(16*s.x))),h=Math.max(0,Math.min(15,t.ss.truncate(16*s.y))),u=a-l,c=o-h;return null!=this.demArray?((this.demArray[l+17*h]*(1-u)+u*this.demArray[l+1+17*h])*(1-c)+c*(this.demArray[l+17*(h+1)]*(1-u)+u*this.demArray[l+1+17*(h+1)]))/(n?1:this.get__demScaleFactor()):this.demAverage/(n?1:this.get__demScaleFactor())},_processIndexBuffer$1:function(t,e){this.indexBuffer[e]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this.indexBuffer[e]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,t,Yr.STATIC_DRAW)},cleanUp:function(t){eo.prototype.cleanUp.call(this,t),this._returnBuffers$1(),this._subDivided$1=!1},_returnBuffers$1:function(){null!=this._vertexList$1&&(this._vertexList$1=null)},_populateVertexList$1:function(t,e){for(var i=0;i<e;i+=2)for(var n=0;n<e;n+=2){var r=this._boundaries$1(n,i,e);t[i*(e+1)+n]=cn.createPos(r[2],1/e*i,1/e*n),t[i*(e+1)+n+1]=cn.createPos(r[3],1/e*i,1/e+1/e*n),t[(i+1)*(e+1)+n]=cn.createPos(r[1],1/e+1/e*i,1/e*n),t[(i+1)*(e+1)+n+1]=cn.createPos(r[0],1/e+1/e*i,1/e+1/e*n),n+2>=e&&e>1&&(n=e-1,r=this._boundaries$1(n,i,e),t[i*(e+1)+e]=cn.createPos(r[3],1/e*i,1/e+1/e*n),t[(i+1)*(e+1)+e]=cn.createPos(r[0],1/e+1/e*i,1/e+1/e*n))}e>1&&this._vertexOfLastRow$1(t,e)},_vertexOfLastRow$1:function(t,e){for(var i=e-1,n=0;n<e;n+=2){var r=this._boundaries$1(n,i,e);t[(i+1)*(e+1)+n]=cn.createPos(r[1],1/e+1/e*i,1/e*n),t[(i+1)*(e+1)+n+1]=cn.createPos(r[0],1/e+1/e*i,1/e+1/e*n),n+2>=e&&(n=e-1,r=this._boundaries$1(n,i,e),t[(i+1)*(e+1)+e]=cn.createPos(r[0],1/e+1/e*i,1/e+1/e*n))}}};function uo(){this._tileDegrees$1=0,this._latMin$1=0,this._latMax$1=0,this._lngMin$1=0,this._lngMax$1=0,this._subDivisionLevel$1=32,eo.call(this)}n("HealpixTile",[lo,ho,eo]),uo.create=function(t,e,i,n,r){var s=new uo;return s.parent=r,s.level=t,s.tileX=e,s.tileY=i,s.dataset=n,s.computeBoundingSphere(),s},uo.getCentrePointOffsetAsTileRatio=function(t,e,i){var n=uo.absoluteLonToMetersAtZoom(e,i),r=n/256-Math.floor(n/256),s=uo.absoluteLatToMetersAtZoom(t,i),a=s/256-Math.floor(s/256);return vn.create(r,a)},uo.relativeMetersToLatAtZoom=function(t,e){var i=t*uo.metersPerPixel2(e);return uo._radToDeg$1(Math.PI/2-2*Math.atan(Math.exp(0-i/6378137)))},uo.relativeMetersToLonAtZoom=function(t,e){var i=t*uo.metersPerPixel2(e);return uo._radToDeg$1(i/6378137)},uo.absoluteLatToMetersAtZoom=function(e,i){var n=Math.sin(uo._degToRad$1(e)),r=3189068.5*Math.log((1+n)/(1-n)),s=uo.metersPerPixel2(i);return t.ss.truncate(Math.round(20037508-r)/s)},uo.absoluteMetersToLatAtZoom=function(t,e){var i=20037508-t*uo.metersPerPixel2(e);return uo._radToDeg$1(Math.PI/2-2*Math.atan(Math.exp(0-i/6378137)))},uo.absoluteLonToMetersAtZoom=function(e,i){var n=6378137*uo._degToRad$1(e),r=uo.metersPerPixel2(i);return t.ss.truncate((n+20037508)/r)},uo.absoluteMetersToLonAtZoom=function(t,e){var i=t*uo.metersPerPixel2(e)-20037508;return uo._radToDeg$1(i/6378137)},uo.absoluteLonToMetersAtZoomTile=function(e,i,n){var r=6378137*uo._degToRad$1(e),s=uo.metersPerPixel2(i);return t.ss.truncate((r+20037508)/s)},uo.absoluteLatToMetersAtZoomTile=function(e,i,n){var r=Math.sin(uo._degToRad$1(e)),s=3189068.5*Math.log((1+r)/(1-r)),a=uo.metersPerPixel2(i);return t.ss.truncate(Math.round(20037508-s)/a)},uo.absoluteMetersToLonAtZoomByTileY=function(t,e,i){var n=t*uo.metersPerPixel2(e)-20037508;return uo._radToDeg$1(n/6378137)},uo._degToRad$1=function(t){return t*Math.PI/180},uo.metersPerPixel2=function(t){return 156543/(1<<t)},uo._radToDeg$1=function(t){return 180*t/Math.PI};var co={computeBoundingSphere:function(){this._tileDegrees$1=360/Math.pow(2,this.level),this._latMin$1=uo.absoluteMetersToLatAtZoom(256*this.tileY,this.level),this._latMax$1=uo.absoluteMetersToLatAtZoom(256*(this.tileY+1),this.level),this._lngMin$1=this.tileX*this._tileDegrees$1-180,this._lngMax$1=(this.tileX+1)*this._tileDegrees$1-180;var t=(this._latMin$1+this._latMax$1)/2,e=(this._lngMin$1+this._lngMax$1)/2;this.sphereCenter=this.geoTo3d(t,e,!1),this.topLeft=this.geoTo3d(this._latMin$1,this._lngMin$1,!1),this.bottomRight=this.geoTo3d(this._latMax$1,this._lngMax$1,!1),this.topRight=this.geoTo3d(this._latMin$1,this._lngMax$1,!1),this.bottomLeft=this.geoTo3d(this._latMax$1,this._lngMin$1,!1),this.tileY||(this.topLeft=wn.create(0,1,0),this.topRight=wn.create(0,1,0)),this.tileY===Math.pow(2,this.level)-1&&(this.bottomRight=wn.create(0,-1,0),this.bottomLeft=wn.create(0,-1,0));var i=this.topLeft;i.subtract(this.sphereCenter),this.sphereRadius=i.length(),(i=this.bottomRight).subtract(this.sphereCenter);var n=i.length();this.sphereRadius<n&&(this.sphereRadius=n),this._tileDegrees$1=Math.abs(this._latMax$1-this._latMin$1)},isPointInTile:function(t,e){return!(!this.demReady||null==this.demData||t<Math.min(this._latMin$1,this._latMax$1)||t>Math.max(this._latMax$1,this._latMin$1)||e<Math.min(this._lngMin$1,this._lngMax$1)||e>Math.max(this._lngMin$1,this._lngMax$1))},getSurfacePointAltitude:function(e,i,n){if(this.level<eo.lastDeepestLevel)for(var r=t.ss.enumerate(this.children);r.moveNext();){var s=r.current;if(null!=s&&s.isPointInTile(e,i)){var a=s.getSurfacePointAltitude(e,i,n);if(a)return a;break}}return this._getAltitudeAtLatLng$1(e,i,n?1:this.get__demScaleFactor())},_getAltitudeAtLatLng$1:function(e,i,n){var r=Math.abs(this._latMax$1-this._latMin$1),s=Math.abs(this._lngMax$1-this._lngMin$1),a=(e-Math.min(this._latMax$1,this._latMin$1))/r*32,o=(i-Math.min(this._lngMax$1,this._lngMin$1))/s*32,l=Math.min(31,t.ss.truncate(a)),h=Math.min(31,t.ss.truncate(o)),u=o-h,c=a-l;return((this.demData[33*l+h]*(1-u)+u*this.demData[33*l+(h+1)])*(1-c)+c*(this.demData[33*(l+1)+h]*(1-u)+u*this.demData[33*(l+1)+(h+1)]))/n},createGeometry:function(e){if(eo.prototype.createGeometry.call(this,e),this.geometryCreated)return!0;this.geometryCreated=!0,256==ji&&(this.dataset.get_dataSetType()&&1!==this.dataset.get_dataSetType()||(this._subDivisionLevel$1=Math.max(2,2*(6-this.level))));for(var i=0;i<4;i++)this._renderTriangleLists[i]=[];var n,r,s=0,a=360/Math.pow(2,this.level);this._latMin$1=uo.absoluteMetersToLatAtZoom(256*this.tileY,this.level),this._latMax$1=uo.absoluteMetersToLatAtZoom(256*(this.tileY+1),this.level),this._lngMin$1=this.tileX*a-180,this._lngMax$1=(this.tileX+1)*a-180;var o=uo.absoluteMetersToLatAtZoom(256*(2*this.tileY+1),this.level+1);this.topLeft=this.geoTo3d(this._latMin$1,this._lngMin$1,!1),this.bottomRight=this.geoTo3d(this._latMax$1,this._lngMax$1,!1),this.topRight=this.geoTo3d(this._latMin$1,this._lngMax$1,!1),this.bottomLeft=this.geoTo3d(this._latMax$1,this._lngMin$1,!1);var l,h,u=new Array((this._subDivisionLevel$1+1)*(this._subDivisionLevel$1+1)),c=(a=this._lngMax$1-this._lngMin$1,this._subDivisionLevel$1,1/this._subDivisionLevel$1),_=this._latMax$1-o;for(h=0;h<this._subDivisionLevel$1/2;h++)for(n=h!==this._subDivisionLevel$1/2?this._latMax$1-2*c*_*h:o,l=0;l<=this._subDivisionLevel$1;l++)r=l!==this._subDivisionLevel$1?this._lngMin$1+c*a*l:this._lngMax$1,u[s=h*(this._subDivisionLevel$1+1)+l]=new cn,u[s].position=this.geoTo3dWithAlt(n,r,!1,!0),u[s].tu=l*c*ji,u[s].tv=(uo.absoluteLatToMetersAtZoom(n,this.level)-256*this.tileY)/256*ji,this.demIndex++;for(_=this._latMin$1-o,h=this._subDivisionLevel$1/2;h<=this._subDivisionLevel$1;h++)for(n=h!==this._subDivisionLevel$1?o+2*c*_*(h-this._subDivisionLevel$1/2):this._latMin$1,l=0;l<=this._subDivisionLevel$1;l++)r=l!==this._subDivisionLevel$1?this._lngMin$1+c*a*l:this._lngMax$1,u[s=h*(this._subDivisionLevel$1+1)+l]=new cn,u[s].position=this.geoTo3dWithAlt(n,r,!1,!0),u[s].tu=l*c*ji,u[s].tv=(uo.absoluteLatToMetersAtZoom(n,this.level)-256*this.tileY)/256*ji,this.demIndex++;if(!this.tileY)for(h=this._subDivisionLevel$1,l=0;l<=this._subDivisionLevel$1;l++)u[s=h*(this._subDivisionLevel$1+1)+l].position=wn.create(0,1,0);if(this.tileY===Math.pow(2,this.level)-1)for(h=0,l=0;l<=this._subDivisionLevel$1;l++)u[s=h*(this._subDivisionLevel$1+1)+l].position=wn.create(0,-1,0);this.triangleCount=this._subDivisionLevel$1*this._subDivisionLevel$1*2;var d=this._subDivisionLevel$1/2,g=0;if(null==e.gl)for(var f=0;f<2;f++)for(var m=0;m<2;m++){for(s=0,h=d*f;h<d*(f+1);h++)for(l=d*m;l<d*(m+1);l++){var p,w,b;p=u[h*(this._subDivisionLevel$1+1)+l],w=u[(h+1)*(this._subDivisionLevel$1+1)+l],b=u[h*(this._subDivisionLevel$1+1)+(l+1)];var v=no.create(p,w,b,this.texture,this.level);this._renderTriangleLists[g].push(v),p=u[h*(this._subDivisionLevel$1+1)+(l+1)],w=u[(h+1)*(this._subDivisionLevel$1+1)+l],b=u[(h+1)*(this._subDivisionLevel$1+1)+(l+1)],v=no.create(p,w,b,this.texture,this.level),this._renderTriangleLists[g].push(v)}g++}else{this._vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this._vertexBuffer);var y=new Float32Array(5*u.length),S=y;s=0;for(var x=t.ss.enumerate(u);x.moveNext();){var T=x.current;s=this.addVertex(S,s,T)}for(Hi.bufferData(Yr.ARRAY_BUFFER,y,Yr.STATIC_DRAW),f=0;f<2;f++)for(m=0;m<2;m++){var M=new Uint16Array(3*this.triangleCount),C=M;for(s=0,h=d*f;h<d*(f+1);h++)for(l=d*m;l<d*(m+1);l++)C[s++]=h*(this._subDivisionLevel$1+1)+l,C[s++]=(h+1)*(this._subDivisionLevel$1+1)+l,C[s++]=h*(this._subDivisionLevel$1+1)+(l+1),C[s++]=h*(this._subDivisionLevel$1+1)+(l+1),C[s++]=(h+1)*(this._subDivisionLevel$1+1)+l,C[s++]=(h+1)*(this._subDivisionLevel$1+1)+(l+1);this._indexBuffers[g]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this._indexBuffers[g]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,M,Yr.STATIC_DRAW),g++}}return!0},_getDemSample$1:function(t,e){return this.demData[33*(32-e)+t]},createDemFromParent:function(){var e=t.ss.safeCast(this.parent,uo);if(null==e||null==e.demData)return!1;var i=this.tileX%2==1?16:0,n=this.tileY%2==1?16:0;this.demData=new Array(this.demSize);for(var r=0;r<33;r+=2)for(var s=!0,a=0;a<33;a++)this.demData[33*(32-r)+a]=s?e._getDemSample$1(a/2+i,r/2+n):(e._getDemSample$1(a/2+i,r/2+n)+e._getDemSample$1(a/2+i+1,r/2+n))/2,s=!s;for(r=1;r<33;r+=2)for(a=0;a<33;a++)this.demData[33*(32-r)+a]=(this._getDemSample$1(a,r-1)+this._getDemSample$1(a,r+1))/2;for(var o=t.ss.enumerate(this.demData);o.moveNext();){var l=o.current;this.demAverage+=l}return this.demAverage/=this.demData.length,this.demReady=!0,!0}};function _o(){}function go(){this._topDown$1=!0,this.backslash=!1,this._vertexList$1=null,this._childTriangleList$1=null,this._stars$1=[],this._subDivisionLevel$1=4,this._subDivided$1=!1,eo.call(this)}function fo(){this.latMin=0,this.latMax=0,this.lngMin=0,this.lngMax=0}function mo(t,e,i,n,r){this._topDown$1=!0,eo.call(this),this.parent=r,this.level=t,this.tileX=e,this.tileY=i,this.dataset=n,this._topDown$1=!n.get_bottomsUp(),this.computeBoundingSphere()}n("MercatorTile",[uo,co,eo]),_o.drawPointPlanet=function(t,e,i,n,r){var s=e,a=i/2;if(null!=t.gl){var o=new zs(t);o.minSize=20,o.addPoint(e.copy(),n._clone(),new As(0,1),i/100),o.depthBuffered=!0,o.draw(t,1,!1)}else{var l=t.WVP.transform(s);if(l.z<0)return;if(!r&&wn.dot(t.get_viewPoint(),s)<.55)return;var h=t.device;h.save(),h.beginPath(),h.arc(l.x,l.y,a,0,2*Math.PI,!0),h.lineWidth=1,h.fillStyle=n.toString(),h.fill(),h.globalAlpha=1,h.strokeStyle=n.toString(),h.stroke(),h.restore()}},n("BasePlanets",[_o,{},null]),go.create=function(t,e,i,n,r){var s=new go;return s.parent=r,s.level=t,s.tileX=e,s.tileY=i,s.dataset=n,s._topDown$1=!n.get_bottomsUp(),s.tileX!==e&&alert("bad"),n.get_meanRadius()?s.set__demScaleFactor(n.get_meanRadius()):n.get_dataSetType()?s.set__demScaleFactor(3396010):s.set__demScaleFactor(6371e3),s.computeBoundingSphere(),s},n("PlotTile",[go,{computeBoundingSphere:function(){this._initializeGrids$1(),this.topLeft=this.bounds[0].position.copy(),this.bottomRight=this.bounds[8].position.copy(),this.topRight=this.bounds[2].position.copy(),this.bottomLeft=this.bounds[6].position.copy(),this.calcSphere()},renderPart:function(e,i,n,r){if(null!=e.gl);else if(!i)for(var s=t.ss.enumerate(this._stars$1);s.moveNext();){var a=s.current,o=25/Math.pow(1.6,a.magnitude);_o.drawPointPlanet(e,a.position,o,a.col,!1)}},requestImage:function(){this.downloading||this.readyToRender||(this.downloading=!0,this._webFile$1=new $a(zr.singleton.rewrite(this.get_URL(),0)),this._webFile$1.onStateChange=t.ss.bind("fileStateChange",this),this._webFile$1.send())},fileStateChange:function(){2===this._webFile$1.get_state()?(this.downloading=!1,this.readyToRender=!1,this.errored=!0,this.requestPending=!1,en(this.get_key(),!0)):1===this._webFile$1.get_state()&&(this.texReady=!0,this.downloading=!1,this.errored=!1,this.readyToRender=this.texReady&&(this.demReady||!this.demTile),this.requestPending=!1,en(this.get_key(),!0),this._loadData$1(this._webFile$1.getText()))},_loadData$1:function(e){for(var i=t.ss.replaceString(e,"\r\n","\n").split("\n"),n=!0,r=null,s=t.ss.enumerate(i);s.moveNext();){var a=s.current;n?n=!1:t.ss.trim(a).length>5&&((r=new Ea(a)).position=Qs.raDecTo3dAu(r.RA,r.dec,1),this._stars$1.push(r))}},isPointInTile:function(t,e){if(!this.level)return!0;if(1===this.level)return e>=0&&e<=90&&!this.tileX&&1===this.tileY||e>90&&e<=180&&1===this.tileX&&1===this.tileY||e<0&&e>=-90&&!this.tileX&&!this.tileY||e<-90&&e>=-180&&1===this.tileX&&!this.tileY;if(!this.demReady||null==this.demData)return!1;var i=Qs.geoTo3dDouble(-t,e),n=this._isLeftOfHalfSpace$1(this.topLeft.copy(),this.topRight.copy(),i),r=this._isLeftOfHalfSpace$1(this.topRight.copy(),this.bottomRight.copy(),i),s=this._isLeftOfHalfSpace$1(this.bottomRight.copy(),this.bottomLeft.copy(),i),a=this._isLeftOfHalfSpace$1(this.bottomLeft.copy(),this.topLeft.copy(),i);return!!(n&&r&&s&&a)},_isLeftOfHalfSpace$1:function(t,e,i){t.normalize(),e.normalize();var n=wn.cross(t,e);return wn.dot(n,i)<0},_initializeGrids$1:function(){if(this._vertexList$1=[],this._childTriangleList$1=new Array(4),this._childTriangleList$1[0]=[],this._childTriangleList$1[1]=[],this._childTriangleList$1[2]=[],this._childTriangleList$1[3]=[],this.bounds=new Array(9),this.level>0){null==this.parent&&(this.parent=rn(this.level-1,this.tileX/2,this.tileY/2,this.dataset,null));var t=this.parent,e=this.tileX%2,i=this.tileY%2;this.level>1?this.backslash=t.backslash:this.backslash=1==(1===e^1===i),this.bounds[0]=t.bounds[e+3*i].copy(),this.bounds[1]=this._midpoint$1(t.bounds[e+3*i],t.bounds[e+1+3*i]),this.bounds[2]=t.bounds[e+1+3*i].copy(),this.bounds[3]=this._midpoint$1(t.bounds[e+3*i],t.bounds[e+3*(i+1)]),this.backslash?this.bounds[4]=this._midpoint$1(t.bounds[e+3*i],t.bounds[e+1+3*(i+1)]):this.bounds[4]=this._midpoint$1(t.bounds[e+1+3*i],t.bounds[e+3*(i+1)]),this.bounds[5]=this._midpoint$1(t.bounds[e+1+3*i],t.bounds[e+1+3*(i+1)]),this.bounds[6]=t.bounds[e+3*(i+1)].copy(),this.bounds[7]=this._midpoint$1(t.bounds[e+3*(i+1)],t.bounds[e+1+3*(i+1)]),this.bounds[8]=t.bounds[e+1+3*(i+1)].copy(),this.bounds[0].tu=0*ji,this.bounds[0].tv=0*ji,this.bounds[1].tu=.5*ji,this.bounds[1].tv=0*ji,this.bounds[2].tu=1*ji,this.bounds[2].tv=0*ji,this.bounds[3].tu=0*ji,this.bounds[3].tv=.5*ji,this.bounds[4].tu=.5*ji,this.bounds[4].tv=.5*ji,this.bounds[5].tu=1*ji,this.bounds[5].tv=.5*ji,this.bounds[6].tu=0*ji,this.bounds[6].tv=1*ji,this.bounds[7].tu=.5*ji,this.bounds[7].tv=1*ji,this.bounds[8].tu=1*ji,this.bounds[8].tv=1*ji}else this.bounds[0]=cn.create(0,-1,0,0,0),this.bounds[1]=cn.create(0,0,1,.5,0),this.bounds[2]=cn.create(0,-1,0,1,0),this.bounds[3]=cn.create(-1,0,0,0,.5),this.bounds[4]=cn.create(0,1,0,.5,.5),this.bounds[5]=cn.create(1,0,0,1,.5),this.bounds[6]=cn.create(0,-1,0,0,1),this.bounds[7]=cn.create(0,0,-1,.5,1),this.bounds[8]=cn.create(0,-1,0,1,1)},_midpoint$1:function(t,e){var i=wn.lerp(t.position,e.position,.5),n=vn.lerp(vn.create(t.tu,t.tv),vn.create(e.tu,e.tv),.5);return i.normalize(),cn.createPos(i,n.x,n.y)},createGeometry:function(t){return this.geometryCreated||(this.geometryCreated=!0,eo.prototype.createGeometry.call(this,t)),!0},cleanUp:function(t){eo.prototype.cleanUp.call(this,t),null!=this._vertexList$1&&(this._vertexList$1=null),null!=this._childTriangleList$1&&(this._childTriangleList$1=null),this._subDivided$1=!1,this.demArray=null}},eo]),n("LatLngEdges",[fo,{},null]);var po={computeBoundingSphere:function(){if(this._topDown$1){var t=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level),e=this.dataset.get_baseTileDegrees()/2-this.tileY*t+this.dataset.get_offsetY(),i=this.dataset.get_baseTileDegrees()/2-(this.tileY+1)*t+this.dataset.get_offsetY(),n=this.tileX*t-this.dataset.get_baseTileDegrees()/this.dataset.get_widthFactor()+this.dataset.get_offsetX(),r=(this.tileX+1)*t-this.dataset.get_baseTileDegrees()/this.dataset.get_widthFactor()+this.dataset.get_offsetX(),s=(e+i)/2,a=(n+r)/2;this.sphereCenter=this.geoTo3dTan(s,a),this.topLeft=this.geoTo3dTan(e,n),this.bottomRight=this.geoTo3dTan(i,r),this.topRight=this.geoTo3dTan(e,r),this.bottomLeft=this.geoTo3dTan(i,n);var o=this.geoTo3dTan(e,n);o.subtract(this.sphereCenter),this.sphereRadius=o.length()}else this.computeBoundingSphereBottomsUp()},computeBoundingSphereBottomsUp:function(){var t=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level),e=this.dataset.get_baseTileDegrees()/2+(this.tileY+1)*t+this.dataset.get_offsetY(),i=this.dataset.get_baseTileDegrees()/2+this.tileY*t+this.dataset.get_offsetY(),n=this.tileX*t-this.dataset.get_baseTileDegrees()/this.dataset.get_widthFactor()+this.dataset.get_offsetX(),r=(this.tileX+1)*t-this.dataset.get_baseTileDegrees()/this.dataset.get_widthFactor()+this.dataset.get_offsetX();this.topLeft=this.geoTo3dTan(e,n),this.bottomRight=this.geoTo3dTan(i,r),this.topRight=this.geoTo3dTan(e,r),this.bottomLeft=this.geoTo3dTan(i,n)},getLatLngEdges:function(){var t=this.dataset.get_baseTileDegrees()/Math.pow(2,this.level),e=new fo;return e.latMin=this.dataset.get_baseTileDegrees()/2-this.tileY*t+this.dataset.get_offsetY(),e.latMax=this.dataset.get_baseTileDegrees()/2-(this.tileY+1)*t+this.dataset.get_offsetY(),e.lngMin=this.tileX*t-this.dataset.get_baseTileDegrees()/this.dataset.get_widthFactor()+this.dataset.get_offsetX(),e.lngMax=(this.tileX+1)*t-this.dataset.get_baseTileDegrees()/this.dataset.get_widthFactor()+this.dataset.get_offsetX(),e},geoTo3dTan:function(t,e){e=-e;var i=this.dataset.get_baseTileDegrees()/2,n=Math.tan(i*eo.RC);return this.dataset.get_matrix().transform(wn.create(1,t/i*n,e/i*n))},requestImage:function(){this.fitsImage=t.ss.safeCast(this.dataset.get_wcsImage(),Ga),null!=this.fitsImage?(this.texReady=!0,this.downloading=!1,this.errored=this.fitsImage.errored,this.requestPending=!1,en(this.get_key(),!0),Ji?(this.makeTexture(),this.readyToRender=!0):(this.bmp=this.fitsImage.getBitmap(),this.texture2d=this.bmp.getTexture(),this.readyToRender=!0)):eo.prototype.requestImage.call(this)},createGeometry:function(t){if(this.geometryCreated)return!0;this.geometryCreated=!0;for(var e=0;e<4;e++)this._renderTriangleLists[e]=[];this.globalCenter=this.geoTo3dTan(0,0);var i=this.getLatLngEdges();this.topLeft=this.geoTo3dTan(i.latMin,i.lngMin).subtract(this.globalCenter),this.bottomRight=this.geoTo3dTan(i.latMax,i.lngMax).subtract(this.globalCenter),this.topRight=this.geoTo3dTan(i.latMin,i.lngMax).subtract(this.globalCenter),this.bottomLeft=this.geoTo3dTan(i.latMax,i.lngMin).subtract(this.globalCenter);var n=wn.midPoint(this.topLeft,this.bottomRight),r=wn.midPoint(this.topLeft,this.bottomLeft),s=wn.midPoint(this.topRight,this.bottomRight),a=wn.midPoint(this.topLeft,this.topRight),o=wn.midPoint(this.bottomLeft,this.bottomRight);if(null==t.gl)this._renderTriangleLists[0].push(no.create(cn.createPos(this.topLeft,0,0),cn.createPos(r,0,.5),cn.createPos(a,.5,0),this.texture,this.level)),this._renderTriangleLists[0].push(no.create(cn.createPos(r,0,.5),cn.createPos(n,.5,.5),cn.createPos(a,.5,0),this.texture,this.level)),this._renderTriangleLists[1].push(no.create(cn.createPos(a,.5,0),cn.createPos(s,1,.5),cn.createPos(this.topRight,1,0),this.texture,this.level)),this._renderTriangleLists[1].push(no.create(cn.createPos(a,.5,0),cn.createPos(n,.5,.5),cn.createPos(s,1,.5),this.texture,this.level)),this._renderTriangleLists[2].push(no.create(cn.createPos(r,0,.5),cn.createPos(o,.5,1),cn.createPos(n,.5,.5),this.texture,this.level)),this._renderTriangleLists[2].push(no.create(cn.createPos(r,0,.5),cn.createPos(this.bottomLeft,0,1),cn.createPos(o,.5,1),this.texture,this.level)),this._renderTriangleLists[3].push(no.create(cn.createPos(n,.5,.5),cn.createPos(this.bottomRight,1,1),cn.createPos(s,1,.5),this.texture,this.level)),this._renderTriangleLists[3].push(no.create(cn.createPos(n,.5,.5),cn.createPos(o,.5,1),cn.createPos(this.bottomRight,1,1),this.texture,this.level)),this.readyToRender=!0;else{this._vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this._vertexBuffer);var l=new Float32Array(45),h=l,u=0;for(u=this.addVertex(h,u,cn.createPos(o,.5,1)),u=this.addVertex(h,u,cn.createPos(this.bottomLeft,0,1)),u=this.addVertex(h,u,cn.createPos(this.bottomRight,1,1)),u=this.addVertex(h,u,cn.createPos(n,.5,.5)),u=this.addVertex(h,u,cn.createPos(r,0,.5)),u=this.addVertex(h,u,cn.createPos(s,1,.5)),u=this.addVertex(h,u,cn.createPos(a,.5,0)),u=this.addVertex(h,u,cn.createPos(this.topLeft,0,0)),u=this.addVertex(h,u,cn.createPos(this.topRight,1,0)),Hi.bufferData(Yr.ARRAY_BUFFER,l,Yr.STATIC_DRAW),e=0;e<4;e++){u=0,this.triangleCount=2;var c=new Uint16Array(3*this.triangleCount),_=c;switch(e){case 0:_[u++]=7,_[u++]=4,_[u++]=6,_[u++]=4,_[u++]=3,_[u++]=6;break;case 1:_[u++]=6,_[u++]=5,_[u++]=8,_[u++]=6,_[u++]=3,_[u++]=5;break;case 2:_[u++]=4,_[u++]=0,_[u++]=3,_[u++]=4,_[u++]=1,_[u++]=0;break;case 3:_[u++]=3,_[u++]=2,_[u++]=5,_[u++]=3,_[u++]=0,_[u++]=2}this._indexBuffers[e]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,this._indexBuffers[e]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,c,Yr.STATIC_DRAW)}}return!0}};function wo(t,e,i,n,r){this.pixelCenterX=0,this.pixelCenterY=0,this.scaleX=.01,this.scaleY=.01,this.height=0,this.width=0,mo.call(this,t,e,i,n,r),this.pixelCenterX=n.get_offsetX(),this.pixelCenterY=n.get_offsetY(),this.scaleX=-(this.scaleY=n.get_baseTileDegrees()),n.get_bottomsUp()&&(this.scaleX=-this.scaleX),this.sphereCenter=this.geoTo3dTan(0,0),this.radius=1.25,this.computeBoundingSphere()}function bo(){this.a=-1,this.b=-1,this.c=-1}n("TangentTile",[mo,po,eo]),n("SkyImageTile",[wo,{getLatLngEdges:function(){var e=new fo,i=t.ss.safeCast(this.dataset.get_wcsImage(),Va);return null!=i&&Ki?Ji?(this.width=i.get_sizeX(),this.height=i.get_sizeY()):(this.height=this.bmp.height,this.width=this.bmp.width,this.bmp.height!==i.get_sizeY()&&(this.pixelCenterY+=this.bmp.height-i.get_sizeY())):null!=this.texture?(this.height=this.texture.naturalHeight,this.width=this.texture.naturalWidth):(this.height=256,this.width=256),e.latMin=0+this.scaleY*(this.height-this.pixelCenterY),e.latMax=0-this.scaleY*this.pixelCenterY,e.lngMin=0+this.scaleX*this.pixelCenterX,e.lngMax=0-this.scaleX*(this.width-this.pixelCenterX),e}},mo]),bo.create=function(t,e,i){var n=new bo;return n.a=t,n.b=e,n.c=i,n};var vo={subDivide:function(t,e){var i=wn.lerp(e[this.b].position,e[this.c].position,.5),n=wn.lerp(e[this.c].position,e[this.a].position,.5),r=wn.lerp(e[this.a].position,e[this.b].position,.5),s=vn.lerp(vn.create(e[this.b].tu,e[this.b].tv),vn.create(e[this.c].tu,e[this.c].tv),.5),a=vn.lerp(vn.create(e[this.c].tu,e[this.c].tv),vn.create(e[this.a].tu,e[this.a].tv),.5),o=vn.lerp(vn.create(e[this.a].tu,e[this.a].tv),vn.create(e[this.b].tu,e[this.b].tv),.5);i.normalize(),n.normalize(),r.normalize();var l=e.length,h=e.length+1,u=e.length+2;e.push(cn.createPosRaw(i,s.x,s.y)),e.push(cn.createPosRaw(n,a.x,a.y)),e.push(cn.createPosRaw(r,o.x,o.y)),t.push(bo.create(this.a,u,h)),t.push(bo.create(this.b,l,u)),t.push(bo.create(this.c,h,l)),t.push(bo.create(l,h,u))},subDivideNoNormalize:function(t,e){var i=wn.lerp(e[this.b].position,e[this.c].position,.5),n=wn.lerp(e[this.c].position,e[this.a].position,.5),r=wn.lerp(e[this.a].position,e[this.b].position,.5),s=vn.lerp(vn.create(e[this.b].tu,e[this.b].tv),vn.create(e[this.c].tu,e[this.c].tv),.5),a=vn.lerp(vn.create(e[this.c].tu,e[this.c].tv),vn.create(e[this.a].tu,e[this.a].tv),.5),o=vn.lerp(vn.create(e[this.a].tu,e[this.a].tv),vn.create(e[this.b].tu,e[this.b].tv),.5),l=e.length,h=e.length+1,u=e.length+2;e.push(cn.createPosRaw(i,s.x,s.y)),e.push(cn.createPosRaw(n,a.x,a.y)),e.push(cn.createPosRaw(r,o.x,o.y)),t.push(bo.create(this.a,u,h)),t.push(bo.create(this.b,l,u)),t.push(bo.create(this.c,h,l)),t.push(bo.create(l,h,u))}};function yo(){this._topDown$1=!0,this.backslash=!1,this._vertexList$1=null,this._childTriangleList$1=null,this._subDivisionLevel$1=4,this._subDivided$1=!1,eo.call(this)}n("Triangle",[bo,vo,null]),yo.slashIndexBuffer=new Array(64),yo.backSlashIndexBuffer=new Array(64),yo.rootIndexBuffer=new Array(4),yo._cloneArray$1=function(t){for(var e=t.length,i=new Uint16Array(e),n=0;n<e;n++)i[n]=t[n];return i},yo.create=function(t,e,i,n,r){var s=new yo;return s.parent=r,s.level=t,s.tileX=e,s.tileY=i,s.dataset=n,s._topDown$1=!n.get_bottomsUp(),s.tileX!==e&&alert("bad"),n.get_meanRadius()?s.set__demScaleFactor(n.get_meanRadius()):n.get_dataSetType()?s.set__demScaleFactor(3396010):s.set__demScaleFactor(6371e3),s.computeBoundingSphere(),s};var So={computeBoundingSphere:function(){this._initializeGrids$1(),this.topLeft=this.bounds[0].position.copy(),this.bottomRight=this.bounds[8].position.copy(),this.topRight=this.bounds[2].position.copy(),this.bottomLeft=this.bounds[6].position.copy(),this.calcSphere()},getIndexBuffer:function(t,e){return this.level?this.backslash?yo.backSlashIndexBuffer[16*t+e]:yo.slashIndexBuffer[16*t+e]:yo.rootIndexBuffer[t]},_processIndexBuffer$1:function(t,e){if(!this.level)return yo.rootIndexBuffer[e]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,yo.rootIndexBuffer[e]),void Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,t,Yr.STATIC_DRAW);for(var i=0;i<16;i++){var n=yo._cloneArray$1(t);this._processAccomindations$1(n,i),this.backslash?(yo.backSlashIndexBuffer[16*e+i]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,yo.backSlashIndexBuffer[16*e+i]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,n,Yr.STATIC_DRAW)):(yo.slashIndexBuffer[16*e+i]=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,yo.slashIndexBuffer[16*e+i]),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,n,Yr.STATIC_DRAW))}},_processAccomindations$1:function(e,i){for(var n={},r={},s=t.ss.enumerate(e);s.moveNext();){var a=s.current,o=this._vertexList$1[a],l=t.ss.truncate(16*o.tu+.5),h=(t.ss.truncate(16*o.tv+.5)<<8)+l;t.ss.keyExists(r,h)||(r[h]=a)}var u=16;if(1==(1&i))for(var c=1;c<u;c+=2){var _=((g=u)<<8)+c,d=(g<<8)+c+1;t.ss.keyExists(r,_)&&(n[r[_]]=r[d])}if(2==(2&i))for(var g=1;g<u;g+=2)_=(g<<8)+(c=u),d=(g+1<<8)+c,t.ss.keyExists(r,_)&&(n[r[_]]=r[d]);if(4==(4&i))for(c=1;c<u;c+=2)_=((g=0)<<8)+c,d=(g<<8)+c+1,t.ss.keyExists(r,_)&&(n[r[_]]=r[d]);if(8==(8&i))for(g=1;g<u;g+=2)_=(g<<8)+(c=0),d=(g+1<<8)+c,t.ss.keyExists(r,_)&&(n[r[_]]=r[d]);if(t.ss.keyCount(n))for(var f=0;f<e.length;f++)t.ss.keyExists(n,e[f])&&(e[f]=n[e[f]])},calculateFullSphere:function(t){var e=Rn.findEnclosingSphere(t);this.sphereCenter=e.center,this.sphereRadius=e.radius},isPointInTile:function(t,e){if(!this.level)return!0;if(1===this.level)return e>=0&&e<=90&&!this.tileX&&1===this.tileY||e>90&&e<=180&&1===this.tileX&&1===this.tileY||e<0&&e>=-90&&!this.tileX&&!this.tileY||e<-90&&e>=-180&&1===this.tileX&&!this.tileY;if(!this.demReady||null==this.demData)return!1;var i=Qs.geoTo3dDouble(-t,e),n=this._isLeftOfHalfSpace$1(this.topLeft.copy(),this.topRight.copy(),i),r=this._isLeftOfHalfSpace$1(this.topRight.copy(),this.bottomRight.copy(),i),s=this._isLeftOfHalfSpace$1(this.bottomRight.copy(),this.bottomLeft.copy(),i),a=this._isLeftOfHalfSpace$1(this.bottomLeft.copy(),this.topLeft.copy(),i);return!!(n&&r&&s&&a)},_isLeftOfHalfSpace$1:function(t,e,i){t.normalize(),e.normalize();var n=wn.cross(t,e);return wn.dot(n,i)<0},getSurfacePointAltitude:function(e,i,n){if(this.level<eo.lastDeepestLevel)for(var r=0;r<4;r++){var s=this.children[r];if(null!=s&&s.isPointInTile(e,i)){var a=s.getSurfacePointAltitude(e,i,n);if(a)return a;break}}eo.tileTargetLevel=this.level,eo.tileTargetX=this.tileX,eo.tileTargetY=this.tileY;var o=Qs.geoTo3dDouble(-e,i);o=wn.subtractVectors(new wn,o);var l=Ui.getUVFromInnerPoint(this.topLeft.copy(),this.topRight.copy(),this.bottomLeft.copy(),this.bottomRight.copy(),o.copy()),h=Math.max(0,Math.min(16,16*l.x)),u=Math.max(0,Math.min(16,16*l.y)),c=Math.max(0,Math.min(15,t.ss.truncate(16*l.x))),_=Math.max(0,Math.min(15,t.ss.truncate(16*l.y))),d=h-c,g=u-_;return null!=this.demArray?((this.demArray[c+17*_]*(1-d)+d*this.demArray[c+1+17*_])*(1-g)+g*(this.demArray[c+17*(_+1)]*(1-d)+d*this.demArray[c+1+17*(_+1)]))/this.get__demScaleFactor():this.demAverage/this.get__demScaleFactor()},_initializeGrids$1:function(){if(this._vertexList$1=[],this._childTriangleList$1=new Array(4),this._childTriangleList$1[0]=[],this._childTriangleList$1[1]=[],this._childTriangleList$1[2]=[],this._childTriangleList$1[3]=[],this.bounds=new Array(9),this.level>0){null==this.parent&&(this.parent=rn(this.level-1,this.tileX/2,this.tileY/2,this.dataset,null));var t=this.parent,e=this.tileX%2,i=this.tileY%2;this.level>1?this.backslash=t.backslash:this.backslash=1==(1===e^1===i),this.bounds[0]=t.bounds[e+3*i].copy(),this.bounds[1]=this._midpoint$1(t.bounds[e+3*i],t.bounds[e+1+3*i]),this.bounds[2]=t.bounds[e+1+3*i].copy(),this.bounds[3]=this._midpoint$1(t.bounds[e+3*i],t.bounds[e+3*(i+1)]),this.backslash?this.bounds[4]=this._midpoint$1(t.bounds[e+3*i],t.bounds[e+1+3*(i+1)]):this.bounds[4]=this._midpoint$1(t.bounds[e+1+3*i],t.bounds[e+3*(i+1)]),this.bounds[5]=this._midpoint$1(t.bounds[e+1+3*i],t.bounds[e+1+3*(i+1)]),this.bounds[6]=t.bounds[e+3*(i+1)].copy(),this.bounds[7]=this._midpoint$1(t.bounds[e+3*(i+1)],t.bounds[e+1+3*(i+1)]),this.bounds[8]=t.bounds[e+1+3*(i+1)].copy(),this.bounds[0].tu=0*ji,this.bounds[0].tv=0*ji,this.bounds[1].tu=.5*ji,this.bounds[1].tv=0*ji,this.bounds[2].tu=1*ji,this.bounds[2].tv=0*ji,this.bounds[3].tu=0*ji,this.bounds[3].tv=.5*ji,this.bounds[4].tu=.5*ji,this.bounds[4].tv=.5*ji,this.bounds[5].tu=1*ji,this.bounds[5].tv=.5*ji,this.bounds[6].tu=0*ji,this.bounds[6].tv=1*ji,this.bounds[7].tu=.5*ji,this.bounds[7].tv=1*ji,this.bounds[8].tu=1*ji,this.bounds[8].tv=1*ji,this._vertexList$1.push(this.bounds[0]),this._vertexList$1.push(this.bounds[1]),this._vertexList$1.push(this.bounds[2]),this._vertexList$1.push(this.bounds[3]),this._vertexList$1.push(this.bounds[4]),this._vertexList$1.push(this.bounds[5]),this._vertexList$1.push(this.bounds[6]),this._vertexList$1.push(this.bounds[7]),this._vertexList$1.push(this.bounds[8]),this.backslash?(this._childTriangleList$1[0].push(bo.create(4,1,0)),this._childTriangleList$1[0].push(bo.create(3,4,0)),this._childTriangleList$1[1].push(bo.create(5,2,1)),this._childTriangleList$1[1].push(bo.create(4,5,1)),this._childTriangleList$1[2].push(bo.create(7,4,3)),this._childTriangleList$1[2].push(bo.create(6,7,3)),this._childTriangleList$1[3].push(bo.create(8,5,4)),this._childTriangleList$1[3].push(bo.create(7,8,4))):(this._childTriangleList$1[0].push(bo.create(3,1,0)),this._childTriangleList$1[0].push(bo.create(4,1,3)),this._childTriangleList$1[1].push(bo.create(4,2,1)),this._childTriangleList$1[1].push(bo.create(5,2,4)),this._childTriangleList$1[2].push(bo.create(6,4,3)),this._childTriangleList$1[2].push(bo.create(7,4,6)),this._childTriangleList$1[3].push(bo.create(7,5,4)),this._childTriangleList$1[3].push(bo.create(8,5,7)))}else this.bounds[0]=cn.create(0,-1,0,0,0),this.bounds[1]=cn.create(0,0,1,.5,0),this.bounds[2]=cn.create(0,-1,0,1,0),this.bounds[3]=cn.create(-1,0,0,0,.5),this.bounds[4]=cn.create(0,1,0,.5,.5),this.bounds[5]=cn.create(1,0,0,1,.5),this.bounds[6]=cn.create(0,-1,0,0,1),this.bounds[7]=cn.create(0,0,-1,.5,1),this.bounds[8]=cn.create(0,-1,0,1,1),this._vertexList$1.push(this.bounds[0]),this._vertexList$1.push(this.bounds[1]),this._vertexList$1.push(this.bounds[2]),this._vertexList$1.push(this.bounds[3]),this._vertexList$1.push(this.bounds[4]),this._vertexList$1.push(this.bounds[5]),this._vertexList$1.push(this.bounds[6]),this._vertexList$1.push(this.bounds[7]),this._vertexList$1.push(this.bounds[8]),this._childTriangleList$1[0].push(bo.create(3,1,0)),this._childTriangleList$1[0].push(bo.create(4,1,3)),this._childTriangleList$1[1].push(bo.create(5,2,1)),this._childTriangleList$1[1].push(bo.create(4,5,1)),this._childTriangleList$1[2].push(bo.create(7,4,3)),this._childTriangleList$1[2].push(bo.create(6,7,3)),this._childTriangleList$1[3].push(bo.create(7,5,4)),this._childTriangleList$1[3].push(bo.create(8,5,7))},_midpoint$1:function(t,e){var i=wn.lerp(t.position,e.position,.5),n=vn.lerp(vn.create(t.tu,t.tv),vn.create(e.tu,e.tv),.5);return i.normalize(),cn.createPos(i,n.x,n.y)},createGeometry:function(e){if(this.geometryCreated)return!0;if(this.geometryCreated=!0,eo.prototype.createGeometry.call(this,e),!this._subDivided$1){null==this._vertexList$1&&this._initializeGrids$1(),256==ji?(this.dataset.get_dataSetType()&&this.dataset.get_dataSetType(),this._subDivisionLevel$1=Math.min(5,Math.max(0,5-this.level))):this.demTile&&this.level>1&&(this.demArray=new Array(289),this.demSize=289,this.backslash?null==yo._backslashYIndex$1&&(this._tempBackslashYIndex$1=new Array(this.demSize),this._tempBackslashXIndex$1=new Array(this.demSize)):null==yo._slashYIndex$1&&(this._tempSlashYIndex$1=new Array(this.demSize),this._tempSlashXIndex$1=new Array(this.demSize)));for(var i=0;i<4;i++)for(var n=this._subDivisionLevel$1;n-- >1;){for(var r=[],s=t.ss.enumerate(this._childTriangleList$1[i]);s.moveNext();)(o=s.current).subDivide(r,this._vertexList$1);this._childTriangleList$1[i]=r}if(null==e.gl)for(i=0;i<4;i++){this._renderTriangleLists[i]=[];for(var a=t.ss.enumerate(this._childTriangleList$1[i]);a.moveNext();){var o=a.current,l=this._vertexList$1[o.c],h=this._vertexList$1[o.b],u=this._vertexList$1[o.a];this._renderTriangleLists[i].push(no.create(l,h,u,this.texture,this.level))}}else{this._vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this._vertexBuffer);for(var c=new Float32Array(5*this._vertexList$1.length),_=c,d=0,g=t.ss.enumerate(this._vertexList$1);g.moveNext();){var f=g.current;this.demTile?(d=this.addVertex(_,d,this._getMappedVertex(f)),this.demIndex++):d=this.addVertex(_,d,f)}for(this.demTile&&(this.backslash?null!=this._tempBackslashXIndex$1&&(yo._backslashXIndex$1=this._tempBackslashXIndex$1,yo._backslashYIndex$1=this._tempBackslashYIndex$1,this._tempBackslashXIndex$1=null,this._tempBackslashYIndex$1=null):null!=this._tempSlashYIndex$1&&(yo._slashXIndex$1=this._tempSlashXIndex$1,yo._slashYIndex$1=this._tempSlashYIndex$1,this._tempSlashYIndex$1=null,this._tempSlashXIndex$1=null)),Hi.bufferData(Yr.ARRAY_BUFFER,c,Yr.STATIC_DRAW),i=0;i<4;i++)if(this.triangleCount=this._childTriangleList$1[i].length,null==this.getIndexBuffer(i,0)){var m=new Uint16Array(3*this.triangleCount);d=0;for(var p=t.ss.enumerate(this._childTriangleList$1[i]);p.moveNext();)o=p.current,m[d++]=o.c,m[d++]=o.b,m[d++]=o.a;this._processIndexBuffer$1(m,i)}}this._subDivided$1=!0}return!0},_getMappedVertex:function(e){var i=new cn,n=Qs.cartesianToSpherical2(e.position);if(n.get_lng()<-180&&n.set_lng(n.get_lng()+360),n.get_lng()>180&&n.set_lng(n.get_lng()-360),this.level>1){var r=t.ss.truncate(16*e.tu+.5),s=t.ss.truncate(16*e.tv+.5);this.demArray[r+17*s]=this.demData[this.demIndex],this.backslash?null!=this._tempBackslashYIndex$1&&(this._tempBackslashXIndex$1[this.demIndex]=r,this._tempBackslashYIndex$1[this.demIndex]=s):null!=this._tempSlashYIndex$1&&(this._tempSlashXIndex$1[this.demIndex]=r,this._tempSlashYIndex$1[this.demIndex]=s)}var a=this.geoTo3dWithAlt(n.get_lat(),n.get_lng(),!1,!1);return i.tu=e.tu,i.tv=e.tv,a.subtract(this.localCenter),i.position=a,i},cleanUp:function(t){eo.prototype.cleanUp.call(this,t),null!=this._vertexList$1&&(this._vertexList$1=null),null!=this._childTriangleList$1&&(this._childTriangleList$1=null),this._subDivided$1=!1,this.demArray=null},_getDemSample$1:function(t,e){return this.demArray[17*(16-e)+t]},createDemFromParent:function(){var e=t.ss.safeCast(this.parent,yo);if(null==e)return!1;var i=this.tileX%2==1?8:0,n=this.tileY%2?0:8;this.demArray=new Array(289);for(var r=0;r<17;r+=2)for(var s=!0,a=0;a<17;a++)this.demArray[17*(16-r)+a]=s?e._getDemSample$1(a/2+i,r/2+n):(e._getDemSample$1(a/2+i,r/2+n)+e._getDemSample$1(a/2+i+1,r/2+n))/2,s=!s;for(var o=1;o<17;o+=2)for(var l=0;l<17;l++)this.demArray[17*(16-o)+l]=(this._getDemSample$1(l,o-1)+this._getDemSample$1(l,o+1))/2;this.demData=new Array(this.demSize);for(var h=0;h<this.demSize;h++)this.backslash?this.demData[h]=this.demArray[yo._backslashXIndex$1[h]+17*yo._backslashYIndex$1[h]]:this.demData[h]=this.demArray[yo._slashXIndex$1[h]+17*yo._slashYIndex$1[h]],this.demAverage+=this.demData[h];return this.demAverage/=this.demData.length,this.demReady=!0,!0}};n("ToastTile",[yo,So,eo]);var xo={mercator:0,equirectangular:1,tangent:2,tan:2,toast:3,spherical:4,skyImage:5,plotted:6,healpix:7};n("ProjectionType",xo),r("ProjectionType",xo);var To={earth:0,planet:1,sky:2,panorama:3,solarSystem:4,sandbox:5};n("ImageSetType",To),r("ImageSetType",To);var Mo={gamma:0,xRay:1,ultraviolet:2,visible:3,hydrogenAlpha:4,IR:4,microwave:5,radio:6,visibleNight:6};function Co(){this._projection=0,this._imageSetID=0,this._baseTileDegrees=0,this._widthFactor=1,this.demUrl="",this._levels=0,this._mercator=!1,this._bottomsUp=!1,this._baseLevel=1,this._quadTreeTileMap="0123",this._centerX=0,this._centerY=0,this._rotation=0,this._meanRadius=0,this._dataSetType=0,this._bandPass=3,this._altUrl="",this._singleImage=!1,this._fitsProperties=new Ra,this._matrixComputed=!1,this._name="",this._sparse=!1,this._thumbnailUrl="",this._generic=!1,this._defaultSet=!1,this._elevationModel=!1,this._offsetX=0,this._offsetY=0}n("BandPass",Mo),r("BandPass",Mo),Co.getNewTile=function(t,e,i,n,r){switch(t.get_projection()){case xo.mercator:return uo.create(e,i,n,t,r);case xo.equirectangular:return so.create(e,i,n,t,r);case xo.toast:default:return yo.create(e,i,n,t,r);case xo.skyImage:return new wo(e,i,n,t,r);case xo.plotted:return go.create(e,i,n,t,r);case xo.healpix:return null==t.get_hipsProperties()&&t.set_hipsProperties(Ar(t)),t.get_hipsProperties().get_downloadComplete()?new lo(e,i,n,t,r):null;case xo.tangent:return new mo(e,i,n,t,r)}},Co.fromXMLNode=function(e){try{var i,n,r=2;null!=e.attributes.getNamedItem("DataSetType")&&(r=s.parse("ImageSetType",e.attributes.getNamedItem("DataSetType").nodeValue)),n=s.parse("BandPass",e.attributes.getNamedItem("BandPass").nodeValue);var o=1;if(null!=e.attributes.getNamedItem("WidthFactor")&&(o=parseInt(e.attributes.getNamedItem("WidthFactor").nodeValue)),null!=e.attributes.getNamedItem("Generic")&&t.ss.boolean(e.attributes.getNamedItem("Generic").nodeValue))return Co.createGeneric(r,n);i=s.parse("ProjectionType",e.attributes.getNamedItem("Projection").nodeValue);var l=e.attributes.getNamedItem("FileType").nodeValue;t.ss.startsWith(l,".")||(l="."+l);var h="",u=a.selectSingleNode(e,"ThumbnailUrl");null!=u&&(h=t.ss.emptyString(u.text)?u.textContent:u.text);var c=!1,_=!1;null!=e.attributes.getNamedItem("StockSet")&&(c=t.ss.boolean(e.attributes.getNamedItem("StockSet").nodeValue)),null!=e.attributes.getNamedItem("ElevationModel")&&(_=t.ss.boolean(e.attributes.getNamedItem("ElevationModel").nodeValue));var d="";null!=e.attributes.getNamedItem("DemUrl")&&(d=e.attributes.getNamedItem("DemUrl").nodeValue);var g="";null!=e.attributes.getNamedItem("AltUrl")&&(g=e.attributes.getNamedItem("AltUrl").nodeValue);var f=0;null!=e.attributes.getNamedItem("OffsetX")&&(f=parseFloat(e.attributes.getNamedItem("OffsetX").nodeValue));var m=0;null!=e.attributes.getNamedItem("OffsetY")&&(m=parseFloat(e.attributes.getNamedItem("OffsetY").nodeValue));var p="",w=a.selectSingleNode(e,"Credits");null!=w&&(p=a.getInnerText(w));var b="";null!=(w=a.selectSingleNode(e,"CreditsUrl"))&&(b=a.getInnerText(w));var v=0;null!=e.attributes.getNamedItem("MeanRadius")&&(v=parseFloat(e.attributes.getNamedItem("MeanRadius").nodeValue));var y=null;null!=e.attributes.getNamedItem("ReferenceFrame")&&(y=e.attributes.getNamedItem("ReferenceFrame").nodeValue);var S="";null!=e.attributes.getNamedItem("Name")&&(S=e.attributes.getNamedItem("Name").nodeValue);var x="";null!=e.attributes.getNamedItem("Url")&&(x=e.attributes.getNamedItem("Url").nodeValue);var T=0;null!=e.attributes.getNamedItem("BaseTileLevel")&&(T=parseInt(e.attributes.getNamedItem("BaseTileLevel").nodeValue));var M=0;null!=e.attributes.getNamedItem("TileLevels")&&(M=parseInt(e.attributes.getNamedItem("TileLevels").nodeValue));var C=0;null!=e.attributes.getNamedItem("BaseDegreesPerTile")&&(C=parseFloat(e.attributes.getNamedItem("BaseDegreesPerTile").nodeValue));var A=!1;null!=e.attributes.getNamedItem("BottomsUp")&&(A=t.ss.boolean(e.attributes.getNamedItem("BottomsUp").nodeValue));var L="";null!=e.attributes.getNamedItem("QuadTreeMap")&&(L=e.attributes.getNamedItem("QuadTreeMap").nodeValue);var I=0;null!=e.attributes.getNamedItem("CenterX")&&(I=parseFloat(e.attributes.getNamedItem("CenterX").nodeValue));var k=0;null!=e.attributes.getNamedItem("CenterY")&&(k=parseFloat(e.attributes.getNamedItem("CenterY").nodeValue));var P=0;null!=e.attributes.getNamedItem("Rotation")&&(P=parseFloat(e.attributes.getNamedItem("Rotation").nodeValue));var R=!1;return null!=e.attributes.getNamedItem("Sparse")&&(R=t.ss.boolean(e.attributes.getNamedItem("Sparse").nodeValue)),Co.create(S,x,r,n,i,Math.abs(a.getHashCode(x)),T,M,256,C,l,A,L,I,k,P,R,h,c,_,o,f,m,p,b,d,g,v,y)}catch(t){return null}},Co.saveToXml=function(e,i,n){e._writeStartElement("ImageSet"),e._writeAttributeString("Generic",i.get_generic().toString()),e._writeAttributeString("DataSetType",s.toXml("ImageSetType",i.get_dataSetType())),e._writeAttributeString("BandPass",s.toXml("BandPass",i.get_bandPass())),i.get_generic()||(e._writeAttributeString("Name",i.get_name()),t.ss.emptyString(n)?e._writeAttributeString("Url",i.get_url()):e._writeAttributeString("Url",n),e._writeAttributeString("DemUrl",i.get_demUrl()),e._writeAttributeString("BaseTileLevel",i.get_baseLevel().toString()),e._writeAttributeString("TileLevels",i.get_levels().toString()),e._writeAttributeString("BaseDegreesPerTile",i.get_baseTileDegrees().toString()),e._writeAttributeString("FileType",i.get_extension()),e._writeAttributeString("BottomsUp",i.get_bottomsUp().toString()),e._writeAttributeString("Projection",s.toXml("ProjectionType",i.get_projection())),e._writeAttributeString("QuadTreeMap",i.get_quadTreeTileMap()),e._writeAttributeString("CenterX",i.get_centerX().toString()),e._writeAttributeString("CenterY",i.get_centerY().toString()),e._writeAttributeString("OffsetX",i.get_offsetX().toString()),e._writeAttributeString("OffsetY",i.get_offsetY().toString()),e._writeAttributeString("Rotation",i.get_rotation().toString()),e._writeAttributeString("Sparse",i.get_sparse().toString()),e._writeAttributeString("ElevationModel",i.get_elevationModel().toString()),e._writeAttributeString("StockSet",i.get_defaultSet().toString()),e._writeAttributeString("WidthFactor",i.get_widthFactor().toString()),e._writeAttributeString("MeanRadius",i.get_meanRadius().toString()),e._writeAttributeString("ReferenceFrame",i.get_referenceFrame()),t.ss.emptyString(n)?e._writeElementString("ThumbnailUrl",i.get_thumbnailUrl()):e._writeElementString("ThumbnailUrl",i.get_url())),e._writeEndElement()},Co.createGeneric=function(t,e){var i=new Co;return i._generic=!0,i._name="Generic",i._sparse=!1,i._dataSetType=t,i._bandPass=e,i._quadTreeTileMap="",i.url="",i._levels=0,i._baseTileDegrees=0,i._imageSetID=0,i._extension="",i._projection=1,i._bottomsUp=!1,i._baseLevel=0,i._mercator=!i._projection,i._centerX=0,i._centerY=0,i._rotation=0,i._thumbnailUrl="",i._matrix=yn.get_identity(),i._matrix._multiply(yn._rotationX(i.get_rotation()/180*Math.PI)),i._matrix._multiply(yn._rotationZ(i.get_centerY()/180*Math.PI)),i._matrix._multiply(yn._rotationY((360-i.get_centerX()+180)/180*Math.PI)),i},Co.create=function(t,e,i,n,r,s,a,o,l,h,u,c,_,d,g,f,m,p,w,b,v,y,S,x,T,M,C,A,L){var I=new Co;return I.setInitialParameters(t,e,i,n,r,s,a,o,h,u,c,_,d,g,f,m,p,w,b,v,y,S,x,T,M,C,A,L),I};var Ao={get_wcsImage:function(){return this._wcsImage},set_wcsImage:function(t){return this._wcsImage=t,t},get_projection:function(){return this._projection},set_projection:function(t){return this._projection=t,t},get_referenceFrame:function(){return this._referenceFrame},set_referenceFrame:function(t){return this._referenceFrame=t,t},get_imageSetID:function(){return this._imageSetID},set_imageSetID:function(t){return this._imageSetID=t,t},get_baseTileDegrees:function(){return this._baseTileDegrees},set_baseTileDegrees:function(t){return this._baseTileDegrees=t,t},get_widthFactor:function(){return this._widthFactor},set_widthFactor:function(t){return this._widthFactor=t,t},getHashCode:function(){return a.getHashCode(this.get_url())},get_url:function(){return this.url},set_url:function(t){return this.url=t,t},get_demUrl:function(){return!t.ss.emptyString(this.demUrl)||this._projection||Mr?this.demUrl:zr.singleton.coreStaticUrl("wwtweb/BingDemTile.aspx?Q={0},{1},{2}")},set_demUrl:function(t){return this.demUrl=t,t},get_extension:function(){return this._extension},set_extension:function(t){return this._extension=t,t},get_levels:function(){return this._levels},set_levels:function(t){return this._levels=t,t},get_bottomsUp:function(){return this._bottomsUp},set_bottomsUp:function(t){return this._bottomsUp=t,t},get_mercator:function(){return this._mercator},set_mercator:function(t){return this._mercator=t,t},get_baseLevel:function(){return this._baseLevel},set_baseLevel:function(t){return this._baseLevel=t,t},get_quadTreeTileMap:function(){return this._quadTreeTileMap},set_quadTreeTileMap:function(t){return this._quadTreeTileMap=t,t},get_centerX:function(){return this._centerX},set_centerX:function(t){return this._centerX!==t&&(this._centerX=t,this._computeMatrix()),t},get_centerY:function(){return this._centerY},set_centerY:function(t){return this._centerY!==t&&(this._centerY=t,this._computeMatrix()),t},get_rotation:function(){return this._rotation},set_rotation:function(t){return this._rotation!==t&&(this._rotation=t,this._computeMatrix()),t},get_meanRadius:function(){return this._meanRadius},set_meanRadius:function(t){return this._meanRadius=t,t},get_bandPass:function(){return this._bandPass},set_bandPass:function(t){return this._bandPass=t,t},get_dataSetType:function(){return this._dataSetType},set_dataSetType:function(t){return this._dataSetType=t,t},get_altUrl:function(){return this._altUrl},set_altUrl:function(t){return this._altUrl=t,t},get_singleImage:function(){return this._singleImage},set_singleImage:function(t){return this._singleImage=t,t},get_hipsProperties:function(){return this._hipsProperties},set_hipsProperties:function(t){return this._hipsProperties=t,t},get_fitsProperties:function(){return this._fitsProperties},set_fitsProperties:function(t){return this._fitsProperties=t,t},toString:function(){return this.get_defaultSet()?this._name+" *":this._name},get_stockImageSet:function(){return this._generic||!this._defaultSet?this:Co.createGeneric(this.get_dataSetType(),this.get_bandPass())},equals:function(e){if(null==e)return!1;if(!t.ss.canCast(e,Co))return!1;var i=e;return a.getHashCode(i.get_url())===a.getHashCode(this.get_url())&&i.get_dataSetType()===this.get_dataSetType()&&i.get_bandPass()===this.get_bandPass()&&i.get_generic()===this.get_generic()},get_matrix:function(){return this._matrixComputed||this._computeMatrix(),this._matrix},set_matrix:function(t){return this._matrix=t,t},_computeMatrix:function(){this._matrixComputed=!0,this._matrix=yn.get_identity(),this._matrix._multiply(yn._rotationX(this.get_rotation()/180*Math.PI)),this._matrix._multiply(yn._rotationZ(this.get_centerY()/180*Math.PI)),this._matrix._multiply(yn._rotationY((360-this.get_centerX())/180*Math.PI))},get_name:function(){return this._name},set_name:function(t){return this._name=t,t},get_sparse:function(){return this._sparse},set_sparse:function(t){return this._sparse=t,t},get_thumbnailUrl:function(){return this._thumbnailUrl},set_thumbnailUrl:function(t){return this._thumbnailUrl=t,t},get_generic:function(){return this._generic},set_generic:function(t){return this._generic=t,t},get_elevationModel:function(){return this._elevationModel},set_elevationModel:function(t){return this._elevationModel=t,t},get_defaultSet:function(){return this._defaultSet},set_defaultSet:function(t){return this._defaultSet=t,t},get_offsetX:function(){return this._offsetX},set_offsetX:function(t){return this._offsetX=t,t},get_offsetY:function(){return this._offsetY},set_offsetY:function(t){return this._offsetY=t,t},get_creditsText:function(){return this._creditsText},set_creditsText:function(t){return this._creditsText=t,t},get_creditsUrl:function(){return this._creditsUrl},set_creditsUrl:function(t){return this._creditsUrl=t,t},get_isMandelbrot:function(){return!1},_calcViewCenterCoordinate:function(t){var e=Qs.degreesToRadians(this._rotation),i=Math.cos(e),n=Math.sin(e),r=0,s=0;return this.get_levels()>0?(r=-this._offsetX,s=this._offsetY):(r=(this._offsetX-400)*this._baseTileDegrees,s=(400-this._offsetY)*this._baseTileDegrees),this._bottomsUp&&(r=-r),t?this._centerX+r*i+s*n:this._centerY-r*n+s*i},get_viewCenterX:function(){return null!=this.get_wcsImage()?this.get_wcsImage().get_viewCenterX():this._calcViewCenterCoordinate(!0)},get_viewCenterY:function(){return null!=this.get_wcsImage()?this.get_wcsImage().get_viewCenterY():this._calcViewCenterCoordinate(!1)},setInitialParameters:function(t,e,i,n,r,s,a,o,l,h,u,c,_,d,g,f,m,p,w,b,v,y,S,x,T,M,C,A){this.set_referenceFrame(A),this.set_meanRadius(C),this._altUrl=M,this.demUrl=T,this._creditsText=S,this._creditsUrl=x,this._offsetY=y,this._offsetX=v,this._widthFactor=b,this._elevationModel=w,this._defaultSet=p,this._name=t,this._sparse=f,this._dataSetType=i,this._bandPass=n,this._quadTreeTileMap=c,this.url=e,this._levels=o,this._baseTileDegrees=l,this._imageSetID=s,this._extension=h,this._projection=r,this._bottomsUp=u,this._baseLevel=a,this._mercator=!r,this._centerX=_,this._centerY=d,this._rotation=g,this._thumbnailUrl=m,this._computeMatrix()},_guessZoomSetting:function(e){var i=e,n=t.ss.safeCast(this._wcsImage,Ga);return this.get_projection()===xo.skyImage?null!=n&&(i=this.get_baseTileDegrees()*n.get_sizeY()*6*1.7):i=null!=n?n.get_scaleY()*n.get_sizeY()*6*1.7:6*this.get_baseTileDegrees()*1.7,i>e&&(i=e),i},get_thumbnail:function(){return this._thumbnail},set_thumbnail:function(t){return this._thumbnail=t,t},get_bounds:function(){return this._bounds},set_bounds:function(t){return this._bounds=t,t},get_isImage:function(){return!0},get_isTour:function(){return!1},get_isFolder:function(){return!1},get_isCloudCommunityItem:function(){return!1},get_readOnly:function(){return!1},get_children:function(){return[]}};n("Imageset",[Co,Ao,null,ua]);var Lo={empty:0,equatorialGrid:1,equatorialGridText:2,galacticGrid:3,galacticGridText:4,eclipticGrid:5,eclipticGridText:6,eclipticOverview:7,eclipticOverviewText:8,precessionChart:9,altAzGrid:10,altAzGridText:11,constellationFigures:12,constellationBoundaries:13,constellationFocusedOnly:14,constellationNames:15,constellationPictures:16,fadeToBlack:17,fadeToLogo:18,fadeToGradient:19,screenBroadcast:20,fadeRemoteOnly:21,skyGrids:22,constellations:23,solarSystemStars:24,solarSystemMilkyWay:25,solarSystemCosmos:26,solarSystemOrbits:27,solarSystemPlanets:28,solarSystemAsteroids:29,solarSystemLighting:30,solarSystemMinorOrbits:31,showEarthCloudLayer:32,showElevationModel:33,showAtmosphere:34,multiResSolarSystemBodies:35,auroraBorialis:36,earthCutAway:37,showSolarSystem:38,clouds8k:39,filedOfView:40,showISSModel:41,solarSystemCMB:42,mpcZone1:43,mpcZone2:44,mpcZone3:45,mpcZone4:46,mpcZone5:47,mpcZone6:48,mpcZone7:49,orbitFilters:50};function Io(t,e,i,n){this.targetState=!1,this.edgeTrigger=!1,this.opacity=0,this.edgeTrigger=t,this.opacity=e,this.targetState=i,this.filter=n}function ko(){this.autoRepeatTour=!1,this._localHorizonMode=!1,this._galacticMode=!1,this._constellationBoundryColor="blue",this._constellationSelectionColor="yellow",this._constellationFigureColor="red",this._showConstellationFigures=!0,this._showConstellationBoundries=!0,this._showConstellationSelection=!0,this._showCrosshairs=!0,this._crosshairsColor="white",this._showEcliptic=!1,this._locationLat=47.717,this._locationLng=-122.0858,this._locationAltitude=100,this._showFiledOfView=!1,this._actualPlanetScale=!0,this._fovCamera=0,this._fovEyepiece=0,this._fovTelescope=0,this._showClouds=!1,this._showGrid=!1,this._showHorizon=!0,this._showHorizonPanorama=!1,this._showMoonsAsPointSource=!0,this._showSolarSystem=!0,this._solarSystemStars=!0,this._solarSystemMilkyWay=!0,this._solarSystemCosmos=!0,this._solarSystemOrbits=!0,this._solarSystemOverlays=!0,this._solarSystemLighting=!0,this._solarSystemMultiRes=!0,this._solarSystemScale=1,this._smoothPan=!0,this._showElevationModel=!0,this._showEquatorialGridText=!1,this._showGalacticGrid=!1,this._showGalacticGridText=!1,this._showEclipticGrid=!1,this._showEclipticGridText=!1,this._showEclipticOverviewText=!1,this._showAltAzGrid=!1,this._eclipticGridColor=Xi.get_green(),this._galacticGridColor=Xi.get_cyan(),this._altAzGridColor=Xi.get_magenta(),this._precessionChartColor=Xi.get_orange(),this._eclipticColor=Xi.get_blue(),this._equatorialGridColor=Xi.get_white(),this._showAltAzGridText=!1,this._showPrecessionChart=!1,this._showConstellationPictures=!1,this._showConstellationLabels=!1,this._constellationLabelsHeight=80,this._solarSystemCMB=!0,this._solarSystemMinorPlanets=!1,this._solarSystemPlanets=!0,this._showEarthSky=!0,this._solarSystemMinorOrbits=!1,this._constellationsEnabled="",this._constellationFiguresFilter=new Ia,this._constellationBoundariesFilter=new Ia,this._constellationNamesFilter=new Ia,this._constellationArtFilter=new Ia,this._showSkyOverlays=!0,this._showConstellations=!0,this._showSkyNode=!0,this._showSkyGrids=!0,this._showSkyOverlaysIn3d=!0,this._earthCutawayView=!1,this._showISSModel=!1,this._milkyWayModel=!1,this._minorPlanetsFilter=255,this._planetOrbitsFilter=2147483647,this._constellations=!0}n("StockSkyOverlayTypes",Lo),r("StockSkyOverlayTypes",Lo),n("SettingParameter",[Io,{},null]),ko._active=null,ko.tourSettings=null,ko.get_current=function(){return null==ko._active&&(ko._active=new ko),ko._active},ko.get_globalSettings=function(){return null==ko._active&&(ko._active=new ko),ko._active},ko.get_active=function(){return null==ko._active&&(ko._active=new ko),null!=ko.tourSettings?ko.tourSettings:ko._active};var Po={get_constellationFigureColor:function(){return this._constellationFigureColor},set_constellationFigureColor:function(t){return this._constellationFigureColor=t,t},get_constellationBoundryColor:function(){return this._constellationBoundryColor},set_constellationBoundryColor:function(t){return this._constellationBoundryColor=t,t},get_constellationSelectionColor:function(){return this._constellationSelectionColor},set_constellationSelectionColor:function(t){return this._constellationSelectionColor=t,t},get_showCrosshairs:function(){return this._showCrosshairs},set_showCrosshairs:function(t){return this._showCrosshairs=t,t},get_smoothPan:function(){return this._smoothPan},set_smoothPan:function(t){return this._smoothPan=t,t},get_crosshairsColor:function(){return this._crosshairsColor},set_crosshairsColor:function(t){return this._crosshairsColor=t,t},get_actualPlanetScale:function(){return this._actualPlanetScale},set_actualPlanetScale:function(t){return this._actualPlanetScale=t,t},get_fovCamera:function(){return this._fovCamera},get_fovEyepiece:function(){return this._fovEyepiece},get_fovTelescope:function(){return this._fovTelescope},get_locationAltitude:function(){return this._locationAltitude},set_locationAltitude:function(t){return this._locationAltitude=t,t},get_locationLat:function(){return this._locationLat},set_locationLat:function(t){return this._locationLat=t,t},get_locationLng:function(){return this._locationLng},set_locationLng:function(t){return this._locationLng=t,t},get_showClouds:function(){return this._showClouds},get_showConstellationBoundries:function(){return this._showConstellationBoundries},set_showConstellationBoundries:function(t){return this._showConstellationBoundries=t,t},get_showConstellationFigures:function(){return this._showConstellationFigures},set_showConstellationFigures:function(t){return this._showConstellationFigures=t,t},get_showConstellationSelection:function(){return this._showConstellationSelection},set_showConstellationSelection:function(t){return this._showConstellationSelection=t,t},get_showEcliptic:function(){return this._showEcliptic},set_showEcliptic:function(t){return this._showEcliptic=t,t},get_showElevationModel:function(){return this._showElevationModel},set_showElevationModel:function(t){return this._showElevationModel=t,t},get_showFieldOfView:function(){return this._showFiledOfView},get_showGrid:function(){return this._showGrid},set_showGrid:function(t){return this._showGrid=t,t},get_showHorizon:function(){return this._showHorizon},set_showHorizon:function(t){return this._showHorizon=t,t},get_showHorizonPanorama:function(){return this._showHorizonPanorama},get_showMoonsAsPointSource:function(){return this._showMoonsAsPointSource},get_showSolarSystem:function(){return this._showSolarSystem},set_showSolarSystem:function(t){return this._showSolarSystem=t,t},get_localHorizonMode:function(){return this._localHorizonMode},set_localHorizonMode:function(t){return this._localHorizonMode=t,t},get_galacticMode:function(){return this._galacticMode},set_galacticMode:function(t){return this._galacticMode=t,t},get_solarSystemStars:function(){return this._solarSystemStars},set_solarSystemStars:function(t){return this._solarSystemStars=t,t},get_solarSystemMilkyWay:function(){return this._solarSystemMilkyWay},set_solarSystemMilkyWay:function(t){return this._solarSystemMilkyWay=t,t},get_solarSystemCosmos:function(){return this._solarSystemCosmos},set_solarSystemCosmos:function(t){return this._solarSystemCosmos=t,t},get_solarSystemOrbits:function(){return this._solarSystemOrbits},set_solarSystemOrbits:function(t){return this._solarSystemOrbits=t,t},get_solarSystemOverlays:function(){return this._solarSystemOverlays},set_solarSystemOverlays:function(t){return this._solarSystemOverlays=t,t},get_solarSystemLighting:function(){return this._solarSystemLighting},set_solarSystemLighting:function(t){return this._solarSystemLighting=t,t},get_solarSystemMultiRes:function(){return!0},set_solarSystemMultiRes:function(t){return this._solarSystemMultiRes=t,t},get_solarSystemScale:function(){return this._solarSystemScale},set_solarSystemScale:function(t){return this._solarSystemScale=t,t},get_showEquatorialGridText:function(){return this._showEquatorialGridText},set_showEquatorialGridText:function(t){return this._showEquatorialGridText=t,t},get_showGalacticGrid:function(){return this._showGalacticGrid},set_showGalacticGrid:function(t){return this._showGalacticGrid=t,t},get_showGalacticGridText:function(){return this._showGalacticGridText},set_showGalacticGridText:function(t){return this._showGalacticGridText=t,t},get_showEclipticGrid:function(){return this._showEclipticGrid},set_showEclipticGrid:function(t){return this._showEclipticGrid=t,t},get_showEclipticGridText:function(){return this._showEclipticGridText},set_showEclipticGridText:function(t){return this._showEclipticGridText=t,t},get_showEclipticOverviewText:function(){return this._showEclipticOverviewText},set_showEclipticOverviewText:function(t){return this._showEclipticOverviewText=t,t},get_showAltAzGrid:function(){return this._showAltAzGrid},set_showAltAzGrid:function(t){return this._showAltAzGrid=t,t},get_eclipticGridColor:function(){return this._eclipticGridColor},set_eclipticGridColor:function(t){return this._eclipticGridColor=t,t},get_galacticGridColor:function(){return this._galacticGridColor},set_galacticGridColor:function(t){return this._galacticGridColor=t,t},get_altAzGridColor:function(){return this._altAzGridColor},set_altAzGridColor:function(t){return this._altAzGridColor=t,t},get_precessionChartColor:function(){return this._precessionChartColor},set_precessionChartColor:function(t){return this._precessionChartColor=t,t},get_eclipticColor:function(){return this._eclipticColor},set_eclipticColor:function(t){return this._eclipticColor=t,t},get_equatorialGridColor:function(){return this._equatorialGridColor},set_equatorialGridColor:function(t){return this._equatorialGridColor=t,t},get_showAltAzGridText:function(){return this._showAltAzGridText},set_showAltAzGridText:function(t){return this._showAltAzGridText=t,t},get_showPrecessionChart:function(){return this._showPrecessionChart},set_showPrecessionChart:function(t){return this._showPrecessionChart=t,t},get_showConstellationPictures:function(){return this._showConstellationPictures},set_showConstellationPictures:function(t){return this._showConstellationPictures=t,t},get_showConstellationLabels:function(){return this._showConstellationLabels},set_showConstellationLabels:function(t){return this._showConstellationLabels=t,t},get_constellationLabelsHeight:function(){return this._constellationLabelsHeight},set_constellationLabelsHeight:function(t){return this._constellationLabelsHeight=t,t},get_solarSystemCMB:function(){return this._solarSystemCMB},set_solarSystemCMB:function(t){return this._solarSystemCMB=t,t},get_solarSystemMinorPlanets:function(){return this._solarSystemMinorPlanets},set_solarSystemMinorPlanets:function(t){return this._solarSystemMinorPlanets=t,t},get_solarSystemPlanets:function(){return this._solarSystemPlanets},set_solarSystemPlanets:function(t){return this._solarSystemPlanets=t,t},get_showEarthSky:function(){return this._showEarthSky},set_showEarthSky:function(t){return this._showEarthSky=t,t},get_solarSystemMinorOrbits:function(){return this._solarSystemMinorOrbits},set_solarSystemMinorOrbits:function(t){return this._solarSystemMinorOrbits=t,t},get_constellationsEnabled:function(){return this._constellationsEnabled},set_constellationsEnabled:function(t){return this._constellationsEnabled=t,t},get_constellationFiguresFilter:function(){return this._constellationFiguresFilter},set_constellationFiguresFilter:function(t){return this._constellationFiguresFilter=t,t},get_constellationBoundariesFilter:function(){return this._constellationBoundariesFilter},set_constellationBoundariesFilter:function(t){return this._constellationBoundariesFilter=t,t},get_constellationNamesFilter:function(){return this._constellationNamesFilter},set_constellationNamesFilter:function(t){return this._constellationNamesFilter=t,t},get_constellationArtFilter:function(){return this._constellationArtFilter},set_constellationArtFilter:function(t){return this._constellationArtFilter=t,t},get_showSkyOverlays:function(){return this._showSkyOverlays},set_showSkyOverlays:function(t){return this._showSkyOverlays=t,t},get_showConstellations:function(){return this._showConstellations},set_showConstellations:function(t){return this._showConstellations=t,t},get_showSkyNode:function(){return this._showSkyNode},set_showSkyNode:function(t){return this._showSkyNode=t,t},get_showSkyGrids:function(){return this._showSkyGrids},set_showSkyGrids:function(t){return this._showSkyGrids=t,t},get_showSkyOverlaysIn3d:function(){return this._showSkyOverlaysIn3d},set_showSkyOverlaysIn3d:function(t){return this._showSkyOverlaysIn3d=t,t},get_earthCutawayView:function(){return this._earthCutawayView},set_earthCutawayView:function(t){return this._earthCutawayView=t,t},get_showISSModel:function(){return this._showISSModel},set_showISSModel:function(t){return this._showISSModel=t,t},get_milkyWayModel:function(){return this._milkyWayModel},set_milkyWayModel:function(t){return this._milkyWayModel=t,t},get_minorPlanetsFilter:function(){return this._minorPlanetsFilter},set_minorPlanetsFilter:function(t){return this._minorPlanetsFilter=t,t},get_planetOrbitsFilter:function(){return this._planetOrbitsFilter},set_planetOrbitsFilter:function(t){return this._planetOrbitsFilter=t,t},get_constellations:function(){return this._constellations},set_constellations:function(t){return this._constellations=t,t},getSetting:function(t){return 17===t?new Io(!0,0,!1,null):new Io(!1,1,!1,null)}};n("Settings",[ko,Po,null,fa]);var Ro={none:0,tight:1,small:2,medium:3,large:4};function Eo(){this.bold=!1,this.italic=!1,this.underline=!1,this.fontSize=0,this.borderStyle=0}n("TextBorderStyle",Ro),r("TextBorderStyle",Ro),Eo.create=function(t,e,i,n,r,s,a,o,l){var h=new Eo;return h.text=t,h.bold=e,h.italic=i,h.underline=n,h.fontSize=r,h.fontName=s,h.foregroundColor=a,h.backgroundColor=o,h.borderStyle=l,h},Eo._fromXml=function(e){var i=new Eo;return i.text=a.getInnerText(e),i.borderStyle=0,i.bold=t.ss.boolean(e.attributes.getNamedItem("Bold").nodeValue),i.italic=t.ss.boolean(e.attributes.getNamedItem("Italic").nodeValue),i.underline=t.ss.boolean(e.attributes.getNamedItem("Underline").nodeValue),i.fontSize=parseFloat(e.attributes.getNamedItem("FontSize").nodeValue),i.fontName=e.attributes.getNamedItem("FontName").nodeValue,i.foregroundColor=Oi.load(e.attributes.getNamedItem("ForgroundColor").nodeValue),i.backgroundColor=Oi.load(e.attributes.getNamedItem("BackgroundColor").nodeValue),null!=e.attributes.getNamedItem("BorderStyle")&&(i.borderStyle=s.parse("TextBorderStyle",e.attributes.getNamedItem("BorderStyle").nodeValue)),i},n("TextObject",[Eo,{toString:function(){return this.text},_saveToXml:function(t){t._writeStartElement("TextObject"),t._writeAttributeString("Bold",this.bold.toString()),t._writeAttributeString("Italic",this.italic.toString()),t._writeAttributeString("Underline",this.underline.toString()),t._writeAttributeString("FontSize",this.fontSize.toString()),t._writeAttributeString("FontName",this.fontName),t._writeAttributeString("ForgroundColor",this.foregroundColor.save()),t._writeAttributeString("BackgroundColor",this.backgroundColor.save()),t._writeAttributeString("BorderStyle",s.toXml("TextBorderStyle",this.borderStyle)),t._writeString(this.text),t._writeEndElement()}},null]);var Do={center:0,left:1};function Fo(t){this.height=128,this.items=[],this._glyphVersion=-1,this.viewTransform=yn.get_identity(),this._textObject=new Eo,this._vertCount=0,this.height=3*t}n("Alignment",Do),r("Alignment",Do);var No={add:function(t){this.items.push(t)},draw:function(e,i,n){if(null==e.gl)for(var r=wn._transformCoordinate(e.get_viewPoint(),this.viewTransform),s=this.height/e.get_fovAngle()*e.height/180,a=t.ss.enumerate(this.items);a.moveNext();){var o=a.current,l=e.WVP.transform(o.center);if(!(l.z<0||wn.dot(r,o.center)<.55)){var h=e.WVP.transform(o.top),u=Math.atan2(l.x-h.x,l.y-h.y),c=e.device;c.save(),c.translate(l.x,l.y),c.rotate(-u),c.globalAlpha=i,c.fillStyle=n.toString(),c.font="normal normal "+Math.round(1.2*s).toString()+"px Arial",c.textBaseline="top";var _=c.measureText(o.text);c.fillText(o.text,-_.width/2,-s/2),c.restore()}}else{if((null==this._glyphCache||this._glyphCache.get_version()>this._glyphVersion)&&this.prepareBatch(),!this._glyphCache.ready)return;xs.use(e,this._vertexBuffer.vertexBuffer,this._glyphCache.get_texture().texture2d),e.gl.drawArrays(Yr.TRIANGLES,0,this._vertexBuffer.count)}},prepareBatch:function(){if(null==this._glyphCache&&(this._glyphCache=zo.getCache(this.height)),this._glyphCache.ready){this._textObject.text="",this._textObject.fontSize=.5*this.height;for(var e=[],i=t.ss.enumerate(this.items);i.moveNext();){for(var n=i.current,r=n.text,s=0,a=this._textObject.fontSize/128,o=.6666,l=0,h=0,u=0;u<r.length;u++)null!=(d=this._glyphCache.getGlyphItem(r.substr(u,1)))&&(l+=d.extents.x,h=Math.max(d.extents.y,h));var c=vn.create(l,h);n.width=c.x*n.scale*o*a,n.height=c.y*n.scale*o*a;var _=r.length;for(u=0;u<_;u++){var d;if(null!=(d=this._glyphCache.getGlyphItem(r.substr(u,1)))){var g=Ai.create(s*n.scale*o,0*n.scale*o,d.extents.x*a*n.scale*o,d.extents.y*a*n.scale*o);s+=d.extents.x*a,n.addGlyphPoints(e,d.size,g,d.uvRect)}}}this._vertCount=e.length,this._vertexBuffer=new Kr(this._vertCount);var f=this._vertexBuffer.lock();for(u=0;u<this._vertCount;u++)f[u]=e[u];this._vertexBuffer.unlock(),this._glyphVersion=this._glyphCache.get_version()}},cleanUp:function(){null!=this._vertexBuffer&&(this._vertexBuffer=null),this.items.length=0}};function $o(t){this.referenceCount=0,this.glyph=t,this.uvRect=new Ai,this.size=new vn,this.referenceCount=1}function zo(e){this._cellHeight=128,this._gridSize=8,this.ready=!1,this._glyphItems={},this.textObject=new Eo,this._dirty=!0,this._textureDirty=!0,this._version=0,this._cellHeight=e,this._texture=rs.fromUrl(zr.singleton.engineAssetUrl("glyphs1.png")),this._webFile=new $a(zr.singleton.engineAssetUrl("glyphs1.xml")),this._webFile.onStateChange=t.ss.bind("_glyphXmlReady",this),this._webFile.send()}n("Text3dBatch",[Fo,No,null]),$o.create=function(t,e,i,n){var r=new $o(t);return r.glyph=t,r.uvRect=e,r.size=i,r.extents=n,r.referenceCount=1,r},$o._fromXML=function(t){var e=new $o(t.attributes.getNamedItem("Glyph").nodeValue);return e.uvRect=Ai.create(parseFloat(t.attributes.getNamedItem("UVLeft").nodeValue),parseFloat(t.attributes.getNamedItem("UVTop").nodeValue),parseFloat(t.attributes.getNamedItem("UVWidth").nodeValue),parseFloat(t.attributes.getNamedItem("UVHeight").nodeValue)),e.size=vn.create(parseFloat(t.attributes.getNamedItem("SizeWidth").nodeValue),parseFloat(t.attributes.getNamedItem("SizeHeight").nodeValue)),e.extents=vn.create(parseFloat(t.attributes.getNamedItem("ExtentsWidth").nodeValue),parseFloat(t.attributes.getNamedItem("ExtentsHeight").nodeValue)),e},n("GlyphItem",[$o,{addRef:function(){this.referenceCount++},release:function(){this.referenceCount--}},null]),zo._caches={},zo._allGlyphs="",zo.getCache=function(e){return t.ss.keyExists(zo._caches,e)||(zo._caches[e]=new zo(e)),zo._caches[e]},zo.cleanUpAll=function(){t.ss.clearKeys(zo._caches)};var Bo={get_height:function(){return this._cellHeight},_glyphXmlReady:function(){2===this._webFile.get_state()?alert(this._webFile.get_message()):1===this._webFile.get_state()&&this._loadXmlGlyph(this._webFile.getXml())},_loadXmlGlyph:function(e){for(var i=a.selectSingleNode(e,"GlyphItems"),n=t.ss.enumerate(i.childNodes);n.moveNext();){var r=n.current;if("GlyphItem"===r.nodeName){var s=$o._fromXML(r);this._glyphItems[s.glyph]=s,zo._allGlyphs=zo._allGlyphs+s.glyph}}this.ready=!0},get_texture:function(){return this._texture},_makeTexture:function(){this._calcOrMake(!0)},getGlyphItem:function(t){return this._dirty&&this._calculateGlyphDetails(),this._glyphItems[t]},_calculateGlyphDetails:function(){this._calcOrMake(!1)},_calcOrMake:function(t){},get_version:function(){return this._version},set_version:function(t){return this._version=t,t},addGlyph:function(e){if(t.ss.keyExists(this._glyphItems,e))this._glyphItems[e].addRef();else{var i=new $o(e);this._glyphItems[e]=i,this._dirty=!0,this._textureDirty=!0,this._version++,zo._allGlyphs=zo._allGlyphs+e}},cleanUp:function(){this._dirty=!0,this._texture=null},dispose:function(){this.cleanUp()},get_dirty:function(){return this._dirty},set_dirty:function(t){return this._dirty=t,t}};function Uo(t,e,i,n,r){this.rotation=0,this.tilt=0,this.bank=0,this._matInit=!1,this.color=Xi.get_white(),this.sky=!0,this.scale=0,this.opacity=1,this.text="",this.width=1,this.height=1,this.alignment=0,this.text=i,this.up=e,this.center=t,this.scale=r,this.top=wn.addVectors(t,wn.scale(e,r)),n<0&&(this.sky=!1)}n("GlyphCache",[zo,Bo,null,t.ss.IDisposable]);var Vo={addGlyphPoints:function(e,i,n,r){for(var s=new Array(6),a=0;a<6;a++)s[a]=new cn;var o=wn.cross(this.center,this.up),l=wn.cross(this.up,this.center);o.normalize(),l.normalize(),this.up.normalize();var h=wn.cross(this.center,l);h.normalize(),this.alignment?1===this.alignment&&(o.multiply(2*-n.get_left()),l.multiply(2*n.get_right())):(o.multiply(this.width-2*n.get_left()),l.multiply(this.width-(2*this.width-2*n.get_right())));var u=h.copy(),c=wn.subtractVectors(wn.get_empty(),h);u.multiply(this.height-2*n.get_top()),c.multiply(this.height-(2*this.height-2*n.get_bottom()));var _=this.center.copy();_.add(u),this.sky?_.add(o):_.subtract(o);var d=this.center.copy();d.add(u),this.sky?d.add(l):d.subtract(l);var g=this.center.copy();this.sky?g.add(o):g.subtract(o),g.add(c);var f=this.center.copy();if(this.sky?f.add(l):f.subtract(l),f.add(c),s[0].position=_.copy(),s[0].tu=r.get_left(),s[0].tv=r.get_top(),s[2].tu=r.get_left(),s[2].tv=r.get_bottom(),s[2].position=g.copy(),s[1].tu=r.get_right(),s[1].tv=r.get_top(),s[1].position=d.copy(),s[3].tu=r.get_right(),s[3].tv=r.get_bottom(),s[3].position=f.copy(),s[5].tu=r.get_right(),s[5].tv=r.get_top(),s[5].position=d.copy(),s[4].tu=r.get_left(),s[4].tv=r.get_bottom(),s[4].position=g.copy(),this.rotation||this.tilt||this.bank){if(!this._matInit){var m=yn.lookAtLH(this.center,new wn,this.up),p=m.clone();p.invert(),this._rtbMat=yn.multiplyMatrix(yn.multiplyMatrix(yn.multiplyMatrix(yn.multiplyMatrix(m,yn._rotationZ(-this.rotation/180*Math.PI)),yn._rotationX(-this.tilt/180*Math.PI)),yn._rotationY(-this.bank/180*Math.PI)),p),this._matInit=!0}for(a=0;a<6;a++)s[a].position=wn._transformCoordinate(s[a].position,this._rtbMat)}for(var w=t.ss.enumerate(s);w.moveNext();){var b=w.current;e.push(b)}}};n("Text3d",[Uo,Vo,null]);var Oo={move:0,line:1,dash:2,start:3};function Go(t){this._name=t,this.points=[]}n("PointType",Oo),r("PointType",Oo);var Xo={get_name:function(){return this._name},set_name:function(t){return this._name=t,t},add:function(t,e,i,n){this.points.push(new Ho(t,e,i,n))}};function Ho(t,e,i,n){this.RA=0,this.dec=0,this.pointType=0,this.name=null,this.RA=t,this.dec=e,this.pointType=i,this.name=n}function Yo(){this._pointCount=0,this._boundry=!1,this._noInterpollation=!1,this.readOnly=!1,this.radius=1,this._drawCount=0,this._constellationVertexBuffers={}}n("Lineset",[Go,Xo,null]),n("Linepoint",[Ho,{toString:function(){return t.ss.emptyString(this.name)?Qs.formatDMS((this.RA/360*24+12)%24)+", "+Qs.formatDMS(this.dec)+", "+this.pointType.toString():this.name+", "+this.pointType.toString()}},null]),Yo.RC=.017453292519943,Yo._maxSeperation=.745,Yo.containment=null,Yo._constToDraw="",Yo.selectedSegment=null,Yo._artFile=null,Yo.artwork=null,Yo.boundries=null,Yo.pictureBlendStates={},Yo.createBasic=function(e){var i=new Yo;i._name=e,i._url=null,i.lines=[];for(var n=t.ss.enumerate(t.ss.keys(Yo.fullNames));n.moveNext();){var r=n.current;i.lines.push(new Go(r))}return i},Yo.create=function(t,e,i,n,r){var s=new Yo;return s._noInterpollation=n,s._boundry=i,s._name=t,s._url=e,s.getFile(),s},Yo.drawConstellationNames=function(t,e,i){null==Yo._namesBatch&&(Yo.initializeConstellationNames(),null==Yo._namesBatch)||Yo._namesBatch.draw(t,e,i)},Yo.initializeConstellationNames=function(){if(null!=Yo.constellationCentroids){Yo._namesBatch=new Fo(ko.get_active().get_constellationLabelsHeight());for(var e=t.ss.enumerate(t.ss.keys(Yo.constellationCentroids));e.moveNext();){var i=e.current,n=Yo.constellationCentroids[i],r=Qs.raDecTo3dAu(n.get_RA(),n.get_dec(),1),s=wn.create(0,1,0),a=n.get_name();"Triangulum Australe"===n.get_name()&&(a=t.ss.replaceString(a," ","\n   ")),Yo._namesBatch.add(new Uo(r,s,a,ko.get_active().get_constellationLabelsHeight(),125e-6))}}},Yo.drawArtwork=function(e){if(null!=Yo.artwork){Yo._maxSeperation=Math.max(.5,Math.cos(2*e.get_fovAngle()/180*Math.PI));for(var i=t.ss.enumerate(Yo.artwork);i.moveNext();){var n=i.current,r=Yo.pictureBlendStates[n.get_constellation()];if(r.set_targetState(ko.get_active().get_constellationArtFilter().isSet(n.get_constellation())),r.get_state()){var s=Yo.constellationCentroids[n.get_constellation()];if(null!=s){var a=Qs.raDecTo3d(s.get_RA(),s.get_dec());wn.dot(e.get_viewPoint(),a)>Yo._maxSeperation&&e.drawImageSet(n.get_studyImageset(),100)}}}}else null==Yo._artFile&&(Yo._artFile=Lr(),Yo._artFile.loadFromUrl(zr.singleton.coreStaticUrl("wwtweb/catalog.aspx?W=hevelius"),Yo._onArtReady))},Yo._onArtReady=function(){Yo._artFile.childLoadCallback(Yo._loadArtList)},Yo._loadArtList=function(){Yo.artwork=Yo._artFile.get_places()},Yo.initializeConstellations=function(){if(null==Yo.containment){var t=zr.singleton.engineAssetUrl("ConstellationNamePositions_EN.txt");Yo._webFileConstNames=new $a(t),Yo._webFileConstNames.onStateChange=Yo._loadNames,Yo._webFileConstNames.send(),Yo.containment=Yo.create("Constellations",zr.singleton.engineAssetUrl("constellations.txt"),!0,!0,!0)}},Yo._loadNames=function(){2===Yo._webFileConstNames.get_state()?alert(Yo._webFileConstNames.get_message()):1===Yo._webFileConstNames.get_state()&&Yo._centroidsReady(Yo._webFileConstNames.getText())},Yo._centroidsReady=function(e){Yo.constellationCentroids={},Yo.fullNames={},Yo.abbreviations={};for(var i=e.split("\r\n"),n=0,r=t.ss.enumerate(i);r.moveNext();){var s=r.current.split(",");Yo.fullNames[s[1]]=s[0],Yo.abbreviations[s[0]]=s[1],Ia.bitIDs[s[1]]=n++,Yo.pictureBlendStates[s[1]]=xr.create(!0,1e3),Yo.constellationCentroids[s[1]]=Ir(s[0],parseFloat(s[3]),parseFloat(s[2]),128,s[1],2,360)}Ia.buildConstellationFilters()},Yo.fullName=function(e){return t.ss.keyExists(Yo.fullNames,e)?Yo.fullNames[e]:e},Yo.abbreviation=function(e){return null!=Yo.abbreviations&&!t.ss.emptyString(e)&&t.ss.keyExists(Yo.abbreviations,e)?Yo.abbreviations[e]:e};var jo={get_name:function(){return this._name},set_name:function(t){return this._name=t,t},getFile:function(){this._webFile=new $a(this._url),this._webFile.onStateChange=t.ss.bind("fileStateChange",this),this._webFile.send()},fileStateChange:function(){2===this._webFile.get_state()?alert(this._webFile.get_message()):1===this._webFile.get_state()&&this._loadConstellationData(this._webFile.getText())},_loadConstellationData:function(e){this._boundry&&!this._noInterpollation&&(Yo.boundries={}),this.lines=[];var i=null;try{for(var n,r,s,a=e.split("\r\n"),o="",l=0,h=0,u=t.ss.enumerate(a);u.moveNext();){var c=u.current;if("- "===c.substr(11,2)&&(c=c.substr(0,11)+" -"+c.substr(13,c.length-13)),"+ "===c.substr(11,2)&&(c=c.substr(0,11)+" +"+c.substr(13,c.length-13)),s=parseFloat(c.substr(11,10)),this._noInterpollation,r=parseFloat(c.substr(0,10)),n=t.ss.trim(c.substr(23,4)),this._boundry){if(this._noInterpollation&&"O"!==c.substr(28,1))continue}else t.ss.trim(c.substr(28,1))&&(h=parseInt(c.substr(28,1)));n!==o&&(h=3,i=new Go(n),this.lines.push(i),this._boundry&&!this._noInterpollation&&(Yo.boundries[n]=i),o=n,l=0),this._noInterpollation&&(Math.abs(r-l)>12&&(r-=24*(r-l<0?-1:1)),l=r);var _=null;c.length>30&&(_=t.ss.trim(c.substr(30))),null!=_&&"Empty"===_||i.add(r,s,h,_),this._pointCount++,h=1}}catch(t){}},draw:function(e,i,n,r){Yo._maxSeperation=Math.max(.6,Math.cos(2*e.get_fovAngle()/180*Math.PI)),this._drawCount=0;var s=null;if(null!=this.lines&&null!=Yo.constellationCentroids){Yo._constToDraw=n;for(var a=t.ss.enumerate(this.lines);a.moveNext();){var o=a.current;Yo._constToDraw===o.get_name()&&this._boundry?s=o:i&&this._boundry||this._drawSingleConstellation(e,o,1)}null!=s&&this._drawSingleConstellation(e,s,1)}},_drawSingleConstellation:function(e,i,n){var r=Yo.constellationCentroids[i.get_name()];if(null!=r){var s=Qs.raDecTo3d(r.get_RA(),r.get_dec());if(wn.dot(e.get_viewPoint(),s)<Yo._maxSeperation)return}if(!t.ss.keyExists(this._constellationVertexBuffers,i.get_name())){var a=i.points.length,o=new Is;o.set_depthBuffered(!1),this._constellationVertexBuffers[i.get_name()]=o;for(var l,h=new wn,u=0;u<a;u++)i.points[u].pointType&&u?(l=Qs.raDecTo3d(i.points[u].RA,i.points[u].dec),o.addLine(h,l),h=l):h=Qs.raDecTo3d(i.points[u].RA,i.points[u].dec);this._boundry&&(l=Qs.raDecTo3d(i.points[0].RA,i.points[0].dec),o.addLine(h,l))}var c;c=this._boundry?Yo._constToDraw!==i.get_name()?ko.get_globalSettings().get_constellationBoundryColor():ko.get_globalSettings().get_constellationSelectionColor():ko.get_globalSettings().get_constellationFigureColor(),this._constellationVertexBuffers[i.get_name()].drawLines(e,n,Oi.load(c))},_drawSingleConstellationOld:function(t,e){var i,n=Yo.constellationCentroids[e.get_name()];if(null!=n){var r=Qs.raDecTo3d(n.get_RA(),n.get_dec());if(wn.dot(t.get_viewPoint(),r)<Yo._maxSeperation)return}if(this._drawCount++,i=this._boundry?Yo._constToDraw!==e.get_name()?ko.get_globalSettings().get_constellationBoundryColor():ko.get_globalSettings().get_constellationSelectionColor():ko.get_globalSettings().get_constellationFigureColor(),null==t.gl){var s=t.device,a=e.points.length,o=new wn;s.save();var l=!1;s.beginPath(),s.strokeStyle=i,s.lineWidth=2,s.globalAlpha=.25;for(var h=0;h<a;h++)if(e.points[h].pointType&&h){var u=t.WVP.transform(Qs.raDecTo3d(e.points[h].RA,e.points[h].dec));s.lineTo(u.x,u.y),l=!0}else l&&s.stroke(),o=t.WVP.transform(Qs.raDecTo3d(e.points[h].RA,e.points[h].dec)),s.moveTo(o.x,o.y);this._boundry&&s.closePath(),s.stroke(),s.restore()}},findConstellationForPoint:function(e,i){if(i>88.402||null==this.lines)return"UMI";for(var n=t.ss.enumerate(this.lines);n.moveNext();){var r,s,a=n.current,o=a.points.length,l=!1;for(r=0,s=o-1;r<o;s=r++)(a.points[r].dec<=i&&i<a.points[s].dec||a.points[s].dec<=i&&i<a.points[r].dec)&&e<(a.points[s].RA-a.points[r].RA)*(i-a.points[r].dec)/(a.points[s].dec-a.points[r].dec)+a.points[r].RA&&(l=!l);if(l)return a.get_name()}return e>0?this.findConstellationForPoint(e-24,i):i>65.5?"UMI":i<-65.5?"OCT":"Error"}};function Wo(){}function qo(){this.vertCount=0}function Zo(){this.a=0,this.e=0,this.ea=0}function Ko(t,e,i,n){this.poleDec=0,this.poleRa=0,this.primeMeridian=0,this.rotationRate=0,this.poleDec=e,this.poleRa=t,this.primeMeridian=i,this.rotationRate=n}function Jo(){}n("Constellations",[Yo,jo,null]),Wo.framesPerSecond=30,Wo.frameDumping=!1,Wo.cancelFrameDump=!1,Wo.currentFrameNumber=0,Wo.totalFrames=0,Wo._offset=0,Wo._syncToClock=!0,Wo._timeRate=1,Wo._altitude=0,Wo.updateClock=function(){if(Wo._syncToClock){var t=Wo.get_metaNow();if(1!==Wo._timeRate){var e=(t.getTime()-Wo.last.getTime())*Wo._timeRate;Wo._offset+=e}Wo.last=t;try{Wo._now=new Date(t.getTime()+Wo._offset)}catch(t){Wo._now=new Date(1,12,25,23,59,59),Wo._offset=Wo._now-Wo.get_metaNow()}Wo._now.getFullYear()>4e3&&(Wo._now=new Date(4e3,12,31,23,59,59),Wo._offset=Wo._now-Wo.get_metaNow()),Wo._now.getFullYear()<1&&(Wo._now=new Date(0,12,25,23,59,59),Wo._offset=Wo._now-Wo.get_metaNow())}},Wo.getTimeForFutureTime=function(t){try{return Wo._syncToClock?new Date(Wo.get_now().getTime()+1e3*t*Wo._timeRate):Wo.get_now()}catch(t){return Wo.get_now()}},Wo.getJNowForFutureTime=function(e){try{if(Wo._syncToClock){var i=new Date(Wo.get_now().getTime()+t.ss.truncate(1e3*e*Wo._timeRate));return Wo.utcToJulian(i)}return Wo.utcToJulian(Wo.get_now())}catch(t){return Wo.utcToJulian(Wo.get_now())}},Wo.get_now=function(){return Wo._now},Wo.set_now=function(t){return Wo._now=t,Wo._offset=Wo._now-Wo.get_metaNow(),Wo.last=Wo.get_metaNow(),t},Wo.get_metaNow=function(){return Wo._metaNow},Wo.set_metaNow=function(t){return Wo.frameDumping||(Wo._metaNow=t),t},Wo.nextFrame=function(){Wo._metaNow.setMilliseconds(Wo._metaNow.getMilliseconds()+Math.round(1e3/Wo.framesPerSecond)),Wo.currentFrameNumber+=1},Wo.get_doneDumping=function(){return!Wo.frameDumping||Wo.cancelFrameDump||Wo.currentFrameNumber>=Wo.totalFrames},Wo.syncTime=function(){Wo._offset=0,Wo._now=t.ss.now(),Wo._syncToClock=!0},Wo.get_jNow=function(){return Wo.utcToJulian(Wo.get_now())},Wo.get_syncToClock=function(){return Wo._syncToClock},Wo.set_syncToClock=function(e){return Wo._syncToClock!==e&&(Wo._syncToClock=e,e?(Wo.last=t.ss.now(),Wo._offset=Wo._now-t.ss.now()):Wo._now=new Date(t.ss.now().getTime()+Wo._offset)),e},Wo.get_timeRate=function(){return Wo._timeRate},Wo.set_timeRate=function(t){return Wo._timeRate=t,t},Wo.get_altitude=function(){return Wo._altitude},Wo.set_altitude=function(t){return Wo._altitude=t,t},Wo.get_location=function(){return Wo._location=Qs.fromLatLng(ko.get_active().get_locationLat(),ko.get_active().get_locationLng()),Wo._altitude=ko.get_active().get_locationAltitude(),Wo._location},Wo.set_location=function(t){return ko.get_globalSettings().get_locationLat()!==t.get_lat()&&ko.get_globalSettings().set_locationLat(t.get_lat()),ko.get_globalSettings().get_locationLng()!==t.get_lng()&&ko.get_globalSettings().set_locationLng(t.get_lng()),Wo._location=t,t},Wo.julianToUtc=function(e){var i=new h;i.setJD(e,!0);var n=1e3*(i.second()-t.ss.truncate(i.second()));return new Date(i.year(),i.month()-1,i.day(),i.hour(),i.minute(),t.ss.truncate(i.second()),t.ss.truncate(n))},Wo._twoLineDateToJulian=function(t){var e=parseInt(t.substring(0,1))<6,i=parseInt((e?" 20":"19")+t.substring(0,2)),n=parseFloat(t.substring(2,3)),r=parseFloat(t.substr(5)),s=new Date(i,0,1,0,0);return Wo.utcToJulian(s)+(n-1+r)},Wo.julianToTwoLineDate=function(t){return Wo.dateToTwoLineDate(Wo.julianToUtc(t))},Wo.dateToTwoLineDate=function(e){var i=new t.ss.StringBuilder;i.append(e.getFullYear()%100);var n=new Date(e.getFullYear(),0,1,0,0),r=Math.floor((e-n)/864e5)+2+e.getHours()/24+e.getMinutes()/60/24+e.getSeconds()/60/60/24+e.getMilliseconds()/1e3/60/60/24,s=Wo.tleDayString(r);return i.append(s),i.toString()},Wo.tleDayString=function(t){var e=t.toString(),i=e.indexOf(".");-1===i&&(i=e.length,e+=".0");var n=e.length-i-1,r="00000000";return r.substr(0,3-i)+e+r.substr(0,8-n)},Wo.utcToJulian=function(t){var e=t.getUTCFullYear(),i=t.getUTCMonth()+1,n=t.getUTCDate()+t.getUTCHours()/24+t.getUTCMinutes()/1440+(t.getUTCSeconds()+t.getUTCMilliseconds()/1e3)/86400;return Hr.getJulianDay(e,i,n)},Wo.dateToJD=function(e,i,n,r){var s=e,a=i;a<3&&(s-=1,a+=12);var o=0,l=0;return r&&(l=2-(o=t.ss.truncate(s/100))+t.ss.truncate(o/4)),t.ss.truncate(365.25*(s+4716))+t.ss.truncate(30.6001*(a+1))+n+l-1524.5},n("SpaceTimeController",[Wo,{},null]),n("Sprite2d",[qo,{draw:function(t,e,i,n,r,s){null==this.vertexBuffer?this.create(e):this.update(e),null==n?(Ss.use(t,this.vertexBuffer),t.gl.drawArrays(r?Yr.TRIANGLE_STRIP:Yr.TRIANGLES,0,e.length)):(ys.use(t,this.vertexBuffer,null!=n?n.texture2d:null),t.gl.drawArrays(r?Yr.TRIANGLE_STRIP:Yr.TRIANGLES,0,e.length))},create:function(e){this.vertexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var i=new Float32Array(9*e.length),n=i,r=0,s=t.ss.enumerate(e);s.moveNext();){var a=s.current;n[r++]=a.position.x,n[r++]=a.position.y,n[r++]=a.position.z,n[r++]=a.color.r/255,n[r++]=a.color.g/255,n[r++]=a.color.b/255,n[r++]=a.color.a/255,n[r++]=a.tu,n[r++]=a.tv}Hi.bufferData(Yr.ARRAY_BUFFER,i,Yr.DYNAMIC_DRAW)},update:function(e){if(this.vertCount<e.length)return Hi.deleteBuffer(this.vertexBuffer),void this.create(e);Hi.bindBuffer(Yr.ARRAY_BUFFER,this.vertexBuffer);for(var i=new Float32Array(9*e.length),n=i,r=0,s=t.ss.enumerate(e);s.moveNext();){var a=s.current;n[r++]=a.position.x,n[r++]=a.position.y,n[r++]=a.position.z,n[r++]=a.color.r/255,n[r++]=a.color.g/255,n[r++]=a.color.b/255,n[r++]=a.color.a/255,n[r++]=a.tu,n[r++]=a.tv}Hi.bufferSubData(Yr.ARRAY_BUFFER,0,i)}},null]),n("KeplerianElements",[Zo,{},null]),n("BodyAngles",[Ko,{},null]),Jo.RC=Math.PI/180,Jo._jNow=0,Jo._planetAngles=[new Ko(286.13,63.87,84.176,14.1844),new Ko(281.0097,61.4143,329.548,6.1385025),new Ko(272.76,67.16,160.2,-1.4813688),new Ko(317.68143,52.8865,176.63,350.89198226),new Ko(268.056595,64.495303,284.95,870.536),new Ko(40.589,83.537,38.9,810.7939024),new Ko(257.311,-15.175,203.81,501.1600928),new Ko(299.36,43.46,253.18,536.3128492),new Ko(132.993,-6.163,302.695,56.3625225),new Ko(269.9949,66.5392,38.3213,13.17635815),new Ko(268.05,64.5,200.39,203.4889538),new Ko(268.08,64.51,36.022,101.3747235),new Ko(268.2,64.57,44.064,50.3176081),new Ko(268.72,64.83,259.51,21.5710715),new Ko(0,0,0,0),new Ko(0,0,0,0),new Ko(0,0,0,0),new Ko(0,0,0,0),new Ko(0,0,0,0),new Ko(0,90,190.147,360.9856235)],Jo._lastPlanetCenterID=-2,Jo._orbitalSampleRate=256,Jo._obliquity=23.5*Jo.RC,Jo._drawOrder={},Jo.earthMatrix=new yn,Jo.earthMatrixInv=new yn,Jo._lastUpdate=new Date,Jo._planetSprite=new qo,Jo._planetPoints=null,Jo._planet3dLocations=null,Jo.loadPlanetTexture=function(t){var e=new rs;return e.load(t),e},Jo.getPlanet3dLocation=function(t){try{if(t<21)return Jo._planet3dLocations[t].copy()}catch(t){}return wn.create(0,0,0)},Jo.getPlanet3dSufaceAltitude=function(t){try{if(t<21)return Jo.getAdjustedPlanetRadius(t)}catch(t){}return 0},Jo.getPlanetTargetPoint=function(t,e,i,n){var r;return(r=n?Jo.getPlanet3dLocationJD(t,n):Jo.getPlanet3dLocation(t)).add(Qs.raDecTo3dAu(i/15+6,e,Jo.getPlanet3dSufaceAltitude(t))),r},Jo.getPlanet3dLocationJD=function(t,e){try{var i=new wn,n=Hr.getPlanet(e,0,0,0,-6378149),r=Qs.raDecTo3dAu(n.RA,n.dec,n.distance);if(t===Ma.earth)i=wn.create(-r.x,-r.y,-r.z);else{var s=Hr.getPlanet(e,t,0,0,-6378149);(i=Qs.raDecTo3dAu(s.RA,s.dec,s.distance)).subtract(r)}if(i.rotateX(Qs.meanObliquityOfEcliptic(e)*Jo.RC),1!==ko.get_active().get_solarSystemScale())switch(t){case Ma.moon:var a=Jo.getPlanet3dLocationJD(Ma.earth,e);i.subtract(a),i.multiply(ko.get_active().get_solarSystemScale()/2),i.add(a);break;case Ma.io:case Ma.europa:case Ma.ganymede:case Ma.callisto:a=Jo.getPlanet3dLocationJD(Ma.jupiter,e),i.subtract(a),i.multiply(ko.get_active().get_solarSystemScale()),i.add(a)}return i}catch(t){return wn.create(0,0,0)}},Jo.getPlanetLocation=function(t){var e=Jo.getPlanetIDFromName(t);return null!=Jo._planetLocations?Jo._planetLocations[e]:Hr.getPlanet(Wo.get_jNow(),e,Wo.get_location().get_lat(),Wo.get_location().get_lng(),Wo.get_altitude())},Jo.getPlanetLocationJD=function(t,e){var i=Jo.getPlanetIDFromName(t);return Hr.getPlanet(e,i,Wo.get_location().get_lat(),Wo.get_location().get_lng(),Wo.get_altitude())},Jo.getPlanetIDFromName=function(t){switch(t){case"Sun":return Ma.sun;case"Mercury":return Ma.mercury;case"Venus":return Ma.venus;case"Mars":return Ma.mars;case"Jupiter":return Ma.jupiter;case"Saturn":return Ma.saturn;case"Uranus":return Ma.uranus;case"Neptune":return Ma.neptune;case"Pluto":return Ma.pluto;case"Moon":return Ma.moon;case"Io":return Ma.io;case"Europa":return Ma.europa;case"Ganymede":return Ma.ganymede;case"Callisto":return Ma.callisto;case"Earth":return Ma.earth;case"IoShadow":return Ma.ioShadow;case"EuropaShadow":return Ma.europaShadow;case"GanymedeShadow":return Ma.ganymedeShadow;case"CallistoShadow":return Ma.callistoShadow;case"SunEclipsed":return Ma.sunEclipsed;case"Custom":return Ma.custom;case"Undefined":return Ma.undefined;default:return-1}},Jo.getNameFrom3dId=function(t){switch(t){case Ma.sun:return"Sun";case Ma.mercury:return"Mercury";case Ma.venus:return"Venus";case Ma.mars:return"Mars";case Ma.jupiter:return"Jupiter";case Ma.saturn:return"Saturn";case Ma.uranus:return"Uranus";case Ma.neptune:return"Neptune";case Ma.pluto:return"Pluto";case Ma.moon:return"Moon";case Ma.io:return"Io";case Ma.europa:return"Europa";case Ma.ganymede:return"Ganymede";case Ma.callisto:return"Callisto";case Ma.earth:return"Earth";default:return""}},Jo.updatePlanetLocations=function(e){if(Jo._jNow=Wo.get_jNow(),e&&Jo.updateOrbits(0),null==Jo._planetDiameters&&(Jo._planetDiameters=new Array(20),Jo._planetDiameters[0]=.009291568,Jo._planetDiameters[1]=325794793734425e-19,Jo._planetDiameters[2]=808669220531394e-19,Jo._planetDiameters[3]=453785605596396e-19,Jo._planetDiameters[4]=954501e-9,Jo._planetDiameters[5]=802173e-9,Jo._planetDiameters[6]=339564e-9,Jo._planetDiameters[7]=324825e-9,Jo._planetDiameters[8]=152007379777805e-19,Jo._planetDiameters[9]=232084653538149e-19,Jo._planetDiameters[10]=243519298386342e-19,Jo._planetDiameters[11]=208692629580609e-19,Jo._planetDiameters[12]=351742670356556e-19,Jo._planetDiameters[13]=322263666626559e-19,Jo._planetDiameters[14]=243519298386342e-19,Jo._planetDiameters[15]=208692629580609e-19,Jo._planetDiameters[16]=351742670356556e-19,Jo._planetDiameters[17]=322263666626559e-19,Jo._planetDiameters[18]=.018583136,Jo._planetDiameters[Ma.earth]=855626412117809e-19),null==Jo.planetColors){var i=Oi.fromArgb(255,255,255,221),n=Oi.fromArgb(255,255,68,0);Jo.planetColors=new Array(20),Jo.planetColors[0]=Xi.get_yellow(),Jo.planetColors[1]=Xi.get_white(),Jo.planetColors[2]=i,Jo.planetColors[3]=n,Jo.planetColors[4]=Oi.fromArgb(255,255,165,0),Jo.planetColors[5]=Oi.fromArgb(255,184,134,11),Jo.planetColors[6]=Oi.fromArgb(255,173,216,230),Jo.planetColors[7]=Xi.get_blue(),Jo.planetColors[8]=Xi.get_white(),Jo.planetColors[9]=Xi.get_white(),Jo.planetColors[10]=Xi.get_white(),Jo.planetColors[11]=Xi.get_white(),Jo.planetColors[12]=Xi.get_white(),Jo.planetColors[13]=Xi.get_white(),Jo.planetColors[14]=Xi.get_black(),Jo.planetColors[15]=Xi.get_black(),Jo.planetColors[16]=Xi.get_black(),Jo.planetColors[17]=Xi.get_black(),Jo.planetColors[18]=Xi.get_white(),Jo.planetColors[Ma.earth]=Oi.fromArgb(255,173,216,230)}if(null==Jo._planetTilts&&(Jo._planetTilts=new Array(20),Jo._planetTilts[0]=0,Jo._planetTilts[1]=.01,Jo._planetTilts[2]=177.4,Jo._planetTilts[3]=25.19,Jo._planetTilts[4]=3.13,Jo._planetTilts[5]=26.73,Jo._planetTilts[6]=97.77,Jo._planetTilts[7]=28.32,Jo._planetTilts[8]=119.61,Jo._planetTilts[9]=23.439,Jo._planetTilts[10]=2.21,Jo._planetTilts[11]=0,Jo._planetTilts[12]=-.33,Jo._planetTilts[13]=0,Jo._planetTilts[14]=0,Jo._planetTilts[15]=0,Jo._planetTilts[16]=0,Jo._planetTilts[17]=0,Jo._planetTilts[18]=0,Jo._planetTilts[Ma.earth]=23.5),Jo._planetTilts[Ma.earth]=Jo._obliquity/Jo.RC,null==Jo.planetRotationPeriod&&(Jo.planetRotationPeriod=new Array(20),Jo.planetRotationPeriod[0]=25.37995,Jo.planetRotationPeriod[1]=58.6462,Jo.planetRotationPeriod[2]=-243.0187,Jo.planetRotationPeriod[3]=1.02595675,Jo.planetRotationPeriod[4]=.41007,Jo.planetRotationPeriod[5]=.426,Jo.planetRotationPeriod[6]=-.71833,Jo.planetRotationPeriod[7]=.67125,Jo.planetRotationPeriod[8]=-6.38718,Jo.planetRotationPeriod[9]=27.3,Jo.planetRotationPeriod[10]=1.769137786,Jo.planetRotationPeriod[11]=3.551,Jo.planetRotationPeriod[12]=7.155,Jo.planetRotationPeriod[13]=16.69,Jo.planetRotationPeriod[14]=0,Jo.planetRotationPeriod[15]=0,Jo.planetRotationPeriod[16]=0,Jo.planetRotationPeriod[17]=0,Jo.planetRotationPeriod[18]=0,Jo.planetRotationPeriod[Ma.earth]=.99726968),null==Jo._planetScales&&(Jo._planetScales=new Array(20)),null==Jo._planet3dLocations&&(Jo._planet3dLocations=new Array(20)),ko.get_active().get_actualPlanetScale())Jo._planetScales[0]=.5,Jo._planetScales[1]=.25,Jo._planetScales[2]=.25,Jo._planetScales[3]=.25,Jo._planetScales[4]=.25,Jo._planetScales[5]=.5,Jo._planetScales[6]=.25,Jo._planetScales[7]=.25,Jo._planetScales[8]=.25,Jo._planetScales[9]=.25,Jo._planetScales[10]=.25,Jo._planetScales[11]=.25,Jo._planetScales[12]=.25,Jo._planetScales[13]=.25,Jo._planetScales[14]=.25,Jo._planetScales[15]=.25,Jo._planetScales[16]=.25,Jo._planetScales[17]=.25,Jo._planetScales[18]=.5,Jo._planetScales[Ma.earth]=.25;else{for(var r=0;r<20;r++)Jo._planetScales[r]=r<10?.25:.1;Jo._planetScales[Ma.sun]=.5,Jo._planetScales[Ma.saturn]=.5,Jo._planetScales[Ma.sunEclipsed]=.5}Jo._planetDrawOrder={},Jo._planetLocations=new Array(20);var s=new wn,a=Hr.getPlanet(Jo._jNow,0,e?0:Wo.get_location().get_lat(),e?0:Wo.get_location().get_lng(),e?-6378149:Wo.get_altitude());for(s=Qs.raDecTo3dAu(a.RA,a.dec,a.distance),Jo._planet3dLocations[Ma.earth]=wn.create(-s.x,-s.y,-s.z),Jo._planet3dLocations[Ma.earth].rotateX(Jo._obliquity),r=0;r<18;r++){if(Jo._planetLocations[r]=Hr.getPlanet(Jo._jNow,r,e?0:Wo.get_location().get_lat(),e?0:Wo.get_location().get_lng(),e?-6378149:Wo.get_altitude()),Jo._planet3dLocations[r]=Qs.raDecTo3dAu(Jo._planetLocations[r].RA,Jo._planetLocations[r].dec,Jo._planetLocations[r].distance),Jo._planet3dLocations[r].subtract(s),Jo._planet3dLocations[r].rotateX(Jo._obliquity),ko.get_active().get_actualPlanetScale()&&(Jo._planetScales[r]=2*Math.atan(Jo._planetDiameters[r]/Jo._planetLocations[r].distance*.5)/Math.PI*180),1!==ko.get_active().get_solarSystemScale())switch(r){case Ma.moon:var o=Jo._planet3dLocations[Ma.earth];Jo._planet3dLocations[r].subtract(o),Jo._planet3dLocations[r].multiply(ko.get_active().get_solarSystemScale()/2),Jo._planet3dLocations[r].add(o);break;case Ma.io:case Ma.europa:case Ma.ganymede:case Ma.callisto:o=Jo._planet3dLocations[Ma.jupiter],Jo._planet3dLocations[r].subtract(o),Jo._planet3dLocations[r].multiply(ko.get_active().get_solarSystemScale()),Jo._planet3dLocations[r].add(o)}for(var l=-Jo._planetLocations[r].distance;t.ss.keyExists(Jo._planetDrawOrder,l);)l+=1e-10;Jo._planetDrawOrder[l]=r}Jo._planetLocations[Ma.sunEclipsed]=Jo._planetLocations[Ma.sun],Jo._planetScales[Ma.sun]*=2,Jo._planetScales[Ma.sunEclipsed]=Jo._planetScales[Ma.sun],Jo._planetScales[Ma.saturn]=2*Jo._planetScales[Ma.saturn],Jo._lastUpdate=Wo.get_now()},Jo.planetsReady=function(){},Jo.updateOrbits=function(t){try{if(Jo._obliquity=Qs.meanObliquityOfEcliptic(Wo.get_jNow())*Jo.RC,t!==Jo._lastPlanetCenterID&&(Jo._orbits=null),Jo._lastPlanetCenterID=t,null==Jo._orbits&&(t<0?Jo._eclipticTilt=yn.get_identity():(Jo._eclipticTilt=yn.get_identity(),Jo._eclipticTilt=yn._rotationX(Jo._obliquity)),null==Jo.planetOrbitalYears&&(Jo.planetOrbitalYears=new Array(20),Jo.planetOrbitalYears[0]=1,Jo.planetOrbitalYears[1]=.241,Jo.planetOrbitalYears[2]=.615,Jo.planetOrbitalYears[3]=1.881,Jo.planetOrbitalYears[4]=11.87,Jo.planetOrbitalYears[5]=29.45,Jo.planetOrbitalYears[6]=84.07,Jo.planetOrbitalYears[7]=164.9,Jo.planetOrbitalYears[8]=248.1,Jo.planetOrbitalYears[9]=27.3/365.25,Jo.planetOrbitalYears[10]=16.6890184/365.25,Jo.planetOrbitalYears[11]=3.551181/365.25,Jo.planetOrbitalYears[12]=7.15455296/365.25,Jo.planetOrbitalYears[13]=16.6890184/365.25,Jo.planetOrbitalYears[Ma.earth]=1),!Jo.readOrbits())){Jo._orbits=new Array(20);for(var e=1;e<20;e++)if(Jo._orbits[e]=new Array(Jo._orbitalSampleRate),e<9||e===Ma.earth){for(var i=0;i<Jo._orbitalSampleRate;i++){var n=t,r=Jo._jNow+365.25*Jo.planetOrbitalYears[e]/Jo._orbitalSampleRate*(i-Jo._orbitalSampleRate/2),s=new wn;if(e===Ma.moone?n=-1:e>9&&e<14&&(n=4),n>-1){var a=Hr.getPlanet(r,n,0,0,-6378149);s=Qs.raDecTo3dAu(a.RA,a.dec,a.distance)}if(e!==Ma.earth){var o=Hr.getPlanet(r,e,0,0,-6378149);Jo._orbits[e][i]=Qs.raDecTo3dAu(o.RA,o.dec,o.distance),Jo._orbits[e][i].subtract(s)}else Jo._orbits[e][i]=wn.create(-s.x,-s.y,-s.z);Jo._orbits[e][i].rotateX(Jo._obliquity)}Jo._orbits[e][Jo._orbitalSampleRate-1]=Jo._orbits[e][0]}Jo.dumpOrbitsFile()}}finally{}},Jo.readOrbits=function(){return!1},Jo.dumpOrbitsFile=function(){},Jo.drawPlanets=function(e,i){null==Jo._planetTextures&&Jo._loadPlanetTextures();var n=Jo._geocentricElongation(Jo._planetLocations[9].RA,Jo._planetLocations[9].dec,Jo._planetLocations[0].RA,Jo._planetLocations[0].dec);Jo._planetLocations[9].RA,Jo._planetLocations[0].RA;Jo._planetLocations[9].RA,Jo._planetLocations[0].RA,Jo._phaseAngle(n,Jo._planetLocations[9].distance,Jo._planetLocations[0].distance),Jo._positionAngle(Jo._planetLocations[9].RA,Jo._planetLocations[9].dec,Jo._planetLocations[0].RA,Jo._planetLocations[0].dec);var r=15*Math.abs(Jo._planetLocations[9].RA-Jo._planetLocations[0].RA)*Math.cos(Qs.degreesToRadians(Jo._planetLocations[0].dec)),s=Math.abs(Jo._planetLocations[9].dec-Jo._planetLocations[0].dec),a=Math.sqrt(r*r+s*s),o=0,l=Jo._planetScales[9]/2-a;Math.min(32,t.ss.truncate(32*a)),l>Jo._planetScales[0]/4&&(o=Math.min(1,(l-Jo._planetScales[0]/2)/.001),Jo._drawPlanet(e,18,o));for(var h=t.ss.enumerate(t.ss.keys(Jo._planetDrawOrder));h.moveNext();){var u=h.current,c=Jo._planetDrawOrder[u];Jo._drawPlanet(e,c,1)}return!0},Jo._loadPlanetTextures=function(){var t=zr.singleton.engineAssetUrl("");Jo._planetTextures=new Array(20),Jo._planetTextures[0]=rs.fromUrl(t+"sun.png"),Jo._planetTextures[1]=rs.fromUrl(t+"mercury.png"),Jo._planetTextures[2]=rs.fromUrl(t+"venus.png"),Jo._planetTextures[3]=rs.fromUrl(t+"mars.png"),Jo._planetTextures[4]=rs.fromUrl(t+"jupiter.png"),Jo._planetTextures[5]=rs.fromUrl(t+"saturn.png"),Jo._planetTextures[6]=rs.fromUrl(t+"uranus.png"),Jo._planetTextures[7]=rs.fromUrl(t+"neptune.png"),Jo._planetTextures[8]=rs.fromUrl(t+"pluto.png"),Jo._planetTextures[9]=rs.fromUrl(t+"moon.png"),Jo._planetTextures[10]=rs.fromUrl(t+"io.png"),Jo._planetTextures[11]=rs.fromUrl(t+"europa.png"),Jo._planetTextures[12]=rs.fromUrl(t+"ganymede.png"),Jo._planetTextures[13]=rs.fromUrl(t+"callisto.png"),Jo._planetTextures[14]=rs.fromUrl(t+"moonshadow.png"),Jo._planetTextures[15]=rs.fromUrl(t+"moonshadow.png"),Jo._planetTextures[16]=rs.fromUrl(t+"moonshadow.png"),Jo._planetTextures[17]=rs.fromUrl(t+"moonshadow.png"),Jo._planetTextures[18]=rs.fromUrl(t+"sunCorona.png"),Jo._planetTextures[Ma.earth]=rs.fromUrl(t+"earth.png")},Jo.getPlanetOrientationAtEpoch=function(t){var e=yn.get_identity(),i=23.4392794;return t===Ma.earth?e._multiply(yn._rotationX(i*Jo.RC)):(e._multiply(yn._rotationX(-90*Jo.RC)),e._multiply(yn._rotationZ((180+Jo._planetAngles[t].primeMeridian)*Jo.RC)),e._multiply(yn._rotationX((90-Jo._planetAngles[t].poleDec)*Jo.RC)),e._multiply(yn._rotationZ((Jo._planetAngles[t].poleRa-90)*Jo.RC)),e._multiply(yn._rotationX(i*Jo.RC)),e._multiply(yn._rotationX(90*Jo.RC))),e},Jo.setupPlanetMatrix=function(t,e,i,n){var r=t.get_world().clone();if(Jo._setupMatrixForPlanetGeometry(t,e,i,n),e===Ma.sun){var s=Jo.getAdjustedPlanetRadius(e);r.scale(wn.create(s,s,s));var a=wn.subtractVectors(Jo._planet3dLocations[e],i);r._multiply(yn.translation(a)),t.set_worldBaseNonRotating(r)}},Jo._setupMatrixForPlanetGeometry=function(t,e,i,n){var r=Jo.getAdjustedPlanetRadius(e),s=0;s=e===Ma.earth?Math.PI+Qs.mstFromUTC2(Wo.get_now(),0)/180*Math.PI:Math.PI+(Jo._jNow-2451545)/Jo.planetRotationPeriod[e]*Math.PI*2%(2*Math.PI),9===e&&(s-=Math.PI/2);var a=t.get_world().clone(),o=t.get_world().clone(),l=wn.subtractVectors(Jo._planet3dLocations[e],i),h=Jo.getPlanetOrientationAtEpoch(e);return a.scale(wn.create(r,r,r)),a._multiply(yn._rotationY(-s)),a._multiply(h),e===t.viewCamera.target&&(Jo.earthMatrix=yn.get_identity(),Jo.earthMatrix._multiply(yn._rotationY(-s)),Jo.earthMatrix._multiply(h),Jo.earthMatrixInv=Jo.earthMatrix.clone(),Jo.earthMatrixInv.invert()),a._multiply(yn.translation(l)),t.set_world(a),t.set_worldBase(t.get_world().clone()),t.set_nominalRadius(Jo.getPlanetRadiusInMeters(e)),n&&t.makeFrustum(),o.scale(wn.create(r,r,r)),o._multiply(h),o._multiply(yn.translation(l)),t.set_worldBaseNonRotating(o),s},Jo.getPlanetPositionDirect=function(t,e){var i=0,n=0,r=0;switch(t){case 1:i=ot.eclipticLongitude(e),n=ot.eclipticLatitude(e),r=ot.radiusVector(e);break;case 2:i=Tt.eclipticLongitude(e),n=Tt.eclipticLatitude(e),r=Tt.radiusVector(e);break;case Ma.earth:i=U.eclipticLongitude(e),n=U.eclipticLatitude(e),r=U.radiusVector(e);break;case 3:i=Vt.eclipticLongitude(e),n=Vt.eclipticLatitude(e),r=Vt.radiusVector(e);break;case 4:i=ae.eclipticLongitude(e),n=ae.eclipticLatitude(e),r=ae.radiusVector(e);break;case 5:i=Me.eclipticLongitude(e),n=Me.eclipticLatitude(e),r=Me.radiusVector(e);break;case 6:i=Ve.eclipticLongitude(e),n=Ve.eclipticLatitude(e),r=Ve.radiusVector(e);break;case 7:i=ii.eclipticLongitude(e),n=ii.eclipticLatitude(e),r=ii.radiusVector(e);break;case 8:i=hi.eclipticLongitude(e),n=hi.eclipticLatitude(e),r=hi.radiusVector(e);break;case 9:i=Kn.eclipticLongitude(e),n=Kn.eclipticLatitude(e),r=Kn.radiusVector(e)/149598e3;break;case 10:var s=Vn.calculate(e).satellite1.eclipticRectangularCoordinates;return wn.create(s.x,s.z,s.y);case 11:return s=Vn.calculate(e).satellite2.eclipticRectangularCoordinates,wn.create(s.x,s.z,s.y);case 12:return s=Vn.calculate(e).satellite3.eclipticRectangularCoordinates,wn.create(s.x,s.z,s.y);case 13:return s=Vn.calculate(e).satellite4.eclipticRectangularCoordinates,wn.create(s.x,s.z,s.y)}i=Qs.degreesToRadians(i),n=Qs.degreesToRadians(n);var a=wn.create(Math.cos(i)*Math.cos(n)*r,Math.sin(i)*Math.cos(n)*r,Math.sin(n)*r),o=(Qs.meanObliquityOfEcliptic(e)-Qs.meanObliquityOfEcliptic(2451545))*Jo.RC;return a.rotateX(o),wn.create(a.x,a.z,a.y)},Jo._stateVectorToKeplerian=function(t,e,i){var n=wn.scale(t,149598e3),r=wn.scale(wn.scale(e,1/86400),149598e3),s=n.length(),a=r.length(),o=1/(2/s-a*a/i),l=wn.cross(n,r),h=wn.subtractVectors(wn.scale(wn.cross(r,l),1/i),wn.scale(n,1/s)),u=h.length();l.normalize(),h.normalize();var c=wn.cross(l,h);n.normalize();var _=wn.dot(h,n),d=wn.dot(c,n),g=Math.atan2(Math.sqrt(1-u*u)*d,u+_),f=new Zo;return f.orientation=yn.create(h.x,h.y,h.z,0,c.x,c.y,c.z,0,l.x,l.y,l.z,0,0,0,0,1),f.a=o,f.e=u,f.ea=g,f},Jo.getAdjustedPlanetRadius=function(t){return t>Jo._planetDiameters.length-1&&(t=Ma.earth),Jo._planetDiameters[t]/2*(t?1+3*(ko.get_active().get_solarSystemScale()-1):1+.3*(ko.get_active().get_solarSystemScale()-1))},Jo.getPlanetRadiusInMeters=function(t){return t>Jo._planetDiameters.length-1&&(t=Ma.earth),Jo._planetDiameters[t]/2*149598e3*1e3},Jo._drawPlanet=function(t,e,i){var n=Jo._planetLocations[e];if(e<14&&Jo._planetScales[e]<t.viewCamera.zoom/6/400){if(e<10||e<14&&Jo._planetScales[e]>t.viewCamera.zoom/6/6400){var r=Qs.raDecTo3d(n.RA,n.dec);_o.drawPointPlanet(t,r,3,Jo.planetColors[e],!1)}}else{var s=null;if(e<10||18===e)s=Jo._planetTextures[e];else if(e<14)s=Jo._planetLocations[e].eclipsed?Jo._planetTextures[15]:ko.get_active().get_showMoonsAsPointSource()?Jo._planetTextures[14]:Jo._planetTextures[e];else{if(!Jo._planetLocations[e].shadow)return;s=Jo._planetTextures[15]}if(null!=t.gl){if(null==Jo._planetPoints){Jo._planetPoints=new Array(4);for(var a=0;a<4;a++)Jo._planetPoints[a]=new dn}var o=Jo._planetScales[e]/2,l=o/Math.cos(n.dec/180*Math.PI);Jo._planetPoints[0].position=Qs.raDecTo3dAu(n.RA-l/15,n.dec+o,1),Jo._planetPoints[0].tu=0,Jo._planetPoints[0].tv=1,Jo._planetPoints[0].color=Xi.get_white(),Jo._planetPoints[1].position=Qs.raDecTo3dAu(n.RA-l/15,n.dec-o,1),Jo._planetPoints[1].tu=0,Jo._planetPoints[1].tv=0,Jo._planetPoints[1].color=Xi.get_white(),Jo._planetPoints[2].position=Qs.raDecTo3dAu(n.RA+l/15,n.dec+o,1),Jo._planetPoints[2].tu=1,Jo._planetPoints[2].tv=1,Jo._planetPoints[2].color=Xi.get_white(),Jo._planetPoints[3].position=Qs.raDecTo3dAu(n.RA+l/15,n.dec-o,1),Jo._planetPoints[3].tu=1,Jo._planetPoints[3].tv=0,Jo._planetPoints[3].color=Xi.get_white(),Jo._planetSprite.draw(t,Jo._planetPoints,4,s,!0,1)}else{var h=Qs.raDecTo3d(n.RA,n.dec),u=Jo._planetScales[e]/(t.get_fovScale()/3600)/2,c=t.WVP.transform(h);if(c.z<0)return;if(wn.dot(t.get_viewPoint(),h)<.55)return;var _=t.device;_.save(),_.globalAlpha=i,_.beginPath(),_.arc(c.x,c.y,u,0,2*Math.PI,!0),_.lineWidth=0,_.closePath(),_.clip(),_.drawImage(s.imageElement,c.x-u,c.y-u,2*u,2*u),_.globalAlpha=1,_.restore()}}},Jo._drawPlanetPhase=function(t,e,i,n,r){},Jo._geocentricElongation=function(t,e,i,n){return t=Qs.degreesToRadians(15*t),i=Qs.degreesToRadians(15*i),e=Qs.degreesToRadians(e),n=Qs.degreesToRadians(n),Qs.radiansToDegrees(Math.acos(Math.sin(n)*Math.sin(e)+Math.cos(n)*Math.cos(e)*Math.cos(i-t)))},Jo._phaseAngle=function(t,e,i){return t=Qs.degreesToRadians(t),Qs.mapTo0To360Range(Qs.radiansToDegrees(Math.atan2(i*Math.sin(t),e-i*Math.cos(t))))},Jo._positionAngle=function(t,e,i,n){return t=Qs.hoursToRadians(t),i=Qs.hoursToRadians(i),e=Qs.degreesToRadians(e),n=Qs.degreesToRadians(n),Qs.mapTo0To360Range(Qs.radiansToDegrees(Math.atan2(Math.cos(e)*Math.sin(t-i),Math.sin(e)*Math.cos(n)-Math.cos(e)*Math.sin(n)*Math.cos(t-i))))},n("Planets",[Jo,{},null]);var Qo={star:1,supernova:2,blackHole:4,neutronStar:8,doubleStar:16,multipleStars:32,asterism:64,constellation:128,openCluster:256,globularCluster:512,nebulousCluster:1024,nebula:2048,emissionNebula:4096,planetaryNebula:8192,reflectionNebula:16384,darkNebula:32768,giantMolecularCloud:65536,supernovaRemnant:131072,interstellarDust:262144,quasar:524288,galaxy:1048576,spiralGalaxy:2097152,irregularGalaxy:4194304,ellipticalGalaxy:8388608,knot:16777216,plateDefect:33554432,clusterOfGalaxies:67108864,otherNGC:134217728,unidentified:268435456,solarSystem:536870912,unfiltered:1073741823,stellar:63,stellarGroupings:2032,nebulae:523264,galactic:133693440,other:436207616};function tl(){this._camParams=Aa.create(0,0,-1,0,0,100),this._location3d=wn.create(0,0,0),this.htmlDescription="",this._constellation="",this._classification=1048576,this._type=2,this._magnitude=0,this._distnace=0,this.angularSize=60,this.annotation="",this._thumbNail=null,this._studyImageset=null,this._backgroundImageSet=null,this._searchDistance=0,this._elevation=50}n("Classification",Qo),r("Classification",Qo),tl.create=function(t,e,i,n,r,s,a){var o=new tl;return o.set_zoomLevel(a),o._constellation=r,o._name=t,2===s||4===s?o._camParams.set_RA(i):o.set_lng(i),o.set_lat(e),o.set_classification(n),o.set_type(s),o},tl.createCameraParams=function(t,e,i,n,r,s){var a=new tl;return a._constellation=n,a._name=t,a.set_classification(i),a._camParams=e,a.set_type(r),a.set_target(s),a},tl._fromXml=function(t){var e=new tl;if(e._name=t.attributes.getNamedItem("Name").nodeValue,null!=t.attributes.getNamedItem("MSRComponentId")&&null!=t.attributes.getNamedItem("Permission")&&null!=t.attributes.getNamedItem("Url"))return e.set_url(t.attributes.getNamedItem("Url").nodeValue),e.set_thumbnailUrl(t.attributes.getNamedItem("Thumbnail").nodeValue),e;null!=t.attributes.getNamedItem("DataSetType")&&(e._type=s.parse("ImageSetType",t.attributes.getNamedItem("DataSetType").nodeValue)),2===e.get_type()?(e._camParams.set_RA(parseFloat(t.attributes.getNamedItem("RA").nodeValue)),e._camParams.set_dec(parseFloat(t.attributes.getNamedItem("Dec").nodeValue))):(e.set_lat(parseFloat(t.attributes.getNamedItem("Lat").nodeValue)),e.set_lng(parseFloat(t.attributes.getNamedItem("Lng").nodeValue))),null!=t.attributes.getNamedItem("Constellation")&&(e._constellation=t.attributes.getNamedItem("Constellation").nodeValue),null!=t.attributes.getNamedItem("Classification")&&(e._classification=s.parse("Classification",t.attributes.getNamedItem("Classification").nodeValue)),null!=t.attributes.getNamedItem("Magnitude")&&(e._magnitude=parseFloat(t.attributes.getNamedItem("Magnitude").nodeValue)),null!=t.attributes.getNamedItem("AngularSize")&&(e.angularSize=parseFloat(t.attributes.getNamedItem("AngularSize").nodeValue)),null!=t.attributes.getNamedItem("ZoomLevel")&&e.set_zoomLevel(parseFloat(t.attributes.getNamedItem("ZoomLevel").nodeValue)),null!=t.attributes.getNamedItem("Rotation")&&(e._camParams.rotation=parseFloat(t.attributes.getNamedItem("Rotation").nodeValue)),null!=t.attributes.getNamedItem("Annotation")&&(e.annotation=t.attributes.getNamedItem("Annotation").nodeValue),null!=t.attributes.getNamedItem("Angle")&&(e._camParams.angle=parseFloat(t.attributes.getNamedItem("Angle").nodeValue)),null!=t.attributes.getNamedItem("Opacity")?e._camParams.opacity=parseFloat(t.attributes.getNamedItem("Opacity").nodeValue):e._camParams.opacity=100,e.set_target(65536),null!=t.attributes.getNamedItem("Target")&&e.set_target(s.parse("SolarSystemObjects",t.attributes.getNamedItem("Target").nodeValue)),null!=t.attributes.getNamedItem("ViewTarget")&&(e._camParams.viewTarget=wn.parse(t.attributes.getNamedItem("ViewTarget").nodeValue)),null!=t.attributes.getNamedItem("TargetReferenceFrame")&&(e._camParams.targetReferenceFrame=t.attributes.getNamedItem("TargetReferenceFrame").nodeValue);var i=a.selectSingleNode(t,"Description");null!=i&&(e.htmlDescription=a.getInnerText(i));var n=a.selectSingleNode(t,"BackgroundImageSet");if(null!=n){var r=a.selectSingleNode(n,"ImageSet");e._backgroundImageSet=Co.fromXMLNode(r)}var o=a.selectSingleNode(t,"ForegroundImageSet");return null!=o&&(r=a.selectSingleNode(o,"ImageSet"),e._studyImageset=Co.fromXMLNode(r)),null!=(o=a.selectSingleNode(t,"ImageSet"))&&(e._studyImageset=Co.fromXMLNode(o)),e},tl._properCaps=function(e){for(var i=e.split(" "),n="",r=t.ss.enumerate(i);r.moveNext();){var s=r.current;n=n+s.substr(0,1).toUpperCase()+(s.length>1?s.substr(1).toLowerCase():"")+" "}return t.ss.trim(n)};var el,il={get_tag:function(){return this._tag},set_tag:function(t){return this._tag=t,t},get_url:function(){return this._url},set_url:function(t){return this._url=t,t},get_thumbnail:function(){return this._thumbnail},set_thumbnail:function(t){return this._thumbnail=t,t},get_name:function(){return this.get_names()[0]},get_names:function(){return t.ss.emptyString(this._name)?"".split(";"):this._name.split(";")},set_names:function(t){return this._name=Fa.getNamesStringFromArray(t),t},get_camParams:function(){if(536870912===this.get_classification()&&20!==this._camParams.target){var t=Jo.getPlanetLocation(this.get_name());this._camParams.set_RA(t.RA),this._camParams.set_dec(t.dec),this._distnace=t.distance}return this._camParams},set_camParams:function(t){return this._camParams=t,t},updatePlanetLocation:function(t){this._camParams.viewTarget=Jo.getPlanet3dLocationJD(this.get_target(),t),65536!==this.get_target()&&20!==this.get_target()&&(this._camParams.viewTarget=Jo.getPlanetTargetPoint(this.get_target(),this.get_lat(),this.get_lng(),t))},get_location3d:function(){return 536870912!==this.get_classification()&&(this._location3d.x||this._location3d.y||this._location3d.z)||(this._location3d=Qs.raDecTo3d(this.get_RA(),this.get_dec())),this._location3d},get_lat:function(){return this.get_camParams().lat},set_lat:function(t){return this._camParams.lat=t,t},get_lng:function(){return this.get_camParams().lng},set_lng:function(t){return this._camParams.lng=t,t},get_opacity:function(){return this.get_camParams().opacity},set_opacity:function(t){return this._camParams.opacity=t,t},get_constellation:function(){return this._constellation},set_constellation:function(t){return this._constellation=t,t},get_classification:function(){return this._classification},set_classification:function(t){return this._classification=t,t},get_type:function(){return this._type},set_type:function(t){return this._type=t,t},get_magnitude:function(){return this._magnitude},set_magnitude:function(t){return this._magnitude=t,t},get_distance:function(){return this._distnace},set_distance:function(t){return this._distnace=t,t},get_zoomLevel:function(){return this.get_camParams().zoom},set_zoomLevel:function(t){return this._camParams.zoom=t,t},get_annotation:function(){return this.annotation},set_annotation:function(t){return this.annotation=t,t},get_studyImageset:function(){return this._studyImageset},set_studyImageset:function(t){return this._studyImageset=t,t},get_backgroundImageset:function(){return this._backgroundImageSet},set_backgroundImageset:function(t){return null!=t&&this.set_type(t.get_dataSetType()),this._backgroundImageSet=t,t},get_searchDistance:function(){return this._searchDistance},set_searchDistance:function(t){return this._searchDistance=t,t},get_elevation:function(){return this._elevation},set_elevation:function(t){return this._elevation=t,t},get_thumbnailUrl:function(){if(t.ss.emptyString(this._thumbnailField)){if(null!=this._studyImageset&&!t.ss.emptyString(this._studyImageset.get_thumbnailUrl()))return this._studyImageset.get_thumbnailUrl();if(null!=this._backgroundImageSet&&!t.ss.emptyString(this._backgroundImageSet.get_thumbnailUrl()))return this._backgroundImageSet.get_thumbnailUrl();var e=this.get_name();return e.indexOf(";")>-1&&(e=e.substr(0,e.indexOf(";"))),1===this.get_classification()||Mr?zr.singleton.engineAssetUrl("thumb_star.jpg"):zr.singleton.coreStaticUrl("wwtweb/thumbnail.aspx?name="+e.toLowerCase())}return this._thumbnailField},set_thumbnailUrl:function(t){return this._thumbnailField=t,t},get_RA:function(){return this.get_camParams().get_RA()},set_RA:function(t){return this._camParams.set_RA(t),t},get_dec:function(){return this.get_camParams().get_dec()},set_dec:function(t){return this._camParams.set_dec(t),t},toString:function(){return this._name},_saveToXml:function(t,e){t._writeStartElement(e),t._writeAttributeString("Name",this._name),t._writeAttributeString("DataSetType",s.toXml("ImageSetType",this._type)),2===this.get_type()?(t._writeAttributeString("RA",this._camParams.get_RA().toString()),t._writeAttributeString("Dec",this._camParams.get_dec().toString())):(t._writeAttributeString("Lat",this.get_lat().toString()),t._writeAttributeString("Lng",this.get_lng().toString())),t._writeAttributeString("Constellation",this._constellation),t._writeAttributeString("Classification",s.toXml("Classification",this._classification)),t._writeAttributeString("Magnitude",this._magnitude.toString()),t._writeAttributeString("Distance",this._distnace.toString()),t._writeAttributeString("AngularSize",this.angularSize.toString()),t._writeAttributeString("ZoomLevel",this.get_zoomLevel().toString()),t._writeAttributeString("Rotation",this._camParams.rotation.toString()),t._writeAttributeString("Angle",this._camParams.angle.toString()),t._writeAttributeString("Opacity",this._camParams.opacity.toString()),t._writeAttributeString("Target",s.toXml("SolarSystemObjects",this.get_target())),t._writeAttributeString("ViewTarget",this._camParams.viewTarget.toString()),t._writeAttributeString("TargetReferenceFrame",this._camParams.targetReferenceFrame),t._writeStartElement("Description"),t._writeCData(this.htmlDescription),t._writeEndElement(),null!=this._backgroundImageSet&&(t._writeStartElement("BackgroundImageSet"),Co.saveToXml(t,this._backgroundImageSet,""),t._writeEndElement()),null!=this._studyImageset&&Co.saveToXml(t,this._studyImageset,""),t._writeEndElement()},get_bounds:function(){return this._bounds},set_bounds:function(t){return this._bounds=t,t},get_isImage:function(){return null!=this._studyImageset||null!=this._backgroundImageSet},get_isTour:function(){return!1},get_isFolder:function(){return!1},get_children:function(){return[]},get_readOnly:function(){return!0},get_target:function(){return this._camParams.target},set_target:function(t){return this._camParams.target=t,t},get_isCloudCommunityItem:function(){return!1}};function nl(){this.parent=null,this._bounds=new Ai}n("Place",[tl,il,null,ua,ca]),el=tl.create,Ir=el;var rl={get_name:function(){return"Up Level"},get_thumbnail:function(){return this._thumbnail},set_thumbnail:function(t){return this._thumbnail=t,t},get_thumbnailUrl:function(){return zr.singleton.engineAssetUrl("thumb_folderup.jpg")},set_thumbnailUrl:function(t){return t},get_bounds:function(){return this._bounds},set_bounds:function(t){return this._bounds=t,t},get_isImage:function(){return!1},get_isTour:function(){return!1},get_isFolder:function(){return!1},get_isCloudCommunityItem:function(){return!1},get_readOnly:function(){return!1},get_children:function(){return null==this.parent?[]:this.parent.get_children()}};function sl(){}function al(){this.ABC=new wn,this.abc1=new wn,this.pointSize=0,this.w=0,this.e=0,this.n=0,this.t=0,this.a=0,this.z=0,this.orbitPos=0,this.orbits=0}function ol(){this.theta=0,this.phi=0}function ll(){this.userLevel=0,this.classification=0,this.averageRating=0,this.lengthInSecs=0,this._thumbnailUrlField=""}n("FolderUp",[nl,rl,null,ua]),sl._galaxyImageIndexBuffer=null,sl._galaxyImageTriangleCount=0,sl._milkyWayImage=null,sl._starSprites=null,sl._starCount=0,sl._starsDownloading=!1,sl._stars=null,sl._hipparcosIndex={},sl._limitingMagnitude=16,sl._galaxyTextures=null,sl._galaxyVertexCounts=null,sl._largeSet=!0,sl._cosmosReady=!1,sl._cosmos=null,sl._downloadingGalaxy=!1,sl._eclipticCount=0,sl._eclipticYear=0,sl._monthDays=[31,28.2421,31,30,31,30,31,31,30,31,30,31],sl._monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],sl._eclipticTextYear=0,sl._createGalaxyImage=function(t){null==sl._milkyWayImage&&(sl._milkyWayImage=rs.fromUrl(zr.singleton.engineAssetUrl("milkywaybar.jpg")));var e,i,n=50,r=0;sl._galaxyImageVertexBuffer=new Kr(2601);var s,a,o,l=sl._galaxyImageVertexBuffer.lock(),h=608e5,u=Qs.meanObliquityOfEcliptic(Wo.get_jNow())/180*Math.PI;for(a=0;a<=n;a++)for(e=a!==n?-64- -2.56*a:64,s=0;s<=n;s++)i=s!==n?2.56*s-64:64,r=51*a+s,(o=wn.create(i*h,0,(e-28)*h)).rotateY(213/180*Math.PI),o.rotateZ(-.3492875*Math.PI),o.rotateY(-192.8595083/180*Math.PI),o.rotateX(u),l[r]=cn.createPosRaw(o,1-.02*s,.02*a);sl._galaxyImageVertexBuffer.unlock(),sl._galaxyImageTriangleCount=5e3;var c=new Uint16Array(15e3),_=c;for(a=0;a<n;a++)for(s=0;s<n;s++)_[r=a*n*6+6*s]=51*a+s,_[r+2]=51*(a+1)+s,_[r+1]=51*a+(s+1),_[r+3]=51*a+(s+1),_[r+5]=51*(a+1)+s,_[r+4]=51*(a+1)+(s+1);sl._galaxyImageIndexBuffer=Hi.createBuffer(),Hi.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,sl._galaxyImageIndexBuffer),Hi.bufferData(Yr.ELEMENT_ARRAY_BUFFER,c,Yr.STATIC_DRAW)},sl.drawGalaxyImage=function(t,e){null==sl._galaxyImageIndexBuffer&&sl._createGalaxyImage(t);var i=t.viewCamera.zoom,n=128*(Math.log(Math.max(1,i))/Math.log(4)-14);Math.min(255,Math.max(0,n)),bs.use(t,sl._galaxyImageVertexBuffer.vertexBuffer,sl._galaxyImageIndexBuffer,sl._milkyWayImage.texture2d,e,!0),t.gl.drawElements(Yr.TRIANGLES,3*sl._galaxyImageTriangleCount,Yr.UNSIGNED_SHORT,0)},sl.drawStars3D=function(e,i){var n=e.viewCamera.zoom,r=Math.max(Math.min(255,40.8*(Math.log(n)-15.5)),0),s=Math.min(255,Math.max(0,t.ss.truncate(r)));s>254||(s=(255-s)*i,null==sl._starSprites&&sl.initStarVertexBuffer(e),null!=sl._starSprites&&sl._starSprites.draw(e,s/255,!1))},sl.initStarVertexBuffer=function(e){if(sl._starsDownloading||Mr||(sl.getStarFile(zr.singleton.coreStaticUrl("wwtweb/catalog.aspx?Q=hipparcos")),sl._starsDownloading=!0),null==sl._starSprites&&sl._starCount>0){var i=Qs.meanObliquityOfEcliptic(Wo.get_jNow())/180*Math.PI,n=sl._stars.length;sl._starCount=n,sl._starSprites=new zs(e),sl._starSprites.depthBuffered=!1,sl._starSprites.showFarSide=!0;for(var r=t.ss.enumerate(sl._stars);r.moveNext();){var s=r.current,a=Qs.raDecTo3dAu(s.RA,s.dec,s.distance);a.rotateX(i),s.position=a;var o=12e5/Math.pow(1.6,s.absoluteMagnitude);sl._starSprites.addPoint(a,s.col,new As(0,1),100*o)}}},sl.initializeStarDB=function(e){if(null==sl._stars&&null==sl._stars){sl._stars=[];for(var i,n=e.split("\r\n"),r=t.ss.enumerate(n);r.moveNext();)(i=new Ea(r.current)).magnitude<sl._limitingMagnitude&&i.par>.001&&(sl._stars.push(i),sl._hipparcosIndex[i.id]=i);sl._starCount=sl._stars.length}},sl.getStarFile=function(t){sl._webFileStar=new $a(t),sl._webFileStar.onStateChange=sl.starFileStateChange,sl._webFileStar.send()},sl.starFileStateChange=function(){2===sl._webFileStar.get_state()?alert(sl._webFileStar.get_message()):1===sl._webFileStar.get_state()&&sl.initializeStarDB(sl._webFileStar.getText())},sl.getGalaxyFile=function(t){sl._webFileGalaxy=new $a(t),sl._webFileGalaxy.responseType="blob",sl._webFileGalaxy.onStateChange=sl.galaxyFileStateChange,sl._webFileGalaxy.send()},sl.galaxyFileStateChange=function(){if(2===sl._webFileGalaxy.get_state())alert(sl._webFileGalaxy.get_message());else if(1===sl._webFileGalaxy.get_state()){var t=sl._webFileGalaxy.getBlob(),e=new FileReader;e.onloadend=function(t){var i=new js(new Uint8Array(e.result));sl.initializeCosmos(i)},e.readAsArrayBuffer(t)}},sl.drawCosmos3D=function(e,i){e.gl;var n=e.viewCamera.zoom,r=90*(Math.log(Math.max(1,n))/Math.log(4)-15.5),s=Math.min(255,Math.max(0,t.ss.truncate(r)));if(!(s<3)){if(sl.initCosmosVertexBuffer(),null==sl._galaxyTextures&&sl._largeSet){sl._galaxyTextures=new Array(256);for(var a=0;a<256;a++){for(var o=a.toString();o.length<4;)o="0"+o;var l=t.ss.format(zr.singleton.engineAssetUrl("galimg/gal_{0}.jpg"),o);sl._galaxyTextures[a]=rs.fromUrl(l)}}if(sl._cosmosReady)for(a=0;a<256;a++)sl._cosmosSprites[a].drawTextured(e,sl._galaxyTextures[a].texture2d,s*i/255)}},sl.initCosmosVertexBuffer=function(){null==sl._cosmosSprites&&sl._downloadCosmosFile()},sl._createCosmosVertexBuffer=function(e){var i=256;if(null!=sl._cosmosSprites)for(var n=0;n<i;n++)null!=sl._cosmosSprites[n]&&(sl._cosmosSprites[n]=null);sl._cosmosSprites=null;var r=Qs.meanObliquityOfEcliptic(Wo.get_jNow())/180*Math.PI;sl._cosmosSprites=new Array(i);for(var s=new Array(i),a=0;a<i;a++)sl._galaxyVertexCounts[a],sl._cosmosSprites[a]=new zs(e),sl._cosmosSprites[a].depthBuffered=!1,sl._cosmosSprites[a].showFarSide=!0,s[a]=0;for(var o=t.ss.enumerate(sl._cosmos);o.moveNext();){var l=o.current,h=l.eTypeBucket,u=(s[h],Qs.raDecTo3dAu(l.RA,l.dec,206264.806*l.distance*1e6/.73));u.rotateX(r),l.position=u,sl._cosmosSprites[h].addPoint(u,Xi.get_white(),new As(0,1),1e9*l.size*100),s[h]++}sl._cosmosReady=!0},sl.initializeCosmos=function(t){if(Math.pow(100,2.849485002),null==sl._cosmos){if(sl._galaxyVertexCounts=new Array(sl._largeSet?256:20),null==sl._cosmos){var e;sl._cosmos=[];try{for(;t.get_position()<t.get_length();)e=new Da(t),sl._cosmos.push(e),sl._galaxyVertexCounts[e.eTypeBucket]++}catch(t){}t.close()}sl._createCosmosVertexBuffer(an)}},sl._downloadCosmosFile=function(){return sl._downloadingGalaxy||Mr||(sl.getGalaxyFile(zr.singleton.coreStaticUrl("wwtweb/catalog.aspx?Q=cosmosnewbin")),sl._downloadingGalaxy=!0),!1},sl.drawEquitorialGrid=function(t,e,i){if(null==sl._equLineList){sl._equLineList=new Is,sl._equLineList.set_depthBuffered(!1);for(var n=0;n<24;n++)for(var r=-80;r<80;r+=2)sl._equLineList.addLine(Qs.raDecTo3dAu(n,r,1),Qs.raDecTo3dAu(n,r+2,1));for(r=-80;r<=80;r+=10)for(n=0;n<23.8;n+=.2)sl._equLineList.addLine(Qs.raDecTo3dAu(n,r,1),Qs.raDecTo3dAu(n+.2,r,1));for(var s=0,a=0;a<24;a+=.25){switch(r=.5,s%4){case 0:s++;continue;case 3:case 1:r=.25}s++,sl._equLineList.addLine(Qs.raDecTo3dAu(a,r,1),Qs.raDecTo3dAu(a,-r,1))}for(s=0,a=0;a<24;a+=3)for(s=0,r=-80;r<=80;r+=1){var o=.5/30;switch(s%10){case 0:s++;continue;case 5:o=.5/15}s++,sl._equLineList.addLine(Qs.raDecTo3dAu(a+o,r,1),Qs.raDecTo3dAu(a-o,r,1))}}return sl._equLineList.drawLines(t,e,i),!0},sl.drawEquitorialGridText=function(t,e,i){return sl._makeEquitorialGridText(),sl._equTextBatch.draw(t,e,i),!0},sl._makeEquitorialGridText=function(){if(null==sl._equTextBatch){sl._equTextBatch=new Fo(30);for(var t=0;t<24;t++){var e=t.toString()+" hr";t<10&&(e="  "+t.toString()+" hr"),sl._equTextBatch.add(new Uo(Qs.raDecTo3dAu(t+.005,.4,1),Qs.raDecTo3dAu(t+.005,.5,1),e,45,18e-5))}for(t=0;t<24;t+=3)for(var i=-80;i<=80;i+=10)i&&(e=i.toString(),i>0?(e="  +"+i.toString(),sl._equTextBatch.add(new Uo(Qs.raDecTo3dAu(t,i-.4,1),Qs.raDecTo3dAu(t,i-.3,1),e,45,18e-5))):(e="  - "+e.substr(1),sl._equTextBatch.add(new Uo(Qs.raDecTo3dAu(t,i+.4,1),Qs.raDecTo3dAu(t,i+.5,1),e,45,18e-5))))}},sl.drawEcliptic=function(e,i,n){var r=Wo.get_now().getUTCFullYear();if(null==sl._eclipticOverviewLineList||r!==sl._eclipticYear){null!=sl._eclipticOverviewLineList&&(sl._eclipticOverviewLineList.clear(),sl._eclipticOverviewLineList=null),sl._eclipticYear=r;var s=Qs.meanObliquityOfEcliptic(Wo.get_jNow()),a=yn._rotationX(-s/360*(2*Math.PI)),o=365.25;h.isLeap(r,!0)?(sl._monthDays[1]=29,o=366):(sl._monthDays[1]=28,o=365),t.ss.truncate(o),sl._eclipticCount=t.ss.truncate(o);var l=Wo.utcToJulian(new Date(r,0,1,12,0,0));sl._eclipticOverviewLineList=new Is,sl._eclipticOverviewLineList.set_depthBuffered(!1);for(var u=0;u<12;u++){for(var c=t.ss.truncate(sl._monthDays[u]),_=0;_<c;_++){var g=Jo.getPlanetLocationJD("Sun",l),f=.005;_||(f=.01);var m=d.eq2Ec(g.RA,g.dec,s).x;sl._eclipticOverviewLineList.addLine(wn._transformCoordinate(wn.create(Math.cos(m*Math.PI*2/360),f,Math.sin(m*Math.PI*2/360)),a),wn._transformCoordinate(wn.create(Math.cos(m*Math.PI*2/360),-f,Math.sin(m*Math.PI*2/360)),a)),l+=1}sl._monthDays[u]}}return sl._eclipticOverviewLineList.drawLines(e,i,n),!0},sl.drawEclipticText=function(t,e,i){return sl._makeEclipticText(),sl._eclipOvTextBatch.draw(t,e,i),!0},sl._makeEclipticText=function(){var e=Wo.get_now().getUTCFullYear();if(null==sl._eclipOvTextBatch){sl._eclipOvTextBatch=new Fo(80),sl._eclipticTextYear=e;var i=Qs.meanObliquityOfEcliptic(Wo.get_jNow()),n=yn._rotationX(-i/360*(2*Math.PI)),r=365.25;h.isLeap(e,!0)?(sl._monthDays[1]=29,r=366):(sl._monthDays[1]=28,r=365),t.ss.truncate(r),sl._eclipticCount=t.ss.truncate(r);for(var s=Wo.utcToJulian(new Date(e,0,1,12,0,0)),a=0;a<12;a++){for(var o=t.ss.truncate(sl._monthDays[a]),l=0;l<o;l++){var u=Jo.getPlanetLocationJD("Sun",s),c=d.eq2Ec(u.RA,u.dec,i).x;if(l===Math.floor(o/2)){var _=wn._transformCoordinate(wn.create(Math.cos(c*Math.PI*2/360),.025,Math.sin(c*Math.PI*2/360)),n),g=wn._transformCoordinate(wn.create(Math.cos(c*Math.PI*2/360),.045,Math.sin(c*Math.PI*2/360)),n);g.subtract(_),g.normalize(),sl._eclipOvTextBatch.add(new Uo(_,g,sl._monthNames[a],80,159375e-9))}s+=1}sl._monthDays[a]}}},sl.drawPrecessionChart=function(t,e,i){return sl._makePrecessionChart(),sl._precTextBatch.draw(t,e,i),sl._precLineList.drawLines(t,e,i),!0},sl._makePrecessionChart=function(){var t=Qs.meanObliquityOfEcliptic(Wo.get_jNow()),e=yn._rotationX(t/360*(2*Math.PI));if(Xi.get_white(),null==sl._precLineList){sl._precLineList=new Is,sl._precLineList.set_depthBuffered(!1);for(var i=0;i<360;i++){var n=90-t;sl._precLineList.addLine(wn._transformCoordinate(Qs.raDecTo3dAu(i/15,n,1),e),wn._transformCoordinate(Qs.raDecTo3dAu((i+1)/15,n,1),e))}for(i=-12e3;i<13e3;i+=2e3){n=90-t;var r=-(i-2e3)/25772*24-6;sl._precLineList.addLine(wn._transformCoordinate(Qs.raDecTo3dAu(r,n-.5,1),e),wn._transformCoordinate(Qs.raDecTo3dAu(r,n+.5,1),e))}}if(null==sl._precTextBatch)for(sl._precTextBatch=new Fo(50),i=-12e3;i<13e3;i+=2e3){n=90-t+3,r=-(i-2e3)/25772*24-6;var s=i.toString();i?s=i<0?"  "+Math.abs(i).toString()+" BCE":Math.abs(i).toString()+" CE":(n=90-t+2,s="1 CE"),9===s.length&&(s="   "+s),sl._precTextBatch.add(new Uo(wn._transformCoordinate(Qs.raDecTo3dAu(r,n,1),e),wn._transformCoordinate(Qs.raDecTo3dAu(r+.01,n,1),e),s,75,15e-5))}},sl.drawAltAzGrid=function(t,e,i){var n=new Qs(0,0),r=Qs.horizonToEquitorial(n,Wo.get_location(),Wo.get_now()),s=-(r.get_RA()+6)/24*(2*Math.PI),a=-r.get_dec()/360*(2*Math.PI),o=(Qs.formatDMS(r.get_RA()),yn._rotationY(-s));if(o._multiply(yn._rotationX(a)),o.invert(),null==sl._altAzLineList){sl._altAzLineList=new Is,sl._altAzLineList.set_depthBuffered(!1);for(var l=0;l<360;l+=10)for(var h=-80;h<80;h+=2)sl._altAzLineList.addLine(Qs.raDecTo3dAu(l/15,h,1),Qs.raDecTo3dAu(l/15,h+2,1));for(h=-80;h<=80;h+=10)for(l=0;l<360;l+=5)sl._altAzLineList.addLine(Qs.raDecTo3dAu(l/15,h,1),Qs.raDecTo3dAu((l+5)/15,h,1));var u=0;for(l=0;l<360;l+=1){switch(h=.25,u%10){case 0:u++;continue;case 5:h=.5}u++,sl._altAzLineList.addLine(Qs.raDecTo3dAu(l/15,h,1),Qs.raDecTo3dAu(l/15,-h,1))}for(u=0,l=0;l<360;l+=90)for(u=0,h=-80;h<=80;h+=1){var c=.25;switch(u%10){case 0:u++;continue;case 5:c=.5}u++,sl._altAzLineList.addLine(Qs.raDecTo3dAu((l+c)/15,h,1),Qs.raDecTo3dAu((l-c)/15,h,1))}}var _=t.get_world().clone(),d=t.get_worldBase().clone();return t.set_worldBase(yn.multiplyMatrix(o,t.get_world())),t.set_world(t.get_worldBase().clone()),t.makeFrustum(),sl._altAzLineList.viewTransform=yn.invertMatrix(o),sl._altAzLineList.drawLines(t,e,i),t.set_worldBase(d),t.set_world(_),t.makeFrustum(),!0},sl.drawAltAzGridText=function(t,e,i){var n=new Qs(0,0),r=Qs.horizonToEquitorial(n,Wo.get_location(),Wo.get_now()),s=-(r.get_RA()-6)/24*(2*Math.PI),a=-r.get_dec()/360*(2*Math.PI),o=(Qs.formatDMS(r.get_RA()),yn._rotationY(-s-Math.PI));o._multiply(yn._rotationX(a)),o.invert(),sl._makeAltAzGridText();var l=t.get_world().clone(),h=t.get_worldBase().clone();return t.set_worldBase(yn.multiplyMatrix(o,t.get_world())),t.set_world(t.get_worldBase().clone()),t.makeFrustum(),sl._altAzTextBatch.viewTransform=yn.invertMatrix(o),sl._altAzTextBatch.draw(t,e,i),t.set_worldBase(h),t.set_world(l),t.makeFrustum(),!0},sl._makeAltAzGridText=function(){if(Xi.get_white(),null==sl._altAzTextBatch){sl._altAzTextBatch=new Fo(30);for(var t=0;t<360;t+=10){var e="       "+t.toString();t<10?e="   "+t.toString():t<100&&(e="     "+t.toString());var i=360-t;sl._altAzTextBatch.add(new Uo(Qs.raDecTo3dAu(i/15-6,.4,1),Qs.raDecTo3dAu(i/15-6,.5,1),e,75,18e-5))}for(t=0;t<360;t+=90)for(var n=-80;n<=80;n+=10)n&&(e=n.toString(),n>0?(e="  +"+n.toString(),sl._altAzTextBatch.add(new Uo(Qs.raDecTo3dAu(t/15,n-.4,1),Qs.raDecTo3dAu(t/15,n-.3,1),e,75,18e-5))):(e="  - "+e.substr(1),sl._altAzTextBatch.add(new Uo(Qs.raDecTo3dAu(t/15,n+.4,1),Qs.raDecTo3dAu(t/15,n+.5,1),e,75,18e-5))))}},sl.drawEclipticGrid=function(t,e,i){if(null==sl._eclipticLineList){sl._eclipticLineList=new Is,sl._eclipticLineList.set_depthBuffered(!1);for(var n=Qs.meanObliquityOfEcliptic(2451545),r=yn._rotationX(-n/360*(2*Math.PI)),s=0;s<360;s+=10)for(var a=-80;a<80;a+=2)sl._eclipticLineList.addLine(wn._transformCoordinate(Qs.raDecTo3dAu(s/15,a,1),r),wn._transformCoordinate(Qs.raDecTo3dAu(s/15,a+2,1),r));for(a=-80;a<=80;a+=10)for(s=0;s<360;s+=5)sl._eclipticLineList.addLine(wn._transformCoordinate(Qs.raDecTo3dAu(s/15,a,1),r),wn._transformCoordinate(Qs.raDecTo3dAu((s+5)/15,a,1),r));var o=0;for(s=0;s<360;s+=1){switch(a=.25,o%10){case 0:o++;continue;case 5:a=.5}o++,sl._eclipticLineList.addLine(wn._transformCoordinate(Qs.raDecTo3dAu(s/15,a,1),r),wn._transformCoordinate(Qs.raDecTo3dAu(s/15,-a,1),r))}for(o=0,s=0;s<360;s+=90)for(o=0,a=-80;a<=80;a+=1){var l=.25;switch(o%10){case 0:o++;continue;case 5:l=.5}o++,sl._eclipticLineList.addLine(wn._transformCoordinate(Qs.raDecTo3dAu((s+l)/15,a,1),r),wn._transformCoordinate(Qs.raDecTo3dAu((s-l)/15,a,1),r))}}return sl._eclipticLineList.drawLines(t,e,i),!0},sl.drawEclipticGridText=function(t,e,i){return sl._makeEclipticGridText(),sl._eclipticTextBatch.draw(t,e,i),!0},sl._makeEclipticGridText=function(){Xi.get_white();var t=Qs.meanObliquityOfEcliptic(Wo.get_jNow()),e=yn._rotationX(-t/360*(2*Math.PI));if(null==sl._eclipticTextBatch){sl._eclipticTextBatch=new Fo(30);for(var i=0;i<360;i+=10){var n="       "+i.toString();i<10?n="   "+i.toString():i<100&&(n="     "+i.toString()),sl._eclipticTextBatch.add(new Uo(wn._transformCoordinate(Qs.raDecTo3dAu(i/15,.4,1),e),wn._transformCoordinate(Qs.raDecTo3dAu(i/15,.5,1),e),n,75,18e-5))}for(i=0;i<360;i+=90)for(var r=-80;r<=80;r+=10)r&&(n=r.toString(),r>0?(n="  +"+r.toString(),sl._eclipticTextBatch.add(new Uo(wn._transformCoordinate(Qs.raDecTo3dAu(i/15,r-.4,1),e),wn._transformCoordinate(Qs.raDecTo3dAu(i/15,r-.3,1),e),n,75,18e-5))):(n="  - "+n.substr(1),sl._eclipticTextBatch.add(new Uo(wn._transformCoordinate(Qs.raDecTo3dAu(i/15,r+.4,1),e),wn._transformCoordinate(Qs.raDecTo3dAu(i/15,r+.5,1),e),n,75,18e-5))))}},sl.drawGalacticGrid=function(t,e,i){if(null==sl._galLineList){sl._galLineList=new Is,sl._galLineList.set_depthBuffered(!1);for(var n=0;n<360;n+=10)for(var r=-80;r<80;r+=2)sl._galLineList.addLine(Qs.galacticTo3dDouble(n,r),Qs.galacticTo3dDouble(n,r+2));for(r=-80;r<=80;r+=10)for(n=0;n<360;n+=5)sl._galLineList.addLine(Qs.galacticTo3dDouble(n,r),Qs.galacticTo3dDouble(n+5,r));var s=0;for(n=0;n<360;n+=1){switch(r=.25,s%10){case 0:s++;continue;case 5:r=.5}s++,sl._galLineList.addLine(Qs.galacticTo3dDouble(n,r),Qs.galacticTo3dDouble(n,-r))}for(s=0,n=0;n<360;n+=90)for(s=0,r=-80;r<=80;r+=1){var a=.25;switch(s%10){case 0:s++;continue;case 5:a=.5}s++,sl._galLineList.addLine(Qs.galacticTo3dDouble(n+a,r),Qs.galacticTo3dDouble(n-a,r))}}return sl._galLineList.drawLines(t,e,i),!0},sl.drawGalacticGridText=function(t,e,i){return sl._makeGalacticGridText(),sl._galTextBatch.draw(t,e,i),!0},sl._makeGalacticGridText=function(){if(null==sl._galTextBatch){sl._galTextBatch=new Fo(30);for(var t=0;t<360;t+=10){var e="       "+t.toString();t<10?e="   "+t.toString():t<100&&(e="     "+t.toString()),sl._galTextBatch.add(new Uo(Qs.galacticTo3dDouble(t,.4),Qs.galacticTo3dDouble(t,.5),e,75,18e-5))}for(t=0;t<360;t+=90)for(var i=-80;i<=80;i+=10)i&&(e=i.toString(),i>0?(e="  +"+i.toString(),sl._galTextBatch.add(new Uo(Qs.galacticTo3dDouble(t,i-.4),Qs.galacticTo3dDouble(t,i-.3),e,75,18e-5))):(e="  - "+e.substr(1),sl._galTextBatch.add(new Uo(Qs.galacticTo3dDouble(t,i+.4),Qs.galacticTo3dDouble(t,i+.5),e,75,18e-5))))}},sl.drawPlanetGrid=function(t,e,i){if(null==sl._planetLineList){sl._planetLineList=new Is,sl._planetLineList.set_depthBuffered(!0);for(var n=0;n<360;n+=10)for(var r=-80;r<80;r+=2)sl._planetLineList.addLine(Qs.geoTo3dDouble(r,n),Qs.geoTo3dDouble(r+2,n));for(r=-80;r<=80;r+=10)for(var s=0;s<360;s+=5)sl._planetLineList.addLine(Qs.geoTo3dDouble(r,s),Qs.geoTo3dDouble(r,s+5));var a=0;for(n=0;n<360;n+=1){switch(r=.25,a%10){case 0:a++;continue;case 5:r=.5}a++,sl._planetLineList.addLine(Qs.geoTo3dDouble(r,n),Qs.geoTo3dDouble(-r,n))}for(a=0,n=0;n<360;n+=90){a=0;for(var o=-80;o<=80;o+=1){var l=.25;switch(a%10){case 0:a++;continue;case 5:l=.5}a++,sl._planetLineList.addLine(Qs.geoTo3dDouble(o,n+l),Qs.geoTo3dDouble(o,n-l))}}}return sl._planetLineList.aaFix=!1,sl._planetLineList.set_depthBuffered(!0),sl._planetLineList.sky=!1,sl._planetLineList.drawLines(t,e,i),!0},sl.drawPlanetGridText=function(t,e,i){return sl._makePlanetGridText(),sl._planetTextBatch.draw(t,e,i),!0},sl._makePlanetGridText=function(){if(null==sl._planetTextBatch){sl._planetTextBatch=new Fo(80);for(var t=-180;t<180;t+=10){var e="       "+t.toString();t<10?e="   "+t.toString():t<100&&(e="     "+t.toString()),sl._planetTextBatch.add(new Uo(Qs.geoTo3dDouble(.4,t),Qs.geoTo3dDouble(.5,t),e,-80,6e-5))}for(t=0;t<360;t+=90)for(var i=-80;i<=80;i+=10)i&&(e=i.toString(),i>0?(e="  +"+i.toString(),sl._planetTextBatch.add(new Uo(Qs.geoTo3dDouble(i-.4,t),Qs.geoTo3dDouble(i-.3,t),e,-80,6e-5))):(e="  - "+e.substring(1),sl._planetTextBatch.add(new Uo(Qs.geoTo3dDouble(i+.4,t),Qs.geoTo3dDouble(i+.5,t),e,-80,6e-5))))}},n("Grids",[sl,{},null]),al._sine=0,al._cose=1,al._degrad=Math.PI/180,n("KeplerVertex",[al,{fill:function(t){var e=Math.cos(t.omega*al._degrad),i=Math.sin(t.omega*al._degrad),n=Math.cos(t.i*al._degrad),r=Math.sin(t.i*al._degrad),s=i*al._cose,a=i*al._sine,o=-i*n,l=e*n*al._cose-r*al._sine,h=e*n*al._sine+r*al._cose;this.ABC.x=Math.atan2(e,o),this.ABC.y=Math.atan2(s,l),this.ABC.z=Math.atan2(a,h),this.abc1.x=Math.sqrt(e*e+o*o),this.abc1.y=Math.sqrt(s*s+l*l),this.abc1.z=Math.sqrt(a*a+h*h),this.pointSize=.1,t.a<2.5?this.color=Xi.get_white():t.a<2.83?this.color=Xi.get_red():t.a<2.96?this.color=Xi.get_green():t.a<3.3?this.color=Xi.get_magenta():t.a<5?this.color=Xi.get_cyan():t.a<10?(this.color=Xi.get_yellow(),this.pointSize=.9):(this.color=Xi.get_white(),this.pointSize=8),this.w=t.w,this.e=t.e,t.n?this.n=t.n:this.n=.9856076686/(t.a*Math.sqrt(t.a)),this.t=t.t-al.baseDate,this.a=t.a,this.z=0,this.orbitPos=0,this.orbits=0}},null]),ol.create=function(t,e){var i=new ol;return i.theta=t,i.phi=e,i},n("Pointing",[ol,{normalizeTheta:function(){this.theta=oa.fmodulo(this.theta,2*Math.PI),this.theta>Math.PI&&(this.phi+=Math.PI,this.theta=2*Math.PI-this.theta)},normalize:function(){this.normalizeTheta(),this.phi=oa.fmodulo(this.phi,2*Math.PI)},toString:function(){var e=new t.ss.StringBuilder;return e.append("ptg("),e.append(this.theta),e.append(","),e.append(this.phi),e.append(")"),e.toString()}},null]),ll._fromXml=function(t){var e=new ll;return null!=t.attributes.getNamedItem("ID")&&(e.id=t.attributes.getNamedItem("ID").nodeValue),null!=t.attributes.getNamedItem("TourUrl")&&(e._tourUrl=t.attributes.getNamedItem("TourUrl").nodeValue),null!=t.attributes.getNamedItem("Title")&&(e.title=t.attributes.getNamedItem("Title").nodeValue),null!=t.attributes.getNamedItem("Description")&&(e.description=t.attributes.getNamedItem("Description").nodeValue),null!=t.attributes.getNamedItem("Classification")&&(e.classification=s.parse("Classification",t.attributes.getNamedItem("Classification").nodeValue)),null!=t.attributes.getNamedItem("AuthorEmail")&&(e.authorEmail=t.attributes.getNamedItem("AuthorEmail").nodeValue),null!=t.attributes.getNamedItem("Author")&&(e.author=t.attributes.getNamedItem("Author").nodeValue),null!=t.attributes.getNamedItem("AuthorURL")&&(e.authorURL=t.attributes.getNamedItem("AuthorURL").nodeValue),null!=t.attributes.getNamedItem("AuthorImageUrl")&&(e.authorImageUrl=t.attributes.getNamedItem("AuthorImageUrl").nodeValue),null!=t.attributes.getNamedItem("AverageRating")&&(e.averageRating=parseFloat(t.attributes.getNamedItem("AverageRating").nodeValue)),null!=t.attributes.getNamedItem("LengthInSecs")&&(e.lengthInSecs=parseFloat(t.attributes.getNamedItem("LengthInSecs").nodeValue)),null!=t.attributes.getNamedItem("OrganizationUrl")&&(e.organizationUrl=t.attributes.getNamedItem("OrganizationUrl").nodeValue),null!=t.attributes.getNamedItem("OrganizationName")&&(e.organizationName=t.attributes.getNamedItem("OrganizationName").nodeValue),null!=t.attributes.getNamedItem("RelatedTours")&&(e.relatedTours=t.attributes.getNamedItem("RelatedTours").nodeValue),null!=t.attributes.getNamedItem("Keywords")&&(e.keywords=t.attributes.getNamedItem("Keywords").nodeValue),null!=t.attributes.getNamedItem("ThumbnailUrl")&&e.set_thumbnailUrl(t.attributes.getNamedItem("ThumbnailUrl").nodeValue),e};var hl={get_name:function(){return this.title},get_thumbnail:function(){return this._thumbnail},set_thumbnail:function(t){return this._thumbnail=t,t},get_thumbnailUrl:function(){return t.ss.emptyString(this._thumbnailUrlField)?Mr?zr.singleton.engineAssetUrl("thumb_star.jpg"):t.ss.format(zr.singleton.coreStaticUrl("wwtweb/GetTourThumbnail.aspx?GUID={0}"),this.id):this._thumbnailUrlField},set_thumbnailUrl:function(t){return this._thumbnailUrlField=t,t},get_tourUrl:function(){return t.ss.emptyString(this._tourUrl)&&!Mr?t.ss.format(zr.singleton.coreStaticUrl("wwtweb/GetTour.aspx?GUID={0}"),this.id):this._tourUrl},set_tourUrl:function(t){return this._tourUrl=t,t},get_bounds:function(){return this._bounds},set_bounds:function(t){return this._bounds=t,t},get_isImage:function(){return!1},get_isTour:function(){return!0},get_isFolder:function(){return!1},get_isCloudCommunityItem:function(){return!1},get_readOnly:function(){return!1},get_children:function(){return[]}};function ul(t,e,i,n,r){this.fps=0,this.width=0,this.height=0,this.totalFrames=0,this.waitDownload=!1,this.format="image/jpeg",this.width=t,this.height=e,this.fps=i,this.format=n,this.waitDownload=r}function cl(t,e,i,n,r,s){this.interpolationType=0,this.fastDirectionMove=!1,this._toTargetTime=0,this._dateTimeSpan=0,this._complete=!1,this._midpointFired=!1,this.interpolationType=s,Math.abs(t.lng-e.lng)>180&&(t.lng>e.lng?t.lng-=360:t.lng+=360),this._fromDateTime=n,this._toDateTime=r,this._dateTimeSpan=r-n,this._from=t.copy(),this._to=e.copy(),this._fromTime=Wo.get_metaNow(),this._toTargetTime=i}n("Tour",[ll,hl,null,ua]),n("VideoOutputType",[ul,{},null]);var _l={get_complete:function(){return this._complete},get_currentPosition:function(){var t=(Wo.get_metaNow()-this._fromTime)/1e3/this._toTargetTime;return!this._midpointFired&&t>=.5&&(this._midpointFired=!0,null!=this._midpoint&&this._midpoint()),t>=1?(t=1,this._complete=!0,this._to.copy()):ko.get_active().get_galacticMode()&&an.space?Aa.interpolateGreatCircle(this._from,this._to,t,this.interpolationType,this.fastDirectionMove):Aa.interpolate(this._from,this._to,t,this.interpolationType,this.fastDirectionMove)},get_currentDateTime:function(){var e=(Wo.get_metaNow()-this._fromTime)/1e3/this._toTargetTime,i=this._dateTimeSpan*e;return new Date(this._fromDateTime.getTime()+t.ss.truncate(i))},get_midpoint:function(){return this._midpoint},set_midpoint:function(t){return this._midpoint=t,t},get_moveTime:function(){return this._toTargetTime}};function dl(){this._upTargetTime=0,this._downTargetTime=0,this._toTargetTime=0,this._upTimeFactor=.6,this._downTimeFactor=.6,this._travelTimeFactor=7,this._midpointFired=!1,this._complete=!1}n("ViewMoverKenBurnsStyle",[cl,_l,null,da]),dl.create=function(t,e){var i=new dl;return i.init(t,e),i},dl.createUpDown=function(t,e,i){var n=new dl;return n._upTimeFactor=n._downTimeFactor=i,n.init(t.copy(),e.copy()),n};var gl={init:function(t,e){Math.abs(t.lng-e.lng)>180&&(t.lng>e.lng?t.lng-=360:t.lng+=360),e.zoom<=0&&(e.zoom=360),t.zoom<=0&&(t.zoom=360),this._from=t,this._to=e,this._fromTime=Wo.get_metaNow();var i,n=360,r=Math.abs(t.lng-e.lng),s=Math.abs(t.lat-e.lat),o=Math.sqrt(s*s+r*r);(n=o/3*20)>360&&(n=360),n<t.zoom&&(n=t.zoom),i=o/180*(360/n)*this._travelTimeFactor;var l=Math.max(Math.abs(t.angle-e.angle),Math.abs(t.rotation-e.rotation)),h=Math.max(Math.abs(a.logN(n,2)-a.logN(t.zoom,2)),l);this._upTargetTime=this._upTimeFactor*h,this._downTargetTime=this._upTargetTime+i;var u=Math.abs(a.logN(n,2)-a.logN(e.zoom,2));this._toTargetTime=this._downTargetTime+Math.max(this._downTimeFactor*u,l),this._fromTop=t.copy(),this._fromTop.zoom=n,this._fromTop.angle=(t.angle+e.angle)/2,this._fromTop.rotation=(t.rotation+e.rotation)/2,this._toTop=e.copy(),this._toTop.zoom=this._fromTop.zoom,this._toTop.angle=this._fromTop.angle,this._toTop.rotation=this._fromTop.rotation},get_complete:function(){return this._complete},get_currentPosition:function(){var t=(Wo.get_metaNow()-this._fromTime)/1e3;if(t<this._upTargetTime)return Aa.interpolate(this._from,this._fromTop,t/this._upTargetTime,3,!1);if(t<this._downTargetTime)return t-=this._upTargetTime,ko.get_active().get_galacticMode()&&an.space?Aa.interpolateGreatCircle(this._fromTop,this._toTop,t/(this._downTargetTime-this._upTargetTime),3,!1):Aa.interpolate(this._fromTop,this._toTop,t/(this._downTargetTime-this._upTargetTime),3,!1);this._midpointFired||(this._midpointFired=!0,null!=this._midpoint&&this._midpoint());var e=(t-=this._downTargetTime)/(this._toTargetTime-this._downTargetTime);return e>1?(e=1,this._complete=!0,this._to.copy()):Aa.interpolate(this._toTop,this._to,e,3,!1)},get_currentDateTime:function(){return Wo.updateClock(),Wo.get_now()},get_midpoint:function(){return this._midpoint},set_midpoint:function(t){return this._midpoint=t,t},get_moveTime:function(){return this._toTargetTime}};function fl(){this.table=[],this.items=[],this._imageReady=!1,this._dateColumn=0,this._latColumn=1,this._lngColumn=2,this._depthColumn=3,this._magColumn=4}function ml(){this.callBack=null,this.color=Xi.get_white()}function pl(){}n("ViewMoverSlew",[dl,gl,null,da]),fl.earthRadius=6371e3,n("VizLayer",[fl,{load:function(e){var i=this,n=e.split("\r\n");this._starProfile=document.createElement("img"),this._starProfile.addEventListener("load",(function(t){i._imageReady=!0}),!1),this._starProfile.src=zr.singleton.engineAssetUrl("StarProfileAlpha.png");for(var r=!1,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;r?this.table.push(a.split("\t")):(this.header=a.split("\t"),r=!0)}},prepare:function(){this._worldList=new Array(this.table.length),this._transformedList=new Array(this.table.length);for(var e=0,i=t.ss.enumerate(this.table);i.moveNext();){var n=i.current,r=new Cs;r.eventTime=t.ss.date(n[this._dateColumn]);var s=(6371e3-1e3*parseFloat(n[this._depthColumn]))/6371e3;r.location=Qs.geoTo3dRad(parseFloat(n[this._latColumn]),parseFloat(n[this._lngColumn])+180,s),r.tranformed=new wn,r.size=Math.pow(2,parseFloat(n[this._magColumn]))/50,this._worldList[e]=r.location,this._transformedList[e]=r.tranformed,this.items.push(r),e++}},draw:function(e){if(this._imageReady){e.device.save(),e.WVP.projectArrayToScreen(this._worldList,this._transformedList);var i=e.device;i.globalAlpha=.4;for(var n=e.width,r=e.height,s=(wn.makeCopy(e.get_viewPoint()),e.get_fovScale()/100),a=t.ss.enumerate(this.items);a.moveNext();){var o=a.current;if(o.tranformed.z<1){var l=o.tranformed.x,h=o.tranformed.y,u=4*o.size/s,c=u/2;l>-c&&l<n+c&&h>-c&&h<r+c&&i.drawImage(this._starProfile,l-u/2,h-u/2,u,u)}}e.device.restore()}}},null]),n("ColorPicker",[ml,{nonMenuClick:function(t){},show:function(t){Pr.showColorPicker(this,t)},getColorFromClick:function(t){var e=document.getElementById("colorhex"),i=document.createElement("canvas");i.width=e.width,i.height=e.height;var n=i.getContext("2d");n.drawImage(e,0,0);var r=n.getImageData(t.offsetX,t.offsetY,1,1).data;return this.color=Oi.fromArgb(r[3],r[0],r[1],r[2]),this.color},pickColor:function(t){this.callBack(this.color)}},null]);var wl={add_showDialogHook:function(e){this.__showDialogHook=t.ss.bindAdd(this.__showDialogHook,e)},remove_showDialogHook:function(e){this.__showDialogHook=t.ss.bindSub(this.__showDialogHook,e)},show:function(t,e){null!=this.__showDialogHook&&this.__showDialogHook(t,e)}};function bl(){this.image=null,this.layer=null,this.tile=null,this._dropDown=null,this._downPosition=0,this._lowPosition=0,this._highPosition=255,this._center=127,this._ignoreNextClick=!1,this._dragType=4,this._updated=!1,this.selectedCurveStyle=0}n("Dialog",[pl,wl,null]),bl.updateImage=function(e,i){if(!Ji){var n=t.ss.safeCast(e.get_imageSet().get_wcsImage(),Ja);rn(0,0,0,e.get_imageSet(),null).texture2d=n.getBitmap().getTexture()}},bl.updateScale=function(e,i,n,r){if(e.get_imageSet().get_fitsProperties().scaleType=i,e.get_imageSet().get_fitsProperties().lowerCut=n,e.get_imageSet().get_fitsProperties().upperCut=r,!Ji){var s=t.ss.safeCast(e.get_imageSet().get_wcsImage(),Ja);rn(0,0,0,e.get_imageSet(),null).texture2d=s.getBitmap().getTexture()}},bl.updateColorMapper=function(e,i){if(e.get_imageSet().get_fitsProperties().colorMapName=i,!Ji){var n=t.ss.safeCast(e.get_imageSet().get_wcsImage(),Ja);rn(0,0,0,e.get_imageSet(),null).texture2d=n.getBitmap().getTexture()}};var vl={close:function(e){var i=document.getElementById("histogram");document.getElementById("histogramClose"),i.style.display="none",window.removeEventListener("click",t.ss.bind("close",this),!0);var n=document.getElementById("graph");n.removeEventListener("mousedown",t.ss.bind("onPointerDown",this),!1),n.removeEventListener("mousemove",t.ss.bind("onPointerMove",this),!1),n.removeEventListener("mouseup",t.ss.bind("onPointerUp",this),!1),this._dropDown.removeEventListener("change",t.ss.bind("curveStyleSelected",this),!1),this._dropDown.removeEventListener("click",t.ss.bind("ignoreMe",this),!0)},show:function(e){this.tile=rn(0,0,0,this.layer.get_imageSet(),null);var i=document.getElementById("histogram"),n=document.getElementById("histogramClose");i.style.display="block",i.style.left=e.x.toString()+"px",i.style.top=e.y.toString()+"px",this.selectedCurveStyle=this.layer.get_imageSet().get_fitsProperties().scaleType,this._dropDown=document.getElementById("ScaleTypePicker"),this._dropDown.addEventListener("change",t.ss.bind("curveStyleSelected",this),!1),this._dropDown.addEventListener("click",t.ss.bind("ignoreMe",this),!0);var r=document.getElementById("graph");r.addEventListener("pointerdown",t.ss.bind("onPointerDown",this),!1),r.addEventListener("pointermove",t.ss.bind("onPointerMove",this),!1),r.addEventListener("pointerup",t.ss.bind("onPointerUp",this),!1),n.addEventListener("click",t.ss.bind("close",this),!0),this.draw()},ignoreMe:function(t){this._ignoreNextClick=!0},curveStyleSelected:function(t){this.selectedCurveStyle=this._dropDown.selectedIndex,this.setUpdateTimer(),this.layer.get_imageSet().get_fitsProperties().scaleType=this.selectedCurveStyle,this.draw(),this._ignoreNextClick=!0},onPointerDown:function(t){var e=document.getElementById("graph"),i=ki.offsetX(e,t),n=ki.offsetY(e,t);e.setPointerCapture(t.pointerId),Math.abs(i-this._center)<10&&Math.abs(n-75)<10?this._dragType=3:Math.abs(i-this._lowPosition)<10?this._dragType=0:Math.abs(i-this._highPosition)<10?this._dragType=1:(this._dragType=2,this._downPosition=Math.min(255,Math.max(0,i)),this.draw()),t.cancelBubble=!0},onPointerMove:function(t){var e=document.getElementById("graph"),i=ki.offsetX(e,t);switch(ki.offsetY(e,t),this._dragType){case 0:this._lowPosition=Math.min(255,Math.max(0,i));break;case 1:this._highPosition=Math.min(255,Math.max(0,i));break;case 2:this._lowPosition=this._downPosition,this._highPosition=Math.min(255,Math.max(0,i));break;case 3:var n=Math.abs(this._highPosition-this._lowPosition)/2,r=Math.min(255-n,Math.max(n,i)),s=this._center-r;this._lowPosition-=s,this._highPosition-=s;break;case 4:return}this._center=(this._lowPosition+this._highPosition)/2,this.draw();var a=(this.layer.get_imageSet().get_fitsProperties().maxVal-this.layer.get_imageSet().get_fitsProperties().minVal)/256,o=this.layer.get_imageSet().get_fitsProperties().minVal+this._lowPosition*a,l=this.layer.get_imageSet().get_fitsProperties().minVal+this._highPosition*a;this.setUpdateTimer(),this.layer.get_imageSet().get_fitsProperties().upperCut=l,this.layer.get_imageSet().get_fitsProperties().lowerCut=o,this.layer.get_imageSet().get_fitsProperties().scaleType=this.selectedCurveStyle,t.cancelBubble=!0},onPointerUp:function(t){t.srcElement.releasePointerCapture(t.pointerId),4!==this._dragType&&(this._dragType=4,this.setUpdateTimer(),this._ignoreNextClick=!0),t.cancelBubble=!0},setUpdateTimer:function(){var t=this;Ji||(setTimeout((function(){t.update()}),500),this._updated=!1)},update:function(){if(!this._updated){if(t.ss.canCast(this.image,Ja)){var e=(this.layer.get_imageSet().get_fitsProperties().maxVal-this.layer.get_imageSet().get_fitsProperties().minVal)/256,i=this.layer.get_imageSet().get_fitsProperties().minVal+this._lowPosition*e,n=this.layer.get_imageSet().get_fitsProperties().minVal+this._highPosition*e;this.tile.texture2d=this.image.getScaledBitmap(i,n,this.selectedCurveStyle,0,null).getTexture()}this._updated=!0}},draw:function(){var t=document.getElementById("graph").getContext("2d");null!=this.image&&this.image.drawHistogram(t);var e="rgba(0,0,255,255)";t.strokeStyle="rgba(255,0,0,255)",t.beginPath(),t.moveTo(this._lowPosition,0),t.lineTo(this._lowPosition,150),t.stroke(),t.strokeStyle="rgba(0,255,0,255)",t.beginPath(),t.moveTo(this._highPosition,0),t.lineTo(this._highPosition,150),t.stroke(),t.strokeStyle=e,t.beginPath(),t.arc(this._center,75,10,0,2*Math.PI,!1),t.closePath(),t.stroke();var i=[];switch(this.selectedCurveStyle){case 0:i.length=0,i.push(vn.create(this._lowPosition,150)),i.push(vn.create(this._highPosition,0));break;case 1:i.length=0;for(var n=150/Math.log(255),r=(l=this._highPosition-this._lowPosition)<0?-1:1,s=Math.abs(256/(l||1e-6)),a=1e-6,o=this._lowPosition;o!==this._highPosition;o+=r)i.push(vn.create(o,150-Math.log(a)*n)),a+=s;break;case 2:for(i.length=0,n=150/Math.pow(255,2),r=(l=this._highPosition-this._lowPosition)<0?-1:1,s=Math.abs(256/(l||1e-6)),a=1e-6,o=this._lowPosition;o!==this._highPosition;o+=r)i.push(vn.create(o,150-Math.pow(a,2)*n)),a+=s;break;case 3:var l;for(i.length=0,n=150/Math.sqrt(255),r=(l=this._highPosition-this._lowPosition)<0?-1:1,s=Math.abs(256/(l||1e-6)),a=1e-6,o=this._lowPosition;o!==this._highPosition;o+=r)i.push(vn.create(o,150-Math.sqrt(a)*n)),a+=s}if(i.length>1){for(t.beginPath(),t.strokeStyle=e,t.moveTo(i[0].x,i[0].y),o=1;o<i.length;o++)t.lineTo(i[o].x,i[o].y);t.stroke()}}};n("Histogram",[bl,vl,null]);var yl=__webpack_require__(991),Sl=__webpack_require__.n(yl),xl={meters:1,feet:2,inches:3,miles:4,kilometers:5,astronomicalUnits:6,lightYears:7,parsecs:8,megaParsecs:9,custom:10};n("AltUnits",xl),r("AltUnits",xl);var Tl={fadeIn:1,fadeOut:2,both:3,none:4};function Ml(t,e){this.markerIndex=4,this.customMarker=null,this.text=t,this.markerIndex=e}function Cl(){this.id=Ii.newGuid(),this.loadedFromTour=!1,this.tourDocument=null,this.opacity=1,this.opened=!1,this._startTime=t.ss.date("01/01/1900"),this._endTime=t.ss.date("01/01/2100"),this._fadeSpan=0,this._fadeType=4,this.version=0,this.color=Xi.get_white(),this.enabled=!0,this.astronomical=!1}n("FadeType",Tl),r("FadeType",Tl),n("DomainValue",[Ml,{},null]);var Al={getPrimaryUI:function(){return null},getFileStreamUrl:function(t){return null!=this.tourDocument?this.tourDocument.getFileStream(t):null},get_opacity:function(){return this.opacity},set_opacity:function(t){return this.opacity!==t&&(this.version++,this.opacity=t),t},get_opened:function(){return this.opened},set_opened:function(t){return this.opened!==t&&(this.version++,this.opened=t),t},get_startTime:function(){return this._startTime},set_startTime:function(e){return t.ss.compareDates(this._startTime,e)||(this.version++,this._startTime=e),e},get_endTime:function(){return this._endTime},set_endTime:function(e){return t.ss.compareDates(this._endTime,e)||(this.version++,this._endTime=e),e},get_fadeSpan:function(){return this._fadeSpan},set_fadeSpan:function(t){return this.version++,this._fadeSpan=t,t},get_fadeType:function(){return this._fadeType},set_fadeType:function(t){return this._fadeType!==t&&(this.set_version(this.get_version()+1),this._fadeType=t),t},get_version:function(){return this.version},set_version:function(t){return this.version=t,t},findClosest:function(t,e,i,n){return i},hoverCheckScreenSpace:function(t){return!1},clickCheckScreenSpace:function(t){return!1},draw:function(t,e,i){return!0},preDraw:function(t,e){return!0},updateData:function(t,e,i,n){return!0},upadteData:function(t,e,i,n){return this.updateData(t,e,i,n)},canCopyToClipboard:function(){return!1},copyToClipboard:function(){},getParams:function(){var t=new Array(5);return t[0]=this.color.r/255,t[1]=this.color.g/255,t[2]=this.color.b/255,t[3]=this.color.a/255,t[4]=this.opacity,t},setParams:function(t){5===t.length&&(this.opacity=t[4],this.color=Oi.fromArgb(255*t[3],255*t[0],255*t[1],255*t[2]))},getParamNames:function(){return["Color.Red","Color.Green","Color.Blue","Color.Alpha","Opacity"]},getEditUI:function(){return t.ss.safeCast(this,_a)},cleanUp:function(){},get_name:function(){return this._name},set_name:function(t){return this._name!==t&&(this.version++,this._name=t),t},toString:function(){return this._name},get_referenceFrame:function(){return this.referenceFrame},set_referenceFrame:function(t){return this.referenceFrame=t,t},getProps:function(){return""},get_color:function(){return this.color},set_color:function(t){return this.color!==t&&(this.color=t,this.version++),t},colorChanged:function(){},get_colorValue:function(){return this.get_color().toString()},set_colorValue:function(t){return this.set_color(Oi.fromName(t)),t},get_enabled:function(){return this.enabled},set_enabled:function(t){return this.enabled=t,t},get_astronomical:function(){return this.astronomical},set_astronomical:function(t){return this.astronomical!==t&&(this.version++,this.astronomical=t),t},getTypeName:function(){return"TerraViewer.Layer"},saveToXml:function(t){t._writeStartElement("Layer"),t._writeAttributeString("Id",this.id.toString()),t._writeAttributeString("Type",this.getTypeName()),t._writeAttributeString("Name",this.get_name()),t._writeAttributeString("ReferenceFrame",this.referenceFrame),t._writeAttributeString("Color",this.color.save()),t._writeAttributeString("Opacity",this.opacity.toString()),t._writeAttributeString("StartTime",a.xmlDate(this.get_startTime())),t._writeAttributeString("EndTime",a.xmlDate(this.get_endTime())),t._writeAttributeString("FadeSpan",this.get_fadeSpan().toString()),t._writeAttributeString("FadeType",this.get_fadeType().toString()),this.writeLayerProperties(t),t._writeEndElement()},writeLayerProperties:function(t){},initializeFromXml:function(t){},initFromXml:function(t){if(this.id=Ii.fromString(t.attributes.getNamedItem("Id").nodeValue),this.set_name(t.attributes.getNamedItem("Name").nodeValue),this.referenceFrame=t.attributes.getNamedItem("ReferenceFrame").nodeValue,this.color=Oi.load(t.attributes.getNamedItem("Color").nodeValue),this.opacity=parseFloat(t.attributes.getNamedItem("Opacity").nodeValue),null!=t.attributes.getNamedItem("StartTime")&&this.set_startTime(new Date(t.attributes.getNamedItem("StartTime").nodeValue)),null!=t.attributes.getNamedItem("EndTime")&&this.set_endTime(new Date(t.attributes.getNamedItem("EndTime").nodeValue)),null!=t.attributes.getNamedItem("FadeSpan")&&this.set_fadeSpan(a.parseTimeSpan(t.attributes.getNamedItem("FadeSpan").nodeValue)),null!=t.attributes.getNamedItem("FadeType"))switch(t.attributes.getNamedItem("FadeType").nodeValue){case"In":this.set_fadeType(1);break;case"Out":this.set_fadeType(2);break;case"Both":this.set_fadeType(3);break;case"None":this.set_fadeType(4)}this.initializeFromXml(t)},loadData:function(t,e){},addFilesToCabinet:function(t){},getStringFromGzipBlob:function(t,e){var i=new FileReader;i.onloadend=function(t){var i="";try{i=Sl().inflate(t.target.result,{to:"string"})}catch(e){var n=e.toString();if("incorrect header check"!==n&&"unknown compression method"!==n)throw e;i=String.fromCharCode.apply(null,new Uint8Array(t.target.result))}e(i)},i.readAsArrayBuffer(t)}};function Ll(){}function Il(){this._tag=null,this._isChecked=!1,this._isEnabled=!0,this._subMenus=null}n("Layer",[Cl,Al,null]),n("LayerCollection",[function(){Cl.call(this)},{draw:function(t,e,i){return Cl.prototype.draw.call(this,t,e,!1)}},Cl]),Ll._type=null,n("LayerUI",[Ll,{get_hasTreeViewNodes:function(){return!1},getTreeNodes:function(){return null},getNodeContextMenu:function(t){return null},setUICallbacks:function(t){}},null]);var kl={get_name:function(){return this._name},set_name:function(t){return this._name=t,t},get_tag:function(){return this._tag},set_tag:function(t){return this._tag=t,t},get_checked:function(){return this._isChecked},set_checked:function(t){return this._isChecked=t,t},get_enabled:function(){return this._isEnabled},set_enabled:function(t){return this._isEnabled=t,t},add_menuItemSelected:function(e){this.__menuItemSelected=t.ss.bindAdd(this.__menuItemSelected,e)},remove_menuItemSelected:function(e){this.__menuItemSelected=t.ss.bindSub(this.__menuItemSelected,e)},fireMenuItemSelected:function(){null!=this.__menuItemSelected&&this.__menuItemSelected(this)},get_subMenus:function(){return null==this._subMenus&&(this._subMenus=[]),this._subMenus}};function Pl(){this._parent=null,this._level=0,this._open=!1,this._isChecked=!1,this._bold=!1,this._color=Xi.get_white(),this._nodes=null}n("LayerUIMenuItem",[Il,kl,null]);var Rl={add_nodeChecked:function(e){this.__nodeChecked=t.ss.bindAdd(this.__nodeChecked,e)},remove_nodeChecked:function(e){this.__nodeChecked=t.ss.bindSub(this.__nodeChecked,e)},fireNodeChecked:function(t){null!=this.__nodeChecked&&this.__nodeChecked(this,t)},add_nodeUpdated:function(e){this.__nodeUpdated=t.ss.bindAdd(this.__nodeUpdated,e)},remove_nodeUpdated:function(e){this.__nodeUpdated=t.ss.bindSub(this.__nodeUpdated,e)},fireNodeUpdated:function(){null!=this.__nodeUpdated&&this.__nodeUpdated(this)},add_nodeSelected:function(e){this.__nodeSelected=t.ss.bindAdd(this.__nodeSelected,e)},remove_nodeSelected:function(e){this.__nodeSelected=t.ss.bindSub(this.__nodeSelected,e)},fireNodeSelected:function(){null!=this.__nodeSelected&&this.__nodeSelected(this)},add_nodeActivated:function(e){this.__nodeActivated=t.ss.bindAdd(this.__nodeActivated,e)},remove_nodeActivated:function(e){this.__nodeActivated=t.ss.bindSub(this.__nodeActivated,e)},fireNodeActivated:function(){null!=this.__nodeActivated&&this.__nodeActivated(this)},get_name:function(){return this._name},set_name:function(t){return this._name!==t&&(this._name=t,this.fireNodeUpdated()),t},get_parent:function(){return this._parent},set_parent:function(t){return this._parent=t,t},get_level:function(){return this._level},set_level:function(t){return this._level=t,t},get_tag:function(){return this._tag},set_tag:function(t){return this._tag=t,t},get_referenceTag:function(){return this._referenceTag},set_referenceTag:function(t){return this._referenceTag=t,t},get_opened:function(){return this._open},set_opened:function(t){return this._open!==t&&(this._open=t,this.fireNodeUpdated()),t},get_checked:function(){return this._isChecked},set_checked:function(t){return this._isChecked!==t&&(this._isChecked=t,this.fireNodeUpdated()),t},get_bold:function(){return this._bold},set_bold:function(t){return this._bold!==t&&(this._bold=t,this.fireNodeUpdated()),t},get_color:function(){return this._color},set_color:function(t){return this._color!==t&&(this._color=t,this.fireNodeUpdated()),t},add:function(t){var e=new Pl;return e.set_name(t),e.set_parent(this),e.set_level(this.get_level()+1),this.get_nodes().push(e),e},get_nodes:function(){return null==this._nodes&&(this._nodes=[]),this._nodes}};function El(){this._triangleList$1=null,this._latStart$1=0,this._lngStart$1=0,this._latEnd$1=0,this._lngEnd$1=0,this._width$1=4,this._percentComplete$1=100,Cl.call(this)}n("LayerUITreeNode",[Pl,Rl,null]);var Dl={getTypeName:function(){return"TerraViewer.GreatCirlceRouteLayer"},cleanUp:function(){null!=this._triangleList$1&&this._triangleList$1.clear(),this._triangleList$1=null,Cl.prototype.cleanUp.call(this)},draw:function(t,e,i){return null==this._triangleList$1&&this._initializeRoute$1(t),this._triangleList$1.jNow=this._percentComplete$1/100,this._triangleList$1.draw(t,e*this.get_opacity(),2),!0},_initializeRoute$1:function(t){this._triangleList$1=new Fs,this._triangleList$1.decay=1e3,this._triangleList$1.sky=this.get_astronomical(),this._triangleList$1.timeSeries=!0,this._triangleList$1.depthBuffered=!1,this._triangleList$1.autoTime=!1;var e=Qs.geoTo3dDouble(this._latStart$1,this._lngStart$1),i=Qs.geoTo3dDouble(this._latEnd$1,this._lngEnd$1),n=wn.subtractVectors(i,e);n.normalize();var r=e;r.normalize();var s=wn.cross(r,n),a=wn.cross(n,r);s.normalize(),a.normalize(),s.multiply(.001*this._width$1),a.multiply(.001*this._width$1);for(var o=new wn,l=new wn,h=!0,u=0;u<=500;u++){var c=wn.lerp(e,i,u/500);c.normalize();var _=c,d=c;_.add(s),d.add(a),h?h=!1:this._triangleList$1.addQuad(l,o,d,_,this.get_color(),new As(u/500,2)),o=_,l=d}},getParams:function(){return[this._percentComplete$1]},getParamNames:function(){return["Percentage"]},setParams:function(t){t.length>0&&(this._percentComplete$1=t[0])},get_latStart:function(){return this._latStart$1},set_latStart:function(t){return this._latStart$1!==t&&(this._latStart$1=t,this.version++),t},get_lngStart:function(){return this._lngStart$1},set_lngStart:function(t){return this._lngStart$1!==t&&(this._lngStart$1=t,this.version++),t},get_latEnd:function(){return this._latEnd$1},set_latEnd:function(t){return this._latEnd$1!==t&&(this._latEnd$1=t,this.version++),t},get_lngEnd:function(){return this._lngEnd$1},set_lngEnd:function(t){return this._lngEnd$1!==t&&(this._lngEnd$1=t,this.version++),t},get_width:function(){return this._width$1},set_width:function(t){return this._width$1!==t&&(this._width$1=t,this.version++),t},get_percentComplete:function(){return this._percentComplete$1},set_percentComplete:function(t){return this._percentComplete$1!==t&&(this._percentComplete$1=t,this.version++),t},writeLayerProperties:function(t){t._writeAttributeString("LatStart",this.get_latStart().toString()),t._writeAttributeString("LngStart",this.get_lngStart().toString()),t._writeAttributeString("LatEnd",this.get_latEnd().toString()),t._writeAttributeString("LngEnd",this.get_lngEnd().toString()),t._writeAttributeString("Width",this.get_width().toString()),t._writeAttributeString("PercentComplete",this.get_percentComplete().toString())},initializeFromXml:function(t){this._latStart$1=parseFloat(t.attributes.getNamedItem("LatStart").nodeValue),this._lngStart$1=parseFloat(t.attributes.getNamedItem("LngStart").nodeValue),this._latEnd$1=parseFloat(t.attributes.getNamedItem("LatEnd").nodeValue),this._lngEnd$1=parseFloat(t.attributes.getNamedItem("LngEnd").nodeValue),this._width$1=parseFloat(t.attributes.getNamedItem("Width").nodeValue),this._percentComplete$1=parseFloat(t.attributes.getNamedItem("PercentComplete").nodeValue)}};function Fl(){Cl.call(this)}function Nl(){this._imageSet$1=null,this._extension$1=".txt",this._overrideDefaultLayer$1=!1,this._loaded$1=!1,Cl.call(this)}n("GreatCirlceRouteLayer",[El,Dl,Cl]),n("GridLayer",[Fl,{draw:function(t,e,i){return sl.drawPlanetGrid(t,e*this.get_opacity(),this.get_color()),sl.drawPlanetGridText(t,e*this.get_opacity(),this.get_color()),!0}},Cl]),Nl.create=function(t){var e=new Nl;return e._imageSet$1=t,e};var $l={get_imageSet:function(){return this._imageSet$1},set_imageSet:function(t){return this._imageSet$1=t,t},get_overrideDefaultLayer:function(){return this._overrideDefaultLayer$1},set_overrideDefaultLayer:function(t){return this._overrideDefaultLayer$1=t,t},getFitsImage:function(){return t.ss.safeCast(this._imageSet$1.get_wcsImage(),Ga)},_isFitsImageset$1:function(){var e=".fits"===this._imageSet$1.get_extension();return t.ss.canCast(this._imageSet$1.get_wcsImage(),Ga)||null==this._imageSet$1.get_wcsImage()&&e},initializeFromXml:function(e){var i=a.selectSingleNode(e,"ImageSet");this._imageSet$1=Co.fromXMLNode(i),null!=e.attributes.getNamedItem("Extension")&&(this._extension$1=e.attributes.getNamedItem("Extension").nodeValue),null!=e.attributes.getNamedItem("ScaleType")&&(this.get_imageSet().get_fitsProperties().scaleType=s.parse("ScaleTypes",e.attributes.getNamedItem("ScaleType").nodeValue)),null!=e.attributes.getNamedItem("MinValue")&&(this.get_imageSet().get_fitsProperties().minVal=parseFloat(e.attributes.getNamedItem("MinValue").nodeValue),this.get_imageSet().get_fitsProperties().lowerCut=null!=e.attributes.getNamedItem("LowerCut")?parseFloat(e.attributes.getNamedItem("LowerCut").nodeValue):this.get_imageSet().get_fitsProperties().minVal),null!=e.attributes.getNamedItem("MaxValue")&&(this.get_imageSet().get_fitsProperties().maxVal=parseFloat(e.attributes.getNamedItem("MaxValue").nodeValue),this.get_imageSet().get_fitsProperties().upperCut=null!=e.attributes.getNamedItem("UpperCut")?parseFloat(e.attributes.getNamedItem("UpperCut").nodeValue):this.get_imageSet().get_fitsProperties().maxVal),null!=e.attributes.getNamedItem("ColorMapperName")&&(this.get_imageSet().get_fitsProperties().colorMapName=e.attributes.getNamedItem("ColorMapperName").nodeValue),null!=e.attributes.getNamedItem("OverrideDefault")&&(this._overrideDefaultLayer$1=t.ss.boolean(e.attributes.getNamedItem("OverrideDefault").nodeValue))},draw:function(t,e,i){return!!this._loaded$1&&(t.set_worldBase(t.get_world()),t.set_viewBase(t.get_view()),t.makeFrustum(),t.drawImageSet(this._imageSet$1,this.get_opacity()*e*100),!0)},writeLayerProperties:function(t){null!=this._imageSet$1.get_wcsImage()&&(this._isFitsImageset$1()?this._extension$1=".fit":this._extension$1=".png",t._writeAttributeString("Extension",this._extension$1)),this._isFitsImageset$1()&&(t._writeAttributeString("ScaleType",s.toXml("ScaleTypes",this._imageSet$1.get_fitsProperties().scaleType)),t._writeAttributeString("MinValue",this._imageSet$1.get_fitsProperties().minVal.toString()),t._writeAttributeString("MaxValue",this._imageSet$1.get_fitsProperties().maxVal.toString()),t._writeAttributeString("LowerCut",this._imageSet$1.get_fitsProperties().lowerCut.toString()),t._writeAttributeString("UpperCut",this._imageSet$1.get_fitsProperties().upperCut.toString()),null!=this._imageSet$1.get_fitsProperties().colorMapName&&t._writeAttributeString("ColorMapperName",this._imageSet$1.get_fitsProperties().colorMapName)),t._writeAttributeString("OverrideDefault",this._overrideDefaultLayer$1.toString()),Co.saveToXml(t,this._imageSet$1,""),Cl.prototype.writeLayerProperties.call(this,t)},getTypeName:function(){return"TerraViewer.ImageSetLayer"},cleanUp:function(){Cl.prototype.cleanUp.call(this)},addFilesToCabinet:function(e){if(t.ss.canCast(this._imageSet$1.get_wcsImage(),Ga)){this._imageSet$1.get_wcsImage().get_filename();var i=e.tempDirectory+t.ss.format("{0}\\{1}{2}",e.get_packageID(),this.id.toString(),this._extension$1);e.addFile(i,this._imageSet$1.get_wcsImage().sourceBlob)}},getParamNames:function(){return Cl.prototype.getParamNames.call(this)},getParams:function(){return Cl.prototype.getParams.call(this)},setParams:function(t){Cl.prototype.setParams.call(this,t)},setImageScale:function(t,e,i){console.warn("SetImageScale is considered deprecated. Use setImageScaleRaw or setImageScalePhysical instead."),this.setImageScaleRaw(t,e,i)},setImageScaleRaw:function(e,i,n){this.get_imageSet().get_fitsProperties().lowerCut=i,this.get_imageSet().get_fitsProperties().upperCut=n,this.get_imageSet().get_fitsProperties().scaleType=e,t.ss.canCast(this._imageSet$1.get_wcsImage(),Ja)&&bl.updateScale(this,e,i,n)},setImageScalePhysical:function(t,e,i){var n=e,r=i;this._isFitsImageset$1()&&(n=(n-this._imageSet$1.get_fitsProperties().bZero)/this._imageSet$1.get_fitsProperties().bScale,r=(r-this._imageSet$1.get_fitsProperties().bZero)/this._imageSet$1.get_fitsProperties().bScale),this.setImageScaleRaw(t,n,r)},setImageZ:function(t){this._isFitsImageset$1()&&bl.updateImage(this,t)},get_colorMapperName:function(){return this.get_imageSet().get_fitsProperties().colorMapName},set_colorMapperName:function(t){if(null==Ba.fromNamedColormap(t))throw new Error("Invalid colormap name");return this.version++,this._isFitsImageset$1()&&(Ji?this._imageSet$1.get_fitsProperties().colorMapName=t:bl.updateColorMapper(this,t)),t},get_colorMapper:function(){return null==this.get_imageSet().get_fitsProperties().colorMapName?null:Ba.fromNamedColormap(this.get_imageSet().get_fitsProperties().colorMapName)},loadData:function(e,i){if(t.ss.startsWith(this._extension$1.toLowerCase(),".fit")){var n,r=e.getFileBlob(t.ss.replaceString(i,".txt",this._extension$1));n=Ji?new Ga(this._imageSet$1,"image.fit",r,t.ss.bind("doneLoading",this)):new Ja(this._imageSet$1,"image.fit",r,t.ss.bind("doneLoading",this)),this._imageSet$1.set_wcsImage(n)}else this._loaded$1=!0},doneLoading:function(t){this._loaded$1=!0}};function zl(){this.specularSharpness=0,this.opacity=0,this.isDefault=!1}function Bl(){this._primaryUI$1=null,this._heading$1=0,this._flipV$1=!0,this._flipHandedness$1=!1,this._smooth$1=!0,this._twoSidedGeometry$1=!1,this._pitch$1=0,this._roll$1=0,this._scale$1=wn.create(1,1,1),this._translate$1=wn.create(0,0,0),this._lightID$1=0,this._dirty$1=!1,this.objType=!1,this._xHandle$1=new vn,this._yHandle$1=new vn,this._zHandle$1=new vn,this._hprHandles$1=new Array(6),this._uiScale$1=1,this._showEditUi$1=!1,this._dragMode$1=0,this._pntDown$1=new vn,this._valueOnDown$1=0,this._valueOnDown2$1=0,this._hitDist$1=20,this._lockPreferedAxis$1=!1,this._preferY$1=!1,Cl.call(this)}n("ImageSetLayer",[Nl,$l,Cl]),n("Material",[zl,{},null]),Bl._translateUI$1=null,Bl._translateUILines$1=null,Bl._scaleUI$1=null,Bl._rotateUi$1=null,Bl._initTranslateUI$1=function(){Bl._translateUILines$1=new Es,Bl._translateUILines$1.timeSeries=!1,Bl._translateUILines$1.set_depthBuffered(!1),Bl._translateUILines$1.showFarSide=!0,Bl._translateUI$1=new Fs,Bl._translateUI$1.depthBuffered=!1,Bl._translateUI$1.timeSeries=!1,Bl._translateUI$1.writeZbuffer=!1;for(var t=2*Math.PI,e=t/45,i=.05,n=0;n<t;n+=e){var r=wn.create(.8,0,0),s=wn.create(.8,Math.cos(n)*i,Math.sin(n)*i),a=wn.create(.8,Math.cos(n+e)*i,Math.sin(n+e)*i);Bl._translateUI$1.addTriangle(r,s,a,Xi.get_red(),As.empty())}for(n=0;n<t;n+=e)r=wn.create(1,0,0),a=wn.create(.8,Math.cos(n)*i,Math.sin(n)*i),s=wn.create(.8,Math.cos(n+e)*i,Math.sin(n+e)*i),Bl._translateUI$1.addTriangle(r,s,a,Oi.fromArgb(255,255,Math.max(0,128*Math.sin(n)),Math.max(0,128*Math.sin(n))),As.empty());for(Bl._translateUILines$1.addLine(wn.create(0,0,0),wn.create(1,0,0),Xi.get_red(),As.empty()),n=0;n<t;n+=e)r=wn.create(0,.8,0),a=wn.create(Math.cos(n)*i,.8,Math.sin(n)*i),s=wn.create(Math.cos(n+e)*i,.8,Math.sin(n+e)*i),Bl._translateUI$1.addTriangle(r,s,a,Xi.get_green(),As.empty());for(n=0;n<t;n+=e)r=wn.create(0,1,0),s=wn.create(Math.cos(n)*i,.8,Math.sin(n)*i),a=wn.create(Math.cos(n+e)*i,.8,Math.sin(n+e)*i),Bl._translateUI$1.addTriangle(r,s,a,Oi.fromArgb(255,Math.max(0,128*Math.sin(n)),255,Math.max(0,128*Math.sin(n))),As.empty());for(Bl._translateUILines$1.addLine(wn.create(0,0,0),wn.create(0,1,0),Xi.get_green(),As.empty()),n=0;n<t;n+=e)r=wn.create(0,0,.8),s=wn.create(Math.cos(n)*i,Math.sin(n)*i,.8),a=wn.create(Math.cos(n+e)*i,Math.sin(n+e)*i,.8),Bl._translateUI$1.addTriangle(r,s,a,Xi.get_blue(),As.empty());for(n=0;n<t;n+=e)r=wn.create(0,0,1),a=wn.create(Math.cos(n)*i,Math.sin(n)*i,.8),s=wn.create(Math.cos(n+e)*i,Math.sin(n+e)*i,.8),Bl._translateUI$1.addTriangle(r,s,a,Oi.fromArgb(255,Math.max(0,128*Math.sin(n)),Math.max(0,128*Math.sin(n)),255),As.empty());Bl._translateUILines$1.addLine(wn.create(0,0,0),wn.create(0,0,1),Xi.get_blue(),As.empty()),Bl._initRotateUI$1(),Bl._initScaleUI$1()},Bl._initScaleUI$1=function(){Bl._scaleUI$1=new Fs,Bl._scaleUI$1.depthBuffered=!1,Bl._scaleUI$1.timeSeries=!1,Bl._scaleUI$1.writeZbuffer=!1,Math.PI,Bl._makeCube$1(Bl._scaleUI$1,wn.create(.9,0,0),.1,Xi.get_red()),Bl._makeCube$1(Bl._scaleUI$1,wn.create(0,.9,0),.1,Xi.get_green()),Bl._makeCube$1(Bl._scaleUI$1,wn.create(0,0,.9),.1,Xi.get_blue())},Bl._makeCube$1=function(e,i,n,r){var s=Oi.fromArgb(255,t.ss.truncate(.6*r.r),r.g,t.ss.truncate(.6*r.b)),a=Oi.fromArgb(255,t.ss.truncate(.8*r.r),t.ss.truncate(.8*r.g),t.ss.truncate(.8*r.b));e.addQuad(wn.create(i.x+n,i.y+n,i.z+n),wn.create(i.x+n,i.y+n,i.z-n),wn.create(i.x-n,i.y+n,i.z+n),wn.create(i.x-n,i.y+n,i.z-n),r,As.empty()),e.addQuad(wn.create(i.x+n,i.y-n,i.z+n),wn.create(i.x-n,i.y-n,i.z+n),wn.create(i.x+n,i.y-n,i.z-n),wn.create(i.x-n,i.y-n,i.z-n),r,As.empty()),e.addQuad(wn.create(i.x-n,i.y+n,i.z+n),wn.create(i.x-n,i.y+n,i.z-n),wn.create(i.x-n,i.y-n,i.z+n),wn.create(i.x-n,i.y-n,i.z-n),s,As.empty()),e.addQuad(wn.create(i.x+n,i.y+n,i.z+n),wn.create(i.x+n,i.y-n,i.z+n),wn.create(i.x+n,i.y+n,i.z-n),wn.create(i.x+n,i.y-n,i.z-n),s,As.empty()),e.addQuad(wn.create(i.x+n,i.y+n,i.z+n),wn.create(i.x-n,i.y+n,i.z+n),wn.create(i.x+n,i.y-n,i.z+n),wn.create(i.x-n,i.y-n,i.z+n),a,As.empty()),e.addQuad(wn.create(i.x+n,i.y+n,i.z-n),wn.create(i.x+n,i.y-n,i.z-n),wn.create(i.x-n,i.y+n,i.z-n),wn.create(i.x-n,i.y-n,i.z-n),a,As.empty())},Bl._initRotateUI$1=function(){Bl._rotateUi$1=new Fs,Bl._rotateUi$1.depthBuffered=!1,Bl._rotateUi$1.timeSeries=!1,Bl._rotateUi$1.writeZbuffer=!1;for(var t=2*Math.PI,e=t/40,i=.05,n=0,r=0;r<t;r+=e){var s=!(n%10),a=!((n+1)%10),o=wn.create(i*(s?0:a?1.5:1),Math.cos(r),Math.sin(r)),l=wn.create(-i*(s?0:a?1.5:1),Math.cos(r),Math.sin(r)),h=wn.create(i*(s?1.5:a?0:1),Math.cos(r+e),Math.sin(r+e)),u=wn.create(-i*(s?1.5:a?0:1),Math.cos(r+e),Math.sin(r+e));Bl._rotateUi$1.addQuad(o,h,l,u,Oi._fromArgbColor(192,Xi.get_red()),As.empty()),n++}for(n=0,r=0;r<t;r+=e)s=!(n%10),a=!((n+1)%10),o=wn.create(Math.cos(r),Math.sin(r),i*(s?0:a?1.5:1)),l=wn.create(Math.cos(r),Math.sin(r),-i*(s?0:a?1.5:1)),h=wn.create(Math.cos(r+e),Math.sin(r+e),i*(s?1.5:a?0:1)),u=wn.create(Math.cos(r+e),Math.sin(r+e),-i*(s?1.5:a?0:1)),Bl._rotateUi$1.addQuad(o,h,l,u,Oi._fromArgbColor(192,Xi.get_blue()),As.empty()),n++;for(n=0,r=0;r<t;r+=e)s=!(n%10),a=!((n+1)%10),o=wn.create(Math.cos(r),i*(s?0:a?1.5:1),Math.sin(r)),l=wn.create(Math.cos(r),-i*(s?0:a?1.5:1),Math.sin(r)),h=wn.create(Math.cos(r+e),i*(s?1.5:a?0:1),Math.sin(r+e)),u=wn.create(Math.cos(r+e),-i*(s?1.5:a?0:1),Math.sin(r+e)),Bl._rotateUi$1.addQuad(o,l,h,u,Oi._fromArgbColor(192,Xi.get_green()),As.empty()),n++;for(n=0,r=0;r<t;r+=e)s=!(n%10),a=!((n+1)%10),o=wn.create(-i*(s?0:a?1.5:1),Math.cos(r),Math.sin(r)),l=wn.create(i*(s?0:a?1.5:1),Math.cos(r),Math.sin(r)),h=wn.create(-i*(s?1.5:a?0:1),Math.cos(r+e),Math.sin(r+e)),u=wn.create(i*(s?1.5:a?0:1),Math.cos(r+e),Math.sin(r+e)),Bl._rotateUi$1.addQuad(o,h,l,u,Xi.get_red(),As.empty()),n++;for(n=0,r=0;r<t;r+=e)s=!(n%10),a=!((n+1)%10),o=wn.create(Math.cos(r),Math.sin(r),-i*(s?0:a?1.5:1)),l=wn.create(Math.cos(r),Math.sin(r),i*(s?0:a?1.5:1)),h=wn.create(Math.cos(r+e),Math.sin(r+e),-i*(s?1.5:a?0:1)),u=wn.create(Math.cos(r+e),Math.sin(r+e),i*(s?1.5:a?0:1)),Bl._rotateUi$1.addQuad(o,h,l,u,Xi.get_blue(),As.empty()),n++;for(n=0,r=0;r<t;r+=e)s=!(n%10),a=!((n+1)%10),o=wn.create(Math.cos(r),-i*(s?0:a?1.5:1),Math.sin(r)),l=wn.create(Math.cos(r),i*(s?0:a?1.5:1),Math.sin(r)),h=wn.create(Math.cos(r+e),-i*(s?1.5:a?0:1),Math.sin(r+e)),u=wn.create(Math.cos(r+e),i*(s?1.5:a?0:1),Math.sin(r+e)),Bl._rotateUi$1.addQuad(o,l,h,u,Xi.get_green(),As.empty()),n++};var Ul={getPrimaryUI:function(){return null==this._primaryUI$1&&(this._primaryUI$1=new Wl(this)),this._primaryUI$1},get_flipV:function(){return this._flipV$1},set_flipV:function(t){return this._flipV$1!==t&&(this._flipV$1=t,null!=this.object3d&&(this.object3d.flipV=this._flipV$1,this.object3d._reload()),this.version++),t},get_flipHandedness:function(){return this._flipHandedness$1},set_flipHandedness:function(t){return this._flipHandedness$1!==t&&(this._flipHandedness$1=t,null!=this.object3d&&(this.object3d.flipHandedness=this._flipHandedness$1,this.object3d._reload()),this.version++),t},get_smooth:function(){return this._smooth$1},set_smooth:function(t){return this._smooth$1!==t&&(this._smooth$1=t,null!=this.object3d&&(this.object3d.smooth=this._smooth$1,this.object3d._reload()),this.version++),t},get_twoSidedGeometry:function(){return this._twoSidedGeometry$1},set_twoSidedGeometry:function(t){return this._twoSidedGeometry$1!==t&&(this._twoSidedGeometry$1=t,this.version++),t},get_heading:function(){return this._heading$1},set_heading:function(t){return this._heading$1!==t&&(this.version++,this._heading$1=t),t},get_pitch:function(){return this._pitch$1},set_pitch:function(t){return this._pitch$1!==t&&(this.version++,this._pitch$1=t),t},get_roll:function(){return this._roll$1},set_roll:function(t){return this._roll$1!==t&&(this.version++,this._roll$1=t),t},get_scale:function(){return this._scale$1},set_scale:function(t){return this._scale$1!==t&&(this.version++,this._scale$1=t),t},get_translate:function(){return this._translate$1},set_translate:function(t){return this._translate$1!==t&&(this.version++,this._translate$1=t),t},get_lightID:function(){return this._lightID$1},set_lightID:function(t){return this._lightID$1=t,t},cleanUp:function(){this._dirty$1=!0},colorChanged:function(){null!=this.object3d&&(this.object3d.color=this.get_color())},writeLayerProperties:function(t){t._writeAttributeString("FlipV",this.get_flipV().toString()),t._writeAttributeString("FlipHandedness",this.get_flipHandedness().toString()),t._writeAttributeString("Smooth",this.get_smooth().toString()),t._writeAttributeString("TwoSidedGeometry",this.get_twoSidedGeometry().toString()),t._writeAttributeString("Heading",this.get_heading().toString()),t._writeAttributeString("Pitch",this.get_pitch().toString()),t._writeAttributeString("Roll",this.get_roll().toString()),t._writeAttributeString("Scale",this.get_scale().toString()),t._writeAttributeString("Translate",this.get_translate().toString()),t._writeAttributeString("LightID",this.get_lightID().toString()),t._writeAttributeString("Obj",this.objType.toString())},getParams:function(){var t=new Array(14);return t[0]=this._heading$1,t[1]=this._pitch$1,t[2]=this._roll$1,t[3]=this._scale$1.x,t[4]=this._scale$1.y,t[5]=this._scale$1.z,t[6]=this._translate$1.x,t[7]=this._translate$1.y,t[8]=this._translate$1.z,t[9]=this.get_color().r/255,t[10]=this.get_color().g/255,t[11]=this.get_color().b/255,t[12]=this.get_color().a/255,t[13]=this.get_opacity(),t},getParamNames:function(){return["Heading","Pitch","Roll","Scale.X","Scale.Y","Scale.Z","Translate.X","Translate.Y","Translate.Z","Colors.Red","Colors.Green","Colors.Blue","Colors.Alpha","Opacity"]},setParams:function(e){if(14===e.length){this._heading$1=e[0],this._pitch$1=e[1],this._roll$1=e[2],this._scale$1.x=e[3],this._scale$1.y=e[4],this._scale$1.z=e[5],this._translate$1.x=e[6],this._translate$1.y=e[7],this._translate$1.z=e[8],this.set_opacity(e[13]);var i=Oi.fromArgb(t.ss.truncate(255*e[12]),t.ss.truncate(255*e[9]),t.ss.truncate(255*e[10]),t.ss.truncate(255*e[11]));this.set_color(i)}},add_propertiesChanged:function(e){this.__propertiesChanged$1=t.ss.bindAdd(this.__propertiesChanged$1,e)},remove_propertiesChanged:function(e){this.__propertiesChanged$1=t.ss.bindSub(this.__propertiesChanged$1,e)},fireChanged:function(){null!=this.__propertiesChanged$1&&this.__propertiesChanged$1(this,new t.ss.EventArgs)},getEditUI:function(){return t.ss.safeCast(this,_a)},initializeFromXml:function(e){this.set_flipV(t.ss.boolean(e.attributes.getNamedItem("FlipV").nodeValue)),null!=e.attributes.getNamedItem("FlipHandedness")?this.set_flipHandedness(t.ss.boolean(e.attributes.getNamedItem("FlipHandedness").nodeValue)):this.set_flipHandedness(!1),null!=e.attributes.getNamedItem("Smooth")?this.set_smooth(t.ss.boolean(e.attributes.getNamedItem("Smooth").nodeValue)):this.set_smooth(!0),null!=e.attributes.getNamedItem("TwoSidedGeometry")?this.set_twoSidedGeometry(t.ss.boolean(e.attributes.getNamedItem("TwoSidedGeometry").nodeValue)):this.set_twoSidedGeometry(!1),null!=e.attributes.getNamedItem("Obj")?this.objType=t.ss.boolean(e.attributes.getNamedItem("Obj").nodeValue):this.objType=!1,this.set_heading(parseFloat(e.attributes.getNamedItem("Heading").nodeValue)),this.set_pitch(parseFloat(e.attributes.getNamedItem("Pitch").nodeValue)),this.set_roll(parseFloat(e.attributes.getNamedItem("Roll").nodeValue)),this.set_scale(wn.parse(e.attributes.getNamedItem("Scale").nodeValue)),this.set_translate(wn.parse(e.attributes.getNamedItem("Translate").nodeValue)),null!=e.attributes.getNamedItem("LightID")&&this.set_lightID(parseInt(e.attributes.getNamedItem("LightID").nodeValue))},draw:function(t,e,i){var n=t.get_world(),r=yn.multiplyMatrix(yn.multiplyMatrix(yn._rotationZ(-this._roll$1/180*Math.PI),yn._rotationX(-this._pitch$1/180*Math.PI)),yn._rotationY(this._heading$1/180*Math.PI));return t.set_world(yn.multiplyMatrix(yn.multiplyMatrix(yn.multiplyMatrix(r,yn._scaling(this._scale$1.x,this._scale$1.y,this._scale$1.z)),yn.translation(this._translate$1)),n)),t.set_twoSidedLighting(this.get_twoSidedGeometry()),_o.drawPointPlanet(t,new wn,1,Xi.get_red(),!1),this._lightID$1>0||null!=this.object3d&&(this.object3d.color=this.get_color(),this.object3d.render(t,e*this.get_opacity())),t.set_twoSidedLighting(!1),t.set_world(n),!0},addFilesToCabinet:function(t){},loadData:function(e,i){t.ss.endsWith(i.toLowerCase(),".obj")&&(this.objType=!0),this._lightID$1||(this.objType?this.object3d=new Hl(e,t.ss.replaceString(i,".txt",".obj"),this.get_flipV(),this._flipHandedness$1,!0,this.get_color()):this.object3d=new Hl(e,t.ss.replaceString(i,".txt",".3ds"),this.get_flipV(),this._flipHandedness$1,!0,this.get_color()))},pointToView:function(t){var e=an.height,i=an.width,n=an.width/an.height*1116,r=t.x/i*n-(n-1920)/2,s=t.y/e*1116;return vn.create(r,s)},render:function(t){this._showEditUi$1=!0},preRender:function(t){this._showEditUi$1=!0},mouseDown:function(t,e){var i=this.pointToView(vn.create(e.offsetX,e.offsetY));this._pntDown$1=i;var n=i;if(e.shiftKey){if(vn.subtract(n,this._xHandle$1).get_length()<this._hitDist$1)return this._dragMode$1=10,this._valueOnDown$1=this._scale$1.x,!0;if(vn.subtract(n,this._yHandle$1).get_length()<this._hitDist$1)return this._dragMode$1=10,this._valueOnDown$1=this._scale$1.y,!0;if(vn.subtract(n,this._zHandle$1).get_length()<this._hitDist$1)return this._dragMode$1=10,this._valueOnDown$1=this._scale$1.z,!0}else{if(vn.subtract(n,this._xHandle$1).get_length()<this._hitDist$1)return this._dragMode$1=1,this._valueOnDown$1=this._translate$1.x,!0;if(vn.subtract(n,this._yHandle$1).get_length()<this._hitDist$1)return this._dragMode$1=2,this._valueOnDown$1=this._translate$1.y,!0;if(vn.subtract(n,this._zHandle$1).get_length()<this._hitDist$1)return this._dragMode$1=3,this._valueOnDown$1=this._translate$1.z,!0}for(var r=0;r<this._hprHandles$1.length;r++)if(vn.subtract(n,this._hprHandles$1[r]).get_length()<this._hitDist$1)switch(r){case 0:return this._dragMode$1=4,this._valueOnDown$1=this._heading$1,this._valueOnDown2$1=this._pitch$1,!0;case 1:return this._dragMode$1=7,this._valueOnDown$1=this._heading$1,this._valueOnDown2$1=this._pitch$1,!0;case 2:return this._dragMode$1=5,this._valueOnDown$1=this._pitch$1,this._valueOnDown2$1=this._roll$1,!0;case 3:return this._dragMode$1=8,this._valueOnDown$1=this._pitch$1,this._valueOnDown2$1=this._roll$1,!0;case 4:return this._dragMode$1=6,this._valueOnDown$1=this._roll$1,this._valueOnDown2$1=this._heading$1,!0;case 5:return this._dragMode$1=9,this._valueOnDown$1=this._roll$1,this._valueOnDown2$1=this._heading$1,!0}return!1},mouseUp:function(t,e){return!!this._dragMode$1&&(this._dragMode$1=0,this._lockPreferedAxis$1=!1,!0)},mouseMove:function(t,e){var i=this.pointToView(vn.create(e.offsetX,e.offsetY));if(this._dragMode$1){var n=0,r=i.x-this._pntDown$1.x,s=-(i.y-this._pntDown$1.y);switch(this._lockPreferedAxis$1?this._preferY$1?(n=s,this._preferY$1=!0,Ri.set_current(Ei.get_sizeNS())):(n=r,this._preferY$1=!1,Ri.set_current(Ei.get_sizeWE())):(Math.abs(r)>Math.abs(s)?(n=r,this._preferY$1=!1):(n=s,this._preferY$1=!0),n>5&&(this._lockPreferedAxis$1=!0)),this._dragMode$1){case 0:default:break;case 1:this._translate$1.x=this._valueOnDown$1+12*this._uiScale$1*(n/an.width);break;case 2:this._translate$1.y=this._valueOnDown$1+12*this._uiScale$1*(n/an.width);break;case 3:this._translate$1.z=this._valueOnDown$1+12*this._uiScale$1*(n/an.width);break;case 4:this._heading$1=this._valueOnDown$1-r/4,this._pitch$1=this._valueOnDown2$1+s/4;break;case 5:this._pitch$1=this._valueOnDown$1+s/4,this._roll$1=this._valueOnDown2$1-r/4;break;case 6:this._roll$1=this._valueOnDown$1+s/4,this._heading$1=this._valueOnDown2$1-r/4;break;case 7:this._heading$1=this._valueOnDown$1-r/4,this._pitch$1=this._valueOnDown2$1-s/4;break;case 8:this._pitch$1=this._valueOnDown$1+s/4,this._roll$1=this._valueOnDown2$1+r/4;break;case 9:this._roll$1=this._valueOnDown$1-s/4,this._heading$1=this._valueOnDown2$1-r/4;break;case 10:this._scale$1.x=this._scale$1.y=this._scale$1.z=this._valueOnDown$1*Math.pow(2,n/100)}return this.fireChanged(),!0}var a=i;if(vn.subtract(a,this._xHandle$1).get_length()<this._hitDist$1)return Ri.set_current(Ei.get_sizeAll()),!0;if(vn.subtract(a,this._yHandle$1).get_length()<this._hitDist$1)return Ri.set_current(Ei.get_sizeAll()),!0;if(vn.subtract(a,this._zHandle$1).get_length()<this._hitDist$1)return Ri.set_current(Ei.get_sizeAll()),!0;for(var o=0;o<this._hprHandles$1.length;o++)if(vn.subtract(a,this._hprHandles$1[o]).get_length()<this._hitDist$1)return Ri.set_current(Ei.get_sizeAll()),!0;return!1},mouseClick:function(t,e){return!1},click:function(t,e){return!1},mouseDoubleClick:function(t,e){return!1},keyDown:function(t,e){return!1},keyUp:function(t,e){return!1},hover:function(t){return!1}};function Vl(){this.startIndex=0,this.indexCount=0,this.materialIndex=0}function Ol(){this.boundingSphere=new Pn}n("Object3dLayer",[Bl,Ul,Cl,_a]),n("Group",[Vl,{},null]),Ol.create=function(t,e){var i=new Ol;i.vertices=t,i.indices=e;for(var n=new Array(t.length),r=0;r<t.length;++r)n[r]=t[r].get_position();return i.boundingSphere=Rn.findEnclosingSphereFast(n),i},Ol.createTangent=function(t,e){var i=new Ol;i.tangentVertices=t,i.indices=e;for(var n=new Array(i.tangentVertices.length),r=0;r<i.tangentVertices.length;++r)n[r]=i.tangentVertices[r].get_position();return i.boundingSphere=Rn.findEnclosingSphereFast(n),i};var Gl={dispose:function(){null!=this.vertexBuffer&&(this.vertexBuffer.dispose(),this.vertexBuffer=null),null!=this.tangentVertexBuffer&&(this.tangentVertexBuffer.dispose(),this.tangentVertexBuffer=null),null!=this.indexBuffer&&(this.indexBuffer.dispose(),this.indexBuffer=null)},setObjects:function(t){this._objects=t},commitToDevice:function(){null!=this.vertices?this.vertexBuffer=Jr.create(this.vertices):null!=this.tangentVertices&&(this.tangentVertexBuffer=Qr.create(this.tangentVertices)),this.indexBuffer=new Wr(new Uint32Array(this.indices))},beginDrawing:function(t){null!=this.vertexBuffer?t._setVertexBuffer(this.vertexBuffer):null!=this.tangentVertexBuffer&&t._setVertexBuffer(this.tangentVertexBuffer),null!=this.indexBuffer&&t._setIndexBuffer(this.indexBuffer)},drawSubset:function(t,e){null!=this.indexBuffer&&null!=this._objects&&this.drawHierarchy(this._objects,e,t,0)},drawHierarchy:function(e,i,n,r){if(!(r>1212))for(var s=t.ss.enumerate(e);s.moveNext();){var a=s.current;if(null!=a.drawGroup&&a.enabled)for(var o=t.ss.enumerate(a.drawGroup);o.moveNext();){var l=o.current;l.materialIndex===i&&n.gl.drawElements(Yr.TRIANGLES,l.indexCount,Yr.UNSIGNED_INT,4*l.startIndex)}this.drawHierarchy(a.children,i,n,r+1)}},get_objects:function(){return this._objects},set_objects:function(t){return this._objects=t,t}};function Xl(){this.index=0}function Hl(e,i,n,r,s,a){this.flipHandedness=!1,this.flipV=!0,this.smooth=!0,this._mesh=null,this._meshMaterials=[],this._meshTextures=[],this._meshSpecularTextures=[],this._meshNormalMaps=[],this.meshFilenames=[],this.color=Xi.get_white(),this._textureCache={},this._matFiles=new Array(0),this._matFileIndex=0,this.objects=[],this._matLib={},this._textureLib={},this._tourDocument=null,this.issLayer=!1,this._readyToRender=!1,this.useCurrentAmbient=!1,this._dirty=!0,this.color=a,this.smooth=s,this.flipV=n,this.flipHandedness=r,this.filename=i,t.ss.endsWith(this.filename.toLowerCase(),".obj")?this._loadMeshFromObj(e,this.filename):this._loadMeshFrom3ds(e,this.filename,1)}n("Mesh",[Ol,Gl,null,t.ss.IDisposable]),n("VertexPosition",[Xl,{},null]),Hl._compareVector3=function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:t.z<e.z?-1:t.z>e.z?1:0},Hl._compareVector=function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0},Hl._getMaterialID=function(e,i){for(var n=0,r=t.ss.enumerate(i);r.moveNext();){if(r.current===e)return n;n++}return-1},Hl._disposeTextureList=function(t){if(null!=t){for(var e=0;e<t.length;++e)null!=t[e]&&(t[e].dispose(),t[e]=null);t.length=0}};var Yl={_reload:function(){this.issLayer||(this.dispose(),t.ss.endsWith(this.filename.toLowerCase(),".obj")?this._loadMeshFromObj(this._tourDocument,this.filename):this._loadMeshFrom3ds(this._tourDocument,this.filename,1))},_calculateVertexNormalsMerged:function(e,i,n){if(!e.length)return null;e.length;for(var r=Math.floor(i.length/3),s=[],a=0;a<e.length;++a){var o=new Xl;o.position=e[a].get_position(),o.index=a,s.push(o)}s.sort((function(t,e){return Hl._compareVector3(t.position,e.position)}));var l=new Array(s.length),h=0;for(a=0;a<s.length;a++)a&&!Hl._compareVector3(s[a].position,s[a-1].position)||++h,l[s[a].index]=h-1;for(var u=new Array(h),c=0;c<h;c++)u[c]=0;for(var _=t.ss.enumerate(i);_.moveNext();)u[C=l[a=_.current]]++;var d=new Array(h);for(c=0;c<h;++c){var g=u[c];if(g>0){d[c]=new Array(g);for(var f=0;f<g;f++)d[c][f]=0}}for(c=0;c<i.length;++c){var m=Math.floor(c/3);d[C=l[i[c]]][--u[C]]=m}var p=new Array(r);for(c=0;c<r;++c){var w=i[3*c+0],b=i[3*c+1],v=i[3*c+2],y=wn.subtractVectors(e[b].get_position(),e[w].get_position()),S=wn.subtractVectors(e[v].get_position(),e[b].get_position());p[c]=wn.cross(y,S),p[c].normalize()}var x=3*r,T=new Array(x),M=Math.min(.9999,Math.cos(n));for(c=0;c<x;++c){for(var C=l[a=i[c]],A=p[Math.floor(c/3)],L=new wn,I=t.ss.enumerate(d[C]);I.moveNext();){var k=p[m=I.current];wn.dot(A,k)>M&&L.add(k)}T[c]=L,T[c].normalize()}return T},_calculateVertexTangents:function(e,i,n){if(!e.length)return null;e.length;for(var r=Math.floor(i.length/3),s=[],a=0;a<e.length;++a){var o=new Xl;o.position=e[a].get_position(),o.index=a,s.push(o)}s.sort((function(t,e){return Hl._compareVector3(t.position,e.position)}));var l=new Array(s.length),h=0;for(a=0;a<s.length;a++)a&&!Hl._compareVector3(s[a].position,s[a-1].position)||++h,l[s[a].index]=h-1;for(var u=new Array(h),c=0;c<h;c++)u[c]=0;for(var _=t.ss.enumerate(i);_.moveNext();)u[D=l[a=_.current]]++;var d=new Array(h);for(c=0;c<h;++c){var g=u[c];if(g>0){d[c]=new Array(g);for(var f=0;f<g;f++)d[c][f]=0}}for(c=0;c<i.length;++c){var m=Math.floor(c/3);d[D=l[i[c]]][--u[D]]=m}var p=new Array(r);for(c=0;c<r;++c){var w=e[i[3*c+0]],b=e[i[3*c+1]],v=e[i[3*c+2]],y=wn.subtractVectors(b.get_position(),w.get_position()),S=wn.subtractVectors(v.get_position(),w.get_position()),x=b.tu-w.tu,T=b.tv-w.tv,M=v.tu-w.tu,C=v.tv-w.tv,A=x*C-T*M;if(Math.abs(A)<1e-6)y.lengthSq()>0?(p[c]=y,p[c].normalize()):p[c]=wn.create(1,0,0);else{var L=1/A,I=C*L,k=-T*L;p[c]=wn.addVectors(wn.multiplyScalar(y,I),wn.multiplyScalar(S,k)),p[c].normalize()}}var P=3*r,R=new Array(P),E=Math.min(.9999,Math.cos(n));for(c=0;c<P;++c){for(var D=l[a=i[c]],F=p[Math.floor(c/3)],N=new wn,$=t.ss.enumerate(d[D]);$.moveNext();){var z=p[m=$.current];wn.dot(F,z)>E&&N.add(z)}var B=e[a].get_normal();R[c]=wn.subtractVectors(N,wn.multiplyScalar(B,wn.dot(B,N))),R[c].normalize()}return R},_calculateVertexNormals:function(e,i,n){for(var r=e.length,s=Math.floor(i.length/3),a=new Array(r),o=t.ss.enumerate(i);o.moveNext();)a[y=o.current]++;for(var l=new Array(r),h=0;h<r;++h){var u=a[h];u>0&&(l[h]=new Array(u))}for(h=0;h<i.length;++h){var c=Math.floor(h/3);l[y=i[h]][--a[y]]=c}var _=new Array(s);for(h=0;h<s;++h){var d=i[3*h+0],g=i[3*h+1],f=i[3*h+2],m=wn.subtractVectors(e[g].get_position(),e[d].get_position()),p=wn.subtractVectors(e[f].get_position(),e[g].get_position());_[h]=wn.cross(m,p),_[h].normalize()}var w=3*s,b=new Array(w),v=Math.min(.9999,Math.cos(n));for(h=0;h<w;++h){for(var y=i[h],S=_[Math.floor(h/3)],x=new wn,T=t.ss.enumerate(l[y]);T.moveNext();){var M=_[c=T.current];wn.dot(S,M)>v&&x.add(M)}b[h]=x,b[h].normalize()}return b},_addMaterial:function(t){for(this._meshMaterials.push(t);this._meshTextures.length<this._meshMaterials.length;)this._meshTextures.push(null);for(;this._meshSpecularTextures.length<this._meshMaterials.length;)this._meshSpecularTextures.push(null);for(;this._meshNormalMaps.length<this._meshMaterials.length;)this._meshNormalMaps.push(null)},_loadColorChunk:function(e){var i=e.readUInt16(),n=e.readUInt32(),r=Xi.get_black();if(16!==i&&19!==i||18!==n)17!==i&&18!==i||9!==n?e.readBytes(n-6):r=Oi.fromArgb(255,e.readByte(),e.readByte(),e.readByte());else{var s=Math.max(0,Math.min(1,e.readSingle())),a=Math.max(0,Math.min(1,e.readSingle())),o=Math.max(0,Math.min(1,e.readSingle()));r=Oi.fromArgb(255,t.ss.truncate(255*s),t.ss.truncate(255*a),t.ss.truncate(255*o))}return r},_loadPercentageChunk:function(t){var e=t.readUInt16(),i=t.readUInt32(),n=0;return 48===e&&8===i?n=t.readUInt16():49===e&&10===i?n=t.readSingle():t.readBytes(i-6),n},_loadMeshFromObj:function(e,i){var n=this;this.filename=i,this._tourDocument=e;var r=e.getFileBlob(i),s=new FileReader;s.onloadend=function(e){n._matFiles=n._readObjMaterialsFromBin(t.ss.safeCast(s.result,String)),n._matFileIndex=0,n._loadMatLib(t.ss.safeCast(s.result,String))},s.readAsText(r)},_readObjMaterialsFromBin:function(e){for(var i=[],n=e.split("\n"),r=t.ss.enumerate(n);r.moveNext();){var s=r.current,a=t.ss.replaceString(s,"  "," "),o=t.ss.trim(a).split(" ");if(o.length>0&&"mtllib"===o[0]){var l=this.filename.substring(0,this.filename.lastIndexOf("\\")+1)+o[1];i.push(l)}}return i},_readObjFromBin:function(e){var i=!1,n=[],r=new jl;r.name="Default";var s=[],a=[],o=[],l=[];a.push(new wn),o.push(new wn),l.push(new vn);var h=[],u=-1,c=new zl,_=new Vl,d=0;(c=new zl).diffuse=this.color,c.ambient=this.color,c.specular=Xi.get_white(),c.specularSharpness=30,c.opacity=1,c.isDefault=!0,_.startIndex=0,_.indexCount=0,_.materialIndex=0;for(var g=e.split("\n"),f=t.ss.enumerate(g);f.moveNext();){var m=f.current,p=t.ss.replaceString(m,"  "," "),w=t.ss.trim(p).split(" ");if(w.length>0)switch(w[0]){case"mtllib":break;case"usemtl":var b=w[1];if(t.ss.keyExists(this._matLib,b)&&(-1===u&&d>0&&(this._addMaterial(c),u++),u>-1&&(_.indexCount=d-_.startIndex,r.drawGroup.push(_)),u++,t.ss.keyExists(this._matLib,b))){if(c=this._matLib[b],t.ss.keyExists(this._textureLib,b))try{if(!t.ss.keyExists(this._textureCache,this._textureLib[b])){var v=this.filename.substring(0,this.filename.lastIndexOf("\\")+1),y=this._tourDocument.getCachedTexture2d(v+this._textureLib[b]);null!=y&&(this.meshFilenames.push(this._textureLib[b]),this._textureCache[this._textureLib[b]]=y)}this._meshTextures.push(this._textureCache[this._textureLib[b]])}catch(t){}this._addMaterial(c),(_=new Vl).startIndex=d,_.indexCount=0,_.materialIndex=u}break;case"v":this.flipHandedness?a.push(wn.create(-parseFloat(w[1]),parseFloat(w[2]),parseFloat(w[3]))):a.push(wn.create(parseFloat(w[1]),parseFloat(w[2]),parseFloat(w[3])));break;case"vn":this.flipHandedness?o.push(wn.create(-parseFloat(w[1]),parseFloat(w[2]),parseFloat(w[3]))):o.push(wn.create(parseFloat(w[1]),parseFloat(w[2]),parseFloat(w[3])));break;case"vt":l.push(vn.create(parseFloat(w[1]),this.flipV?1-parseFloat(w[2]):parseFloat(w[2])));break;case"g":case"o":i&&(u>-1&&(_.indexCount=d-_.startIndex,r.drawGroup.push(_),(_=new Vl).startIndex=d,_.indexCount=0,_.materialIndex=u),r=new jl),i=!0,w.length>1?r.name=w[1]:r.name="Unnamed",n.push(r);break;case"f":var S=this._getIndexies(w[1]),x=this._getIndexies(w[2]),T=this._getIndexies(w[3]);if(s.push(In.createUV(a[S[0]],o[S[2]],l[S[1]])),s.push(In.createUV(a[x[0]],o[x[2]],l[x[1]])),s.push(In.createUV(a[T[0]],o[T[2]],l[T[1]])),this.flipHandedness?(h.push(d),h.push(d+2),h.push(d+1)):(h.push(d),h.push(d+1),h.push(d+2)),d+=3,w.length>4)for(var M=4;M<w.length;)this.flipHandedness?(S=this._getIndexies(w[1]),T=this._getIndexies(w[M]),x=this._getIndexies(w[M-1])):(S=this._getIndexies(w[1]),x=this._getIndexies(w[M-1]),T=this._getIndexies(w[M])),s.push(In.createUV(a[S[0]],o[S[2]],l[S[1]])),s.push(In.createUV(a[x[0]],o[x[2]],l[x[1]])),s.push(In.createUV(a[T[0]],o[T[2]],l[T[1]])),h.push(d),h.push(d+1),h.push(d+2),d+=3,M++}}if(i||n.push(r),-1===u&&d>0&&(this._addMaterial(c),u++),u>-1&&(_.indexCount=d-_.startIndex,r.drawGroup.push(_)),o.length<2){for(var C=Math.PI/180,A=this.smooth?170*C:45*C,L=this._calculateVertexNormalsMerged(s,h,A),I=[],k=h.length,P=0;P<k;++P){var R=s[h[P]];R.set_normal(L[P]),I.push(R)}s=I}this._mesh=Ol.create(s,h);var E=new jl;E.name="Root",E.parent=null,E.level=-1,E.drawGroup=null,E.children=n,this.objects=[],this.objects.push(E),this._mesh.setObjects(this.objects),this._mesh.commitToDevice(),this._dirty=!1,this._readyToRender=!0},_loadMatLib:function(e){var i=this;if(this._matFileIndex<this._matFiles.length){var n=this._matFiles[this._matFileIndex++],r=this._tourDocument.getFileBlob(n),s=new FileReader;s.onloadend=function(n){i._readMatLibFromBin(t.ss.safeCast(s.result,String)),i._loadMatLib(e)},s.readAsText(r)}else this._readObjFromBin(e)},_readMatLibFromBin:function(e){try{var i=new zl,n="";this._matLib={},this._textureLib={};for(var r=e.split("\n"),s=t.ss.enumerate(r);s.moveNext();){var a=s.current,o=t.ss.trim(a).split(" ");if(o.length>0)switch(o[0]){case"newmtl":t.ss.emptyString(n)||(this._matLib[n]=i),(i=new zl).diffuse=Xi.get_white(),i.ambient=Xi.get_white(),i.specular=Xi.get_black(),i.specularSharpness=30,i.opacity=1,n=o[1];break;case"Ka":i.ambient=Oi.fromArgb(255,Math.min(255*parseFloat(o[1]),255),Math.min(255*parseFloat(o[2]),255),Math.min(255*parseFloat(o[3]),255));break;case"map_Kd":i.diffuse=Xi.get_white();for(var l=o[1],h=2;h<o.length;h++)l+=" "+o[h];this.filename.substring(0,this.filename.lastIndexOf("\\")+1),-1!==(l=t.ss.replaceString(l,"/","\\")).indexOf("\\")&&(l=l.substring(l.lastIndexOf("\\")+1)),this._textureLib[n]=l;break;case"Kd":i.diffuse=Oi.fromArgb(255,Math.min(255*parseFloat(o[1]),255),Math.min(255*parseFloat(o[2]),255),Math.min(255*parseFloat(o[3]),255));break;case"Ks":i.specular=Oi.fromArgb(255,Math.min(255*parseFloat(o[1]),255),Math.min(255*parseFloat(o[2]),255),Math.min(255*parseFloat(o[3]),255));break;case"d":i.opacity=parseFloat(o[1]);break;case"Tr":i.opacity=1-parseFloat(o[1]);break;case"illum":parseInt(o[1]);break;case"sharpness":i.specularSharpness=parseFloat(o[1]);break;case"Ns":i.specularSharpness=1+2*parseFloat(o[1]),i.specularSharpness=Math.max(10,i.specularSharpness)}}t.ss.emptyString(n)||(this._matLib[n]=i)}catch(t){}},_getIndexies:function(e){var i=t.ss.trim(e).split("/"),n=new Array(3);return t.ss.emptyString(e)||(i.length>0&&(n[0]=parseInt(i[0])),i.length>1&&(t.ss.emptyString(i[1])?n[1]=0:n[1]=parseInt(i[1])),i.length>2&&(n[2]=parseInt(i[2]))),n},_loadMeshFrom3ds:function(t,e,i){var n=this;this._tourDocument=t;var r=t.getFileBlob(e),s=new FileReader;s.onloadend=function(t){n._read3dsFromBin(new js(new Uint8Array(s.result)),i)},s.readAsArrayBuffer(r)},_read3dsFromBin:function(e,i){for(var n,r,s,a="",o="",l=0,h=0,u=[],c=[],_=[],d=-1,g=new zl,f=0,m=0,p=!1,w=[],b=null,v=[],y=[],S={},x=e.get_length()-1,T=0,M=0;e.get_position()<x;)switch(r=e.readUInt16(),s=e.readUInt32(),r){case 19789:case 15677:case 45055:case 41472:case 45056:case 45058:break;case 16384:var C;a="";do{(C=e.readByte())>0&&(a+=String.fromCharCode(C))}while(C);(b=new jl).name=a,w.push(b),t.ss.keyExists(S,b.name)||(S[b.name]=b);break;case 16640:T=u.length,M=Math.floor(c.length/3);break;case 16656:for(h=e.readUInt16(),n=0;n<h;n++){var A=e.readSingle()-0,L=e.readSingle()-0,I=e.readSingle()-0,k=In._create(A*i,I*i,L*i,0,0,0,0,0);u.push(k)}break;case 16672:for(l+=D=e.readUInt16(),n=0;n<D;n++){var P=e.readUInt16()+T,R=e.readUInt16()+T,E=e.readUInt16()+T;c.push(E),c.push(R),c.push(P),e.readUInt16()}break;case 16688:o="",n=0;do{(H=e.readByte())>0&&(o+=String.fromCharCode(H)),n++}while(H);var D=e.readUInt16(),F=new Array(D);for(f=Hl._getMaterialID(o,_),n=0;n<D;n++)F[n]=e.readUInt16()+M;b.applyLists.push(F),b.applyListsIndex.push(f);break;case 16704:for(m=e.readUInt16(),n=0;n<m;n++){k=u[T+n];var N=vn.create(e.readSingle(),this.flipV?1-e.readSingle():e.readSingle());u[T+n]=In.createUV(k.get_position(),new wn,N)}break;case 16736:var $=new Array(12);for(n=0;n<12;n++)$[n]=e.readSingle();t.ss.keyExists(S,a)&&(S[a].localMat=yn.create($[0],$[1],$[2],0,$[3],$[4],$[5],0,$[6],$[7],$[8],0,$[9],$[10],$[11],1),S[a].localMat.invert());break;case 40960:var z="";n=0;do{(V=e.readByte())>0&&(z+=String.fromCharCode(V)),n++}while(V);_.push(z),d>-1&&this._addMaterial(g),d++,(g=new zl).diffuse=Xi.get_white(),g.ambient=Xi.get_white(),g.specular=Xi.get_black(),g.specularSharpness=30,g.opacity=1;break;case 40976:g.ambient=this._loadColorChunk(e);break;case 40992:g.diffuse=this._loadColorChunk(e);break;case 41008:g.specular=this._loadColorChunk(e);break;case 41024:g.specularSharpness=1+2*this._loadPercentageChunk(e),g.specularSharpness=Math.max(10,g.specularSharpness);break;case 41728:var B="";n=0;do{(V=e.readByte())>0&&(B+=String.fromCharCode(V)),n++}while(V);var U=this.filename.substring(0,this.filename.lastIndexOf("\\")+1);try{null!=(G=this._tourDocument.getCachedTexture2d(U+B))?(this._meshTextures.push(G),this.meshFilenames.push(B),g.diffuse=Xi.get_white()):this._meshTextures.push(null)}catch(t){this._meshTextures.push(null)}break;case 41520:this._loadPercentageChunk(e),e.readUInt16(),e.readUInt32(),B="",n=0;do{(V=e.readByte())>0&&(B+=String.fromCharCode(V)),n++}while(V);U=this.filename.substring(0,this.filename.lastIndexOf("\\")+1);try{null!=(G=this._tourDocument.getCachedTexture2d(U+B))?(this._meshNormalMaps.push(G),this.meshFilenames.push(B),p=!0):this._meshNormalMaps.push(null)}catch(t){this._meshNormalMaps.push(null)}break;case 41476:var V,O=this._loadPercentageChunk(e);e.readUInt16(),e.readUInt32(),B="",n=0;do{(V=e.readByte())>0&&(B+=String.fromCharCode(V)),n++}while(V);U=this.filename.substring(0,this.filename.lastIndexOf("\\")+1);try{var G;if(null!=(G=this._tourDocument.getCachedTexture2d(U+B))){this._meshSpecularTextures.push(G),this.meshFilenames.push(B);var X=t.ss.truncate(255.99*O/100);g.specular=Oi.fromArgb(255,X,X,X)}else this._meshSpecularTextures.push(null)}catch(t){this._meshSpecularTextures.push(null)}break;case 45072:a="",n=0;do{(H=e.readByte())>0&&(a+=String.fromCharCode(H)),n++}while(H);e.readUInt16(),e.readUInt16(),65535===(dt=e.readUInt16())&&(dt=-1),t.ss.startsWith(a,"$")||y.push(a),v.push(dt),t.ss.keyExists(S,a)&&(S[a].level=dt);break;case 45073:var H;a="",n=0;do{(H=e.readByte())>0&&(a+=String.fromCharCode(H)),n++}while(H);y.push("$$$"+a);break;case 45075:var Y=new Array(3);for(n=0;n<3;n++)Y[n]=e.readSingle();t.ss.keyExists(S,a)&&(S[a].pivotPoint=wn.create(-Y[0],-Y[1],-Y[2]));break;case 45088:var j=new Array(8);for(n=0;n<8;n++)j[n]=e.readSingle();break;default:e.seekRelative(s-6)}e.close(),d>-1&&this._addMaterial(g);for(var W=Math.PI/180,q=this.smooth?70*W:45*W,Z=this._calculateVertexNormalsMerged(u,c,q),K=[],J=3*l,Q=0;Q<J;++Q)(yt=u[c[Q]]).set_normal(Z[Q]),K.push(yt);for(var tt=[],et=t.ss.enumerate(w);et.moveNext();){var it=et.current,nt=[];for(n=0;n<it.applyLists.length;n++){for(var rt=it.applyListsIndex[n],st=tt.length,at=t.ss.enumerate(it.applyLists[n]);at.moveNext();){var ot=at.current;tt.push(3*ot),tt.push(3*ot+1),tt.push(3*ot+2)}var lt=new Vl;lt.startIndex=st,lt.indexCount=3*it.applyLists[n].length,lt.materialIndex=rt,nt.push(lt)}it.drawGroup=nt}var ht=new t.ss.Stack,ut=[],ct=new jl;ct.name="Root",ct.parent=null,ct.level=-1,ct.drawGroup=null;var _t=-1;for(ht.push(ct),ut.push(ct),n=0;n<v.length;n++){var dt;if((dt=v[n])<=_t){for(;dt<=ht.peek().level&&ht.count>1;)ht.pop();_t=dt}if(t.ss.startsWith(y[n],"$$$")){var gt=new jl;gt.name=t.ss.replaceString(y[n],"$$$",""),gt.parent=ht.peek(),gt.parent.children.push(gt),gt.level=_t=dt,gt.drawGroup=null,ht.push(gt)}else S[y[n]].level=_t=dt,S[y[n]].parent=ht.peek(),S[y[n]].parent.children.push(S[y[n]]),ht.push(S[y[n]])}if(!v.length)for(var ft=t.ss.enumerate(w);ft.moveNext();)it=ft.current,ct.children.push(it),it.parent=ct;if(p){for(var mt=[],pt=0;pt<J;++pt)mt.push(pt);for(var wt=this._calculateVertexTangents(K,mt,q),bt=new Array(K.length),vt=(Q=0,t.ss.enumerate(K));vt.moveNext();){var yt,St=new mn((yt=vt.current).get_position(),yt.get_normal(),vn.create(yt.tu,yt.tv),wt[Q]);bt[Q]=St,++Q}this._mesh=Ol.createTangent(bt,tt)}else this._mesh=Ol.create(K,tt);this.objects=ut,this._mesh.setObjects(ut),this._mesh.commitToDevice(),this._dirty=!1,this._readyToRender=!0},_offsetObjects:function(e,i,n,r){for(var s=t.ss.enumerate(i);s.moveNext();){var a=s.current,o=a.localMat;this._offsetObjects(e,a.children,o,wn.addVectors(a.pivotPoint,r));for(var l=t.ss.enumerate(a.drawGroup);l.moveNext();)for(var h=l.current,u=h.startIndex+h.indexCount,c=h.startIndex;c<u;c++){var _=e[c];_.set_position(wn.addVectors(_.get_position(),wn.addVectors(a.pivotPoint,r))),e[c]=_}}},setupLighting:function(e){var i=wn.create(e.get_world().get_offsetX(),e.get_world().get_offsetY(),e.get_world().get_offsetZ()),n=wn.subtractVectors(i,e.get_reflectedLightPosition()),r=wn.subtractVectors(e.get_sunPosition(),e.get_reflectedLightPosition()),s=r.length()<=0?1:wn.dot(n,r)/(n.length()*r.length()),a=Math.max(0,s);a=Math.sqrt(a);var o=0,l=1;if(e.get_occludingPlanetRadius()>0){var h=wn.subtractVectors(i,e.get_occludingPlanetPosition()).length()-e.get_occludingPlanetRadius();a*=1-(o=Math.max(0,Math.min(1,1-h/e.get_occludingPlanetRadius()*300)));var u=wn.subtractVectors(e.get_occludingPlanetPosition(),e.get_sunPosition()),c=wn.subtractVectors(e.get_occludingPlanetPosition(),i),_=wn.create(-c.x,-c.y,-c.z);_.normalize(),e.set_hemisphereLightUp(_);var d=wn.subtractVectors(e.get_sunPosition(),i),g=u.length(),f=-wn.dot(d,u)/(g*g);if(f>1){var m=wn.addVectors(e.get_sunPosition(),wn.multiplyScalar(u,f)),p=wn.subtractVectors(m,i).length(),w=(wn.subtractVectors(m,e.get_sunPosition()).length(),.004645784),b=e.get_occludingPlanetRadius()+(f-1)*(e.get_occludingPlanetRadius()+w),v=e.get_occludingPlanetRadius()+(f-1)*(e.get_occludingPlanetRadius()-w);if(p<b){var y=0;if(v<0){var S=Math.pow(1/(1-v),2);v=0,y=1-S}var x=Math.max(0,v);l=Math.max(y,(p-x)/(b-x));var T=t.ss.truncate(255.99*l);e.set_sunlightColor(Oi.fromArgb(255,T,T,T)),o*=l}}}e.set_reflectedLightColor(Oi.fromArgb(255,t.ss.truncate(e.get_reflectedLightColor().r*a),t.ss.truncate(e.get_reflectedLightColor().g*a),t.ss.truncate(e.get_reflectedLightColor().b*a))),e.set_hemisphereLightColor(Oi.fromArgb(255,t.ss.truncate(e.get_hemisphereLightColor().r*o),t.ss.truncate(e.get_hemisphereLightColor().g*o),t.ss.truncate(e.get_hemisphereLightColor().b*o)))},render:function(e,i){if(this._readyToRender){this._dirty&&!this.issLayer&&this._reload();var n=e.get_world(),r=this._mesh.boundingSphere.center,s=1;this._mesh.boundingSphere.radius>0&&(s=1/this._mesh.boundingSphere.radius),e.set_world(yn.multiplyMatrix(yn.multiplyMatrix(yn.translation(wn.create(-r.x,-r.y,-r.z)),yn._scaling(s,s,s)),n));var a=yn.multiplyMatrix(e.get_world(),e.get_view()),o=a.transform(wn.get_empty()),l=Math.sqrt(a.get_m11()*a.get_m11()+a.get_m22()*a.get_m22()+a.get_m33()*a.get_m33())/s,h=o.length(),u=l,c=t.ss.truncate(e.height),_=e.get_projection().get_m11(),d=e.get_projection().get_m34(),g=e.get_projection().get_m44();if(!(u*(_/(Math.abs(d)*h+g)*c)<.5)){var f=e.get_sunlightColor(),m=e.get_reflectedLightColor(),p=e.get_hemisphereLightColor();if(ko.get_current().get_solarSystemLighting()?(this.setupLighting(e),this.useCurrentAmbient||e.set_ambientLightColor(Oi.fromArgb(255,11,11,11))):(e.set_sunlightColor(Xi.get_black()),e.set_reflectedLightColor(Xi.get_black()),e.set_hemisphereLightColor(Xi.get_black()),e.set_ambientLightColor(Xi.get_white())),null!=this._mesh){fs.minLightingBrightness=.1;var w=this._meshMaterials.length;if(this._mesh.beginDrawing(e),w>0)for(var b=0;b<this._meshMaterials.length;b++){if(this._meshMaterials[b].isDefault){var v=this._meshMaterials[b];v.diffuse=this.color,v.ambient=this.color,this._meshMaterials[b]=v}e.setMaterial(this._meshMaterials[b],this._meshTextures[b],this._meshSpecularTextures[b],this._meshNormalMaps[b],i),null!=this._mesh.vertexBuffer?fs.use(e,this._mesh.vertexBuffer.vertexBuffer,this._mesh.indexBuffer.buffer,null!=this._meshTextures[b]?this._meshTextures[b].texture2d:null,i,!1,32):fs.use(e,this._mesh.tangentVertexBuffer.vertexBuffer,this._mesh.indexBuffer.buffer,null!=this._meshTextures[b]?this._meshTextures[b].texture2d:null,i,!1,44),e.preDraw(),this._mesh.drawSubset(e,b)}else for(e.preDraw(),b=0;b<this._meshTextures.length;b++)null!=this._meshTextures[b]&&(e.set_mainTexture(this._meshTextures[b]),null!=this._mesh.vertexBuffer?fs.use(e,this._mesh.vertexBuffer.vertexBuffer,this._mesh.indexBuffer.buffer,null!=this._meshTextures[b]?this._meshTextures[b].texture2d:null,i,!1,32):fs.use(e,this._mesh.tangentVertexBuffer.vertexBuffer,this._mesh.indexBuffer.buffer,null!=this._meshTextures[b]?this._meshTextures[b].texture2d:null,i,!1,44)),e.preDraw(),this._mesh.drawSubset(e,b);e.set_world(n),e.set_sunlightColor(f),e.set_reflectedLightColor(m),e.set_hemisphereLightColor(p),e.set_ambientLightColor(Xi.get_black())}}}},dispose:function(){null!=this._mesh&&(this._mesh.dispose(),this._mesh=null);for(var e=t.ss.enumerate(t.ss.keys(this._textureCache));e.moveNext();){var i=e.current,n=this._textureCache[i];null!=n&&n.dispose()}t.ss.clearKeys(this._textureCache),Hl._disposeTextureList(this._meshTextures),Hl._disposeTextureList(this._meshSpecularTextures),Hl._disposeTextureList(this._meshNormalMaps),this._meshMaterials.length=0,this._dirty=!0}};function jl(){this.level=-1,this.children=[],this.enabled=!0,this.drawGroup=[],this.applyLists=[],this.applyListsIndex=[]}function Wl(t){this._layer$1=null,this._opened$1=!0,this._callbacks$1=null,Ll.call(this),this._layer$1=t}function ql(t,e,i,n,r){this._elements=null,this._orbitColor=Xi.get_white(),this._scale=0,this._segmentCount=0,this._elements=t,this._segmentCount=e,this._orbitColor=i,this._scale=r}n("Object3d",[Hl,Yl,null]),n("ObjectNode",[jl,{},null]),n("Object3dLayerUI",[Wl,{setUICallbacks:function(t){this._callbacks$1=t},get_hasTreeViewNodes:function(){return!0},getTreeNodes:function(){var t=[];return this._layer$1.object3d.objects.length>0&&null!=this._layer$1.object3d.objects[0].children&&this._loadTree$1(t,this._layer$1.object3d.objects[0].children),t},_loadTree$1:function(e,i){for(var n=t.ss.enumerate(i);n.moveNext();){var r=n.current,s=new Pl;s.set_name(r.name),s.set_tag(r),s.set_checked(r.enabled),s.add_nodeSelected(t.ss.bind("_node_NodeSelected$1",this)),s.add_nodeChecked(t.ss.bind("_node_NodeChecked$1",this)),e.push(s),this._loadTree$1(s.get_nodes(),r.children)}},_node_NodeChecked$1:function(t,e){var i=t.get_tag();null!=i&&(i.enabled=e)},_node_NodeSelected$1:function(t){if(null!=this._callbacks$1){var e=t.get_tag(),i={};i.Name=e.name,i["Pivot.X"]=e.pivotPoint.x.toString(),i["Pivot.Y"]=e.pivotPoint.y.toString(),i["Pivot.Z"]=e.pivotPoint.z.toString(),this._callbacks$1.showRowData(i)}},getNodeContextMenu:function(t){return Ll.prototype.getNodeContextMenu.call(this,t)}},Ll]),ql._orbitalToWwt=yn.create(1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1),ql._initBegun=!1;var Zl={cleanUp:function(){},get_boundingRadius:function(){return null!=this._elements?this._elements.a*(1+this._elements.e)/this._scale:0},draw3D:function(e,i,n){var r=yn.multiplyMatrix(yn._rotationZ(Qs.degreesToRadians(this._elements.w)),yn.multiplyMatrix(yn._rotationX(Qs.degreesToRadians(this._elements.i)),yn._rotationZ(Qs.degreesToRadians(this._elements.omega))));r=yn.multiplyMatrix(r,ql._orbitalToWwt);var s=yn.multiplyMatrix(yn.multiplyMatrix(r,yn.translation(n)),e.get_world()),a=this._elements.n*(Wo.get_jNow()-this._elements.t),o=1;a<0&&(o=-1),a=360*((a=Math.abs(a)/360)-t.ss.truncate(a))*o;for(var l=Oi._fromArgbColor(t.ss.truncate(255*i),this._orbitColor),h=a=Qs.degreesToRadians(a),u=0;u<5;u++)h+=(a-h+this._elements.e*Math.sin(h))/(1-this._elements.e*Math.cos(h));Kl.drawEllipse(e,this._elements.a/this._scale,this._elements.e,h,l,s)}};function Kl(){}n("Orbit",[ql,Zl,null]),Kl.drawEllipseWithPosition=function(t,e,i,n,r,s,a){null==Kl._ellipseShader&&(Kl._ellipseShader=new gs),null==Kl._ellipseVertexBuffer&&(Kl._ellipseVertexBuffer=Kl.createEllipseVertexBuffer(500));var o=t.get_world();t.set_world(s),t.gl.bindBuffer(Yr.ARRAY_BUFFER,Kl._ellipseVertexBuffer.vertexBuffer),t.gl.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),gs.use(t,e,i,n,r,1,o,a),t.gl.drawArrays(Yr.LINE_STRIP,0,Kl._ellipseVertexBuffer.count),t.set_world(o)},Kl.drawEllipse=function(t,e,i,n,r,s){null==Kl._ellipseShader&&(Kl._ellipseShader=new gs),null==Kl._ellipseWithoutStartPointVertexBuffer&&(Kl._ellipseWithoutStartPointVertexBuffer=Kl.createEllipseVertexBufferWithoutStartPoint(360));var a=t.get_world();t.set_world(s),t.gl.bindBuffer(Yr.ARRAY_BUFFER,Kl._ellipseWithoutStartPointVertexBuffer.vertexBuffer),t.gl.bindBuffer(Yr.ELEMENT_ARRAY_BUFFER,null),gs.use(t,e,i,n,r,1,a,wn.create(0,0,0)),t.gl.drawArrays(Yr.LINE_STRIP,0,Kl._ellipseWithoutStartPointVertexBuffer.count-1),t.set_world(a)},Kl.createEllipseVertexBuffer=function(t){for(var e=new Zr(t),i=e.lock(),n=0,r=0;r<t/2;++r)i[n++]=wn.create(2*r/t*.05,0,0);for(r=0;r<t/2;++r)i[n++]=wn.create(2*r/t*.95+.05,0,0);return e.unlock(),e},Kl.createEllipseVertexBufferWithoutStartPoint=function(t){var e=new Zr(t),i=e.lock();i[0]=wn.create(1e-6,0,0);for(var n=1;n<t;++n)i[n]=wn.create(2*n/t,0,0);return e.unlock(),e},n("EllipseRenderer",[Kl,{},null]);var Jl={fixedSherical:0,orbital:1,trajectory:2,synodic:3};function Ql(){this._systemGenerated=!1,this.meanAnomoly=0,this.orbitalYears=0,this.observingLocation=!1,this.reference=18,this.parentsRoationalBase=!1,this.referenceFrameType=0,this.meanRadius=6371e3,this.oblateness=.0033528,this.heading=0,this.pitch=0,this.roll=0,this.scale=1,this.tilt=0,this.translation=new wn,this.lat=0,this.lng=0,this.altitude=0,this.rotationalPeriod=0,this.zeroRotationDate=0,this.representativeColor=Xi.get_white(),this.showAsPoint=!1,this.showOrbitPath=!1,this.stationKeeping=!0,this.semiMajorAxis=0,this.semiMajorAxisUnits=1,this.eccentricity=0,this.inclination=0,this.argumentOfPeriapsis=0,this.longitudeOfAscendingNode=0,this.meanAnomolyAtEpoch=0,this.meanDailyMotion=0,this.epoch=0,this._orbit=null,this._elements=new En,this.worldMatrix=new yn,this.worldMatrix=yn.get_identity()}n("ReferenceFrameTypes",Jl),r("ReferenceFrameTypes",Jl),Ql.isTLECheckSumGood=function(t){if(69!==t.length)return!1;for(var e=0,i=0;i<68;i++)switch(t.substr(i,1)){case"1":case"-":e+=1;break;case"2":e+=2;break;case"3":e+=3;break;case"4":e+=4;break;case"5":e+=5;break;case"6":e+=6;break;case"7":e+=7;break;case"8":e+=8;break;case"9":e+=9}return(e%10).toString()===t.charAt(68).toString()},Ql.toTLEExponential=function(t,e){var i=t.toExponential(e);return i.length<e+6&&(i=i.substring(0,e+4)+"0"+i.substr(e+4,1)),i},Ql.tleNumberString=function(t,e,i){var n=t.toFixed(i),r=n.indexOf(".");-1===r&&(r=n.length,n+=".0");var s=n.length-r-1,a="00000000";return a.substr(0,e-r)+n+a.substr(0,i-s)},Ql.computeTLECheckSum=function(t){if(68!==t.length)return"0";for(var e=0,i=0;i<68;i++)switch(t[i]){case"1":case"-":e+=1;break;case"2":e+=2;break;case"3":e+=3;break;case"4":e+=4;break;case"5":e+=5;break;case"6":e+=6;break;case"7":e+=7;break;case"8":e+=8;break;case"9":e+=9}return e%10};var th={get_representativeColor:function(){return this.representativeColor},set_representativeColor:function(t){return t!==this.representativeColor&&(this.representativeColor=t,this._orbit=null),t},get_orbit:function(){return this._orbit},set_orbit:function(t){return this._orbit=t,t},getIndentifier:function(){return this.name},importTrajectory:function(t){},saveToXml:function(t){t._writeStartElement("ReferenceFrame"),t._writeAttributeString("Name",this.name),t._writeAttributeString("Parent",this.parent),t._writeAttributeString("ReferenceFrameType",s.toXml("ReferenceFrameTypes",this.referenceFrameType)),t._writeAttributeString("Reference",s.toXml("ReferenceFrames",this.reference)),t._writeAttributeString("ParentsRoationalBase",this.parentsRoationalBase.toString()),t._writeAttributeString("MeanRadius",this.meanRadius.toString()),t._writeAttributeString("Oblateness",this.oblateness.toString()),t._writeAttributeString("Heading",this.heading.toString()),t._writeAttributeString("Pitch",this.pitch.toString()),t._writeAttributeString("Roll",this.roll.toString()),t._writeAttributeString("Scale",this.scale.toString()),t._writeAttributeString("Tilt",this.tilt.toString()),t._writeAttributeString("Translation",this.translation.toString()),this.referenceFrameType||(t._writeAttributeString("Lat",this.lat.toString()),t._writeAttributeString("Lng",this.lng.toString()),t._writeAttributeString("Altitude",this.altitude.toString())),t._writeAttributeString("RotationalPeriod",this.rotationalPeriod.toString()),t._writeAttributeString("ZeroRotationDate",this.zeroRotationDate.toString()),t._writeAttributeString("RepresentativeColor",this.get_representativeColor().save()),t._writeAttributeString("ShowAsPoint",this.showAsPoint.toString()),t._writeAttributeString("ShowOrbitPath",this.showOrbitPath.toString()),t._writeAttributeString("StationKeeping",this.stationKeeping.toString()),1===this.referenceFrameType&&(t._writeAttributeString("SemiMajorAxis",this.semiMajorAxis.toString()),t._writeAttributeString("SemiMajorAxisScale",s.toXml("AltUnits",this.semiMajorAxisUnits)),t._writeAttributeString("Eccentricity",this.eccentricity.toString()),t._writeAttributeString("Inclination",this.inclination.toString()),t._writeAttributeString("ArgumentOfPeriapsis",this.argumentOfPeriapsis.toString()),t._writeAttributeString("LongitudeOfAscendingNode",this.longitudeOfAscendingNode.toString()),t._writeAttributeString("MeanAnomolyAtEpoch",this.meanAnomolyAtEpoch.toString()),t._writeAttributeString("MeanDailyMotion",this.meanDailyMotion.toString()),t._writeAttributeString("Epoch",this.epoch.toString())),t._writeEndElement()},initializeFromXml:function(e){this.name=e.attributes.getNamedItem("Name").nodeValue,this.parent=e.attributes.getNamedItem("Parent").nodeValue,this.referenceFrameType=s.parse("ReferenceFrameTypes",e.attributes.getNamedItem("ReferenceFrameType").nodeValue),this.reference=s.parse("ReferenceFrames",e.attributes.getNamedItem("Reference").nodeValue),this.parentsRoationalBase=t.ss.boolean(e.attributes.getNamedItem("ParentsRoationalBase").nodeValue),this.meanRadius=parseFloat(e.attributes.getNamedItem("MeanRadius").nodeValue),this.oblateness=parseFloat(e.attributes.getNamedItem("Oblateness").nodeValue),this.heading=parseFloat(e.attributes.getNamedItem("Heading").nodeValue),this.pitch=parseFloat(e.attributes.getNamedItem("Pitch").nodeValue),this.roll=parseFloat(e.attributes.getNamedItem("Roll").nodeValue),this.scale=parseFloat(e.attributes.getNamedItem("Scale").nodeValue),this.tilt=parseFloat(e.attributes.getNamedItem("Tilt").nodeValue),this.translation=wn.parse(e.attributes.getNamedItem("Translation").nodeValue),this.referenceFrameType||(this.lat=parseFloat(e.attributes.getNamedItem("Lat").nodeValue),this.lng=parseFloat(e.attributes.getNamedItem("Lng").nodeValue),this.altitude=parseFloat(e.attributes.getNamedItem("Altitude").nodeValue)),this.rotationalPeriod=parseFloat(e.attributes.getNamedItem("RotationalPeriod").nodeValue),this.zeroRotationDate=parseFloat(e.attributes.getNamedItem("ZeroRotationDate").nodeValue),this.set_representativeColor(Oi.load(e.attributes.getNamedItem("RepresentativeColor").nodeValue)),this.showAsPoint=t.ss.boolean(e.attributes.getNamedItem("ShowAsPoint").nodeValue),null!=e.attributes.getNamedItem("StationKeeping")&&(this.stationKeeping=t.ss.boolean(e.attributes.getNamedItem("StationKeeping").nodeValue)),1===this.referenceFrameType&&(this.showOrbitPath=t.ss.boolean(e.attributes.getNamedItem("ShowOrbitPath").nodeValue),this.semiMajorAxis=parseFloat(e.attributes.getNamedItem("SemiMajorAxis").nodeValue),this.semiMajorAxisUnits=s.parse("AltUnits",e.attributes.getNamedItem("SemiMajorAxisScale").nodeValue),this.eccentricity=parseFloat(e.attributes.getNamedItem("Eccentricity").nodeValue),this.inclination=parseFloat(e.attributes.getNamedItem("Inclination").nodeValue),this.argumentOfPeriapsis=parseFloat(e.attributes.getNamedItem("ArgumentOfPeriapsis").nodeValue),this.longitudeOfAscendingNode=parseFloat(e.attributes.getNamedItem("LongitudeOfAscendingNode").nodeValue),this.meanAnomolyAtEpoch=parseFloat(e.attributes.getNamedItem("MeanAnomolyAtEpoch").nodeValue),this.meanDailyMotion=parseFloat(e.attributes.getNamedItem("MeanDailyMotion").nodeValue),this.epoch=parseFloat(e.attributes.getNamedItem("Epoch").nodeValue))},fromTLE:function(t,e,i){this.epoch=Wo._twoLineDateToJulian(t.substr(18,14)),this.eccentricity=parseFloat("0."+e.substr(26,7)),this.inclination=parseFloat(e.substr(8,8)),this.longitudeOfAscendingNode=parseFloat(e.substr(17,8)),this.argumentOfPeriapsis=parseFloat(e.substr(34,8));var n=parseFloat(e.substr(52,11));this.meanAnomolyAtEpoch=parseFloat(e.substr(43,8)),this.meanDailyMotion=360*n;var r=86400/n/(2*Math.PI);this.semiMajorAxis=Math.pow(r*r*i,1/3),this.semiMajorAxisUnits=1},toTLE:function(){var e=new t.ss.StringBuilder;e.append("1 99999U 00111AAA "),e.append(Wo.julianToTwoLineDate(this.epoch)),e.append(" "),e.append(this.semiMajorAxis.toExponential(4)),e.append(" 00000-0 "),e.append(Ql.toTLEExponential(this.meanDailyMotion,5)),e.append("  001"),e.append(Ql.computeTLECheckSum(e.toString())),e.appendLine("");var i=new t.ss.StringBuilder;return i.append("2 99999 "),i.append(Ql.tleNumberString(this.inclination,3,4)+" "),i.append(Ql.tleNumberString(this.longitudeOfAscendingNode,3,4)+" "),i.append((Ql.tleNumberString(this.eccentricity,1,7)+" ").substring(2)),i.append(Ql.tleNumberString(this.argumentOfPeriapsis,3,4)+" "),i.append(Ql.tleNumberString(this.meanAnomolyAtEpoch,3,4)+" "),i.append(Ql.toTLEExponential(this.meanDailyMotion/207732,5)),i.append("00001"),i.append(Ql.computeTLECheckSum(i.toString())),i.appendLine(""),e.toString()+i.toString()},get_elements:function(){return this._elements.a=this.semiMajorAxis,this._elements.e=this.eccentricity,this._elements.i=this.inclination,this._elements.w=this.argumentOfPeriapsis,this._elements.omega=this.longitudeOfAscendingNode,this._elements.jdEquinox=this.epoch,this.meanDailyMotion?this._elements.n=this.meanDailyMotion:this._elements.n=$n.meanMotionFromSemiMajorAxis(this._elements.a),this._elements.t=this.epoch-this.meanAnomolyAtEpoch/this._elements.n,this._elements},set_elements:function(t){return this._elements=t,t},computeFrame:function(t){switch(this.referenceFrameType){case 1:this._computeOrbital(t);break;case 0:this._computeFixedSherical(t);break;case 2:this._computeFrameTrajectory(t)}},useRotatingParentFrame:function(){switch(this.referenceFrameType){case 1:case 2:case 3:return!1;default:return!0}},_computeFixedRectangular:function(t){},_computeFixedSherical:function(t){this.observingLocation&&(this.lat=Wo.get_location().get_lat(),this.lng=Wo.get_location().get_lng(),this.altitude=Wo.get_altitude()),this.worldMatrix=yn.get_identity(),this.worldMatrix.translate(this.translation);var e=1/t.get_nominalRadius()*this.scale*this.meanRadius;if(this.worldMatrix.scale(wn.create(e,e,e)),this.worldMatrix._multiply(yn.rotationYawPitchRoll(this.heading/180*Math.PI,this.pitch/180*Math.PI,this.roll/180*Math.PI)),this.worldMatrix._multiply(yn._rotationZ(-.5*Math.PI)),this.rotationalPeriod){var i=(Wo.get_jNow()-this.zeroRotationDate)/this.rotationalPeriod*Math.PI*2%(2*Math.PI);this.worldMatrix._multiply(yn._rotationX(-i))}this.worldMatrix.translate(wn.create(1+this.altitude/t.get_nominalRadius(),0,0)),this.worldMatrix._multiply(yn._rotationZ(this.lat/180*Math.PI)),this.worldMatrix._multiply(yn._rotationY(-(this.lng+180)/180*Math.PI))},_computeFrameTrajectory:function(t){},_computeOrbital:function(t){var e=this.get_elements(),i=$n.calculateRectangularJD(Wo.get_jNow(),e);this.meanAnomoly=e.meanAnnomolyOut;var n=$n.calculateRectangular(e,this.meanAnomoly+.001),r=wn.subtractVectors(i,n),s=i.copy();s.normalize(),r.normalize(),i.length();var a=1;switch(this.semiMajorAxisUnits){case 1:case 10:a=1;break;case 2:a=1/3.2808399;break;case 3:a=1/3.2808399/12;break;case 4:a=1609.344;break;case 5:a=1e3;break;case 6:a=149598e6;break;case 7:a=9460528406976600;break;case 8:a=0x6da0192cd11520;break;case 9:a=30856802447988e9}a*=1/t.get_nominalRadius();var o=yn.lookAtLH(wn.create(0,0,0),r,s);o.invert(),this.worldMatrix=yn.get_identity(),this.worldMatrix.translate(this.translation);var l=1/t.get_nominalRadius()*this.scale*this.meanRadius;if(this.worldMatrix.scale(wn.create(l,l,l)),this.worldMatrix._multiply(yn.rotationYawPitchRoll(this.heading/180*Math.PI,this.pitch/180*Math.PI,this.roll/180*Math.PI)),this.rotationalPeriod){var h=(Wo.get_jNow()-this.zeroRotationDate)/this.rotationalPeriod*Math.PI*2%(2*Math.PI);this.worldMatrix._multiply(yn._rotationX(-h))}i=wn.scale(i,a),this.worldMatrix.translate(i),this.stationKeeping&&(this.worldMatrix=yn.multiplyMatrix(o,this.worldMatrix))}};function eh(){this._frames$1=[],this._primaryUI$1=null,this._pointOpacity$1=1,this._pointColor$1=Xi.get_yellow(),this._filename$1="",this._dataFile$1="",Cl.call(this)}n("ReferenceFrame",[Ql,th,null]);var ih={get_frames:function(){return this._frames$1},set_frames:function(t){return this._frames$1=t,t},getPrimaryUI:function(){return null==this._primaryUI$1&&(this._primaryUI$1=new nh(this)),this._primaryUI$1},cleanUp:function(){for(var e=t.ss.enumerate(this._frames$1);e.moveNext();){var i=e.current;null!=i.get_orbit()&&(i.get_orbit().cleanUp(),i.set_orbit(null))}},writeLayerProperties:function(t){t._writeAttributeString("PointOpacity",this.get_pointOpacity().toString()),t._writeAttributeString("PointColor",this._pointColor$1.save())},get_pointOpacity:function(){return this._pointOpacity$1},set_pointOpacity:function(t){return this._pointOpacity$1!==t&&(this.version++,this._pointOpacity$1=t),t},get_pointColor:function(){return this._pointColor$1},set_pointColor:function(t){return this._pointColor$1!==t&&(this.version++,this._pointColor$1=t),t},getParams:function(){var t=new Array(6);return t[0]=this._pointOpacity$1,t[1]=this.get_color().r/255,t[2]=this.get_color().g/255,t[3]=this.get_color().b/255,t[4]=this.get_color().a/255,t[5]=this.get_opacity(),t},getParamNames:function(){return["PointOpacity","Color.Red","Color.Green","Color.Blue","Color.Alpha","Opacity"]},setParams:function(e){if(6===e.length){this._pointOpacity$1=e[0],this.set_opacity(e[5]);var i=Oi.fromArgb(t.ss.truncate(255*e[4]),t.ss.truncate(255*e[1]),t.ss.truncate(255*e[2]),t.ss.truncate(255*e[3]));this.set_color(i)}},initializeFromXml:function(t){this.set_pointOpacity(parseFloat(t.attributes.getNamedItem("PointOpacity").nodeValue)),this.set_pointColor(Oi.load(t.attributes.getNamedItem("PointColor").nodeValue))},draw:function(e,i,n){var r=e.get_world();e.set_world(e.get_worldBaseNonRotating());for(var s=t.ss.enumerate(this._frames$1);s.moveNext();){var a=s.current;a.showOrbitPath&&(null==a.get_orbit()&&a.set_orbit(new ql(a.get_elements(),360,this.get_color(),1,e.get_nominalRadius())),a.get_orbit().draw3D(e,i*this.get_opacity(),new wn))}return e.set_world(r),!0},addFilesToCabinet:function(e){this._filename$1=e.tempDirectory+t.ss.format("{0}\\{1}.txt",e.get_packageID(),this.id.toString()),this._filename$1.substring(0,this._filename$1.lastIndexOf("\\"));var i=new Blob([this._dataFile$1]);e.addFile(this._filename$1,i),Cl.prototype.addFilesToCabinet.call(this,e)},loadData:function(e,i){var n=this,r=e.getFileBlob(i),s=new FileReader;s.onloadend=function(e){n._dataFile$1=t.ss.safeCast(s.result,String),n.loadString(n._dataFile$1)},s.readAsText(r)},loadString:function(e){var i=e.split("\n");this._frames$1.length=0;for(var n=0;n<i.length;n+=2){var r=n,s=n+1;if(i[n].length>0){var a=new Ql;if("1"!==i[n].substring(0,1))r++,s++,a.name=t.ss.trim(i[n]),n++;else{if("1"!==i[n].substring(0,1)){n-=2;continue}a.name=i[n].substring(2,5)}a.reference=18,a.oblateness=0,a.showOrbitPath=!0,a.showAsPoint=!0,a.referenceFrameType=1,a.scale=1,a.semiMajorAxisUnits=1,a.meanRadius=10,a.oblateness=0,a.fromTLE(i[r],i[s],3986004418e5),this._frames$1.push(a)}else n-=1}}};function nh(t){this._layer$1=null,this._opened$1=!0,this._callbacks$1=null,Ll.call(this),this._layer$1=t}function rh(){this.guid=new Ii,this.header=[],this.rows=[],this.delimiter="\t",this.locked=!1}n("OrbitLayer",[eh,ih,Cl]),n("OrbitLayerUI",[nh,{setUICallbacks:function(t){this._callbacks$1=t},get_hasTreeViewNodes:function(){return!0},getTreeNodes:function(){for(var e=[],i=t.ss.enumerate(this._layer$1.get_frames());i.moveNext();){var n=i.current,r=new Pl;r.set_name(n.name),r.set_tag(n),r.set_checked(n.showOrbitPath),r.add_nodeSelected(t.ss.bind("_node_NodeSelected$1",this)),r.add_nodeChecked(t.ss.bind("_node_NodeChecked$1",this)),e.push(r)}return e},_node_NodeChecked$1:function(t,e){var i=t.get_tag();null!=i&&(i.showOrbitPath=e)},_node_NodeSelected$1:function(t){if(null!=this._callbacks$1){var e=t.get_tag(),i={};i.Name=e.name,i["SemiMajor Axis"]=e.semiMajorAxis.toString(),i["SMA Units"]=e.semiMajorAxisUnits.toString(),i.Inclination=e.inclination.toString(),i.Eccentricity=e.eccentricity.toString(),i["Long of Asc. Node"]=e.longitudeOfAscendingNode.toString(),i["Argument Of Periapsis"]=e.argumentOfPeriapsis.toString(),i.Epoch=e.epoch.toString(),i["Mean Daily Motion"]=e.meanDailyMotion.toString(),i["Mean Anomoly at Epoch"]=e.meanAnomolyAtEpoch.toString(),this._callbacks$1.showRowData(i)}},getNodeContextMenu:function(t){return Ll.prototype.getNodeContextMenu.call(this,t)}},Ll]);var sh={lock:function(){this.locked=!0},unlock:function(){this.locked=!1},save:function(){for(var e="",i=!0,n=t.ss.enumerate(this.header);n.moveNext();)i?i=!1:e+="\t",e+=n.current;e+="\r\n";for(var r=t.ss.enumerate(this.rows);r.moveNext();){var s=r.current;i=!0;for(var a=t.ss.enumerate(s);a.moveNext();)i?i=!1:e+="\t",e+=a.current;e+="\r\n"}return e},loadFromString:function(t,e,i,n){var r=0,s=t.split("\r\n");if(!e||n)if(s.length>0){var a=s[0];r++,-1===a.indexOf("\t")&&a.indexOf(",")>-1&&(this.delimiter=","),e||(this.rows.length=0),this.header=Fa.splitString(a,this.delimiter)}else this.header=[];var o=[];for(i||(o=this.rows);r<s.length;){var l=s[r],h=Fa.splitString(l,this.delimiter);if(h.length<1)break;o.push(h),r++}i&&(this.rows=o)},clone:function(){for(var t=new rh,e=0;e<this.header.length;e++)t.header.push(this.header[e]);for(var i=0;i<this.rows.length;i++)for(t.rows.push([]),e=0;e<this.rows[i].length;e++)t.rows[i].push(this.rows[i][e]);return t},addColumn:function(t,e){this.header.push(t);for(var i=0;i<e.length;i++)this.rows[i].push(e[i])},removeColumn:function(t){var e=this.header.indexOf(t);if(e>-1){this.header.splice(e,1);for(var i=0;i<this.rows.length;i++)this.rows[i].splice(e,1)}}};n("Table",[rh,sh,null]);var ah={voBoolean:1,voBit:2,voUnsignedByte:3,voShort:4,voInt:5,voLong:6,voChar:7,voUnicodeChar:8,voFloat:9,voDouble:10,voFloatComplex:11,voDoubleComplex:12,voUndefined:13};function oh(){this.columns={},this.column=[],this.rows=[],this.loadFilename="",this.sampId="",this.selectedRow=null,this.error=!1,this.errorText=""}function lh(t){this.selected=!1,this.owner=t}function hh(e,i){if(this.id="",this.type=0,this.precision=0,this.dimentions=0,this.sizes=null,this.ucd="",this.unit="",this.name="",this.index=0,this.index=i,null!=e.attributes.getNamedItem("datatype")&&(this.type=hh.getType(e.attributes.getNamedItem("datatype").nodeValue)),null!=e.attributes.getNamedItem("ucd")&&(this.ucd=e.attributes.getNamedItem("ucd").nodeValue),null!=e.attributes.getNamedItem("precision"))try{this.precision=parseInt(e.attributes.getNamedItem("precision").nodeValue)}catch(t){}if(null!=e.attributes.getNamedItem("ID")&&(this.id=e.attributes.getNamedItem("ID").nodeValue),null!=e.attributes.getNamedItem("name")?this.name=e.attributes.getNamedItem("name").nodeValue:this.name=this.id,null!=e.attributes.getNamedItem("unit")&&(this.unit=e.attributes.getNamedItem("unit").nodeValue),null!=e.attributes.getNamedItem("arraysize")){var n=e.attributes.getNamedItem("arraysize").nodeValue.split("x");this.dimentions=n.length,this.sizes=new Array(n.length);for(var r=0,s=t.ss.enumerate(n);s.moveNext();){var a=s.current;if(a.indexOf("*")>-1){var o=9999,l=t.ss.replaceString(a,"*","");l.length>0&&(o=parseInt(l)),this.sizes[r++]=o}else this.sizes[r++]=parseInt(a)}}}function uh(t,e){this.size=0,this.offset=0,this.filename=t,this.size=e}function ch(){this.tempDirectory="",this._currentOffset=0,this._packageID="",this.url="",this.clearFileList()}n("Primitives",ah),r("Primitives",ah),oh.loadFromUrl=function(e,i){var n=new oh;return n._onComplete=i,n._webFile=new $a(zr.singleton.rewrite(e,1)),n._webFile.onStateChange=t.ss.bind("_loadData",n),n._webFile.send(),n},oh.loadFromString=function(t){var e=(new DOMParser).parseFromString(t,"text/xml"),i=new oh;return i.loadFromXML(e),i},n("VoTable",[oh,{_loadData:function(){2===this._webFile.get_state()?alert(this._webFile.get_message()):1===this._webFile.get_state()&&(this.loadFromXML(this._webFile.getXml()),null!=this._onComplete&&this._onComplete())},loadFromXML:function(e){var i=a.selectSingleNode(e,"VOTABLE");if(null!=i){var n=0;try{var r=a.selectSingleNode(a.selectSingleNode(i,"RESOURCE"),"TABLE");if(null!=r)for(var s=t.ss.enumerate(r.childNodes);s.moveNext();)if("FIELD"===(u=s.current).nodeName){var o=new hh(u,n++);this.columns[o.name]=o,this.column.push(o)}}catch(t){this.error=!0,this.errorText=a.selectSingleNode(i,"DESCRIPTION").text}try{var l=a.selectSingleNode(a.selectSingleNode(a.selectSingleNode(a.selectSingleNode(i,"RESOURCE"),"TABLE"),"DATA"),"TABLEDATA");if(null!=l)for(var h=t.ss.enumerate(l.childNodes);h.moveNext();){var u;if("TR"===(u=h.current).nodeName){var c=new lh(this);c.columnData=new Array(t.ss.keyCount(this.columns)),n=0;for(var _=t.ss.enumerate(u.childNodes);_.moveNext();){var d=_.current;"TD"===d.nodeName&&(c.columnData[n++]=t.ss.trim(a.getInnerText(d)))}this.rows.push(c)}}}catch(t){}}},save:function(t){return!0},getColumnByUcd:function(e){for(var i=t.ss.enumerate(t.ss.keys(this.columns));i.moveNext();){var n=i.current,r=this.columns[n];if(t.ss.replaceString(r.ucd,"_",".").toLocaleLowerCase().indexOf(e.toLocaleLowerCase())>-1)return r}return null},getRAColumn:function(){for(var e=t.ss.enumerate(t.ss.keys(this.columns));e.moveNext();){var i=e.current;if((r=this.columns[i]).ucd.toLocaleLowerCase().indexOf("pos.eq.ra")>-1||r.ucd.toLocaleLowerCase().indexOf("pos_eq_ra")>-1)return r}for(var n=t.ss.enumerate(t.ss.keys(this.columns));n.moveNext();){var r;if(i=n.current,(r=this.columns[i]).name.toLocaleLowerCase().indexOf("ra")>-1)return r}return null},getDecColumn:function(){for(var e=t.ss.enumerate(t.ss.keys(this.columns));e.moveNext();){var i=e.current;if((r=this.columns[i]).ucd.toLowerCase().indexOf("pos.eq.dec")>-1||r.ucd.toLowerCase().indexOf("pos_eq_dec")>-1)return r}for(var n=t.ss.enumerate(t.ss.keys(this.columns));n.moveNext();){var r;if(i=n.current,(r=this.columns[i]).name.toLowerCase().indexOf("dec")>-1)return r}return null},getMagColumn:function(){for(var e=t.ss.enumerate(t.ss.keys(this.columns));e.moveNext();){var i=e.current,n=this.columns[i];if(n.ucd.toLowerCase().indexOf("phot.mag")>-1||n.ucd.toLowerCase().indexOf("phot_mag")>-1)return n}return null},getDistanceColumn:function(){for(var e=t.ss.enumerate(t.ss.keys(this.columns));e.moveNext();){var i=e.current,n=this.columns[i];if(n.ucd.toLowerCase().indexOf("pos.distance")>-1||n.ucd.toLowerCase().indexOf("pos_distance")>-1)return n}return null},toString:function(){for(var e=new t.ss.StringBuilder,i=!0,n=t.ss.enumerate(t.ss.keys(this.columns));n.moveNext();){var r=n.current,s=this.columns[r];i?i=!1:e.append("\t"),e.append(s.name)}e.appendLine("");for(var a=t.ss.enumerate(this.rows);a.moveNext();){var o=a.current;i=!0;for(var l=t.ss.enumerate(o.columnData);l.moveNext();)s=l.current,i?i=!1:e.append("\t"),e.append(s.toString());e.appendLine("")}return e.toString()}},null]),n("VoRow",[lh,{getColumnData:function(t){return null!=this.owner.columns[t]?this.columnData[this.owner.columns[t].index]:null},get_item:function(t){return t<0||t>=this.columnData.length?null:this.columnData[t]}},null]),hh.getType=function(t){var e=13;switch(t){case"boolean":e=1;break;case"bit":e=2;break;case"unsignedByte":e=3;break;case"short":e=4;break;case"int":e=5;break;case"long":e=6;break;case"char":e=7;break;case"unicodeChar":e=8;break;case"float":e=9;break;case"double":e=10;break;case"floatComplex":e=11;break;case"doubleComplex":e=12;break;default:e=13}return e},n("VoColumn",[hh,{toString:function(){return this.name}},null]),n("FileEntry",[uh,{toString:function(){return this.filename}},null]),ch.fromUrl=function(e,i){var n=new ch;return n.url=e,n._callMe=i,n._webFile=new $a(e),n._webFile.responseType="blob",n._webFile.onStateChange=t.ss.bind("_loadCabinet",n),n._webFile.send(),n};var _h={get_packageID:function(){return this._packageID},set_packageID:function(t){return this._packageID=t,t},addFile:function(e,i){if(null!=i&&!t.ss.keyExists(this._fileDirectory,e)){var n=new uh(e,i.size);n.offset=this._currentOffset,n.blob=i,this.fileList.push(n),this._fileDirectory[e]=n,this._currentOffset+=n.size}},clearFileList:function(){null==this.fileList&&(this.fileList=[]),null==this._fileDirectory&&(this._fileDirectory={}),this.fileList.length=0,t.ss.clearKeys(this._fileDirectory),this._currentOffset=0},packageFiles:function(){var e=new Ks;e.formatting=1,e._writeProcessingInstruction("xml","version='1.0' encoding='UTF-8'"),e._writeStartElement("FileCabinet"),e._writeAttributeString("HeaderSize","0x0BADFOOD"),e._writeStartElement("Files");for(var i=t.ss.enumerate(this.fileList);i.moveNext();){var n=i.current;e._writeStartElement("File"),e._writeAttributeString("Name",n.filename),e._writeAttributeString("Size",n.size.toString()),e._writeAttributeString("Offset",n.offset.toString()),e._writeEndElement()}e._writeEndElement(),e._writeFullEndElement(),e._close();var r=e.body,s=new Blob([r]),a=t.ss.format("0x{0:x8}",s.size);r=t.ss.replaceString(r,"0x0BADFOOD",a),s=new Blob([r]);var o=[];o.push(s);for(var l=t.ss.enumerate(this.fileList);l.moveNext();)n=l.current,o.push(n.blob);return new Blob(o,{type:"application/x-wtt"})},_loadCabinet:function(){var e=this;if(2===this._webFile.get_state())alert(this._webFile.get_message());else if(1===this._webFile.get_state()){this._mainBlob=this._webFile.getBlob();var i=new FileReader;i.onloadend=function(n){var r=e._getSize(i.result),s=new FileReader;s.onloadend=function(i){var n=t.ss.safeCast(s.result,String),a=new DOMParser;e.extract(a.parseFromString(n,"text/xml"),r),e._callMe()},s.readAsText(e._mainBlob.slice(0,r))},i.readAsText(this._mainBlob.slice(0,255))}},_getSize:function(t){var e=t.indexOf("0x");return-1===e?0:parseInt(t.substring(e,e+10),16)},extract:function(e,i){try{var n=a.selectSingleNode(e,"FileCabinet"),r=a.selectSingleNode(n,"Files");this.fileList.length=0;for(var s=t.ss.enumerate(r.childNodes);s.moveNext();){var o=s.current;if("File"===o.nodeName){var l=new uh(o.attributes.getNamedItem("Name").nodeValue,parseInt(o.attributes.getNamedItem("Size").nodeValue));l.offset=i,i+=l.size,this.fileList.push(l)}}}catch(t){}},getFileBlob:function(t){var e=this.getFileEntry(t);if(null!=e){var i=null;switch(t.substr(t.lastIndexOf(".")).toLowerCase()){case".png":i="image/png";break;case".jpg":case".jpeg":i="image/jpeg";break;case".mp3":i="audio/mpeg3";break;case".txt":i="text/plain";break;case".fit":case".fits":i="application/octet-stream"}return this._mainBlob.slice(e.offset,e.offset+e.size,i)}return null},getFileEntry:function(e){for(var i=t.ss.enumerate(this.fileList);i.moveNext();){var n=i.current;if(n.filename===e)return n}return null},get_masterFile:function(){return this.fileList.length>0?this.fileList[0].filename:null},clearTempFiles:function(){for(var e=t.ss.enumerate(this.fileList);e.moveNext();)e.current}};n("FileCabinet",[ch,_h,null]);var dh={sky:0,screen:1};n("OverlayAnchor",dh),r("OverlayAnchor",dh);var gh={music:0,voice:1};n("AudioType",gh),r("AudioType",gh);var fh={circle:0,rectagle:1,star:2,donut:3,arrow:4,line:5,openRectagle:6};n("ShapeType",fh),r("ShapeType",fh);var mh={loop:0,upDown:1,down:2,upDownOnce:3,once:4,begin:5,end:6};function ph(){this.isDynamic=!1,this.isDesignTimeOnly=!1,this._name="",this.id=(ph.nextId++).toString(),this._owner=null,this._url="",this._linkID="",this._domeMatrix=yn.get_identity(),this._domeMatX=0,this._domeMatY=0,this._domeAngle=0,this.points=null,this._animate=!1,this._tweenFactor=0,this._endX=0,this._endY=0,this._endOpacity=0,this._endColor=new Oi,this._endWidth=0,this._endHeight=0,this._endRotationAngle=0,this._anchor=1,this._x=0,this._y=0,this._width=0,this._height=0,this._color=Xi.get_white(),this._opacity=.5,this._rotationAngle=0,this.currentRotation=0,this.texture=null,this.texture2d=null,this._interpolationType=5}n("LoopTypes",mh),r("LoopTypes",mh),ph.defaultAnchor=1,ph.clipboardFormat="WorldWideTelescope.Overlay",ph.nextId=11231,ph.RC=3.1415927/180,ph._fromXml=function(e,i){if(null==i.attributes)return null;if(null==i.attributes.getNamedItem("Type"))return null;var n=i.attributes.getNamedItem("Type").nodeValue,r=null;switch(t.ss.replaceString(n,"TerraViewer.","")){case"AudioOverlay":r=new Mh;break;case"BitmapOverlay":r=new bh;break;case"FlipBookOverlay":r=new Ah;break;case"ShapeOverlay":r=new xh;break;case"TextOverlay":r=new yh;break;default:return null}return r._owner=e,r._initOverlayFromXml(i),r};var wh={get_name:function(){return this._name},set_name:function(t){return this._name=t,t},get_owner:function(){return this._owner},set_owner:function(t){return this._owner=t,t},get_zOrder:function(){for(var e=0,i=t.ss.enumerate(this._owner.get_overlays());i.moveNext()&&i.current!==this;)e++;return e},get_url:function(){return this._url},set_url:function(t){return this._url=t,t},get_linkID:function(){return this._linkID},set_linkID:function(t){return this._linkID=t,t},play:function(){},pause:function(){},stop:function(){},seek:function(t){},makePosition:function(t,e,i,n,r){t-=960,e-=558;var s=wn.create(t+i,e+n,1347);return(this._domeMatX||this._domeMatY||this._domeAngle!==r)&&(this._domeMatX=t,this._domeMatY=e,this._domeMatrix=yn.translation(wn.create(-t,-e,0)),this._domeMatrix._multiply(yn._rotationZ(r/180*Math.PI)),this._domeMatrix._multiply(yn.translation(wn.create(t,e,0)))),wn._transformCoordinate(s,this._domeMatrix)},draw3D:function(t,e){Ki&&((null==this.texture||this.isDynamic)&&this.initializeTexture(),this.isDesignTimeOnly&&!e||(this.initializeGeometry(),this.updateRotation()))},cleanUp:function(){null!=this.texture&&(this.texture=null),this.texture2d=null},initializeTexture:function(){},prepMultimedia:function(){},cleanUpGeometry:function(){this.currentRotation=0,this.points=null},initializeGeometry:function(){null==this.points&&(this.currentRotation=0,this.points=new Array(4),this.points[0]=new dn,this.points[0].position=this.makePosition(this.get_x(),this.get_y(),-this.get_width()/2,-this.get_height()/2,this.get_rotationAngle()),this.points[0].tu=0,this.points[0].tv=0,this.points[0].color=this.get_color(),this.points[1]=new dn,this.points[1].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/2,-this.get_height()/2,this.get_rotationAngle()),this.points[1].tu=1,this.points[1].tv=0,this.points[1].color=this.get_color(),this.points[2]=new dn,this.points[2].position=this.makePosition(this.get_x(),this.get_y(),-this.get_width()/2,this.get_height()/2,this.get_rotationAngle()),this.points[2].tu=0,this.points[2].tv=1,this.points[2].color=this.get_color(),this.points[3]=new dn,this.points[3].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/2,this.get_height()/2,this.get_rotationAngle()),this.points[3].tu=1,this.points[3].tv=1,this.points[3].color=this.get_color())},updateRotation:function(){},get_animate:function(){return this._animate},set_animate:function(t){return this._animate!==t&&(this._animate=t,this._animate?(this._endX=this._x,this._endY=this._y,this._endRotationAngle=this._rotationAngle,this._endColor=this._color,this._endWidth=this._width,this._endHeight=this._height,this.cleanUpGeometry()):(this._endX=this._x=this.get_x(),this._endY=this._y=this.get_y(),this._endRotationAngle=this._rotationAngle=this.get_rotationAngle(),this._endColor=this._color=this.get_color(),this._endWidth=this._width=this.get_width(),this._endHeight=this._height=this.get_height(),this.cleanUpGeometry(),this._tweenFactor=0)),t},get_tweenFactor:function(){return this._tweenFactor},set_tweenFactor:function(t){return this._animate?this._tweenFactor!==t&&(this._tweenFactor=t,this.cleanUpGeometry()):this._tweenFactor=0,t},get_anchor:function(){return this._anchor},set_anchor:function(t){return this._anchor=t,t},get_position:function(){return vn.create(this.get_x(),this.get_y())},set_position:function(t){return this.set_x(t.x),this.set_y(t.y),t},get_x:function(){return this._x*(1-this._tweenFactor)+this._endX*this._tweenFactor},set_x:function(t){return this._tweenFactor<.5?this._x!==t&&(this._x=t,this.cleanUpGeometry()):this._endX!==t&&(this._endX=t,this.cleanUpGeometry()),t},get_y:function(){return this._y*(1-this._tweenFactor)+this._endY*this._tweenFactor},set_y:function(t){return this._tweenFactor<.5?this._y!==t&&(this._y=t,this.cleanUpGeometry()):this._endY!==t&&(this._endY=t,this.cleanUpGeometry()),t},get_width:function(){return this._width*(1-this._tweenFactor)+this._endWidth*this._tweenFactor},set_width:function(t){return t<5&&t&&(t=5),this._tweenFactor<.5?this._width!==t&&(this._width=t,this.cleanUpGeometry()):this._endWidth!==t&&(this._endWidth=t,this.cleanUpGeometry()),t},get_height:function(){return this._height*(1-this._tweenFactor)+this._endHeight*this._tweenFactor},set_height:function(t){return t<5&&t&&(t=5),this._tweenFactor<.5?this._height!==t&&(this._height=t,this.cleanUpGeometry()):this._endHeight!==t&&(this._endHeight=t,this.cleanUpGeometry()),t},get_color:function(){var e=t.ss.truncate(this._color.r*(1-this._tweenFactor)+this._endColor.r*this._tweenFactor),i=t.ss.truncate(this._color.g*(1-this._tweenFactor)+this._endColor.g*this._tweenFactor),n=t.ss.truncate(this._color.b*(1-this._tweenFactor)+this._endColor.b*this._tweenFactor),r=t.ss.truncate(this._color.a*(1-this._tweenFactor)+this._endColor.a*this._tweenFactor);return Oi.fromArgb(Math.max(0,Math.min(255,r)),Math.max(0,Math.min(255,e)),Math.max(0,Math.min(255,i)),Math.max(0,Math.min(255,n)))},set_color:function(t){return this._tweenFactor<.5?this._color!==t&&(this._color=t,this.cleanUpGeometry()):this._endColor!==t&&(this._endColor=t,this.cleanUpGeometry()),t},get_opacity:function(){return this.get_color().a/255},set_opacity:function(e){var i=this.get_color();return this.set_color(Oi.fromArgb(Math.min(255,t.ss.truncate(255*e)),i.r,i.g,i.b)),this._opacity=e,e},get_rotationAngle:function(){return this._rotationAngle*(1-this._tweenFactor)+this._endRotationAngle*this._tweenFactor},set_rotationAngle:function(t){return this._tweenFactor<.5?this._rotationAngle!==t&&(this._rotationAngle=t,this.cleanUpGeometry()):this._endRotationAngle!==t&&(this._endRotationAngle=t,this.cleanUpGeometry()),t},hitTest:function(t){var e=new Array(1);return e[0]=vn.create(t.x,t.y),xn.rotateAt(-this.get_rotationAngle()/180*Math.PI,vn.create(this.get_x(),this.get_y()))._transformPoints(e),Ai.create(this.get_x()-this.get_width()/2,this.get_y()-this.get_height()/2,this.get_width(),this.get_height()).contains(e[0])},get_bounds:function(){return this._bounds},set_bounds:function(t){return this._bounds=t,t},get_interpolationType:function(){return this._interpolationType},set_interpolationType:function(t){return this._interpolationType=t,t},saveToXml:function(t,e){t._writeStartElement("Overlay"),t._writeAttributeString("Id",this.id),t._writeAttributeString("Type",this.getTypeName()),t._writeAttributeString("Name",this.get_name()),t._writeAttributeString("X",this._x.toString()),t._writeAttributeString("Y",this._y.toString()),t._writeAttributeString("Width",this._width.toString()),t._writeAttributeString("Height",this._height.toString()),t._writeAttributeString("Rotation",this._rotationAngle.toString()),t._writeAttributeString("Color",this._color.save()),t._writeAttributeString("Url",this._url),t._writeAttributeString("LinkID",this._linkID),t._writeAttributeString("Animate",this._animate.toString()),this._animate&&(t._writeAttributeString("EndX",this._endX.toString()),t._writeAttributeString("EndY",this._endY.toString()),t._writeAttributeString("EndWidth",this._endWidth.toString()),t._writeAttributeString("EndHeight",this._endHeight.toString()),t._writeAttributeString("EndRotation",this._endRotationAngle.toString()),t._writeAttributeString("EndColor",this._endColor.save()),t._writeAttributeString("InterpolationType",s.toXml("InterpolationType",this._interpolationType))),t._writeAttributeString("Anchor",s.toXml("OverlayAnchor",this._anchor)),this.writeOverlayProperties(t),t._writeEndElement()},getTypeName:function(){return"TerraViewer.Overlay"},addFilesToCabinet:function(t){},writeOverlayProperties:function(t){},_initOverlayFromXml:function(e){this.id=e.attributes.getNamedItem("Id").nodeValue,this.set_name(e.attributes.getNamedItem("Name").nodeValue),this._x=parseFloat(e.attributes.getNamedItem("X").nodeValue),this._y=parseFloat(e.attributes.getNamedItem("Y").nodeValue),this._width=parseFloat(e.attributes.getNamedItem("Width").nodeValue),this._height=parseFloat(e.attributes.getNamedItem("Height").nodeValue),this._rotationAngle=parseFloat(e.attributes.getNamedItem("Rotation").nodeValue),this._color=Oi.load(e.attributes.getNamedItem("Color").nodeValue),null!=e.attributes.getNamedItem("Url")&&this.set_url(e.attributes.getNamedItem("Url").nodeValue),null!=e.attributes.getNamedItem("LinkID")&&this.set_linkID(e.attributes.getNamedItem("LinkID").nodeValue),null!=e.attributes.getNamedItem("Animate")&&(this._animate=t.ss.boolean(e.attributes.getNamedItem("Animate").nodeValue),this._animate&&(this._endX=parseFloat(e.attributes.getNamedItem("EndX").nodeValue),this._endY=parseFloat(e.attributes.getNamedItem("EndY").nodeValue),this._endColor=Oi.load(e.attributes.getNamedItem("EndColor").nodeValue),this._endWidth=parseFloat(e.attributes.getNamedItem("EndWidth").nodeValue),this._endHeight=parseFloat(e.attributes.getNamedItem("EndHeight").nodeValue),this._endRotationAngle=parseFloat(e.attributes.getNamedItem("EndRotation").nodeValue),null!=e.attributes.getNamedItem("InterpolationType")&&this.set_interpolationType(s.parse("InterpolationType",e.attributes.getNamedItem("InterpolationType").nodeValue)))),this.initializeFromXml(e)},initializeFromXml:function(t){},toString:function(){return this.get_name()}};function bh(){this._textureReady$1=!1,this._sprite$1=new qo,ph.call(this)}n("Overlay",[ph,wh,null]),bh.create=function(t,e){var i=new bh;return i.set_owner(t),i._filename$1=e.name,i.set_name(t.getNextDefaultName("Image")),i.set_x(0),i.set_y(0),t.get_owner().addCachedFile(e.name,e),i};var vh={getTypeName:function(){return"TerraViewer.BitmapOverlay"},copy:function(t){var e=new bh;return e.set_owner(t),e._filename$1=this._filename$1,e.set_x(this.get_x()),e.set_y(this.get_y()),e.set_width(this.get_width()),e.set_height(this.get_height()),e.set_color(this.get_color()),e.set_opacity(this.get_opacity()),e.set_rotationAngle(this.get_rotationAngle()),e.set_name(this.get_name()+" - Copy"),e},cleanUp:function(){this.texture=null,null!=this.texture2d&&(this.texture2d.cleanUp(),this.texture2d=null)},initializeTexture:function(){var t=this;try{Ki?(this.texture2d=this.get_owner().get_owner().getCachedTexture2d(this._filename$1),this._textureReady$1=!0):this.texture=this.get_owner().get_owner().getCachedTexture(this._filename$1,(function(){t._textureReady$1=!0}))}catch(t){}},draw3D:function(t,e){if(Ki)null==this.texture2d&&this.initializeTexture(),this.get_width()||this.get_height()||(this.set_width(this.texture2d.imageElement.width),this.set_height(this.texture2d.imageElement.height)),this.initializeGeometry(),this.updateRotation(),this._sprite$1.draw(t,this.points,this.points.length,this.texture2d,!0,1);else{if(null==this.texture&&this.initializeTexture(),!this._textureReady$1)return;this.get_width()||this.get_height()||(this.set_width(this.texture.width),this.set_height(this.texture.height));var i=t.device;i.save(),i.translate(this.get_x(),this.get_y()),i.rotate(this.get_rotationAngle()*ph.RC),i.globalAlpha=this.get_opacity(),i.drawImage(this.texture,-this.get_width()/2,-this.get_height()/2,this.get_width(),this.get_height()),i.restore()}},addFilesToCabinet:function(t){t.addFile(this.get_owner().get_owner().get_workingDirectory()+this._filename$1,this.get_owner().get_owner().getFileBlob(this._filename$1))},writeOverlayProperties:function(t){t._writeStartElement("Bitmap"),t._writeAttributeString("Filename",this._filename$1),t._writeEndElement()},initializeFromXml:function(t){var e=a.selectSingleNode(t,"Bitmap");this._filename$1=e.attributes.getNamedItem("Filename").nodeValue}};function yh(){this._sprite$1=new qo,this._ctx$1=null,this._ce$1=null,ph.call(this)}n("BitmapOverlay",[bh,vh,ph]),yh.create=function(t){var e=new yh;return e.textObject=t,e._calculateTextSize$1(),e};var Sh={getTypeName:function(){return"TerraViewer.TextOverlay"},get_color:function(){return ph.prototype.get_color.call(this)},set_color:function(t){return this.textObject.foregroundColor!==t&&(this.textObject.foregroundColor=t,ph.prototype.set_color.call(this,t),this.cleanUp()),t},draw3D:function(t,e){if(Ki)this.initializeTexture(),this.initializeGeometry(),this.updateRotation(),this._sprite$1.draw(t,this.points,this.points.length,this.texture2d,!0,1);else{var i=t.device;i.save(),i.translate(this.get_x(),this.get_y()),i.rotate(this.get_rotationAngle()*ph.RC),i.globalAlpha=this.get_opacity(),this._drawCanvasText$1(i),i.restore()}},_drawCanvasText$1:function(e){e.fillStyle=this.textObject.foregroundColor.toString(),e.font=(this.textObject.italic?"italic":"normal")+" "+(this.textObject.bold?"bold":"normal")+" "+Math.round(1.2*this.textObject.fontSize).toString()+"px "+this.textObject.fontName,e.textBaseline="top";var i=this.textObject.text;if(i.indexOf("{$")>-1){if(i.indexOf("{$DATE}")>-1){var n=t.ss.format("{0:yyyy/MM/dd}",Wo.get_now());i=t.ss.replaceString(i,"{$DATE}",n)}if(i.indexOf("{$TIME}")>-1){var r=t.ss.format("{0:HH:mm:ss}",Wo.get_now());i=t.ss.replaceString(i,"{$TIME}",r)}i=t.ss.replaceString(i,"{$DIST}",Fa.formatDistance(an.get_solarSystemCameraDistance())),i=t.ss.replaceString(i,"{$LAT}",Qs.formatDMS(an.viewCamera.lat)),i=t.ss.replaceString(i,"{$LNG}",Qs.formatDMS(an.viewCamera.lat)),i=t.ss.replaceString(i,"{$RA}",Qs.formatDMS(an.viewCamera.get_RA())),i=t.ss.replaceString(i,"{$DEC}",Qs.formatDMS(an.viewCamera.get_dec())),i=t.ss.replaceString(i,"{$FOV}",Qs.formatDMS(an.get_fovAngle()))}for(var s=i.split("\n"),o=-this.get_height()/2,l=1.7*this.textObject.fontSize,h=t.ss.enumerate(s);h.moveNext();)for(var u=h.current,c=a.getWrappedText(e,u,this.get_width()),_=t.ss.enumerate(c);_.moveNext();){var d=_.current;e.fillText(d,-this.get_width()/2,o),o+=l}},_calculateTextSize$1:function(){null!=this._ctx$1&&null!=this._ce$1||(this._ce$1=document.createElement("canvas"),this._ce$1.height=100,this._ce$1.width=100,this._ctx$1=this._ce$1.getContext("2d")),this._ctx$1.fillStyle=this.textObject.foregroundColor.toString(),this._ctx$1.font=(this.textObject.italic?"italic":"normal")+" "+(this.textObject.bold?"bold":"normal")+" "+Math.round(1.2*this.textObject.fontSize).toString()+"px "+this.textObject.fontName,this._ctx$1.textBaseline="top";var e=this.textObject.text;if(e.indexOf("{$")>-1){if(e.indexOf("{$DATE}")>-1){var i=t.ss.format("{0:yyyy/MM/dd}",Wo.get_now());e=t.ss.replaceString(e,"{$DATE}",i)}if(e.indexOf("{$TIME}")>-1){var n=t.ss.format("{0:HH:mm:ss}",Wo.get_now());e=t.ss.replaceString(e,"{$TIME}",n)}e=t.ss.replaceString(e,"{$DIST}",Fa.formatDistance(an.get_solarSystemCameraDistance())),e=t.ss.replaceString(e,"{$LAT}",Qs.formatDMS(an.viewCamera.lat)),e=t.ss.replaceString(e,"{$LNG}",Qs.formatDMS(an.viewCamera.lat)),e=t.ss.replaceString(e,"{$RA}",Qs.formatDMS(an.viewCamera.get_RA())),e=t.ss.replaceString(e,"{$DEC}",Qs.formatDMS(an.viewCamera.get_dec())),e=t.ss.replaceString(e,"{$FOV}",Qs.formatDMS(an.get_fovAngle()))}for(var r=e.split("\n"),s=0,a=1.7*this.textObject.fontSize,o=0,l=t.ss.enumerate(r);l.moveNext();){var h=l.current,u=this._ctx$1.measureText(h).width;o=Math.max(u,o),s+=a}this.set_width(1.01*o),this.set_height(s),this._ce$1=null,this._ctx$1=null},initializeTexture:function(){(null==this.texture2d||this.textObject.text.indexOf("{$")>-1)&&(this.get_height()&&this.get_width()||this._calculateTextSize$1(),null!=this._ctx$1&&null!=this._ce$1||(this._ce$1=document.createElement("canvas"),this._ce$1.height=t.ss.truncate(this.get_height()),this._ce$1.width=t.ss.truncate(this.get_width()),this._ctx$1=this._ce$1.getContext("2d")),this._ctx$1.translate(this.get_width()/2,this.get_height()/2),this._ctx$1.clearRect(0,0,this.get_width(),this.get_height()),this._drawCanvasText$1(this._ctx$1),this.texture2d=new rs,this.texture2d.imageElement=this._ce$1,this.texture2d.makeTexture(),this._ce$1=null,this._ctx$1=null)},writeOverlayProperties:function(t){t._writeStartElement("Text"),this.textObject._saveToXml(t),t._writeEndElement()},initializeFromXml:function(t){var e=a.selectSingleNode(t,"Text");this.textObject=Eo._fromXml(a.selectSingleNode(e,"TextObject"))},initializeGeometry:function(){Ki&&ph.prototype.initializeGeometry.call(this)}};function xh(){this._shapeType$1=1,this._sprite$1=new qo,this._triangleStrip$1=!0,ph.call(this)}n("TextOverlay",[yh,Sh,ph]),xh._create=function(t,e){var i=new xh;return i._shapeType$1=e,i.set_owner(t),i};var Th={getTypeName:function(){return"TerraViewer.ShapeOverlay"},get_shapeType:function(){return this._shapeType$1},set_shapeType:function(t){return this._shapeType$1=t,this.cleanUpGeometry(),t},draw3D:function(t,e){if(Ki)this.initializeGeometry(),this._sprite$1.draw(t,this.points,this.points.length,null,this._triangleStrip$1,this.get_opacity());else switch(this._shapeType$1){case 0:this._drawCircleGeometry$1(t);break;case 1:this._drawRectGeometry$1(t);break;case 6:this._drawOpenRectGeometry$1(t);break;case 2:this._drawStarGeometry$1(t);break;case 3:this._drawDonutGeometry$1(t);break;case 4:this._drawArrowGeometry$1(t);break;case 5:this._drawLineGeometry$1(t)}},initializeGeometry:function(){if(null==this.points)switch(this._shapeType$1){case 0:this._createCircleGeometry$1();break;case 1:ph.prototype.initializeGeometry.call(this);break;case 6:this._createOpenRectGeometry$1();break;case 2:this._createStarGeometry$1();break;case 3:this._createDonutGeometry$1();break;case 4:this._createArrowGeometry$1();break;case 5:this._createLineGeometry$1()}},_createLineGeometry$1:function(){this.get_x(),this.get_y(),this.get_width();var e=this.get_width(),i=t.ss.truncate(e/12)+1;Math.PI,null==this.points&&(this.points=new Array(2*i+2));for(var n=0;n<=i;n++){var r=2*n;this.points[r]=new dn,this.points[r].position=this.makePosition(this.get_x(),this.get_y(),n/i*this.get_width()-this.get_width()/2,6,this.get_rotationAngle()),this.points[r].tu=n%2,this.points[r].tv=0,this.points[r].color=this.get_color(),this.points[r+1]=new dn,this.points[r+1].position=this.makePosition(this.get_x(),this.get_y(),n/i*this.get_width()-this.get_width()/2,-6,this.get_rotationAngle()),this.points[r+1].tu=n%2,this.points[r+1].tv=1,this.points[r+1].color=this.get_color()}},_createOpenRectGeometry$1:function(){var e=this.get_x(),i=this.get_y(),n=(this.get_width(),this.get_width()),r=t.ss.truncate(n/12)+1,s=t.ss.truncate(this.get_height()/12)+1,a=2*(2*(r+1)+2*(s+1));null==this.points&&(this.points=new Array(a));for(var o=0;o<=r;o++){var l=2*o;this.points[l]=new dn,this.points[l].position=this.makePosition(e,i,o/r*this.get_width()-this.get_width()/2,this.get_height()/2,this.get_rotationAngle()),this.points[l].tu=o%2,this.points[l].tv=0,this.points[l].color=this.get_color(),this.points[l+1]=new dn,this.points[l+1].position=this.makePosition(e,i,o/r*this.get_width()-this.get_width()/2,this.get_height()/2-12,this.get_rotationAngle()),this.points[l+1].tu=o%2,this.points[l+1].tv=1,this.points[l+1].color=this.get_color();var h=4*(r+1)+2*(s+1)-2-l;this.points[h]=new dn,this.points[h].position=this.makePosition(e,i,o/r*this.get_width()-this.get_width()/2,-this.get_height()/2+12,this.get_rotationAngle()),this.points[h].tu=o%2,this.points[h].tv=0,this.points[h].color=this.get_color(),this.points[h+1]=new dn,this.points[h+1].position=this.makePosition(e,i,o/r*this.get_width()-this.get_width()/2,-this.get_height()/2,this.get_rotationAngle()),this.points[h+1].tu=o%2,this.points[h+1].tv=1,this.points[h+1].color=this.get_color()}var u=2*(r+1);for(o=0;o<=s;o++){var c=2*(s+1)+u-2;l=2*o,this.points[c-l]=new dn,this.points[c-l].position=this.makePosition(e,i,this.get_width()/2,o/s*this.get_height()-this.get_height()/2,this.get_rotationAngle()),this.points[c-l].tu=o%2,this.points[c-l].tv=0,this.points[c-l].color=this.get_color(),this.points[c-l+1]=new dn,this.points[c-l+1].position=this.makePosition(e,i,this.get_width()/2-12,o/s*this.get_height()-this.get_height()/2,this.get_rotationAngle()),this.points[c-l+1].tu=o%2,this.points[c-l+1].tv=1,this.points[c-l+1].color=this.get_color(),h=l+4*(r+1)+2*(s+1),this.points[h]=new dn,this.points[h].position=this.makePosition(e,i,-this.get_width()/2+12,o/s*this.get_height()-this.get_height()/2,this.get_rotationAngle()),this.points[h].tu=o%2,this.points[h].tv=0,this.points[h].color=this.get_color(),this.points[h+1]=new dn,this.points[h+1].position=this.makePosition(e,i,-this.get_width()/2,o/s*this.get_height()-this.get_height()/2,this.get_rotationAngle()),this.points[h+1].tu=o%2,this.points[h+1].tv=1,this.points[h+1].color=this.get_color()}},_createStarGeometry$1:function(){var t=this.get_x(),e=this.get_y(),i=(this.get_width(),2*Math.PI/5);null==this.points&&(this.points=new Array(12)),null==this._pnts$1&&(this._pnts$1=new Array(10));for(var n=0;n<5;n++){var r=n*i-Math.PI/2;this._pnts$1[n]=new dn,this._pnts$1[n].position=this.makePosition(t,e,Math.cos(r)*(this.get_width()/2),Math.sin(r)*(this.get_height()/2),this.get_rotationAngle()),this._pnts$1[n].tu=0,this._pnts$1[n].tv=0,this._pnts$1[n].color=this.get_color()}for(n=5;n<10;n++)r=n*i+i/2-Math.PI/2,this._pnts$1[n]=new dn,this._pnts$1[n].position=this.makePosition(t,e,Math.cos(r)*(this.get_width()/5.3),Math.sin(r)*(this.get_height()/5.3),this.get_rotationAngle()),this._pnts$1[n].tu=0,this._pnts$1[n].tv=0,this._pnts$1[n].color=this.get_color();this.points[0]=this._pnts$1[0],this.points[1]=this._pnts$1[5],this.points[2]=this._pnts$1[9],this.points[3]=this._pnts$1[1],this.points[4]=this._pnts$1[7],this.points[5]=this._pnts$1[4],this.points[6]=this._pnts$1[6],this.points[7]=this._pnts$1[2],this.points[8]=this._pnts$1[7],this.points[9]=this._pnts$1[7],this.points[10]=this._pnts$1[3],this.points[11]=this._pnts$1[8],this._triangleStrip$1=!1},_createArrowGeometry$1:function(){null==this.points&&(this.points=new Array(9)),this.points[0]=new dn,this.points[0].position=this.makePosition(this.get_x(),this.get_y(),-this.get_width()/2,-this.get_height()/4,this.get_rotationAngle()),this.points[0].tu=0,this.points[0].tv=0,this.points[0].color=this.get_color(),this.points[1]=new dn,this.points[1].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/4,-this.get_height()/4,this.get_rotationAngle()),this.points[1].tu=1,this.points[1].tv=0,this.points[1].color=this.get_color(),this.points[2]=new dn,this.points[2].position=this.makePosition(this.get_x(),this.get_y(),-this.get_width()/2,this.get_height()/4,this.get_rotationAngle()),this.points[2].tu=0,this.points[2].tv=1,this.points[2].color=this.get_color(),this.points[3]=new dn,this.points[3].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/4,-this.get_height()/4,this.get_rotationAngle()),this.points[3].tu=1,this.points[3].tv=0,this.points[3].color=this.get_color(),this.points[4]=new dn,this.points[4].position=this.makePosition(this.get_x(),this.get_y(),-this.get_width()/2,this.get_height()/4,this.get_rotationAngle()),this.points[4].tu=0,this.points[4].tv=1,this.points[4].color=this.get_color(),this.points[5]=new dn,this.points[5].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/4,this.get_height()/4,this.get_rotationAngle()),this.points[5].tu=1,this.points[5].tv=1,this.points[5].color=this.get_color(),this.points[6]=new dn,this.points[6].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/4,-this.get_height()/2,this.get_rotationAngle()),this.points[6].tu=1,this.points[6].tv=1,this.points[6].color=this.get_color(),this.points[7]=new dn,this.points[7].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/2,0,this.get_rotationAngle()),this.points[7].tu=1,this.points[7].tv=.5,this.points[7].color=this.get_color(),this.points[8]=new dn,this.points[8].position=this.makePosition(this.get_x(),this.get_y(),this.get_width()/4,this.get_height()/2,this.get_rotationAngle()),this.points[8].tu=1,this.points[8].tv=1,this.points[8].color=this.get_color(),this._triangleStrip$1=!1},_createDonutGeometry$1:function(){var e=this.get_x(),i=this.get_y(),n=this.get_width()/2,r=2*Math.PI*n,s=t.ss.truncate(r/12)+1,a=2*Math.PI/s;null==this.points&&(this.points=new Array(2*s+2));for(var o=0;o<=s;o++){var l=2*o;this.points[l]=new dn,this.points[l].position=this.makePosition(e,i,Math.cos(o*a)*(this.get_width()/2),Math.sin(o*a)*(this.get_height()/2),this.get_rotationAngle()),this.points[l].tu=o%2,this.points[l].tv=0,this.points[l].color=this.get_color(),this.points[l+1]=new dn,this.points[l+1].position=this.makePosition(e,i,Math.cos(o*a)*(this.get_width()/2-10),Math.sin(o*a)*(this.get_height()/2-10),this.get_rotationAngle()),this.points[l+1].tu=o%2,this.points[l+1].tv=1,this.points[l+1].color=this.get_color()}},_createCircleGeometry$1:function(){var e=this.get_x(),i=this.get_y(),n=this.get_width()/2,r=2*Math.PI*n,s=t.ss.truncate(r/12)+1,a=2*Math.PI/s;null==this.points&&(this.points=new Array(2*s+2));for(var o=0;o<=s;o++){var l=2*o;this.points[l]=new dn,this.points[l].position=this.makePosition(e,i,Math.cos(o*a)*(this.get_width()/2),Math.sin(o*a)*(this.get_height()/2),this.get_rotationAngle()),this.points[l].tu=o%2,this.points[l].tv=0,this.points[l].color=this.get_color(),this.points[l+1]=new dn,this.points[l+1].position=this.makePosition(e,i,0,0,this.get_rotationAngle()),this.points[l+1].tu=o%2,this.points[l+1].tv=1,this.points[l+1].color=this.get_color()}},initializeTexture:function(){switch(this.get_shapeType()){case 5:case 3:case 6:break;default:this.texture=null}},_drawLineGeometry$1:function(t){var e=t.device;e.save();var i=this.get_width()/2;e.translate(this.get_x(),this.get_y()),e.rotate(this.get_rotationAngle()*ph.RC),e.moveTo(-i,0),e.lineTo(i,0),e.lineWidth=9,e.strokeStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.stroke(),e.restore()},_drawOpenRectGeometry$1:function(t){var e=t.device;e.save(),e.translate(this.get_x(),this.get_y()),e.rotate(this.get_rotationAngle()*ph.RC),e.beginPath(),e.moveTo(-this.get_width()/2,-this.get_height()/2),e.lineTo(this.get_width()/2,-this.get_height()/2),e.lineTo(this.get_width()/2,this.get_height()/2),e.lineTo(-this.get_width()/2,this.get_height()/2),e.closePath(),e.lineWidth=9,e.strokeStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.stroke(),e.restore()},_drawRectGeometry$1:function(t){var e=t.device;e.save(),e.translate(this.get_x(),this.get_y()),e.rotate(this.get_rotationAngle()*ph.RC),e.beginPath(),e.moveTo(-this.get_width()/2,-this.get_height()/2),e.lineTo(this.get_width()/2,-this.get_height()/2),e.lineTo(this.get_width()/2,this.get_height()/2),e.lineTo(-this.get_width()/2,this.get_height()/2),e.closePath(),e.lineWidth=0,e.fillStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.fill(),e.restore()},_drawStarGeometry$1:function(t){var e=t.device;e.save(),e.translate(this.get_x(),this.get_y()),e.rotate(this.get_rotationAngle()*ph.RC),e.beginPath(),this.get_width();for(var i=2*Math.PI/5,n=!0,r=0;r<5;r++){var s=r*i-Math.PI/2;n?(n=!1,e.moveTo(0+Math.cos(s)*(this.get_width()/2),0+Math.sin(s)*(this.get_height()/2))):e.lineTo(0+Math.cos(s)*(this.get_width()/2),0+Math.sin(s)*(this.get_height()/2));var a=r*i+i/2-Math.PI/2;e.lineTo(0+Math.cos(a)*(this.get_width()/5.3),0+Math.sin(a)*(this.get_height()/5.3))}e.closePath(),e.lineWidth=0,e.fillStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.fill(),e.restore()},_drawArrowGeometry$1:function(t){var e=t.device;e.save(),e.translate(this.get_x(),this.get_y()),e.rotate(this.get_rotationAngle()*ph.RC),e.beginPath(),e.moveTo(-this.get_width()/2,-this.get_height()/4),e.lineTo(this.get_width()/4,-this.get_height()/4),e.lineTo(this.get_width()/4,-this.get_height()/2),e.lineTo(this.get_width()/2,0),e.lineTo(this.get_width()/4,this.get_height()/2),e.lineTo(this.get_width()/4,this.get_height()/4),e.lineTo(-this.get_width()/2,this.get_height()/4),e.closePath(),e.lineWidth=0,e.fillStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.fill(),e.restore()},_drawDonutGeometry$1:function(t){var e=t.device;e.save(),e.translate(this.get_x(),this.get_y()),e.scale(1,this.get_height()/this.get_width()),e.rotate(this.get_rotationAngle()*ph.RC),e.beginPath(),e.arc(0,0,this.get_width()/2,0,2*Math.PI,!1),e.closePath(),e.lineWidth=9,e.strokeStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.stroke(),e.restore()},_drawCircleGeometry$1:function(t){var e=t.device;e.save(),e.scale(1,this.get_width()/this.get_height()),e.translate(this.get_x(),this.get_y()),e.rotate(this.get_rotationAngle()*ph.RC),e.beginPath(),e.arc(0,0,this.get_width(),0,2*Math.PI,!1),e.closePath(),e.lineWidth=0,e.fillStyle=this.get_color().toString(),e.globalAlpha=this.get_opacity(),e.fill(),e.restore()},cleanUpGeometry:function(){ph.prototype.cleanUpGeometry.call(this),this.cleanUp()},writeOverlayProperties:function(t){t._writeStartElement("Shape"),t._writeAttributeString("ShapeType",s.toXml("ShapeType",this._shapeType$1)),t._writeEndElement()},initializeFromXml:function(t){var e=a.selectSingleNode(t,"Shape");this._shapeType$1=s.parse("ShapeType",e.attributes.getNamedItem("ShapeType").nodeValue)}};function Mh(){this._audio$1=null,this._audioReady$1=!1,this._wantPlaying$1=!1,this._volume$1=100,this._mute$1=!1,this._position$1=0,this._trackType$1=0,ph.call(this),this.isDesignTimeOnly=!0}n("ShapeOverlay",[xh,Th,ph]),Mh.create=function(t,e){var i=new Mh;return i.set_owner(t),i._filename$1=e.name,i.get_owner().get_owner().addCachedFile(e.name,e),i};var Ch={getTypeName:function(){return"TerraViewer.AudioOverlay"},get_mute:function(){return this._mute$1},set_mute:function(t){return this._mute$1=t,this.set_volume(this.get_volume()),t},get_volume:function(){return this._volume$1},set_volume:function(t){return this._volume$1=t,null!=this._audio$1&&(this._audio$1.volume=this._mute$1?0:this._volume$1/100),t},addFilesToCabinet:function(t){t.addFile(this.get_owner().get_owner().get_workingDirectory()+this._filename$1,this.get_owner().get_owner().getFileBlob(this._filename$1))},play:function(){null==this._audio$1&&this.prepMultimedia(),this._wantPlaying$1=!0,null!=this._audio$1&&this._audioReady$1&&(this._audio$1.play(),this.set_volume(this.get_volume()),this._audio$1.currentTime=this._position$1)},pause:function(){null==this._audio$1&&this.prepMultimedia(),this._wantPlaying$1=!1,null!=this._audio$1&&this._audioReady$1&&this._audio$1.pause()},stop:function(){this.pause()},seek:function(t){this._position$1=t,null==this._audio$1&&this.prepMultimedia(),this._audioReady$1&&(this._audio$1.duration<t?this._audio$1.pause():this._audio$1.currentTime=this._position$1)},prepMultimedia:function(){var t=this;if(null==this._audio$1){this._audio$1=document.createElement("audio"),this._audio$1.addEventListener("canplaythrough",(function(){t._audioReady$1||(t._audioReady$1=!0,t._wantPlaying$1&&t.play())}),!1);var e=document.createElement("source");this._audio$1.appendChild(e),e.src=this.get_owner().get_owner().getFileStream(this._filename$1),e.type="audio/mp3",this._audio$1.load()}},initializeTexture:function(){this.prepMultimedia()},cleanUp:function(){ph.prototype.cleanUp.call(this),this._wantPlaying$1=!1,null!=this._audio$1&&(this._audio$1.pause(),this._audio$1.src=null,this._audio$1=null)},get_trackType:function(){return this._trackType$1},set_trackType:function(t){return this._trackType$1=t,t},writeOverlayProperties:function(t){t._writeStartElement("Audio"),t._writeAttributeString("Filename",this._filename$1),t._writeAttributeString("Volume",this._volume$1.toString()),t._writeAttributeString("Mute",this._mute$1.toString()),t._writeAttributeString("TrackType",s.toXml("AudioType",this._trackType$1)),t._writeEndElement()},initializeFromXml:function(e){var i=a.selectSingleNode(e,"Audio");this._filename$1=i.attributes.getNamedItem("Filename").nodeValue,null!=i.attributes.getNamedItem("Volume")&&(this._volume$1=parseInt(i.attributes.getNamedItem("Volume").nodeValue)),null!=i.attributes.getNamedItem("Mute")&&(this._mute$1=t.ss.boolean(i.attributes.getNamedItem("Mute").nodeValue)),null!=i.attributes.getNamedItem("TrackType")&&(this._trackType$1=s.parse("AudioType",i.attributes.getNamedItem("TrackType").nodeValue))}};function Ah(){this._loopType$1=1,this._startFrame$1=0,this._framesList$1=[],this._frames$1=1,this._framesX$1=8,this._framesY$1=8,this._textureReady$1=!1,this._currentFrame$1=0,this._cellHeight$1=256,this._cellWidth$1=256,this._timeStart$1=t.ss.now(),this._playing$1=!0,ph.call(this)}n("AudioOverlay",[Mh,Ch,ph]);var Lh={getTypeName:function(){return"TerraViewer.FlipbookOverlay"},get_loopType:function(){return this._loopType$1},set_loopType:function(t){return this._loopType$1=t,t},get_startFrame:function(){return this._startFrame$1},set_startFrame:function(t){return this._startFrame$1=t,t},get_frameSequence:function(){return this._frameSequence$1},set_frameSequence:function(e){if(this._frameSequence$1!==e&&(this._frameSequence$1=e,this._framesList$1=[],!t.ss.emptyString(this._frameSequence$1)))try{for(var i=this._frameSequence$1.split(","),n=t.ss.enumerate(i);n.moveNext();){var r=n.current,s=parseInt(t.ss.trim(r));this._framesList$1.push(s)}}catch(t){}return e},get_frames:function(){return this._frames$1},set_frames:function(t){return this._frames$1=t,t},get_framesX:function(){return this._framesX$1},set_framesX:function(t){return this._framesX$1=t,t},get_framesY:function(){return this._framesY$1},set_framesY:function(t){return this._framesY$1=t,t},copy:function(t){var e=new Ah;return e.set_owner(t),e._filename$1=this._filename$1,e.set_x(this.get_x()),e.set_y(this.get_y()),e.set_width(this.get_width()),e.set_height(this.get_height()),e.set_color(this.get_color()),e.set_opacity(this.get_opacity()),e.set_rotationAngle(this.get_rotationAngle()),e.set_name(this.get_name()+" - Copy"),e.set_startFrame(this.get_startFrame()),e.set_frames(this.get_frames()),e.set_loopType(this.get_loopType()),e.set_frameSequence(this.get_frameSequence()),e.set_framesX(this.get_framesX()),e.set_framesY(this.get_framesY()),e},cleanUp:function(){this.texture=null},initializeTexture:function(){var e=this;try{t.ss.endsWith(this._filename$1.toLowerCase(),".jpg"),this.texture=this.get_owner().get_owner().getCachedTexture(this._filename$1,(function(){e._textureReady$1=!0}))}catch(t){}},addFilesToCabinet:function(t){t.addFile(this.get_owner().get_owner().get_workingDirectory()+this._filename$1,this.get_owner().get_owner().getFileBlob(this._filename$1))},writeOverlayProperties:function(e){e._writeStartElement("Flipbook"),e._writeAttributeString("Filename",this._filename$1),e._writeAttributeString("Frames",this._frames$1.toString()),e._writeAttributeString("Loop",s.toXml("LoopTypes",this._loopType$1)),e._writeAttributeString("FramesX",this._framesX$1.toString()),e._writeAttributeString("FramesY",this._framesY$1.toString()),e._writeAttributeString("StartFrame",this._startFrame$1.toString()),t.ss.emptyString(this._frameSequence$1)||e._writeAttributeString("FrameSequence",this._frameSequence$1),e._writeEndElement()},initializeFromXml:function(t){var e=a.selectSingleNode(t,"Flipbook");this._filename$1=e.attributes.getNamedItem("Filename").nodeValue,this._frames$1=parseInt(e.attributes.getNamedItem("Frames").nodeValue),this._loopType$1=s.parse("LoopTypes",e.attributes.getNamedItem("Loop").nodeValue),null!=e.attributes.getNamedItem("FramesX")&&this.set_framesX(parseInt(e.attributes.getNamedItem("FramesX").nodeValue)),null!=e.attributes.getNamedItem("FramesY")&&this.set_framesY(parseInt(e.attributes.getNamedItem("FramesY").nodeValue)),null!=e.attributes.getNamedItem("StartFrame")&&this.set_startFrame(parseInt(e.attributes.getNamedItem("StartFrame").nodeValue)),null!=e.attributes.getNamedItem("FrameSequence")&&this.set_frameSequence(e.attributes.getNamedItem("FrameSequence").nodeValue)},play:function(){this._playing$1=!0,this._timeStart$1=t.ss.now()},pause:function(){this._playing$1=!1},stop:function(){this._playing$1=!1,this._currentFrame$1=0},initializeGeometry:function(){var e=this._frames$1;if(t.ss.emptyString(this._frameSequence$1)||(e=this._framesList$1.length),this._playing$1){var i=t.ss.now()-this._timeStart$1;switch(this._loopType$1){case 0:this._currentFrame$1=t.ss.truncate(i/1e3*24%e)+this._startFrame$1;break;case 1:this._currentFrame$1=Math.abs(t.ss.truncate((i/1e3*24+e)%(2*e-1))-(e-1))+this._startFrame$1,this._currentFrame$1<0||this._currentFrame$1;break;case 2:this._currentFrame$1=Math.max(0,e-t.ss.truncate(i/1e3*24%e))+this._startFrame$1;break;case 3:var n=Math.min(i/1e3*24,2*e+1)+e;this._currentFrame$1=Math.abs(n%(2*e-1)-(e-1))+this._startFrame$1;break;case 4:this._currentFrame$1=Math.min(e-1,t.ss.truncate(i/1e3*24));break;case 5:default:this._currentFrame$1=this._startFrame$1;break;case 6:this._currentFrame$1=e-1+this._startFrame$1}}t.ss.emptyString(this._frameSequence$1)||(this._currentFrame$1<this._framesList$1.length&&this._currentFrame$1>-1?this._currentFrame$1=this._framesList$1[this._currentFrame$1]:this._currentFrame$1=0),this.currentRotation=0}};n("FlipbookOverlay",[Ah,Lh,ph]);var Ih={topLeft:0,top:1,topRight:2,right:3,bottomRight:4,bottom:5,bottomLeft:6,left:7,rotate:8,move:9,center:10,none:11};function kh(){this._singleSelectHandles=null,this._multiSelectHandles=null,this._focusHandles=null,this.selectionSet=[],this._focus=null,this._ratio=1,this._sprite=new qo,this._centerX=0,this._centerY=0}n("SelectionAnchor",Ih),r("SelectionAnchor",Ih),kh._points=new Array(54);var Ph={clearSelection:function(){this.selectionSet.length=0},addSelection:function(t){null!=t&&(this.selectionSet.indexOf(t)>=0||this.selectionSet.push(t))},addSelectionRange:function(e){for(var i=t.ss.enumerate(e);i.moveNext();){var n=i.current;this.selectionSet.push(n)}},isOverlaySelected:function(t){return this.selectionSet.indexOf(t)>=0},setSelection:function(t){this.selectionSet.length=0,null!=t&&this.selectionSet.push(t)},get_multiSelect:function(){return this.selectionSet.length>1},setSelectionRange:function(e){this.selectionSet.length=0;for(var i=t.ss.enumerate(e);i.moveNext();){var n=i.current;this.selectionSet.push(n)}},get_focus:function(){return this._focus},set_focus:function(t){return this._focus=t,t},draw3D:function(e,i){if(this._ratio=1116/e.height,null==this._singleSelectHandles&&(this._singleSelectHandles=rs.fromUrl("images/Selhand.bmp")),null==this._multiSelectHandles&&(this._multiSelectHandles=rs.fromUrl("images/multiSelhand.bmp")),null==this._focusHandles&&(this._focusHandles=rs.fromUrl("images/FocusHandles.png")),this.selectionSet.length>1)for(var n=t.ss.enumerate(this.selectionSet);n.moveNext();)(s=n.current)===this._focus?this._drawSelectionHandles(e,s,this._focusHandles):this._drawSelectionHandles(e,s,this._multiSelectHandles);else for(var r=t.ss.enumerate(this.selectionSet);r.moveNext();){var s=r.current;this._drawSelectionHandles(e,s,this._singleSelectHandles)}},_drawSelectionHandles:function(e,i,n){for(var r=this.makeHandles(i),s=i.get_rotationAngle(),a=0,o=0,l=t.ss.enumerate(r);l.moveNext();){var h=l.current;kh._points[a+0]=new dn,kh._points[a+0].position=i.makePosition(this._centerX,this._centerY,h.get_left()-this._centerX,h.get_top()-this._centerY,s),kh._points[a+0].tu=o*(1/9),kh._points[a+0].tv=0,kh._points[a+0].color=Xi.get_white(),kh._points[a+1]=new dn,kh._points[a+1].position=i.makePosition(this._centerX,this._centerY,h.get_right()-this._centerX,h.get_top()-this._centerY,s),kh._points[a+1].tu=(o+1)*(1/9),kh._points[a+1].tv=0,kh._points[a+1].color=Xi.get_white(),kh._points[a+2]=new dn,kh._points[a+2].position=i.makePosition(this._centerX,this._centerY,h.get_left()-this._centerX,h.get_bottom()-this._centerY,s),kh._points[a+2].tu=o*(1/9),kh._points[a+2].tv=1,kh._points[a+2].color=Xi.get_white(),kh._points[a+3]=new dn,kh._points[a+3].position=i.makePosition(this._centerX,this._centerY,h.get_right()-this._centerX,h.get_top()-this._centerY,s),kh._points[a+3].tu=(o+1)*(1/9),kh._points[a+3].tv=0,kh._points[a+3].color=Xi.get_white(),kh._points[a+4]=new dn,kh._points[a+4].position=i.makePosition(this._centerX,this._centerY,h.get_right()-this._centerX,h.get_bottom()-this._centerY,s),kh._points[a+4].tu=(o+1)*(1/9),kh._points[a+4].tv=1,kh._points[a+4].color=Xi.get_white(),kh._points[a+5]=new dn,kh._points[a+5].position=i.makePosition(this._centerX,this._centerY,h.get_left()-this._centerX,h.get_bottom()-this._centerY,s),kh._points[a+5].tu=o*(1/9),kh._points[a+5].tv=1,kh._points[a+5].color=Xi.get_white(),a+=6,o++}this.get_multiSelect()?this._sprite.draw(e,kh._points,kh._points.length-6,n,!1,1):this._sprite.draw(e,kh._points,kh._points.length,n,!1,1)},pointToSelectionSpace:function(t){var e=new Array(1);return e[0]=vn.create(t.x,t.y),xn.rotateAt(-this.selectionSet[0].get_rotationAngle()/180*Math.PI,vn.create(this.selectionSet[0].get_x(),this.selectionSet[0].get_y()))._transformPoints(e),e[0]},pointToScreenSpace:function(t){var e=new Array(1);return e[0]=vn.create(t.x,t.y),xn.rotateAt(this.selectionSet[0].get_rotationAngle()/180*Math.PI,vn.create(this.selectionSet[0].get_x(),this.selectionSet[0].get_y()))._transformPoints(e),e[0]},hitTest:function(e){if(1===this.selectionSet.length)for(var i=t.ss.enumerate(this.selectionSet);i.moveNext();)for(var n=i.current,r=this.makeHandles(n),s=0,a=this.pointToSelectionSpace(e),o=t.ss.enumerate(r);o.moveNext();){if(o.current.contains(a))return s;s++}return 11},makeHandles:function(e){var i=t.ss.truncate(e.get_x()-e.get_width()/2)+.5,n=t.ss.truncate(e.get_y())-e.get_height()/2+.5;this._centerX=e.get_x(),this._centerY=e.get_y();var r=e.get_width(),s=e.get_height(),a=12*this._ratio,o=new Array(9);return o[0]=Ai.create(i-a,n-a,a,a),o[1]=Ai.create(i+r/2-a/2,n-a,a,a),o[2]=Ai.create(i+r,n-a,a,a),o[3]=Ai.create(i+r,n+s/2-a/2,a,a),o[4]=Ai.create(i+r,n+s,a,a),o[5]=Ai.create(i+r/2-a/2,n+s,a,a),o[6]=Ai.create(i-a,n+s,a,a),o[7]=Ai.create(i-a,n+s/2-a/2,a,a),o[8]=Ai.create(i+r/2-a/2,n-30*this._ratio,a,a),o}};n("Selection",[kh,Ph,null]);var Rh={slew:0,crossFade:1,crossCut:2,fadeOutIn:3,fadeIn:4,fadeOut:5};function Eh(){this._tourStopType=0,this._keyFramed=!1,this._tweenPosition=0,this.faderOpacity=0,this._owner=null,this._transition=0,this._transitionTime=2,this._transitionHoldTime=4,this._transitionOutTime=2,this._nextSlide="Next",this._fadeInOverlays=!1,this._masterSlide=!1,this._id="",this._description="",this._name="",this._duration=1e4,this._interpolationType=0,this._hasLocation=!0,this._hasTime=!0,this._startTime=Wo.get_now(),this._endTime=Wo.get_now(),this._actualPlanetScale=ko.get_current().get_actualPlanetScale(),this._locationAltitude=ko.get_current().get_locationAltitude(),this._locationLat=ko.get_current().get_locationLat(),this._locationLng=ko.get_current().get_locationLng(),this._showClouds=ko.get_current().get_showClouds(),this._showConstellationBoundries=ko.get_current().get_showConstellationBoundries(),this._showConstellationFigures=ko.get_current().get_showConstellationFigures(),this._showConstellationSelection=ko.get_current().get_showConstellationSelection(),this._showEcliptic=ko.get_current().get_showEcliptic(),this._showElevationModel=ko.get_current().get_showElevationModel(),this._showFieldOfView=ko.get_current().get_showFieldOfView(),this._showGrid=ko.get_current().get_showGrid(),this._showHorizon=ko.get_current().get_showHorizon(),this._showHorizonPanorama=ko.get_current().get_showHorizonPanorama(),this._showMoonsAsPointSource=ko.get_current().get_showMoonsAsPointSource(),this._showSolarSystem=ko.get_current().get_showSolarSystem(),this._fovTelescope=ko.get_current().get_fovTelescope(),this._fovEyepiece=ko.get_current().get_fovEyepiece(),this._fovCamera=ko.get_current().get_fovCamera(),this._localHorizonMode=ko.get_current().get_localHorizonMode(),this._galacticMode=ko.get_current().get_galacticMode(),this._solarSystemStars=ko.get_current().get_solarSystemStars(),this._solarSystemMilkyWay=ko.get_current().get_solarSystemMilkyWay(),this._solarSystemCosmos=ko.get_current().get_solarSystemCosmos(),this._solarSystemOrbits=ko.get_current().get_solarSystemOrbits(),this._solarSystemOverlays=ko.get_current().get_solarSystemOverlays(),this._solarSystemLighting=ko.get_current().get_solarSystemLighting(),this._solarSystemScale=ko.get_current().get_solarSystemScale(),this._solarSystemMultiRes=ko.get_current().get_solarSystemMultiRes(),this._showEquatorialGridText=ko.get_current().get_showEquatorialGridText(),this._showGalacticGrid=ko.get_current().get_showGalacticGrid(),this._showGalacticGridText=ko.get_current().get_showGalacticGridText(),this._showEclipticGrid=ko.get_current().get_showEclipticGrid(),this._showEclipticGridText=ko.get_current().get_showEclipticGridText(),this._showEclipticOverviewText=ko.get_current().get_showEclipticOverviewText(),this._showAltAzGrid=ko.get_current().get_showAltAzGrid(),this._showAltAzGridText=ko.get_current().get_showAltAzGridText(),this._showPrecessionChart=ko.get_current().get_showPrecessionChart(),this._showConstellationPictures=ko.get_current().get_showConstellationPictures(),this._showConstellationLabels=ko.get_current().get_showConstellationLabels(),this._solarSystemCMB=ko.get_current().get_solarSystemCMB(),this._solarSystemMinorPlanets=ko.get_current().get_solarSystemMinorPlanets(),this._solarSystemPlanets=ko.get_current().get_solarSystemPlanets(),this._showEarthSky=ko.get_current().get_showEarthSky(),this._solarSystemMinorOrbits=ko.get_current().get_solarSystemMinorOrbits(),this._constellationsEnabled="",this._constellationFiguresFilter=ko.get_current().get_constellationFiguresFilter().clone(),this._constellationBoundariesFilter=ko.get_current().get_constellationBoundariesFilter().clone(),this._constellationNamesFilter=ko.get_current().get_constellationNamesFilter().clone(),this._constellationArtFilter=ko.get_current().get_constellationArtFilter().clone(),this._showSkyOverlays=ko.get_current().get_showSkyOverlays(),this._showConstellations=ko.get_current().get_showConstellations(),this._showSkyNode=ko.get_current().get_showSkyNode(),this._showSkyGrids=ko.get_current().get_showSkyGrids(),this._showSkyOverlaysIn3d=ko.get_current().get_showSkyOverlaysIn3d(),this._earthCutawayView=ko.get_current().get_earthCutawayView(),this._showISSModel=ko.get_current().get_showISSModel(),this._milkyWayModel=ko.get_current().get_milkyWayModel(),this._minorPlanetsFilter=ko.get_current().get_minorPlanetsFilter(),this._planetOrbitsFilter=ko.get_current().get_planetOrbitsFilter(),this._thumbnailString="",this._thumbnail=null,this.layers={},this._overlays=[],this._musicTrack=null,this._voiceTrack=null,this._eclipticGridColor=Xi.get_green(),this._galacticGridColor=Xi.get_cyan(),this._altAzGridColor=Xi.get_magenta(),this._precessionChartColor=Xi.get_orange(),this._eclipticColor=Xi.get_blue(),this._equatorialGridColor=Xi.get_white(),this._constellationLabelsHeight=80,this._id=Ii.newGuid().toString()}n("TransitionType",Rh),r("TransitionType",Rh),Eh.clipboardFormat="WorldWideTelescope.Slide",Eh.create=function(t){var e=new Eh;return e._target=t,e},Eh.getXmlText=function(t){var e=new Ks;return e._writeProcessingInstruction("xml","version='1.0' encoding='UTF-8'"),t._saveToXml(e,!0),e._close(),e.body},Eh._fromXml=function(e,i){try{var n=new Eh;n._owner=e,n.set_id(i.attributes.getNamedItem("Id").nodeValue),n.set_name(i.attributes.getNamedItem("Name").nodeValue),n.set_description(i.attributes.getNamedItem("Description").nodeValue),n._thumbnailString=i.attributes.getNamedItem("Thumbnail").nodeValue,n._duration=a.parseTimeSpan(i.attributes.getNamedItem("Duration").nodeValue),null!=i.attributes.getNamedItem("Master")&&(n._masterSlide=t.ss.boolean(i.attributes.getNamedItem("Master").nodeValue)),null!=i.attributes.getNamedItem("NextSlide")&&(n._nextSlide=i.attributes.getNamedItem("NextSlide").nodeValue),null!=i.attributes.getNamedItem("InterpolationType")&&n.set_interpolationType(s.parse("InterpolationType",i.attributes.getNamedItem("InterpolationType").nodeValue)),n._fadeInOverlays=!0,null!=i.attributes.getNamedItem("FadeInOverlays")&&(n._fadeInOverlays=t.ss.boolean(i.attributes.getNamedItem("FadeInOverlays").nodeValue)),null!=i.attributes.getNamedItem("Transition")&&(n._transition=s.parse("TransitionType",i.attributes.getNamedItem("Transition").nodeValue)),null!=i.attributes.getNamedItem("HasLocation")&&(n._hasLocation=t.ss.boolean(i.attributes.getNamedItem("HasLocation").nodeValue)),n._hasLocation&&(null!=i.attributes.getNamedItem("LocationAltitude")&&(n._locationAltitude=parseFloat(i.attributes.getNamedItem("LocationAltitude").nodeValue)),null!=i.attributes.getNamedItem("LocationLat")&&(n._locationLat=parseFloat(i.attributes.getNamedItem("LocationLat").nodeValue)),null!=i.attributes.getNamedItem("LocationLng")&&(n._locationLng=parseFloat(i.attributes.getNamedItem("LocationLng").nodeValue))),null!=i.attributes.getNamedItem("HasTime")&&(n._hasTime=t.ss.boolean(i.attributes.getNamedItem("HasTime").nodeValue),n._hasTime&&(null!=i.attributes.getNamedItem("StartTime")&&(n._startTime=t.ss.date(i.attributes.getNamedItem("StartTime").nodeValue+" UTC")),null!=i.attributes.getNamedItem("EndTime")&&(n._endTime=t.ss.date(i.attributes.getNamedItem("EndTime").nodeValue+" UTC")))),null!=i.attributes.getNamedItem("ActualPlanetScale")&&(n._actualPlanetScale=t.ss.boolean(i.attributes.getNamedItem("ActualPlanetScale").nodeValue)),null!=i.attributes.getNamedItem("ShowClouds")&&(n._showClouds=t.ss.boolean(i.attributes.getNamedItem("ShowClouds").nodeValue)),null!=i.attributes.getNamedItem("ShowConstellationBoundries")&&(n._showConstellationBoundries=t.ss.boolean(i.attributes.getNamedItem("ShowConstellationBoundries").nodeValue)),null!=i.attributes.getNamedItem("ShowConstellationFigures")&&(n._showConstellationFigures=t.ss.boolean(i.attributes.getNamedItem("ShowConstellationFigures").nodeValue)),null!=i.attributes.getNamedItem("ShowConstellationSelection")&&(n._showConstellationSelection=t.ss.boolean(i.attributes.getNamedItem("ShowConstellationSelection").nodeValue)),null!=i.attributes.getNamedItem("ShowEcliptic")&&(n._showEcliptic=t.ss.boolean(i.attributes.getNamedItem("ShowEcliptic").nodeValue)),null!=i.attributes.getNamedItem("EclipticColor")&&(n._eclipticColor=Oi.load(i.attributes.getNamedItem("EclipticColor").nodeValue)),null!=i.attributes.getNamedItem("ShowElevationModel")&&(n._showElevationModel=t.ss.boolean(i.attributes.getNamedItem("ShowElevationModel").nodeValue)),null!=i.attributes.getNamedItem("ShowFieldOfView")&&(n._showFieldOfView=t.ss.boolean(i.attributes.getNamedItem("ShowFieldOfView").nodeValue)),null!=i.attributes.getNamedItem("ShowGrid")&&(n._showGrid=t.ss.boolean(i.attributes.getNamedItem("ShowGrid").nodeValue)),null!=i.attributes.getNamedItem("ShowHorizon")&&(n._showHorizon=t.ss.boolean(i.attributes.getNamedItem("ShowHorizon").nodeValue)),null!=i.attributes.getNamedItem("ShowHorizonPanorama")&&(n._showHorizonPanorama=t.ss.boolean(i.attributes.getNamedItem("ShowHorizonPanorama").nodeValue)),null!=i.attributes.getNamedItem("ShowMoonsAsPointSource")&&(n._showMoonsAsPointSource=t.ss.boolean(i.attributes.getNamedItem("ShowMoonsAsPointSource").nodeValue)),null!=i.attributes.getNamedItem("ShowSolarSystem")&&(n._showSolarSystem=t.ss.boolean(i.attributes.getNamedItem("ShowSolarSystem").nodeValue)),null!=i.attributes.getNamedItem("FovTelescope")&&(n._fovTelescope=parseInt(i.attributes.getNamedItem("FovTelescope").nodeValue)),null!=i.attributes.getNamedItem("FovEyepiece")&&(n._fovEyepiece=parseInt(i.attributes.getNamedItem("FovEyepiece").nodeValue)),null!=i.attributes.getNamedItem("FovCamera")&&(n._fovCamera=parseInt(i.attributes.getNamedItem("FovCamera").nodeValue)),null!=i.attributes.getNamedItem("LocalHorizonMode")&&(n._localHorizonMode=t.ss.boolean(i.attributes.getNamedItem("LocalHorizonMode").nodeValue)),null!=i.attributes.getNamedItem("GalacticMode")&&(n._galacticMode=t.ss.boolean(i.attributes.getNamedItem("GalacticMode").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemStars")&&(n._solarSystemStars=t.ss.boolean(i.attributes.getNamedItem("SolarSystemStars").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemMilkyWay")&&(n._solarSystemMilkyWay=t.ss.boolean(i.attributes.getNamedItem("SolarSystemMilkyWay").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemCosmos")&&(n._solarSystemCosmos=t.ss.boolean(i.attributes.getNamedItem("SolarSystemCosmos").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemOrbits")&&(n._solarSystemOrbits=t.ss.boolean(i.attributes.getNamedItem("SolarSystemOrbits").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemOverlays")&&(n._solarSystemOverlays=t.ss.boolean(i.attributes.getNamedItem("SolarSystemOverlays").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemLighting")&&(n._solarSystemLighting=t.ss.boolean(i.attributes.getNamedItem("SolarSystemLighting").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemScale")&&(n._solarSystemScale=parseInt(i.attributes.getNamedItem("SolarSystemScale").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemMultiRes")&&(n._solarSystemMultiRes=t.ss.boolean(i.attributes.getNamedItem("SolarSystemMultiRes").nodeValue)),null!=i.attributes.getNamedItem("ShowEquatorialGridText")&&(n._showEquatorialGridText=t.ss.boolean(i.attributes.getNamedItem("ShowEquatorialGridText").nodeValue)),null!=i.attributes.getNamedItem("EquatorialGridColor")&&(n._equatorialGridColor=Oi.load(i.attributes.getNamedItem("EquatorialGridColor").nodeValue)),null!=i.attributes.getNamedItem("ShowGalacticGrid")&&(n._showGalacticGrid=t.ss.boolean(i.attributes.getNamedItem("ShowGalacticGrid").nodeValue)),null!=i.attributes.getNamedItem("ShowGalacticGridText")&&(n._showGalacticGridText=t.ss.boolean(i.attributes.getNamedItem("ShowGalacticGridText").nodeValue)),null!=i.attributes.getNamedItem("GalacticGridColor")&&(n._galacticGridColor=Oi.load(i.attributes.getNamedItem("GalacticGridColor").nodeValue)),null!=i.attributes.getNamedItem("ShowEclipticGrid")&&(n._showEclipticGrid=t.ss.boolean(i.attributes.getNamedItem("ShowEclipticGrid").nodeValue)),null!=i.attributes.getNamedItem("ShowEclipticGridText")&&(n._showEclipticGridText=t.ss.boolean(i.attributes.getNamedItem("ShowEclipticGridText").nodeValue)),null!=i.attributes.getNamedItem("EclipticGridColor")&&(n._eclipticGridColor=Oi.load(i.attributes.getNamedItem("EclipticGridColor").nodeValue)),null!=i.attributes.getNamedItem("ShowEclipticOverviewText")&&(n._showEclipticOverviewText=t.ss.boolean(i.attributes.getNamedItem("ShowEclipticOverviewText").nodeValue)),null!=i.attributes.getNamedItem("ShowAltAzGrid")&&(n._showAltAzGrid=t.ss.boolean(i.attributes.getNamedItem("ShowAltAzGrid").nodeValue)),null!=i.attributes.getNamedItem("ShowAltAzGridText")&&(n._showAltAzGridText=t.ss.boolean(i.attributes.getNamedItem("ShowAltAzGridText").nodeValue)),null!=i.attributes.getNamedItem("AltAzGridColor")&&(n._altAzGridColor=Oi.load(i.attributes.getNamedItem("AltAzGridColor").nodeValue)),null!=i.attributes.getNamedItem("ShowPrecessionChart")&&(n._showPrecessionChart=t.ss.boolean(i.attributes.getNamedItem("ShowPrecessionChart").nodeValue)),null!=i.attributes.getNamedItem("PrecessionChartColor")&&(n._precessionChartColor=Oi.load(i.attributes.getNamedItem("PrecessionChartColor").nodeValue)),null!=i.attributes.getNamedItem("ShowConstellationPictures")&&(n._showConstellationPictures=t.ss.boolean(i.attributes.getNamedItem("ShowConstellationPictures").nodeValue)),null!=i.attributes.getNamedItem("ShowConstellationLabels")&&(n._showConstellationLabels=t.ss.boolean(i.attributes.getNamedItem("ShowConstellationLabels").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemCMB")&&(n._solarSystemCMB=t.ss.boolean(i.attributes.getNamedItem("SolarSystemCMB").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemMinorPlanets")&&(n._solarSystemMinorPlanets=t.ss.boolean(i.attributes.getNamedItem("SolarSystemMinorPlanets").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemPlanets")&&(n._solarSystemPlanets=t.ss.boolean(i.attributes.getNamedItem("SolarSystemPlanets").nodeValue)),null!=i.attributes.getNamedItem("ShowEarthSky")&&(n._showEarthSky=t.ss.boolean(i.attributes.getNamedItem("ShowEarthSky").nodeValue)),null!=i.attributes.getNamedItem("SolarSystemMinorOrbits")&&(n._solarSystemMinorOrbits=t.ss.boolean(i.attributes.getNamedItem("SolarSystemMinorOrbits").nodeValue)),null!=i.attributes.getNamedItem("ShowSkyOverlays")?n._showSkyOverlays=t.ss.boolean(i.attributes.getNamedItem("ShowSkyOverlays").nodeValue):n._showSkyOverlays=!0,null!=i.attributes.getNamedItem("ShowConstellations")?n._showConstellations=t.ss.boolean(i.attributes.getNamedItem("ShowConstellations").nodeValue):n._showConstellations=!0,null!=i.attributes.getNamedItem("ShowSkyNode")?n._showSkyNode=t.ss.boolean(i.attributes.getNamedItem("ShowSkyNode").nodeValue):n._showSkyNode=!0,null!=i.attributes.getNamedItem("ShowSkyGrids")?n._showSkyGrids=t.ss.boolean(i.attributes.getNamedItem("ShowSkyGrids").nodeValue):n._showSkyGrids=!0,null!=i.attributes.getNamedItem("ShowSkyOverlaysIn3d")&&(n._showSkyOverlaysIn3d=t.ss.boolean(i.attributes.getNamedItem("ShowSkyOverlaysIn3d").nodeValue)),null!=i.attributes.getNamedItem("EarthCutawayView")&&(n._earthCutawayView=t.ss.boolean(i.attributes.getNamedItem("EarthCutawayView").nodeValue)),null!=i.attributes.getNamedItem("ShowISSModel")&&(n._showISSModel=t.ss.boolean(i.attributes.getNamedItem("ShowISSModel").nodeValue)),null!=i.attributes.getNamedItem("MilkyWayModel")&&(n._milkyWayModel=t.ss.boolean(i.attributes.getNamedItem("MilkyWayModel").nodeValue)),null!=i.attributes.getNamedItem("ConstellationBoundariesFilter")?n._constellationBoundariesFilter=Ia.parse(i.attributes.getNamedItem("ConstellationBoundariesFilter").nodeValue):n._constellationBoundariesFilter=Ia.get_allConstellation(),null!=i.attributes.getNamedItem("ConstellationBoundariesFilter")?n._constellationFiguresFilter=Ia.parse(i.attributes.getNamedItem("ConstellationBoundariesFilter").nodeValue):n._constellationFiguresFilter=new Ia,null!=i.attributes.getNamedItem("ConstellationNamesFilter")?n._constellationNamesFilter=Ia.parse(i.attributes.getNamedItem("ConstellationNamesFilter").nodeValue):n._constellationNamesFilter=new Ia,null!=i.attributes.getNamedItem("ConstellationArtFilter")?n._constellationArtFilter=Ia.parse(i.attributes.getNamedItem("ConstellationArtFilter").nodeValue):n._constellationArtFilter=new Ia,null!=i.attributes.getNamedItem("MinorPlanetsFilter")&&(n._minorPlanetsFilter=parseInt(i.attributes.getNamedItem("MinorPlanetsFilter").nodeValue)),null!=i.attributes.getNamedItem("PlanetOrbitsFilter")&&(n._planetOrbitsFilter=parseInt(i.attributes.getNamedItem("PlanetOrbitsFilter").nodeValue));var r=a.selectSingleNode(i,"Place");n._target=tl._fromXml(r);var o=a.selectSingleNode(i,"EndTarget");null!=o&&(n._endTarget=tl._fromXml(o));for(var l=a.selectSingleNode(i,"Overlays"),h=t.ss.enumerate(l.childNodes);h.moveNext();){var u=h.current;"Overlay"===u.nodeName&&n.addOverlay(ph._fromXml(n,u))}var c=a.selectSingleNode(i,"MusicTrack");null!=c&&(n._musicTrack=ph._fromXml(n,a.selectSingleNode(c,"Overlay")));var _=a.selectSingleNode(i,"VoiceTrack");null!=_&&(n._voiceTrack=ph._fromXml(n,a.selectSingleNode(_,"Overlay")));var d=a.selectSingleNode(i,"VisibleLayers");return null!=d&&n._loadLayerList(d),n._thumbnail=e.getCachedTexture(t.ss.format("{0}.thumb.png",n._id),(function(){})),n}catch(t){return Pr._fireTourError(t),null}};var Dh={get_keyFramed:function(){return this._keyFramed},get_tourStopType:function(){return null!=this._target.get_backgroundImageset()?this._target.get_backgroundImageset().get_dataSetType():this._tourStopType},set_tourStopType:function(t){return null!=this._target.get_backgroundImageset()&&this._target.get_backgroundImageset().get_dataSetType()!==t&&this._target.set_backgroundImageset(null),this._tourStopType=t,t},get_tweenPosition:function(){return this._tweenPosition},set_tweenPosition:function(t){return this._tweenPosition!==t&&(this._tweenPosition=Math.max(0,Math.min(1,t)),this.updateTweenPosition()),t},updateTweenPosition:function(){this.get_keyFramed()},copy:function(){var t=new Ks;t._writeProcessingInstruction("xml","version='1.0' encoding='UTF-8'"),this._saveToXml(t,!0);try{var e=(new DOMParser).parseFromString(t.body,"text/xml"),i=a.selectSingleNode(e,"TourStop"),n=Eh._fromXml(this.get_owner(),i);return n.set_id(Ii.newGuid().toString()),n}catch(t){}return null},get_owner:function(){return this._owner},set_owner:function(t){return this._owner=t,t},get__transition:function(){return this._transition},set__transition:function(t){return this._transition!==t&&(this._transition=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get__transitionTime:function(){return this._transitionTime},set__transitionTime:function(t){return this._transitionTime!==t&&(this._transitionTime=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get__transitionHoldTime:function(){return this._transitionHoldTime},set__transitionHoldTime:function(t){return this._transitionHoldTime!==t&&(this._transitionHoldTime=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get__transitionOutTime:function(){return this._transitionOutTime},set__transitionOutTime:function(t){return this._transitionOutTime!==t&&(this._transitionOutTime=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_nextSlide:function(){return this._nextSlide},set_nextSlide:function(t){return this._nextSlide=t,t},get_isLinked:function(){return!(null==this._nextSlide||"Next"===this._nextSlide||!this._nextSlide)},get_fadeInOverlays:function(){return this._fadeInOverlays},set_fadeInOverlays:function(t){return this._fadeInOverlays=t,t},get_masterSlide:function(){return this._masterSlide},set_masterSlide:function(t){return this._masterSlide!==t&&(this._masterSlide=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_id:function(){return this._id},set_id:function(t){return this._id=t,null!=this._owner&&this._owner.set_tourDirty(!0),t},toString:function(){return null!=this._target?this.get_target().get_name():this._description},get_description:function(){return this._description},set_description:function(t){return this._description!==t&&(this._description=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_name:function(){return null!=this._target?this._target.get_name():this._name},set_name:function(t){return this._name!==t&&(this._name=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_duration:function(){return this._duration},set_duration:function(t){return this._duration!==t&&(this._duration=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_target:function(){return this._target},set_target:function(t){return this._target!==t&&(this._target=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_endTarget:function(){return this._endTarget},set_endTarget:function(t){return this._endTarget!==t&&(this._endTarget=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_interpolationType:function(){return this._interpolationType},set_interpolationType:function(t){return this._interpolationType=t,t},get_hasLocation:function(){return this._hasTime},set_hasLocation:function(t){return this._hasLocation!==t&&(this._hasLocation=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_hasTime:function(){return this._hasTime},set_hasTime:function(t){return this._hasTime!==t&&(this._hasTime=this._hasLocation=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_startTime:function(){return this._startTime},set_startTime:function(e){return this._startTime=e,t.ss.compareDates(this._startTime,e)||(this._startTime=e,null!=this._owner&&this._owner.set_tourDirty(!0)),e},get_endTime:function(){return this._endTime},set_endTime:function(e){return t.ss.compareDates(this._endTime,e)||(this._endTime=e,null!=this._owner&&this._owner.set_tourDirty(!0)),e},captureSettings:function(){this._startTime=Wo.get_now(),this._actualPlanetScale=ko.get_current().get_actualPlanetScale(),this._locationAltitude=ko.get_current().get_locationAltitude(),this._locationLat=ko.get_current().get_locationLat(),this._locationLng=ko.get_current().get_locationLng(),this._showClouds=ko.get_current().get_showClouds(),this._showConstellationBoundries=ko.get_current().get_showConstellationBoundries(),this._showConstellationFigures=ko.get_current().get_showConstellationFigures(),this._showConstellationSelection=ko.get_current().get_showConstellationSelection(),this._showEcliptic=ko.get_current().get_showEcliptic(),this._showElevationModel=ko.get_current().get_showElevationModel(),this._showFieldOfView=ko.get_current().get_showFieldOfView(),this._showGrid=ko.get_current().get_showGrid(),this._showHorizon=ko.get_current().get_showHorizon(),this._showHorizonPanorama=ko.get_current().get_showHorizonPanorama(),this._showMoonsAsPointSource=ko.get_current().get_showMoonsAsPointSource(),this._showSolarSystem=ko.get_current().get_showSolarSystem(),this._fovTelescope=ko.get_current().get_fovTelescope(),this._fovEyepiece=ko.get_current().get_fovEyepiece(),this._fovCamera=ko.get_current().get_fovCamera(),this._localHorizonMode=ko.get_current().get_localHorizonMode(),this._galacticMode=ko.get_current().get_galacticMode(),this._solarSystemStars=ko.get_current().get_solarSystemStars(),this._solarSystemMilkyWay=ko.get_current().get_solarSystemMilkyWay(),this._solarSystemCosmos=ko.get_current().get_solarSystemCosmos(),this._solarSystemOrbits=ko.get_current().get_solarSystemOrbits(),this._solarSystemOverlays=ko.get_current().get_solarSystemOverlays(),this._solarSystemLighting=ko.get_current().get_solarSystemLighting(),this._solarSystemScale=ko.get_current().get_solarSystemScale(),this._solarSystemMultiRes=ko.get_current().get_solarSystemMultiRes(),this._showEquatorialGridText=ko.get_current().get_showEquatorialGridText(),this._showGalacticGrid=ko.get_current().get_showGalacticGrid(),this._showGalacticGridText=ko.get_current().get_showGalacticGridText(),this._showEclipticGrid=ko.get_current().get_showEclipticGrid(),this._showEclipticGridText=ko.get_current().get_showEclipticGridText(),this._showEclipticOverviewText=ko.get_current().get_showEclipticOverviewText(),this._showAltAzGrid=ko.get_current().get_showAltAzGrid(),this._showAltAzGridText=ko.get_current().get_showAltAzGridText(),this._showPrecessionChart=ko.get_current().get_showPrecessionChart(),this._showConstellationPictures=ko.get_current().get_showConstellationPictures(),this._showConstellationLabels=ko.get_current().get_showConstellationLabels(),this._solarSystemCMB=ko.get_current().get_solarSystemCMB(),this._solarSystemMinorPlanets=ko.get_current().get_solarSystemMinorPlanets(),this._solarSystemPlanets=ko.get_current().get_solarSystemPlanets(),this._showEarthSky=ko.get_current().get_showEarthSky(),this._solarSystemMinorOrbits=ko.get_current().get_solarSystemMinorOrbits(),this._constellationFiguresFilter=ko.get_current().get_constellationFiguresFilter().clone(),this._constellationBoundariesFilter=ko.get_current().get_constellationBoundariesFilter().clone(),this._constellationNamesFilter=ko.get_current().get_constellationNamesFilter().clone(),this._constellationArtFilter=ko.get_current().get_constellationArtFilter().clone(),this._showSkyOverlays=ko.get_current().get_showSkyOverlays(),this._showConstellations=ko.get_current().get_showConstellations(),this._showSkyNode=ko.get_current().get_showSkyNode(),this._showSkyGrids=ko.get_current().get_showSkyGrids(),this._showSkyOverlaysIn3d=ko.get_current().get_showSkyOverlaysIn3d(),this._earthCutawayView=ko.get_current().get_earthCutawayView(),this._showISSModel=ko.get_current().get_showISSModel(),this._milkyWayModel=ko.get_current().get_milkyWayModel(),this._minorPlanetsFilter=ko.get_current().get_minorPlanetsFilter(),this._planetOrbitsFilter=ko.get_current().get_planetOrbitsFilter()},syncSettings:function(){ko.get_globalSettings().set_actualPlanetScale(this._actualPlanetScale),ko.get_globalSettings().set_locationAltitude(this._locationAltitude),ko.get_globalSettings().set_locationLat(this._locationLat),ko.get_globalSettings().set_locationLng(this._locationLng),ko.get_globalSettings().set_earthCutawayView(this._earthCutawayView),ko.get_globalSettings().set_showConstellationBoundries(this._showConstellationBoundries),ko.get_globalSettings().set_showConstellationFigures(this._showConstellationFigures),ko.get_globalSettings().set_showConstellationSelection(this._showConstellationSelection),ko.get_globalSettings().set_showEcliptic(this._showEcliptic),ko.get_globalSettings().set_showElevationModel(this._showElevationModel),ko.get_globalSettings().set_showGrid(this._showGrid),ko.get_globalSettings().set_showHorizon(this._showHorizon),ko.get_globalSettings().set_showSolarSystem(this._showSolarSystem),ko.get_globalSettings().set_localHorizonMode(this._localHorizonMode),ko.get_globalSettings().set_galacticMode(this._galacticMode),ko.get_globalSettings().set_solarSystemStars(this._solarSystemStars),ko.get_globalSettings().set_solarSystemMilkyWay(this._solarSystemMilkyWay),ko.get_globalSettings().set_solarSystemCosmos(this._solarSystemCosmos),ko.get_globalSettings().set_solarSystemCMB(this._solarSystemCMB),ko.get_globalSettings().set_solarSystemOrbits(this._solarSystemOrbits),ko.get_globalSettings().set_solarSystemMinorOrbits(this._solarSystemMinorOrbits),ko.get_globalSettings().set_solarSystemMinorPlanets(this._solarSystemMinorPlanets),ko.get_globalSettings().set_solarSystemOverlays(this._solarSystemOverlays),ko.get_globalSettings().set_solarSystemLighting(this._solarSystemLighting),ko.get_globalSettings().set_showISSModel(this._showISSModel),ko.get_globalSettings().set_solarSystemScale(this._solarSystemScale),ko.get_globalSettings().set_solarSystemMultiRes(this._solarSystemMultiRes),ko.get_globalSettings().set_showEarthSky(this._showEarthSky),ko.get_globalSettings().set_minorPlanetsFilter(this._minorPlanetsFilter),ko.get_globalSettings().set_planetOrbitsFilter(this._planetOrbitsFilter),ko.get_globalSettings().set_showEquatorialGridText(this._showEquatorialGridText),ko.get_globalSettings().set_showGalacticGrid(this._showGalacticGrid),ko.get_globalSettings().set_showGalacticGridText(this._showGalacticGridText),ko.get_globalSettings().set_showEclipticGrid(this._showEclipticGrid),ko.get_globalSettings().set_showEclipticGridText(this._showEclipticGridText),ko.get_globalSettings().set_showEclipticOverviewText(this._showEclipticOverviewText),ko.get_globalSettings().set_showAltAzGrid(this._showAltAzGrid),ko.get_globalSettings().set_showAltAzGridText(this._showAltAzGridText),ko.get_globalSettings().set_showPrecessionChart(this._showPrecessionChart),ko.get_globalSettings().set_showConstellationPictures(this._showConstellationPictures),ko.get_globalSettings().set_constellationsEnabled(this._constellationsEnabled),ko.get_globalSettings().set_showSkyOverlays(this._showSkyOverlays),ko.get_globalSettings().set_constellations(this._showConstellations),ko.get_globalSettings().set_showSkyNode(this._showSkyNode),ko.get_globalSettings().set_showSkyGrids(this._showSkyGrids),ko.get_globalSettings().set_constellationFiguresFilter(this._constellationFiguresFilter.clone()),ko.get_globalSettings().set_constellationBoundariesFilter(this._constellationBoundariesFilter.clone()),ko.get_globalSettings().set_constellationNamesFilter(this._constellationNamesFilter.clone()),ko.get_globalSettings().set_constellationArtFilter(this._constellationArtFilter.clone())},get_solarSystemStars:function(){return this._solarSystemStars},get_solarSystemMultiRes:function(){return this._solarSystemMultiRes},get_solarSystemMilkyWay:function(){return this._solarSystemMilkyWay},get_solarSystemCosmos:function(){return this._solarSystemCosmos},get_solarSystemOrbits:function(){return this._solarSystemOrbits},get_solarSystemOverlays:function(){return this._solarSystemOverlays},get_solarSystemLighting:function(){return this._solarSystemLighting},get_solarSystemScale:function(){return this._solarSystemScale},get_actualPlanetScale:function(){return this._actualPlanetScale},get_fovCamera:function(){return this._fovCamera},get_fovEyepiece:function(){return this._fovEyepiece},get_fovTelescope:function(){return this._fovTelescope},get_locationAltitude:function(){return this._hasLocation?this._locationAltitude:ko.get_current().get_locationAltitude()},get_locationLat:function(){return this._hasLocation?this._locationLat:ko.get_current().get_locationLat()},get_locationLng:function(){return this._hasLocation?this._locationLng:ko.get_current().get_locationLng()},get_showClouds:function(){return this._showClouds},get_showConstellationBoundries:function(){return this._showConstellationBoundries},get_showConstellationFigures:function(){return this._showConstellationFigures},get_showConstellationSelection:function(){return this._showConstellationSelection},get_showEcliptic:function(){return this._showEcliptic},get_showElevationModel:function(){return this._showElevationModel},get_showFieldOfView:function(){return this._showFieldOfView},get_showGrid:function(){return this._showGrid},get_showHorizon:function(){return this._showHorizon},get_showHorizonPanorama:function(){return this._showHorizonPanorama},get_showMoonsAsPointSource:function(){return this._showMoonsAsPointSource},get_showSolarSystem:function(){return this._showSolarSystem},get_localHorizonMode:function(){return this._localHorizonMode},get_galacticMode:function(){return this._galacticMode},get_thumbnail:function(){return null!=this._target&&null==this._thumbnail?null:this._thumbnail},set_thumbnail:function(t){return this._thumbnail=t,null!=this._owner&&this._owner.set_tourDirty(!0),t},get_overlays:function(){return this._overlays},get_musicTrack:function(){return this._musicTrack},set_musicTrack:function(t){return this._musicTrack!==t&&(this._musicTrack=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},get_voiceTrack:function(){return this._voiceTrack},set_voiceTrack:function(t){return this._voiceTrack!==t&&(this._voiceTrack=t,null!=this._owner&&this._owner.set_tourDirty(!0)),t},addOverlay:function(t){null!=t&&(t.set_owner(this),this._overlays.push(t),null!=this._owner&&this._owner.set_tourDirty(!0))},removeOverlay:function(e){t.ss.remove(this._overlays,e),null!=this._owner&&this._owner.set_tourDirty(!0)},cleanUp:function(){for(var e=t.ss.enumerate(this.get_overlays());e.moveNext();)e.current.cleanUp();null!=this._voiceTrack&&this._voiceTrack.cleanUp(),null!=this._musicTrack&&this._musicTrack.cleanUp()},sendToBack:function(e){t.ss.remove(this._overlays,e),this._overlays.splice(0,0,e),null!=this._owner&&this._owner.set_tourDirty(!0)},bringToFront:function(e){t.ss.remove(this._overlays,e),this._overlays.push(e),null!=this._owner&&this._owner.set_tourDirty(!0)},bringForward:function(e){var i=this._overlays.indexOf(e);i<this._overlays.length-1&&(t.ss.remove(this._overlays,e),this._overlays.splice(i+1,0,e)),null!=this._owner&&this._owner.set_tourDirty(!0)},sendBackward:function(e){var i=this._overlays.indexOf(e);i>0&&(t.ss.remove(this._overlays,e),this._overlays.splice(i-1,0,e)),null!=this._owner&&this._owner.set_tourDirty(!0)},getNextOverlay:function(t){if(null==t)return this._overlays.length>0?this._overlays[0]:null;var e=this._overlays.indexOf(t);return e<this._overlays.length-1?this._overlays[e+1]:this._overlays[0]},getPerviousOverlay:function(t){if(null==t)return this._overlays.length>0?this._overlays[0]:null;var e=this._overlays.indexOf(t);return e>0?this._overlays[e-1]:this._overlays[this._overlays.length-1]},getOverlayById:function(e){for(var i=t.ss.enumerate(this._overlays);i.moveNext();){var n=i.current;if(n.id===e)return n}return null},get_tourStopThumbnailFilename:function(){return t.ss.format("{0}.thumb.png",this._id)},_saveToXml:function(e,i){i&&this._thumbnail,e._writeStartElement("TourStop"),e._writeAttributeString("Id",this._id),e._writeAttributeString("Name",this._name),e._writeAttributeString("Description",this._description),e._writeAttributeString("Thumbnail",this._thumbnailString),e._writeAttributeString("Duration",a.xmlDuration(this._duration)),e._writeAttributeString("Master",this._masterSlide.toString()),e._writeAttributeString("TransitionType",s.toXml("TransitionType",this._transition)),e._writeAttributeString("TransitionTime",this._transitionTime.toString()),e._writeAttributeString("TransitionOutTime",this._transitionOutTime.toString()),e._writeAttributeString("TransitionHoldTime",this._transitionHoldTime.toString()),e._writeAttributeString("NextSlide",this._nextSlide),e._writeAttributeString("InterpolationType",s.toXml("InterpolationType",this._interpolationType)),e._writeAttributeString("HasLocation",this._hasLocation.toString()),this._hasLocation&&(e._writeAttributeString("LocationAltitude",this._locationAltitude.toString()),e._writeAttributeString("LocationLat",this._locationLat.toString()),e._writeAttributeString("LocationLng",this._locationLng.toString())),e._writeAttributeString("HasTime",this._hasTime.toString()),this._hasTime&&(e._writeAttributeString("StartTime",a.xmlDate(this._startTime)),e._writeAttributeString("EndTime",a.xmlDate(this._endTime))),e._writeAttributeString("ActualPlanetScale",this._actualPlanetScale.toString()),e._writeAttributeString("ShowClouds",this._showClouds.toString()),e._writeAttributeString("EarthCutawayView",this._earthCutawayView.toString()),e._writeAttributeString("ShowConstellationBoundries",this._showConstellationBoundries.toString()),e._writeAttributeString("ShowConstellationFigures",this._showConstellationFigures.toString()),e._writeAttributeString("ShowConstellationSelection",this._showConstellationSelection.toString()),e._writeAttributeString("ShowEcliptic",this._showEcliptic.toString()),e._writeAttributeString("EclipticColor",this._eclipticColor.save()),e._writeAttributeString("ShowElevationModel",this._showElevationModel.toString()),this._showFieldOfView=!1,e._writeAttributeString("ShowFieldOfView",this._showFieldOfView.toString()),e._writeAttributeString("ShowGrid",this._showGrid.toString()),e._writeAttributeString("ShowHorizon",this._showHorizon.toString()),e._writeAttributeString("ShowHorizonPanorama",this._showHorizonPanorama.toString()),e._writeAttributeString("ShowMoonsAsPointSource",this._showMoonsAsPointSource.toString()),e._writeAttributeString("ShowSolarSystem",this._showSolarSystem.toString()),e._writeAttributeString("FovTelescope",this._fovTelescope.toString()),e._writeAttributeString("FovEyepiece",this._fovEyepiece.toString()),e._writeAttributeString("FovCamera",this._fovCamera.toString()),e._writeAttributeString("LocalHorizonMode",this._localHorizonMode.toString()),e._writeAttributeString("GalacticMode",this._galacticMode.toString()),e._writeAttributeString("FadeInOverlays",this._fadeInOverlays.toString()),e._writeAttributeString("SolarSystemStars",this._solarSystemStars.toString()),e._writeAttributeString("SolarSystemMilkyWay",this._solarSystemMilkyWay.toString()),e._writeAttributeString("SolarSystemCosmos",this._solarSystemCosmos.toString()),e._writeAttributeString("SolarSystemCMB",this._solarSystemCMB.toString()),e._writeAttributeString("SolarSystemOrbits",this._solarSystemOrbits.toString()),e._writeAttributeString("SolarSystemMinorOrbits",this._solarSystemMinorOrbits.toString()),e._writeAttributeString("SolarSystemOverlays",this._solarSystemOverlays.toString()),e._writeAttributeString("SolarSystemLighting",this._solarSystemLighting.toString()),e._writeAttributeString("ShowISSModel",this._showISSModel.toString()),e._writeAttributeString("SolarSystemScale",this._solarSystemScale.toString()),e._writeAttributeString("MinorPlanetsFilter",this._minorPlanetsFilter.toString()),e._writeAttributeString("PlanetOrbitsFilter",this._planetOrbitsFilter.toString()),e._writeAttributeString("SolarSystemMultiRes",this._solarSystemMultiRes.toString()),e._writeAttributeString("SolarSystemMinorPlanets",this._solarSystemMinorPlanets.toString()),e._writeAttributeString("SolarSystemPlanets",this._solarSystemPlanets.toString()),e._writeAttributeString("ShowEarthSky",this._showEarthSky.toString()),e._writeAttributeString("ShowEquatorialGridText",this.get_showEquatorialGridText().toString()),e._writeAttributeString("EquatorialGridColor",this.get_equatorialGridColor().save()),e._writeAttributeString("ShowGalacticGrid",this.get_showGalacticGrid().toString()),e._writeAttributeString("ShowGalacticGridText",this.get_showGalacticGridText().toString()),e._writeAttributeString("GalacticGridColor",this.get_galacticGridColor().save()),e._writeAttributeString("ShowEclipticGrid",this.get_showEclipticGrid().toString()),e._writeAttributeString("ShowEclipticGridText",this.get_showEclipticGridText().toString()),e._writeAttributeString("EclipticGridColor",this.get_eclipticGridColor().save()),e._writeAttributeString("ShowEclipticOverviewText",this.get_showEclipticOverviewText().toString()),e._writeAttributeString("ShowAltAzGrid",this.get_showAltAzGrid().toString()),e._writeAttributeString("ShowAltAzGridText",this.get_showAltAzGridText().toString()),e._writeAttributeString("AltAzGridColor",this.get_altAzGridColor().save()),e._writeAttributeString("ShowPrecessionChart",this.get_showPrecessionChart().toString()),e._writeAttributeString("PrecessionChartColor",this.get_precessionChartColor().save()),e._writeAttributeString("ConstellationPictures",this.get_showConstellationPictures().toString()),e._writeAttributeString("ConstellationsEnabled",this.get_constellationsEnabled()),e._writeAttributeString("ShowConstellationLabels",this.get_showConstellationLabels().toString()),e._writeAttributeString("ShowSkyOverlays",this.get_showSkyOverlays().toString()),e._writeAttributeString("ShowConstellations",this.get_showConstellations().toString()),e._writeAttributeString("ShowSkyNode",this.get_showSkyNode().toString()),e._writeAttributeString("ShowSkyGrids",this.get_showSkyGrids().toString()),e._writeAttributeString("SkyOverlaysIn3d",this.get_showSkyOverlaysIn3d().toString()),e._writeAttributeString("ConstellationFiguresFilter",this._constellationFiguresFilter.toString()),e._writeAttributeString("ConstellationBoundariesFilter",this._constellationBoundariesFilter.toString()),e._writeAttributeString("ConstellationNamesFilter",this._constellationNamesFilter.toString()),e._writeAttributeString("ConstellationArtFilter",this._constellationArtFilter.toString()),this._target._saveToXml(e,"Place"),null!=this._endTarget&&this._endTarget._saveToXml(e,"EndTarget"),e._writeStartElement("Overlays");for(var n=t.ss.enumerate(this._overlays);n.moveNext();)n.current.saveToXml(e,!1);e._writeEndElement(),null!=this._musicTrack&&(e._writeStartElement("MusicTrack"),this._musicTrack.saveToXml(e,!1),e._writeEndElement()),null!=this._voiceTrack&&(e._writeStartElement("VoiceTrack"),this._voiceTrack.saveToXml(e,!1),e._writeEndElement()),this._writeLayerList(e),e._writeEndElement()},_writeLayerList:function(e){if(t.ss.keyCount(this.layers)>0){e._writeStartElement("VisibleLayers");for(var i=t.ss.enumerate(t.ss.keys(this.layers));i.moveNext();){var n=i.current,r=this.layers[n];e._writeStartElement("Layer"),e._writeAttributeString("StartOpacity",r.startOpacity.toString()),e._writeAttributeString("EndOpacity",r.endOpacity.toString());var s=r.startParams.length;e._writeAttributeString("ParamCount",s.toString());for(var a=0;a<s;a++)e._writeAttributeString(t.ss.format("StartParam{0}",a),r.startParams[a].toString()),e._writeAttributeString(t.ss.format("EndParam{0}",a),r.endParams[a].toString());e._writeValue(r.id.toString()),e._writeEndElement()}e._writeEndElement()}},_addFilesToCabinet:function(e,i){if(null!=this._thumbnail){var n=t.ss.format("{0}.thumb.png",this._id),r=this._owner.getFileBlob(n);e.addFile(this._owner.get_workingDirectory()+n,r)}i||(null!=this._musicTrack&&this._musicTrack.addFilesToCabinet(e),null!=this._voiceTrack&&this._voiceTrack.addFilesToCabinet(e));for(var s=t.ss.enumerate(this._overlays);s.moveNext();)s.current.addFilesToCabinet(e)},getNextDefaultName:function(e){for(var i=1,n=t.ss.enumerate(this._overlays);n.moveNext();){var r=n.current;if(t.ss.startsWith(r.get_name(),e)){var s=0;try{s=parseInt(r.get_name().substr(e.length))}catch(t){}s>=i&&(i=s+1)}}return t.ss.format("{0} {1}",e,i)},_loadLayerList:function(e){for(var i=t.ss.enumerate(e.childNodes);i.moveNext();){var n=i.current;if("Layer"===n.nodeName){var r=new Fh,s=n.innerHTML;r.id=Ii.fromString(s),r.startOpacity=parseFloat(n.attributes.getNamedItem("StartOpacity").nodeValue),r.endOpacity=parseFloat(n.attributes.getNamedItem("EndOpacity").nodeValue);var a=0;null!=n.attributes.getNamedItem("ParamCount")&&(a=parseInt(n.attributes.getNamedItem("ParamCount").nodeValue)),r.startParams=new Array(a),r.endParams=new Array(a),r.frameParams=new Array(a);for(var o=0;o<a;o++)r.startParams[o]=parseFloat(n.attributes.getNamedItem(t.ss.format("StartParam{0}",o)).nodeValue),r.endParams[o]=parseFloat(n.attributes.getNamedItem(t.ss.format("EndParam{0}",o)).nodeValue),r.frameParams[o]=r.startParams[o];this.layers[r.id]=r}}},_updateLayerOpacity:function(){this.get_keyFramed()&&this.updateTweenPosition()},get_showEquatorialGridText:function(){return this._showEquatorialGridText},set_showEquatorialGridText:function(t){return this._showEquatorialGridText=t,t},get_showGalacticGrid:function(){return this._showGalacticGrid},set_showGalacticGrid:function(t){return this._showGalacticGrid=t,t},get_showGalacticGridText:function(){return this._showGalacticGridText},set_showGalacticGridText:function(t){return this._showGalacticGridText=t,t},get_showEclipticGrid:function(){return this._showEclipticGrid},set_showEclipticGrid:function(t){return this._showEclipticGrid=t,t},get_showEclipticGridText:function(){return this._showEclipticGridText},set_showEclipticGridText:function(t){return this._showEclipticGridText=t,t},get_showEclipticOverviewText:function(){return this._showEclipticOverviewText},set_showEclipticOverviewText:function(t){return this._showEclipticOverviewText=t,t},get_showAltAzGrid:function(){return this._showAltAzGrid},set_showAltAzGrid:function(t){return this._showAltAzGrid=t,t},get_showAltAzGridText:function(){return this._showAltAzGridText},set_showAltAzGridText:function(t){return this._showAltAzGridText=t,t},get_showPrecessionChart:function(){return this._showPrecessionChart},set_showPrecessionChart:function(t){return this._showPrecessionChart=t,t},get_showConstellationPictures:function(){return this._showConstellationPictures},set_showConstellationPictures:function(t){return this._showConstellationPictures=t,t},get_showConstellationLabels:function(){return this._showConstellationLabels},set_showConstellationLabels:function(t){return this._showConstellationLabels=t,t},get_solarSystemCMB:function(){return this._solarSystemCMB},set_solarSystemCMB:function(t){return this._solarSystemCMB=t,t},get_solarSystemMinorPlanets:function(){return this._solarSystemMinorPlanets},set_solarSystemMinorPlanets:function(t){return this._solarSystemMinorPlanets=t,t},get_solarSystemPlanets:function(){return this._solarSystemPlanets},set_solarSystemPlanets:function(t){return this._solarSystemPlanets=t,t},get_showEarthSky:function(){return this._showEarthSky},set_showEarthSky:function(t){return this._showEarthSky=t,t},get_solarSystemMinorOrbits:function(){return this._solarSystemMinorOrbits},set_solarSystemMinorOrbits:function(t){return this._solarSystemMinorOrbits=t,t},get_constellationsEnabled:function(){return this._constellationsEnabled},set_constellationsEnabled:function(t){return this._constellationsEnabled=t,t},get_constellationFiguresFilter:function(){return this._constellationFiguresFilter},set_constellationFiguresFilter:function(t){return this._constellationFiguresFilter=t,t},get_constellationBoundariesFilter:function(){return this._constellationBoundariesFilter},set_constellationBoundariesFilter:function(t){return this._constellationBoundariesFilter=t,t},get_constellationNamesFilter:function(){return this._constellationNamesFilter},set_constellationNamesFilter:function(t){return this._constellationNamesFilter=t,t},get_constellationArtFilter:function(){return this._constellationArtFilter},set_constellationArtFilter:function(t){return this._constellationArtFilter=t,t},get_showSkyOverlays:function(){return this._showSkyOverlays},set_showSkyOverlays:function(t){return this._showSkyOverlays=t,t},get_showConstellations:function(){return this._showConstellations},set_showConstellations:function(t){return this._showConstellations=t,t},get_showSkyNode:function(){return this._showSkyNode},set_showSkyNode:function(t){return this._showSkyNode=t,t},get_showSkyGrids:function(){return this._showSkyGrids},set_showSkyGrids:function(t){return this._showSkyGrids=t,t},get_showSkyOverlaysIn3d:function(){return this._showSkyOverlaysIn3d},set_showSkyOverlaysIn3d:function(t){return this._showSkyOverlaysIn3d=t,t},get_earthCutawayView:function(){return this._earthCutawayView},set_earthCutawayView:function(t){return this._earthCutawayView=t,t},get_showISSModel:function(){return this._showISSModel},set_showISSModel:function(t){return this._showISSModel=t,t},get_milkyWayModel:function(){return this._milkyWayModel},set_milkyWayModel:function(t){return this._milkyWayModel=t,t},get_minorPlanetsFilter:function(){return this._minorPlanetsFilter},set_minorPlanetsFilter:function(t){return this._minorPlanetsFilter=t,t},get_planetOrbitsFilter:function(){return this._planetOrbitsFilter},set_planetOrbitsFilter:function(t){return this._planetOrbitsFilter=t,t},getSetting:function(t){return 17===t?new Io(!0,this.faderOpacity,!!this.faderOpacity,null):new Io(!1,1,!1,null)},get_eclipticGridColor:function(){return this._eclipticGridColor},set_eclipticGridColor:function(t){return this._eclipticGridColor=t,t},get_galacticGridColor:function(){return this._galacticGridColor},set_galacticGridColor:function(t){return this._galacticGridColor=t,t},get_altAzGridColor:function(){return this._altAzGridColor},set_altAzGridColor:function(t){return this._altAzGridColor=t,t},get_precessionChartColor:function(){return this._precessionChartColor},set_precessionChartColor:function(t){return this._precessionChartColor=t,t},get_eclipticColor:function(){return this._eclipticColor},set_eclipticColor:function(t){return this._eclipticColor=t,t},get_equatorialGridColor:function(){return this._equatorialGridColor},set_equatorialGridColor:function(t){return this._equatorialGridColor=t,t},get_constellationLabelsHeight:function(){return this._constellationLabelsHeight},set_constellationLabelsHeight:function(t){return this._constellationLabelsHeight=t,t}};function Fh(){this.id=Ii.newGuid(),this.startOpacity=1,this.endOpacity=1,this.frameOpacity=1,this.startParams=new Array(0),this.endParams=new Array(0),this.frameParams=new Array(0)}function Nh(t,e){this._undoXml="",this._redoXml="",this._currentIndex=0,this._actionText="",this._targetTour=null,this._currentIndex=e.get_currentTourstopIndex(),this._actionText=t,this._targetTour=e,this._undoXml=Eh.getXmlText(e.get_currentTourStop()),this._targetTour.set_tourDirty(!0)}n("TourStop",[Eh,Dh,null,fa]),n("LayerInfo",[Fh,{},null]);var $h={get_actionText:function(){return this._actionText},set_actionText:function(t){return this._actionText=t,t},undo:function(){var e=this._targetTour.get_tourStops()[this._currentIndex],i=(new DOMParser).parseFromString(this._undoXml,"text/xml"),n=a.selectSingleNode(i,"TourStop");this._targetTour.get_tourStops()[this._currentIndex]=Eh._fromXml(this._targetTour,n),this._targetTour.set_currentTourstopIndex(this._currentIndex),t.ss.emptyString(this._redoXml)&&(this._redoXml=Eh.getXmlText(e)),this._targetTour.set_tourDirty(!0)},redo:function(){var t=(new DOMParser).parseFromString(this._redoXml,"text/xml"),e=a.selectSingleNode(t,"TourStop");this._targetTour.get_tourStops()[this._currentIndex]=Eh._fromXml(this._targetTour,e),this._targetTour.set_currentTourstopIndex(this._currentIndex),this._targetTour.set_tourDirty(!0)},toString:function(){return this._actionText}};function zh(){}function Bh(){}function Uh(t,e){this._currentIndex=0,this._actionText="",this._targetTour=null,this._undoList=[];for(var i=0;i<e.get_tourStops().length;i++)this._undoList.push(e.get_tourStops()[i]);this._currentIndex=e.get_currentTourstopIndex(),this._actionText=t,this._targetTour=e,this._targetTour.set_tourDirty(!0)}function Vh(t,e){this._actionText="",this._targetTour=null,this._undoDomeMode=!1,this._undoLevel=0,this._redoDomeMode=!1,this._redoLevel=0,this._undoTitle=e.get_title(),this._undoAuthor=e.get_author(),this._undoAuthorEmail=e.get_authorEmail(),this._undoDescription=e.get_description(),this._undoAuthorImage=e.get_authorImage(),this._undoOrganizationUrl=e.get_organizationUrl(),this._undoOrgName=e.get_orgName(),this._undoKeywords=e.get_keywords(),this._undoTaxonomy=e.get_taxonomy(),this._undoLevel=e.get_level(),this._actionText=t,this._targetTour=e,this._targetTour.set_tourDirty(!0)}function Oh(){this.selection=new kh,this._contextMenu=new Gs,this._tour=null,this._mouseDown=!1,this._selectionAction=11,this._needUndoFrame=!1,this._contextPoint=new vn,this._dragCopying=!1,this._brokeThreshold=!1,this.nextSlideCallback=null,this.clipboardData="",this.clipboardType="",this.editTextCallback=null,this._defaultColor=Xi.get_white()}n("UndoTourStopChange",[Nh,$h,null,ma]),zh._undoStack=new t.ss.Stack,zh._redoStack=new t.ss.Stack,zh.clear=function(){zh._undoStack=new t.ss.Stack,zh._redoStack=new t.ss.Stack},zh.push=function(e){zh._undoStack.push(e),zh._redoStack=new t.ss.Stack},zh.peekActionString=function(){return zh._undoStack.count>0?zh._undoStack.peek().toString():Pi.getLocalizedText(551,"Nothing to Undo")},zh.peekRedoActionString=function(){return zh._redoStack.count>0?zh._redoStack.peek().toString():""},zh.peekAction=function(){return zh._undoStack.count>0},zh.peekRedoAction=function(){return zh._redoStack.count>0},zh.stepBack=function(){var t=zh._undoStack.pop();t.undo(),zh._redoStack.push(t)},zh.stepForward=function(){var t=zh._redoStack.pop();t.redo(),zh._undoStack.push(t)},n("Undo",[zh,{},null]),n("UndoStep",[Bh,{undo:function(){},redo:function(){},toString:function(){return Pi.getLocalizedText(551,"Nothing to Undo")}},null,ma]),n("UndoTourSlidelistChange",[Uh,{get_actionText:function(){return this._actionText},set_actionText:function(t){return this._actionText=t,t},undo:function(){this._redoList=this._targetTour.get_tourStops(),this._targetTour.set_tourStops(this._undoList),this._targetTour.set_currentTourstopIndex(this._currentIndex),this._targetTour.set_tourDirty(!0)},redo:function(){this._undoList=this._targetTour.get_tourStops(),this._targetTour.set_tourStops(this._redoList),this._targetTour.set_currentTourstopIndex(this._currentIndex),this._targetTour.set_tourDirty(!0)},toString:function(){return this._actionText}},null,ma]),n("UndoTourPropertiesChange",[Vh,{get_actionText:function(){return this._actionText},set_actionText:function(t){return this._actionText=t,t},undo:function(){this._redoTitle=this._targetTour.get_title(),this._redoAuthor=this._targetTour.get_author(),this._redoAuthorEmail=this._targetTour.get_authorEmail(),this._redoDescription=this._targetTour.get_description(),this._redoAuthorImage=this._targetTour.get_authorImage(),this._redoOrganizationUrl=this._targetTour.get_organizationUrl(),this._redoOrgName=this._targetTour.get_orgName(),this._redoKeywords=this._targetTour.get_keywords(),this._redoTaxonomy=this._targetTour.get_taxonomy(),this._redoLevel=this._targetTour.get_level(),this._targetTour.set_title(this._undoTitle),this._targetTour.set_author(this._undoAuthor),this._targetTour.set_authorEmail(this._undoAuthorEmail),this._targetTour.set_description(this._undoDescription),this._targetTour.set_authorImage(this._undoAuthorImage),this._targetTour.set_organizationUrl(this._undoOrganizationUrl),this._targetTour.set_orgName(this._undoOrgName),this._targetTour.set_keywords(this._undoKeywords),this._targetTour.set_taxonomy(this._undoTaxonomy),this._targetTour.set_level(this._undoLevel),this._targetTour.set_tourDirty(!0)},redo:function(){this._targetTour.set_title(this._redoTitle),this._targetTour.set_author(this._redoAuthor),this._targetTour.set_authorEmail(this._redoAuthorEmail),this._targetTour.set_description(this._redoDescription),this._targetTour.set_authorImage(this._redoAuthorImage),this._targetTour.set_organizationUrl(this._redoOrganizationUrl),this._targetTour.set_orgName(this._redoOrgName),this._targetTour.set_keywords(this._redoKeywords),this._targetTour.set_taxonomy(this._redoTaxonomy),this._targetTour.set_level(this._redoLevel),this._targetTour.set_tourDirty(!0)},toString:function(){return this._actionText}},null,ma]),Oh.capturing=!1,Oh.currentEditor=null;var Gh={render:function(e){if(e.setupMatricesOverlays(),null!=this._tour&&null!=this._tour.get_currentTourStop()){for(var i=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());i.moveNext();){var n=i.current;n.get_animate()&&this.get_tour().get_currentTourStop().get_keyFramed()?n.set_tweenFactor(this._tour.get_currentTourStop().get_tweenPosition()):this.get_tour().get_currentTourStop().get_keyFramed()||n.set_tweenFactor(this._tour.get_currentTourStop().get_tweenPosition()<.5?0:1),n.draw3D(e,!0)}this.selection.draw3D(e,1),null!=Oh.currentEditor&&Oh.currentEditor.render(e),ko.tourSettings=null}},get_tour:function(){return this._tour},set_tour:function(t){return this._tour=t,t},close:function(){null!=this._tour&&(this._tour=null,this.set_focus(null))},clearSelection:function(){this.selection.clearSelection(),Xh._updateOverlayListSelection(this.selection),this.set_focus(null)},get_focus:function(){return this.selection.get_focus()},set_focus:function(t){return this.selection.set_focus(t),t},pointToView:function(t){var e=an.height,i=an.width,n=an.width/an.height*1116,r=t.x/i*n-(n-1920)/2,s=t.y/e*1116;return vn.create(r,s)},mouseDown:function(e,i){this._brokeThreshold=!1,this._needUndoFrame=!0;var n=this.pointToView(vn.create(i.offsetX,i.offsetY));if(null==this._tour||null==this._tour.get_currentTourStop())return this._needUndoFrame=!1,!1;if(null!=Oh.currentEditor&&Oh.currentEditor.mouseDown(e,i))return!0;if(null!=this.get_focus()){if(this.selection.get_multiSelect())for(var r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();){var s=r.current;if(s.hitTest(n))return this._selectionAction=9,this._mouseDown=!0,this._pointDown=n,this.set_focus(s),i.ctrlKey&&(this._dragCopying=!0),!0}else if(this.get_focus().hitTest(n))return this._selectionAction=9,this._mouseDown=!0,this._pointDown=n,i.ctrlKey&&(this._dragCopying=!0),!0;var a=this.selection.hitTest(n);if(11!==a)return this._selectionAction=a,this._mouseDown=!0,this._pointDown=8===a?n:this.selection.pointToSelectionSpace(n),!0}for(var o=this._tour.get_currentTourStop().get_overlays().length-1;o>=0;o--)if(this._tour.get_currentTourStop().get_overlays()[o].hitTest(n))return this._selectionAction=9,this.set_focus(this._tour.get_currentTourStop().get_overlays()[o]),i.ctrlKey||i.shiftKey?this.selection.addSelection(this.get_focus()):this.selection.setSelection(this.get_focus()),Xh._updateOverlayListSelection(this.selection),this._mouseDown=!0,this._pointDown=n,!0;return this.set_focus(null),this.clearSelection(),this._needUndoFrame=!1,!1},mouseUp:function(t,e){return this._brokeThreshold=!1,!(null==Oh.currentEditor||!Oh.currentEditor.mouseUp(t,e))||(this._contextPoint=vn.create(e.offsetX,e.offsetY),this._mouseDown?(this._mouseDown=!1,2===e.button&&null!=this.get_focus()&&this.showSelectionContextMenu(vn.create(e.offsetX,e.offsetY)),!0):2===e.button&&(null==this.get_focus()&&this._showNoSelectionContextMenu(vn.create(e.offsetX,e.offsetY)),!0))},mouseMove:function(e,i){if(null!=Oh.currentEditor&&Oh.currentEditor.mouseMove(e,i))return!0;var n=this.pointToView(vn.create(i.offsetX,i.offsetY));if(this._mouseDown&&null!=this.get_focus()){var r,s,a=null,o=Pi.getLocalizedText(502,"Edit");if(this._needUndoFrame&&(a=new Nh(Pi.getLocalizedText(502,"Edit"),this._tour)),9!==this._selectionAction&&8!==this._selectionAction){var l=this.selection.pointToSelectionSpace(n);r=l.x-this._pointDown.x,s=l.y-this._pointDown.y,this._pointDown=l}else{if(r=n.x-this._pointDown.x,s=n.y-this._pointDown.y,9===this._selectionAction&&!this._brokeThreshold){if(!(Math.abs(r)>3||Math.abs(s)>3))return!0;this._brokeThreshold=!0}this._pointDown=n}if(this._dragCopying)if(this.selection.get_multiSelect()){var h=this.selection.selectionSet;this.clearSelection();for(var u=t.ss.enumerate(h);u.moveNext();){var c=u.current;(_=this.addOverlay(c)).set_x(c.get_x()),_.set_y(c.get_y()),this.set_focus(_),this.selection.addSelection(this.get_focus())}Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection),this._dragCopying=!1}else{var _;(_=this.addOverlay(this.get_focus())).set_x(this.get_focus().get_x()),_.set_y(this.get_focus().get_y()),this.set_focus(_),this.selection.setSelection(this.get_focus()),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection),this._dragCopying=!1}var d=this.get_focus().get_width()/this.get_focus().get_height(),g=vn.create(this.get_focus().get_x(),this.get_focus().get_y());if(i.ctrlKey)switch(o=Pi.getLocalizedText(537,"Resize"),this._selectionAction){case 0:case 6:this.get_focus().set_width(Math.max(2,this.get_focus().get_width()-2*r)),this.get_focus().set_height(Math.max(2,this.get_focus().get_height()-r/d*2));break;case 1:this.get_focus().set_height(Math.max(2,this.get_focus().get_height()-2*s));break;case 2:case 4:this.get_focus().set_width(Math.max(2,this.get_focus().get_width()+2*r)),this.get_focus().set_height(Math.max(2,this.get_focus().get_height()+r/d*2));break;case 3:this.get_focus().set_width(Math.max(2,this.get_focus().get_width()+2*r));break;case 5:this.get_focus().set_height(Math.max(2,this.get_focus().get_height()+2*s));break;case 7:this.get_focus().set_width(Math.max(2,this.get_focus().get_width()-2*r));break;case 8:o=Pi.getLocalizedText(538,"Rotate"),this.get_focus().set_rotationAngle(this.get_focus().get_rotationAngle()+r/10);break;case 9:o=Pi.getLocalizedText(539,"Drag Copy"),g.x+=r,g.y+=s}else switch(8!==this._selectionAction&&9!==this._selectionAction&&(r>this.get_focus().get_width()-2&&(r=0),s>this.get_focus().get_height()-2&&(s=0)),o=Pi.getLocalizedText(537,"Resize"),this._selectionAction){case 0:this.get_focus().set_width(this.get_focus().get_width()-r),this.get_focus().set_height(this.get_focus().get_height()-r/d),g.x+=r/2,g.y+=r/d/2;break;case 1:this.get_focus().set_height(this.get_focus().get_height()-s),g.y+=s/2;break;case 2:this.get_focus().set_width(this.get_focus().get_width()+r),this.get_focus().set_height(this.get_focus().get_height()+r/d),g.x+=r/2,g.y-=r/d/2;break;case 3:this.get_focus().set_width(this.get_focus().get_width()+r),g.x+=r/2;break;case 4:this.get_focus().set_width(this.get_focus().get_width()+r),this.get_focus().set_height(this.get_focus().get_height()+r/d),g.x+=r/2,g.y+=r/d/2;break;case 5:this.get_focus().set_height(this.get_focus().get_height()+s),g.y+=s/2;break;case 6:this.get_focus().set_width(this.get_focus().get_width()-r),this.get_focus().set_height(this.get_focus().get_height()-r/d),g.x+=r/2,g.y-=r/d/2;break;case 7:this.get_focus().set_width(this.get_focus().get_width()-r),g.x+=r/2;break;case 8:o=Pi.getLocalizedText(538,"Rotate"),this.get_focus().set_rotationAngle(this.get_focus().get_rotationAngle()+r);break;case 9:o=Pi.getLocalizedText(540,"Move"),g.x+=r,g.y+=s}if(9!==this._selectionAction&&8!==this._selectionAction&&(g=this.selection.pointToScreenSpace(g)),this.selection.get_multiSelect())for(var f=t.ss.enumerate(this.selection.selectionSet);f.moveNext();)(c=f.current).set_x(c.get_x()+r),c.set_y(c.get_y()+s);else this.get_focus().set_x(g.x),this.get_focus().set_y(g.y);this._needUndoFrame&&(this._needUndoFrame=!1,a.set_actionText(o),zh.push(a))}else if(null!=this.get_focus()){if(this.get_focus().hitTest(n))return Ri.set_current(Ei.get_sizeAll()),!1;var m=this.selection.hitTest(n);if(11===m)return!1;switch(m){case 0:case 4:Ri.set_current(Ei.get_sizeNWSE());break;case 1:case 5:Ri.set_current(Ei.get_sizeNS());break;case 2:case 6:Ri.set_current(Ei.get_sizeNESW());break;case 3:case 7:case 8:Ri.set_current(Ei.get_sizeWE())}}return!1},_showNoSelectionContextMenu:function(e){if(null!=this._contextMenu&&this._contextMenu._dispose(),null!=this._tour.get_currentTourStop()){this._contextMenu=new Gs;var i=Xs.create(Pi.getLocalizedText(425,"Paste"));i.enabled="WorldWideTelescope.Overlay"===this.clipboardType,i.click=t.ss.bind("_pasteMenu_Click",this),this._contextMenu.items.push(i),this._contextMenu._show(e)}},_addOpenRectangle_Click:function(t,e){this.addShape("",6)},_addStar_Click:function(t,e){this.addShape("",2)},_insertShapeCircle_Click:function(t,e){this.addShape("",0)},_insertShapeRectangle_Click:function(t,e){this.addShape("",1)},_insertShapeLine_Click:function(t,e){this.addShape("",5)},_insertDonut_Click:function(t,e){this.addShape("",3)},_addArrow_Click:function(t,e){this.addShape("",4)},showSelectionContextMenu:function(e){if(null!=this.get_focus()){var i=this.selection.get_multiSelect();null!=this._contextMenu&&this._contextMenu._dispose(),this._contextMenu=new Gs;var n=Xs.create(Pi.getLocalizedText(427,"Cut")),r=Xs.create(Pi.getLocalizedText(428,"Copy")),s=Xs.create(Pi.getLocalizedText(425,"Paste")),a=Xs.create(Pi.getLocalizedText(167,"Delete")),o=new Hs,l=new Hs,h=new Hs,u=Xs.create(Pi.getLocalizedText(452,"Bring to Front")),c=Xs.create(Pi.getLocalizedText(453,"Send to Back")),_=Xs.create(Pi.getLocalizedText(454,"Bring Forward")),d=Xs.create(Pi.getLocalizedText(455,"Send Backward")),g=Xs.create(Pi.getLocalizedText(20,"Properties")),f=Xs.create(Pi.getLocalizedText(502,"Edit")),m=Xs.create(Pi.getLocalizedText(587,"Hyperlink")),p=this.get_focus().get_linkID();switch(this.get_focus().get_linkID()){case"":case null:p=" ("+Pi.getLocalizedText(609,"No Link")+")";break;case"Next":p=" ("+Pi.getLocalizedText(610,"Next Slide")+")";break;case"Return":p=" ("+Pi.getLocalizedText(602,"Return to Caller")+")";break;default:var w=this.get_tour().getTourStopIndexByID(this.get_focus().get_linkID());w>-1&&(p=t.ss.emptyString(this._tour.get_tourStops()[w].get_description())?t.ss.format(" ("+Pi.getLocalizedText(1340,"Slide")+" {0})",w):" ("+this._tour.get_tourStops()[w].get_description()+")")}var b=Xs.create(Pi.getLocalizedText(588,"Animate")),v=Xs.create(Pi.getLocalizedText(589,"Link to Slide")+p),y=Xs.create(Pi.getLocalizedText(458,"Color/Opacity")),S=Xs.create(Pi.getLocalizedText(630,"Flipbook Properties")),x=Xs.create(Pi.getLocalizedText(1029,"Animation Tween Type")),T=Xs.create(Pi.getLocalizedText(1030,"Linear")),M=Xs.create(Pi.getLocalizedText(1031,"Ease In/Out")),C=Xs.create(Pi.getLocalizedText(1032,"Ease In")),A=Xs.create(Pi.getLocalizedText(1033,"Ease Out")),L=Xs.create(Pi.getLocalizedText(1034,"Exponential")),I=Xs.create(Pi.getLocalizedText(1035,"Slide Default")),k=Xs.create(Pi.getLocalizedText(790,"Align")),P=Xs.create(Pi.getLocalizedText(1333,"Top")),R=Xs.create(Pi.getLocalizedText(1334,"Bottom")),E=Xs.create(Pi.getLocalizedText(1335,"Left")),D=Xs.create(Pi.getLocalizedText(1336,"Right")),F=Xs.create(Pi.getLocalizedText(1337,"Horizontal")),N=Xs.create(Pi.getLocalizedText(1338,"Vertical")),$=Xs.create(Pi.getLocalizedText(1339,"Centered"));switch(k.dropDownItems.push(P),k.dropDownItems.push(R),k.dropDownItems.push(E),k.dropDownItems.push(D),k.dropDownItems.push(F),k.dropDownItems.push(N),k.dropDownItems.push($),T.tag=0,M.tag=3,C.tag=1,A.tag=2,L.tag=4,I.tag=5,T.click=t.ss.bind("_interpolation_Click",this),M.click=t.ss.bind("_interpolation_Click",this),C.click=t.ss.bind("_interpolation_Click",this),A.click=t.ss.bind("_interpolation_Click",this),L.click=t.ss.bind("_interpolation_Click",this),I.click=t.ss.bind("_interpolation_Click",this),this.get_focus().get_interpolationType()){case 0:T.checked=!0;break;case 1:C.checked=!0;break;case 2:A.checked=!0;break;case 3:M.checked=!0;break;case 4:L.checked=!0;break;case 5:I.checked=!0}x.dropDownItems.push(I),x.dropDownItems.push(T),x.dropDownItems.push(M),x.dropDownItems.push(C),x.dropDownItems.push(A),x.dropDownItems.push(L),n.click=t.ss.bind("_cutMenu_Click",this),r.click=t.ss.bind("_copyMenu_Click",this),a.click=t.ss.bind("_deleteMenu_Click",this),u.click=t.ss.bind("_bringToFront_Click",this),c.click=t.ss.bind("_sendToBack_Click",this),d.click=t.ss.bind("_sendBackward_Click",this),_.click=t.ss.bind("_bringForward_Click",this),g.click=t.ss.bind("_properties_Click",this),f.click=t.ss.bind("_editText_Click",this),m.click=t.ss.bind("_url_Click",this),y.click=t.ss.bind("_pickColor_Click",this),s.click=t.ss.bind("_pasteMenu_Click",this),b.click=t.ss.bind("_animateMenu_Click",this),S.click=t.ss.bind("_flipbookProperties_Click",this),v.click=t.ss.bind("_linkID_Click",this),P.click=t.ss.bind("_alignTop_Click",this),R.click=t.ss.bind("_alignBottom_Click",this),E.click=t.ss.bind("_alignLeft_Click",this),D.click=t.ss.bind("_alignRight_Click",this),F.click=t.ss.bind("_alignHorizon_Click",this),N.click=t.ss.bind("_alignVertical_Click",this),$.click=t.ss.bind("_alignCenter_Click",this),this._contextMenu.items.push(n),this._contextMenu.items.push(r),this._contextMenu.items.push(s),this._contextMenu.items.push(a),this._contextMenu.items.push(o),this._contextMenu.items.push(u),this._contextMenu.items.push(c),this._contextMenu.items.push(_),this._contextMenu.items.push(d),this._contextMenu.items.push(k),this._contextMenu.items.push(l),s.enabled=!1,this._contextMenu.items.push(y),this._contextMenu.items.push(m),this._contextMenu.items.push(v),this._contextMenu.items.push(b),this._contextMenu.items.push(h),this._contextMenu.items.push(S),b.checked=this.get_focus().get_animate(),this._contextMenu.items.push(x),x.enabled=this.get_focus().get_animate(),S.visible=t.ss.canCast(this.get_focus(),Ah),h.visible=t.ss.canCast(this.get_focus(),Ah),i?(m.visible=!1,v.visible=!1,g.visible=!1,S.visible=!1,_.visible=!1,d.visible=!1):k.visible=!1,this._contextMenu.items.push(g),null!=this.get_focus()&&t.ss.typeOf(this.get_focus())===yh&&this._contextMenu.items.push(f),this._contextMenu._show(e)}},_editText_Click:function(e,i){null!=this.get_focus()&&t.ss.typeOf(this.get_focus())===yh&&this._editText()},_alignVertical_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1036,"Vertical Align"),this._tour));for(var n=this.get_focus().get_x(),r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();)r.current.set_x(n)}},_alignHorizon_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1037,"Horizontal Align"),this._tour));for(var n=this.get_focus().get_y(),r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();)r.current.set_y(n)}},_alignCenter_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1038,"Align Centers"),this._tour));for(var n=this.get_focus().get_y(),r=this.get_focus().get_x(),s=t.ss.enumerate(this.selection.selectionSet);s.moveNext();){var a=s.current;a.set_y(n),a.set_x(r)}}},_alignRight_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1040,"Align Right"),this._tour));for(var n=this.get_focus().get_x()+this.get_focus().get_width()/2,r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();){var s=r.current;s.set_x(n-s.get_width()/2)}}},_alignLeft_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1041,"Align Left"),this._tour));for(var n=this.get_focus().get_x()-this.get_focus().get_width()/2,r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();){var s=r.current;s.set_x(n+s.get_width()/2)}}},_alignBottom_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1042,"Align Bottoms"),this._tour));for(var n=this.get_focus().get_y()+this.get_focus().get_height()/2,r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();){var s=r.current;s.set_y(n-s.get_height()/2)}}},_alignTop_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(1039,"Align Tops"),this._tour));for(var n=this.get_focus().get_y()-this.get_focus().get_height()/2,r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();){var s=r.current;s.set_y(n+s.get_height()/2)}}},_interpolation_Click:function(e,i){var n=e;if(null!=this.get_focus())for(var r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();)r.current.set_interpolationType(n.tag)},_linkSlideChosen:function(){this.selectDialog.get_OK()&&this.get_focus().set_linkID(this.selectDialog.get_id())},_linkID_Click:function(e,i){this.selectDialog=new Fi(this.get_focus().get_linkID()),this.nextSlideCallback(this.selectDialog,t.ss.bind("_linkSlideChosen",this))},_flipbookProperties_Click:function(t,e){},_animateMenu_Click:function(e,i){if(null!=this.get_focus()){zh.push(new Nh(Pi.getLocalizedText(588,"Animate"),this._tour));for(var n=!this.get_focus().get_animate(),r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();)r.current.set_animate(n)}},_url_Click:function(t,e){var i=this;if(null!=this.get_focus()){var n=new qs(Pi.getLocalizedText(541,"Edit Hyperlink"),Pi.getLocalizedText(542,"Url"),this.get_focus().get_url(),2048);n.show(Ri.get_position(),(function(){zh.push(new Nh(Pi.getLocalizedText(541,"Edit Hyperlink"),i._tour)),i.get_focus().set_url(n.text)}))}},_pickColor_Click:function(e,i){var n=this,r=new ml;r.color=this.get_focus().get_color(),r.callBack=function(){zh.push(new Nh(Pi.getLocalizedText(543,"Edit Color"),n._tour));for(var e=t.ss.enumerate(n.selection.selectionSet);e.moveNext();)e.current.set_color(r.color)},r.show(i)},_volume_Click:function(t,e){var i=new Ni;i.volume=this.get_focus().get_volume(),i.showDialog(),this.get_focus().set_volume(i.volume)},_deleteMenu_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(167,"Delete"),this._tour));for(var n=t.ss.enumerate(this.selection.selectionSet);n.moveNext();){var r=n.current;this._tour.get_currentTourStop().removeOverlay(r)}this.set_focus(null),this.clearSelection(),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}},_properties_Click:function(t,e){null==this._tour||this._tour.get_currentTourStop(),zh.push(new Nh(Pi.getLocalizedText(549,"Properties Edit"),this._tour));var i=new zi;i.overlay=this.get_focus(),i.showDialog(),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)},_bringForward_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(454,"Bring Forward"),this._tour));for(var n=t.ss.enumerate(this._getSortedSelection(!1));n.moveNext();){var r=n.current;this._tour.get_currentTourStop().bringForward(r)}Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}},_sendBackward_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(455,"Send Backward"),this._tour));for(var n=t.ss.enumerate(this._getSortedSelection(!0));n.moveNext();){var r=n.current;this._tour.get_currentTourStop().sendBackward(r)}Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}},_sendToBack_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(453,"Send to Back"),this._tour));for(var n=t.ss.enumerate(this._getSortedSelection(!0));n.moveNext();){var r=n.current;this._tour.get_currentTourStop().sendToBack(r)}Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}},_bringToFront_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(452,"Bring to Front"),this._tour));for(var n=t.ss.enumerate(this._getSortedSelection(!1));n.moveNext();){var r=n.current;this._tour.get_currentTourStop().bringToFront(r)}Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}},_getSortedSelection:function(e){for(var i=[],n=t.ss.enumerate(this.selection.selectionSet);n.moveNext();){var r=n.current;i.push(r)}return e?i.sort((function(t,e){return-a.compare(t.get_zOrder(),e.get_zOrder())})):i.sort((function(t,e){return a.compare(t.get_zOrder(),e.get_zOrder())})),i},_copyMenu_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){var n=new Ks;n._writeProcessingInstruction("xml","version='1.0' encoding='UTF-8'"),n._writeStartElement("Overlays");for(var r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();)r.current.saveToXml(n,!0);n._writeEndElement(),this.clipboardData=n.body,this.clipboardType="WorldWideTelescope.Overlay"}},_cutMenu_Click:function(e,i){if(null!=this._tour&&null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(427,"Cut"),this._tour)),this._copyMenu_Click(e,i);for(var n=t.ss.enumerate(this.selection.selectionSet);n.moveNext();){var r=n.current;this._tour.get_currentTourStop().removeOverlay(r)}this.set_focus(null),this.clearSelection(),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}},_pasteMenu_Click:function(e,i){if(zh.push(new Uh(Pi.getLocalizedText(544,"Paste Object"),this._tour)),"WorldWideTelescope.Overlay"===this.clipboardType){var n=(new DOMParser).parseFromString(this.clipboardData,"text/xml");this.clearSelection();for(var r=a.selectSingleNode(n,"Overlays"),s=t.ss.enumerate(r.childNodes);s.moveNext();){var o=s.current;if("Overlay"===o.nodeName){for(var l=ph._fromXml(this._tour.get_currentTourStop(),o),h=!1,u=0,c=0,_=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());_.moveNext();){var d=_.current;d.id===l.id&&t.ss.typeOf(d)===t.ss.typeOf(l)&&(h=!0,(c<d.get_y()||u<d.get_x())&&(u=d.get_x(),c=d.get_y()))}h&&(l.set_x(u+20),l.set_y(c+20)),this._tour.get_currentTourStop().addOverlay(l),this.set_focus(l),this.selection.addSelection(this.get_focus()),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection)}}}},mouseClick:function(t,e){return!(null==Oh.currentEditor||!Oh.currentEditor.mouseClick(t,e))},click:function(t,e){return!(null==Oh.currentEditor||!Oh.currentEditor.click(t,e))},mouseDoubleClick:function(e,i){return!(null==Oh.currentEditor||!Oh.currentEditor.mouseDoubleClick(e,i))||null==this.get_focus()||t.ss.typeOf(this.get_focus())!==yh||(this._editText(),!0)},_doneEditing:function(){zh.push(new Nh(Pi.getLocalizedText(545,"Text Edit"),this._tour)),this.get_focus().set_width(0),this.get_focus().set_height(0),this.get_focus().set_color(this.get_focus().textObject.foregroundColor),this.get_focus().cleanUp()},_editText:function(){var e=this.get_focus().textObject;this.editTextCallback(e,t.ss.bind("_doneEditing",this))},keyDown:function(e,i){if(null!=Oh.currentEditor&&Oh.currentEditor.keyDown(e,i))return!0;var n=1;switch(i.ctrlKey&&(n=10),i.keyCode){case 65:i.ctrlKey&&(this.clearSelection(),this.selection.addSelectionRange(this._tour.get_currentTourStop().get_overlays()),Xh._updateOverlayListSelection(this.selection),this._tour.get_currentTourStop().get_overlays().length>0&&this.set_focus(this._tour.get_currentTourStop().get_overlays()[0]));break;case 90:i.ctrlKey&&(zh.peekAction()?Hh._undoStep():Fa._beep());break;case 89:i.ctrlKey&&(zh.peekRedoAction()?Hh._redoStep():Fa._beep());break;case 67:i.ctrlKey&&this._copyMenu_Click(this,new t.ss.EventArgs);break;case 86:i.ctrlKey&&this._pasteMenu_Click(this,new t.ss.EventArgs);break;case 88:i.ctrlKey&&this._cutMenu_Click(this,new t.ss.EventArgs);break;case 46:return this._deleteMenu_Click(null,null),!0;case 9:return i.shiftKey?this._selectLast():this._selectNext(),!0;case 37:if(null!=this.get_focus()){for(var r=t.ss.enumerate(this.selection.selectionSet);r.moveNext();){var s=r.current;if(i.shiftKey)if(i.altKey)s.get_width()>n&&(zh.push(new Nh(Pi.getLocalizedText(537,"Resize"),this._tour)),s.set_width(s.get_width()-n));else{var a=s.get_width()/s.get_height();s.get_width()>n&&s.get_height()>n*a&&(zh.push(new Nh(Pi.getLocalizedText(537,"Resize"),this._tour)),s.set_width(s.get_width()-n),s.set_height(s.get_height()-n*a))}else i.altKey?(zh.push(new Nh(Pi.getLocalizedText(538,"Rotate"),this._tour)),s.set_rotationAngle(s.get_rotationAngle()-n)):(zh.push(new Nh(Pi.getLocalizedText(540,"Move"),this._tour)),s.set_x(s.get_x()-n))}return!0}break;case 39:if(null!=this.get_focus()){for(var o=t.ss.enumerate(this.selection.selectionSet);o.moveNext();)s=o.current,i.shiftKey?(zh.push(new Nh(Pi.getLocalizedText(537,"Resize"),this._tour)),i.altKey?s.set_width(s.get_width()+n):(a=s.get_width()/s.get_height(),s.set_width(s.get_width()+n),s.set_height(s.get_height()+n*a))):i.altKey?(zh.push(new Nh(Pi.getLocalizedText(538,"Rotate"),this._tour)),s.set_rotationAngle(s.get_rotationAngle()+n)):(zh.push(new Nh(Pi.getLocalizedText(540,"Move"),this._tour)),s.set_x(s.get_x()+n));return!0}break;case 38:if(null!=this.get_focus()){for(var l=t.ss.enumerate(this.selection.selectionSet);l.moveNext();)s=l.current,i.shiftKey?(zh.push(new Nh(Pi.getLocalizedText(537,"Resize"),this._tour)),i.altKey?s.set_height(s.get_height()+n):(a=s.get_width()/s.get_height(),s.set_width(s.get_width()+n),s.set_height(s.get_height()+n*a))):i.altKey||(zh.push(new Nh(Pi.getLocalizedText(540,"Move"),this._tour)),s.set_y(s.get_y()-n));return!0}break;case 40:if(null!=this.get_focus()){for(var h=t.ss.enumerate(this.selection.selectionSet);h.moveNext();)s=h.current,i.shiftKey?i.altKey?s.get_height()>n&&(zh.push(new Nh(Pi.getLocalizedText(537,"Resize"),this._tour)),s.set_height(s.get_height()-n)):(a=s.get_width()/s.get_height(),s.get_width()>n&&s.get_height()>n*a&&(zh.push(new Nh(Pi.getLocalizedText(537,"Resize"),this._tour)),s.set_width(s.get_width()-n),s.set_height(s.get_height()-n*a))):i.altKey||(zh.push(new Nh(Pi.getLocalizedText(540,"Move"),this._tour)),s.set_y(s.get_y()+n));return!0}break;case 34:if(i.altKey)return this._tour.get_currentTourstopIndex()<this._tour.get_tourStops().length-1&&(this._tour.set_currentTourstopIndex(this._tour.get_currentTourstopIndex()+1),Hh._selectCurrent(),Hh._ensureSelectedVisible()),!0;break;case 33:if(i.altKey)return this._tour.get_currentTourstopIndex()>0&&(this._tour.set_currentTourstopIndex(this._tour.get_currentTourstopIndex()-1),Hh._selectCurrent(),Hh._ensureSelectedVisible()),!0}return!1},_selectNext:function(){null!=this._tour&&null!=this._tour.get_currentTourStop()&&(this.set_focus(this._tour.get_currentTourStop().getNextOverlay(this.get_focus())),this.selection.setSelection(this.get_focus()),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection))},_selectLast:function(){null!=this._tour&&null!=this._tour.get_currentTourStop()&&(this.set_focus(this._tour.get_currentTourStop().getPerviousOverlay(this.get_focus())),this.selection.setSelection(this.get_focus()),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection))},keyUp:function(t,e){return!(null==Oh.currentEditor||!Oh.currentEditor.keyUp(t,e))},addPicture:function(t){if(null==this._tour||null==this._tour.get_currentTourStop())return!1;zh.push(new Nh(Pi.getLocalizedText(546,"Insert Picture"),this._tour));var e=bh.create(this._tour.get_currentTourStop(),t);return e.set_x(960),e.set_y(600),this._tour.get_currentTourStop().addOverlay(e),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection),!0},addFlipbook:function(t){return!1},addAudio:function(t,e){if(null==this._tour||null==this._tour.get_currentTourStop())return!1;var i=Mh.create(this._tour.get_currentTourStop(),t);return i.set_x(900),i.set_y(600),e?this._tour.get_currentTourStop().set_musicTrack(i):this._tour.get_currentTourStop().set_voiceTrack(i),!0},addVideo:function(t){return!0},addText:function(t,e){if(null==this._tour||null==this._tour.get_currentTourStop())return!1;var i=yh.create(e);return i.set_color(e.foregroundColor),i.set_x(960),i.set_y(600),zh.push(new Nh(Pi.getLocalizedText(547,"Insert Text"),this._tour)),this._tour.get_currentTourStop().addOverlay(i),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection),!0},addOverlay:function(e){if(null==this._tour||null==this._tour.get_currentTourStop())return null;if(t.ss.typeOf(e)===xh){var i=e;if(null!=i){var n=xh._create(this._tour.get_currentTourStop(),i.get_shapeType());return n.set_width(i.get_width()),n.set_height(i.get_height()),n.set_x(this._contextPoint.x),n.set_y(this._contextPoint.y),n.set_color(i.get_color()),n.set_rotationAngle(i.get_rotationAngle()),this._tour.get_currentTourStop().addOverlay(n),n}}else if(t.ss.typeOf(e)===yh){var r=e;if(null!=r){var s=yh.create(r.textObject);return s.set_x(this._contextPoint.x),s.set_y(this._contextPoint.y),s.set_color(r.get_color()),this._tour.get_currentTourStop().addOverlay(s),s}}else if(t.ss.typeOf(e)===bh){if(null!=e)return(a=e.copy(this._tour.get_currentTourStop())).set_x(this._contextPoint.x),a.set_y(this._contextPoint.y),this._tour.get_currentTourStop().addOverlay(a),a}else if(t.ss.typeOf(e)===Ah){var a;if(null!=e)return(a=e.copy(this._tour.get_currentTourStop())).set_x(this._contextPoint.x),a.set_y(this._contextPoint.y),this._tour.get_currentTourStop().addOverlay(a),a}return null},addShape:function(t,e){if(null==this._tour||null==this._tour.get_currentTourStop())return!1;zh.push(new Nh(Pi.getLocalizedText(548,"Insert Shape"),this._tour));var i=xh._create(this._tour.get_currentTourStop(),e);return i.set_width(200),i.set_height(200),4===e&&i.set_height(i.get_height()/2),5===e&&i.set_height(12),i.set_x(960),i.set_y(600),this._tour.get_currentTourStop().addOverlay(i),this.set_focus(i),this.selection.setSelection(this.get_focus()),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.selection),!0},getCurrentColor:function(){return null==this._tour||null==this._tour.get_currentTourStop()?this._defaultColor:null!=this.get_focus()?this.get_focus().get_color():this._defaultColor},setCurrentColor:function(t){this._defaultColor=t,null!=this._tour&&null!=this._tour.get_currentTourStop()&&null!=this.get_focus()&&this.get_focus().set_color(t)},dispose:function(){null!=this._contextMenu&&(this._contextMenu._dispose(),this._contextMenu=null)},hover:function(t){return null!=Oh.currentEditor&&Oh.currentEditor.hover(t),!0}};function Xh(){}function Hh(){}function Yh(){this.target=null}function jh(){this.tour=null,this.showAddButton=!1,this.selectedItems=null,this.selectedItem=-1,this.refreshCallback=null,this.multipleSelection=!1,this.hitType=!1}function Wh(){}function qh(){this._overlayBlend=xr.create(!1,1e3),this._tour=null,this._onTarget=!1,this._currentMasterSlide=null,this._callStack=new t.ss.Stack,this._leaveSettingsWhenStopped=!1}n("TourEditor",[Oh,Gh,null,_a]),Xh._updateOverlayList=function(t,e){},Xh._updateOverlayListSelection=function(t){},n("OverlayList",[Xh,{},null]),Hh._ensureSelectedVisible=function(){},Hh._selectCurrent=function(){},Hh._undoStep=function(){zh.peekAction()&&zh.stepBack()},Hh._redoStep=function(){zh.peekRedoAction()&&zh.stepForward()},n("TourEdit",[Hh,{},null]),n("SoundEditor",[Yh,{},null]),n("TourStopList",[jh,{selectAll:function(){this.selectedItems={};for(var t=0;t<this.tour.get_tourStops().length;t++)this.selectedItems[t]=this.tour.get_tourStops()[t]},refresh:function(){null!=this.refreshCallback&&this.refreshCallback()},findItem:function(t){return-1},ensureSelectedVisible:function(){},ensureAddVisible:function(){}},null]),Wh.refreshUi=function(){},n("TimeLine",[Wh,{},null]),qh._playing=!1,qh._switchedToFullScreen=!1,qh.noRestoreUIOnStop=!1,qh.get_playing=function(){return qh._playing},qh.set_playing=function(t){return qh._playing=t,t},qh.add_tourEnded=function(e){qh.__tourEnded=t.ss.bindAdd(qh.__tourEnded,e)},qh.remove_tourEnded=function(e){qh.__tourEnded=t.ss.bindSub(qh.__tourEnded,e)};var Zh={render:function(e){if(null!=this._tour&&null!=this._tour.get_currentTourStop()&&qh._playing){if(e.save(),this.updateSlideStates(),!this._onTarget&&(this._slideStartTime=t.ss.now(),e.onTarget(this.get_tour().get_currentTourStop().get_target()))){this._onTarget=!0,this._overlayBlend.set_state(!this.get_tour().get_currentTourStop().get_fadeInOverlays()),this._overlayBlend.set_targetState(!0),null!=this._tour.get_currentTourStop().get_musicTrack()&&(this._tour.get_currentTourStop().get_musicTrack().seek(0),this._tour.get_currentTourStop().get_musicTrack().play()),null!=this._tour.get_currentTourStop().get_voiceTrack()&&(this._tour.get_currentTourStop().get_voiceTrack().seek(0),this._tour.get_currentTourStop().get_voiceTrack().play());for(var i="",n=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());n.moveNext();){if("caption"===(u=n.current).get_name().toLowerCase()){var r=t.ss.safeCast(u,yh);null!=r&&(i=r.textObject.text)}u.play()}Rr(this._tour.get_currentTourStop().layers),null!=this._tour.get_currentTourStop().get_endTarget()&&-1!==this._tour.get_currentTourStop().get_endTarget().get_zoomLevel()&&(this._tour.get_currentTourStop().get_target().get_type(),e.viewMover=new cl(this._tour.get_currentTourStop().get_target().get_camParams(),this._tour.get_currentTourStop().get_endTarget().get_camParams(),this._tour.get_currentTourStop().get_duration()/1e3,this._tour.get_currentTourStop().get_startTime(),this._tour.get_currentTourStop().get_endTime(),this._tour.get_currentTourStop().get_interpolationType())),ko.tourSettings=this._tour.get_currentTourStop(),Wo.set_now(this._tour.get_currentTourStop().get_startTime()),Wo.set_syncToClock(!1),Pr._fireSlideChanged(i)}if(null!=e.gl){if(e.setupMatricesOverlays(),null!=this._currentMasterSlide)for(var s=t.ss.enumerate(this._currentMasterSlide.get_overlays());s.moveNext();)(u=s.current).set_tweenFactor(1),u.draw3D(e,!1);if(this._onTarget)for(var a=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());a.moveNext();)("caption"!==(u=a.current).get_name().toLowerCase()||Pr.get_showCaptions())&&(u.set_tweenFactor(Aa.easeCurve(this._tour.get_currentTourStop().get_tweenPosition(),5===u.get_interpolationType()?this._tour.get_currentTourStop().get_interpolationType():u.get_interpolationType())),u.draw3D(e,!1));e.restore()}else{e.device.scale(e.height/1116,e.height/1116);var o=e.width/e.height;if(e.device.translate(-(1920-1116*o)/2,0),null!=this._currentMasterSlide)for(var l=t.ss.enumerate(this._currentMasterSlide.get_overlays());l.moveNext();)(u=l.current).set_tweenFactor(1),u.draw3D(e,!1);if(this._onTarget)for(var h=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());h.moveNext();){var u;("caption"!==(u=h.current).get_name().toLowerCase()||Pr.get_showCaptions())&&(u.set_tweenFactor(Aa.easeCurve(this._tour.get_currentTourStop().get_tweenPosition(),5===u.get_interpolationType()?this._tour.get_currentTourStop().get_interpolationType():u.get_interpolationType())),u.draw3D(e,!1))}e.restore()}}},get_tour:function(){return this._tour},set_tour:function(t){return this._tour=t,t},nextSlide:function(){if(null!=this._tour.get_currentTourStop())if(this._tour.get_currentTourStop().get_masterSlide())this._currentMasterSlide=this._tour.get_currentTourStop();else{null!=this._tour.get_currentTourStop().get_musicTrack()&&this._tour.get_currentTourStop().get_musicTrack().stop(),null!=this._tour.get_currentTourStop().get_voiceTrack()&&this._tour.get_currentTourStop().get_voiceTrack().stop();for(var e=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());e.moveNext();)e.current.stop()}if(this._tour.get_currentTourstopIndex()<this._tour.get_tourStops().length-1||this._tour.get_currentTourStop().get_isLinked()){if(null!=this._tour.get_currentTourStop().get_endTarget()&&(kr.gotoTargetFull(!1,!0,this._tour.get_currentTourStop().get_endTarget().get_camParams(),this._tour.get_currentTourStop().get_target().get_studyImageset(),this._tour.get_currentTourStop().get_target().get_backgroundImageset()),kr.set__mover(null)),this._onTarget=!1,this._tour.get_currentTourStop().get_isLinked())try{"Return"===this._tour.get_currentTourStop().get_nextSlide()?this._callStack.count>0?this.playFromTourstop(this._tour.get_tourStops()[this._callStack.pop()]):this._tour.set_currentTourstopIndex(this._tour.get_tourStops().length-1):this.playFromTourstop(this._tour.get_tourStops()[this._tour.getTourStopIndexByID(this._tour.get_currentTourStop().get_nextSlide())])}catch(t){this._tour.get_currentTourstopIndex()<this._tour.get_tourStops().length-1&&this._tour.set_currentTourstopIndex(this._tour.get_currentTourstopIndex()+1)}else this._tour.set_currentTourstopIndex(this._tour.get_currentTourstopIndex()+1);null!=this._currentMasterSlide&&this._tour.get_currentTourStop().get_masterSlide()&&this._stopCurrentMaster();var i=!1;switch(this._tour.get_currentTourStop().get__transition()){case 0:default:break;case 1:case 2:case 3:case 5:case 4:i=!0}kr.gotoTarget(this._tour.get_currentTourStop().get_target(),!1,i,!1),this._slideStartTime=t.ss.now(),ko.tourSettings=this._tour.get_currentTourStop(),Wo.set_now(this._tour.get_currentTourStop().get_startTime()),Wo.set_syncToClock(!1)}else this._stopCurrentMaster(),qh._playing=!1,ko.get_current().autoRepeatTour?(this._tour.set_currentTourstopIndex(-1),this.play()):(kr._freezeView(),null!=qh.__tourEnded&&qh.__tourEnded(this,new t.ss.EventArgs),kr._hideUI(!1),Pr._fireTourEnded())},_stopCurrentMaster:function(){if(null!=this._currentMasterSlide){null!=this._currentMasterSlide.get_musicTrack()&&this._currentMasterSlide.get_musicTrack().stop(),null!=this._currentMasterSlide.get_voiceTrack()&&this._currentMasterSlide.get_voiceTrack().stop();for(var e=t.ss.enumerate(this._currentMasterSlide.get_overlays());e.moveNext();)e.current.stop();this._currentMasterSlide=null}},get_leaveSettingsWhenStopped:function(){return this._leaveSettingsWhenStopped},set_leaveSettingsWhenStopped:function(t){return this._leaveSettingsWhenStopped=t,t},play:function(){if(null!=this._tour){if(qh._playing?this.stop(!0):qh._playing=!0,kr._hideUI(!0),qh._playing=!0,this._tour.get_tourStops().length>0){this._onTarget=!1,-1===this._tour.get_currentTourstopIndex()&&this._tour.set_currentTourStop(this._tour.get_tourStops()[0]);for(var e=t.ss.enumerate(this._tour.get_tourStops());e.moveNext();){var i=e.current;null!=i.get_musicTrack()&&i.get_musicTrack().prepMultimedia(),null!=i.get_voiceTrack()&&i.get_voiceTrack().prepMultimedia();for(var n=t.ss.enumerate(i.get_overlays());n.moveNext();)n.current.prepMultimedia()}this._tour.get_currentTourstopIndex()>0&&this._playMasterForCurrent(),kr.gotoTarget(this._tour.get_currentTourStop().get_target(),!1,!0,!1)}this._slideStartTime=t.ss.now(),qh._playing=!0}},_playMasterForCurrent:function(){if(!this._tour.get_currentTourStop().get_masterSlide()){var e=this._tour.elapsedTimeSinceLastMaster(this._tour.get_currentTourstopIndex());if(null!=e){var i=e.duration;this._currentMasterSlide=e.master,null!=this._currentMasterSlide.get_musicTrack()&&(this._currentMasterSlide.get_musicTrack().seek(i),this._currentMasterSlide.get_musicTrack().play()),null!=this._currentMasterSlide.get_voiceTrack()&&(this._currentMasterSlide.get_voiceTrack().seek(i),this._currentMasterSlide.get_voiceTrack().play());for(var n=t.ss.enumerate(this._currentMasterSlide.get_overlays());n.moveNext();){var r=n.current;r.seek(i),r.play()}}}},stop:function(e){if(qh._switchedToFullScreen,this._leaveSettingsWhenStopped||(ko.tourSettings=null),qh._playing=!1,null!=this._tour.get_currentTourStop()){null!=this._tour.get_currentTourStop().get_musicTrack()&&this._tour.get_currentTourStop().get_musicTrack().stop(),null!=this._tour.get_currentTourStop().get_voiceTrack()&&this._tour.get_currentTourStop().get_voiceTrack().stop();for(var i=t.ss.enumerate(this._tour.get_currentTourStop().get_overlays());i.moveNext();)i.current.stop()}if(null!=this._currentMasterSlide){null!=this._currentMasterSlide.get_musicTrack()&&this._currentMasterSlide.get_musicTrack().stop(),null!=this._currentMasterSlide.get_voiceTrack()&&this._currentMasterSlide.get_voiceTrack().stop();for(var n=t.ss.enumerate(this._currentMasterSlide.get_overlays());n.moveNext();)n.current.stop()}kr._hideUI(qh.noRestoreUIOnStop),Pr._fireTourEnded()},updateSlideStates:function(){var e=!1,i=t.ss.now()-this._slideStartTime;if(i>this._tour.get_currentTourStop().get_duration()&&qh._playing&&(this.nextSlide(),e=!0),i=t.ss.now()-this._slideStartTime,null!=this._tour.get_currentTourStop()){this._tour.get_currentTourStop().set_tweenPosition(Math.min(1,i/this._tour.get_currentTourStop().get_duration())),this._tour.get_currentTourStop().faderOpacity=0;var n=this._tour.get_currentTourStop().get_tweenPosition()*this._tour.get_currentTourStop().get_duration()/1e3;switch(e&&kr.set_crossFadeFrame(!1),this._tour.get_currentTourStop().get__transition()){case 0:this._tour.get_currentTourStop().faderOpacity=0,kr.set_crossFadeFrame(!1);break;case 2:n<n-this._tour.get_currentTourStop().get__transitionHoldTime()?(kr.set_crossFadeFrame(!0),this._tour.get_currentTourStop().faderOpacity=1):(this._tour.get_currentTourStop().faderOpacity=0,kr.set_crossFadeFrame(!1));break;case 1:kr.set_crossFadeFrame(!0);var r=Math.max(0,1-Math.min(1,(n-this._tour.get_currentTourStop().get__transitionHoldTime())/this._tour.get_currentTourStop().get__transitionTime()));this._tour.get_currentTourStop().faderOpacity=r;break;case 3:case 4:kr.set_crossFadeFrame(!1),r=Math.max(0,1-Math.max(0,n-this._tour.get_currentTourStop().get__transitionHoldTime())/this._tour.get_currentTourStop().get__transitionTime()),this._tour.get_currentTourStop().faderOpacity=r;break;case 5:kr.set_crossFadeFrame(!1)}if(!this._tour.get_currentTourStop().get_isLinked()&&this._tour.get_currentTourstopIndex()<this._tour.get_tourStops().length-1){var s=this._tour.get_tourStops()[this._tour.get_currentTourstopIndex()+1].get__transition(),a=this._tour.get_tourStops()[this._tour.get_currentTourstopIndex()+1].get__transitionOutTime();switch(s){case 5:case 3:this._tour.get_currentTourStop().faderOpacity||(kr.set_crossFadeFrame(!1),r=Math.max(0,1-Math.min(1,(this._tour.get_currentTourStop().get_duration()/1e3-n)/a)),this._tour.get_currentTourStop().faderOpacity=r)}}}},updateTweenPosition:function(e){var i=t.ss.now()-this._slideStartTime;return e>-1?this._tour.get_currentTourStop().set_tweenPosition(Math.min(1,e)):this._tour.get_currentTourStop().set_tweenPosition(Math.min(1,i/this._tour.get_currentTourStop().get_duration()))},close:function(){null!=this._tour&&(qh.get_playing()&&this.stop(qh._switchedToFullScreen),this._tour=null)},mouseDown:function(e,i){var n;if(n=this.pointToView(vn.create(i.offsetX,i.offsetY)),null==this._tour||null==this._tour.get_currentTourStop())return!1;for(var r=this._tour.get_currentTourStop().get_overlays().length-1;r>=0;r--)if(this._tour.get_currentTourStop().get_overlays()[r].hitTest(n)){if(!t.ss.emptyString(this._tour.get_currentTourStop().get_overlays()[r].get_url())){var s=this._tour.get_currentTourStop().get_overlays()[r];return a._openUrl(s.get_url()),!0}if(!t.ss.emptyString(this._tour.get_currentTourStop().get_overlays()[r].get_linkID()))return this._callStack.push(this._tour.get_currentTourstopIndex()),this.playFromTourstop(this._tour.get_tourStops()[this._tour.getTourStopIndexByID(this._tour.get_currentTourStop().get_overlays()[r].get_linkID())]),!0}return!1},mouseUp:function(t,e){return!1},mouseMove:function(e,i){var n;try{n=this.pointToView(vn.create(i.offsetX,i.offsetY))}catch(t){return!1}if(null==this._tour||null==this._tour.get_currentTourStop())return!1;for(var r=this._tour.get_currentTourStop().get_overlays().length-1;r>=0;r--)if(this._tour.get_currentTourStop().get_overlays()[r].hitTest(n)&&(!t.ss.emptyString(this._tour.get_currentTourStop().get_overlays()[r].get_url())||!t.ss.emptyString(this._tour.get_currentTourStop().get_overlays()[r].get_linkID())))return!0;return!1},mouseClick:function(t,e){return!1},click:function(t,e){return!1},mouseDoubleClick:function(t,e){return!1},keyDown:function(t,e){switch(e.keyCode){case 27:return this.stop(qh._switchedToFullScreen),kr._closeTour(),!0;case 32:return this.pauseTour(),!0;case 39:return this._playNextSlide(),!0;case 37:return this._playPreviousSlide(),!0;case 35:return this._tour.get_tourStops().length>0&&this.playFromTourstop(this._tour.get_tourStops()[this._tour.get_tourStops().length-1]),!0;case 36:return this._tour.get_tourStops().length>0&&this.playFromTourstop(this._tour.get_tourStops()[0]),!0}return!1},_playNextSlide:function(){this._tour.get_currentTourstopIndex()<this._tour.get_tourStops().length-1&&this._tour.get_tourStops().length>0&&this.playFromTourstop(this._tour.get_tourStops()[this._tour.get_currentTourstopIndex()+1])},_playPreviousSlide:function(){this._tour.get_currentTourstopIndex()>0&&this.playFromTourstop(this._tour.get_tourStops()[this._tour.get_currentTourstopIndex()-1])},playFromTourstop:function(t){this.stop(!0),this._tour.set_currentTourStop(t),kr.gotoTarget(this._tour.get_currentTourStop().get_target(),!1,!0,!1),Wo.set_now(this._tour.get_currentTourStop().get_startTime()),Wo.set_syncToClock(!1),this.play()},pauseTour:function(){qh._playing?(this.stop(qh._switchedToFullScreen),kr._freezeView(),Pr._fireTourPaused()):(this.play(),Pr._fireTourResume())},keyUp:function(t,e){return!1},hover:function(t){return!!qh._playing},pointToView:function(t){var e=kr.canvas.height,i=kr.canvas.width,n=i/e*1116,r=t.x/i*n-(n-1920)/2,s=t.y/e*1116;return vn.create(r,s)}};function Kh(t,e){this.duration=0,this.master=t,this.duration=e}function Jh(){Bl.call(this),this.id=Jh.issGuid}n("TourPlayer",[qh,Zh,null,_a]),n("MasterTime",[Kh,{},null]),Jh.issGuid=Ii.fromString("00000001-0002-0003-0405-060708090a0b"),Jh._loading$2=!1,Jh._issmodel$2=null,Jh._doc$2=null,Jh.loadBackground=function(){if(!Jh._loading$2&&!Mr){Jh._loading$2=!0;var t=zr.singleton.coreStaticUrl("data/iss.wtt");Jh._doc$2=Er(t,(function(){Jh.createSpaceStation()}))}},Jh.createSpaceStation=function(){Jh._doc$2.set_id("28016047-97a9-4b33-a226-cd820262a151");var t=new Hl(Jh._doc$2,"0c10ae54-b6da-4282-bfda-f34562d403bc.3ds",!0,!1,!0,Xi.get_white());null!=t&&(t.issLayer=!0,Jh._issmodel$2=t)};var Qh={draw:function(e,i,n){if(null==this.object3d&&null==Jh._issmodel$2&&!Jh._loading$2){var r=yn.multiplyMatrix(e.get_world(),e.get_view()),s=r.transform(wn.get_empty()),a=Math.sqrt(r.get_m11()*r.get_m11()+r.get_m22()*r.get_m22()+r.get_m33()*r.get_m33()),o=s.length(),l=a,h=t.ss.truncate(e.height),u=e.get_projection().get_m11(),c=e.get_projection().get_m34(),_=e.get_projection().get_m44();l*(u/(Math.abs(c)*o+_)*h)>.5&&Jh.loadBackground()}return this.object3d=Jh._issmodel$2,Bl.prototype.draw.call(this,e,i,n)},getPrimaryUI:function(){return null},addFilesToCabinet:function(t){},loadData:function(t,e){},cleanUp:function(){}};n("ISSLayer",[Jh,Qh,Bl]);var tu={spherical:0,rectangular:1,orbital:2};n("CoordinatesTypes",tu),r("CoordinatesTypes",tu);var eu={depth:0,altitude:1,distance:2,seaLevel:3,terrain:4};n("AltTypes",eu),r("AltTypes",eu);var iu={same_For_All:0};n("MarkerMixes",iu),r("MarkerMixes",iu);var nu={same_For_All:0,group_by_Values:2,per_Column_Literal:3};n("ColorMaps",nu),r("ColorMaps",nu);var ru={gaussian:0,point:1,circle:2,square:3,pushPin:4,custom:5};n("PlotTypes",ru),r("PlotTypes",ru);var su={screen:0,world:1};n("MarkerScales",su),r("MarkerScales",su);var au={hours:0,degrees:1};function ou(){this.isLongIndex=!1,this.shapeVertexCount=0,this.lines=!1,this.latColumn=-1,this.fixedSize=1,this.decay=16,this.timeSeries=!1,this._dynamicData$1=!1,this._autoUpdate$1=!1,this._dataSourceUrl$1="",this._beginRange$1=new Date("1/1/2100"),this._endRange$1=new Date("01/01/1800"),this.markerDomainValues={},this.colorDomainValues={},this._coordinatesType$1=0,this.lngColumn=-1,this.geometryColumn=-1,this._xAxisColumn$1=-1,this._yAxisColumn$1=-1,this._zAxisColumn$1=-1,this._xAxisReverse$1=!1,this._yAxisReverse$1=!1,this._zAxisReverse$1=!1,this._altType$1=3,this._markerMix$1=0,this._raUnits$1=0,this._colorMap$1=3,this._markerColumn$1=-1,this._colorMapColumn$1=-1,this._plotType$1=0,this._markerIndex$1=0,this._showFarSide$1=!1,this._markerScale$1=1,this._altUnit$1=1,this._cartesianScale$1=1,this._cartesianCustomScale$1=1,this.altColumn=-1,this.startDateColumn=-1,this.endDateColumn=-1,this.sizeColumn=-1,this.nameColumn=0,this._hyperlinkFormat$1="",this._hyperlinkColumn$1=-1,this.scaleFactor=1,this.pointScaleType=1,this.positions=[],this.bufferIsFlat=!1,this.baseDate=new Date(2010,0,1,12,0,0),this.dirty=!0,this.lastVersion=0,Cl.call(this)}n("RAUnits",au),r("RAUnits",au),ou._circleTexture$1=null,ou.get__circleTexture$1=function(){return ou._circleTexture$1};var lu={get_dynamicData:function(){return this._dynamicData$1},set_dynamicData:function(t){return this._dynamicData$1=t,t},get_autoUpdate:function(){return this._autoUpdate$1},set_autoUpdate:function(t){return this._autoUpdate$1=t,t},get_dataSourceUrl:function(){return this._dataSourceUrl$1},set_dataSourceUrl:function(t){return this._dataSourceUrl$1=t,t},get_timeSeries:function(){return this.timeSeries},set_timeSeries:function(t){return this.timeSeries!==t&&(this.version++,this.timeSeries=t),t},get_header:function(){return null},get_beginRange:function(){return this._beginRange$1},set_beginRange:function(e){return t.ss.compareDates(this._beginRange$1,e)||(this.version++,this._beginRange$1=e),e},get_endRange:function(){return this._endRange$1},set_endRange:function(e){return t.ss.compareDates(this._endRange$1,e)||(this.version++,this._endRange$1=e),e},initializeFromXml:function(e){switch(this.set_timeSeries(t.ss.boolean(e.attributes.getNamedItem("TimeSeries").nodeValue)),this.set_beginRange(new Date(e.attributes.getNamedItem("BeginRange").nodeValue)),this.set_endRange(new Date(e.attributes.getNamedItem("EndRange").nodeValue)),this.set_decay(parseFloat(e.attributes.getNamedItem("Decay").nodeValue)),this.set_coordinatesType(s.parse("CoordinatesTypes",e.attributes.getNamedItem("CoordinatesType").nodeValue)),this.get_coordinatesType()<0&&this.set_coordinatesType(0),this.set_latColumn(parseInt(e.attributes.getNamedItem("LatColumn").nodeValue)),this.set_lngColumn(parseInt(e.attributes.getNamedItem("LngColumn").nodeValue)),null!=e.attributes.getNamedItem("GeometryColumn")&&this.set_geometryColumn(parseInt(e.attributes.getNamedItem("GeometryColumn").nodeValue)),e.attributes.getNamedItem("AltType").nodeValue){case"Depth":this.set_altType(0);break;case"Altitude":this.set_altType(1);break;case"Distance":this.set_altType(2);break;case"SeaLevel":this.set_altType(3);break;case"Terrain":this.set_altType(4)}switch(this.set_markerMix(0),e.attributes.getNamedItem("ColorMap").nodeValue){case"Same_For_All":this.set__colorMap(0);break;case"Group_by_Values":this.set__colorMap(2);break;case"Per_Column_Literal":this.set__colorMap(3)}switch(this.set_markerColumn(parseInt(e.attributes.getNamedItem("MarkerColumn").nodeValue)),this.set_colorMapColumn(parseInt(e.attributes.getNamedItem("ColorMapColumn").nodeValue)),e.attributes.getNamedItem("PlotType").nodeValue){case"Gaussian":this.set_plotType(0);break;case"Point":this.set_plotType(1);break;case"Circle":this.set_plotType(2);break;case"PushPin":this.set_plotType(4)}switch(this.set_markerIndex(parseInt(e.attributes.getNamedItem("MarkerIndex").nodeValue)),e.attributes.getNamedItem("MarkerScale").nodeValue){case"Screen":this.set_markerScale(0);break;case"World":this.set_markerScale(1)}switch(e.attributes.getNamedItem("AltUnit").nodeValue){case"Meters":this.set_altUnit(1);break;case"Feet":this.set_altUnit(2);break;case"Inches":this.set_altUnit(3);break;case"Miles":this.set_altUnit(4);break;case"Kilometers":this.set_altUnit(5);break;case"AstronomicalUnits":this.set_altUnit(6);break;case"LightYears":this.set_altUnit(7);break;case"Parsecs":this.set_altUnit(8);break;case"MegaParsecs":this.set_altUnit(9);break;case"Custom":this.set_altUnit(10)}switch(this.set_altColumn(parseInt(e.attributes.getNamedItem("AltColumn").nodeValue)),this.set_startDateColumn(parseInt(e.attributes.getNamedItem("StartDateColumn").nodeValue)),this.set_endDateColumn(parseInt(e.attributes.getNamedItem("EndDateColumn").nodeValue)),this.set_sizeColumn(parseInt(e.attributes.getNamedItem("SizeColumn").nodeValue)),this.set_hyperlinkFormat(e.attributes.getNamedItem("HyperlinkFormat").nodeValue),this.set_hyperlinkColumn(parseInt(e.attributes.getNamedItem("HyperlinkColumn").nodeValue)),this.set_scaleFactor(parseFloat(e.attributes.getNamedItem("ScaleFactor").nodeValue)),e.attributes.getNamedItem("PointScaleType").nodeValue){case"Linear":this.set_pointScaleType(0);break;case"Power":this.set_pointScaleType(1);break;case"Log":this.set_pointScaleType(2);break;case"Constant":this.set_pointScaleType(3);break;case"StellarMagnitude":this.set_pointScaleType(4)}if(null!=e.attributes.getNamedItem("ShowFarSide")&&this.set_showFarSide(t.ss.boolean(e.attributes.getNamedItem("ShowFarSide").nodeValue)),null!=e.attributes.getNamedItem("RaUnits"))switch(e.attributes.getNamedItem("RaUnits").nodeValue){case"Hours":this.set_raUnits(0);break;case"Degrees":this.set_raUnits(1)}if(null!=e.attributes.getNamedItem("HoverTextColumn")&&this.set_nameColumn(parseInt(e.attributes.getNamedItem("HoverTextColumn").nodeValue)),null!=e.attributes.getNamedItem("XAxisColumn")){switch(this.set_xAxisColumn(parseInt(e.attributes.getNamedItem("XAxisColumn").nodeValue)),this.set_xAxisReverse(t.ss.boolean(e.attributes.getNamedItem("XAxisReverse").nodeValue)),this.set_yAxisColumn(parseInt(e.attributes.getNamedItem("YAxisColumn").nodeValue)),this.set_yAxisReverse(t.ss.boolean(e.attributes.getNamedItem("YAxisReverse").nodeValue)),this.set_zAxisColumn(parseInt(e.attributes.getNamedItem("ZAxisColumn").nodeValue)),this.set_zAxisReverse(t.ss.boolean(e.attributes.getNamedItem("ZAxisReverse").nodeValue)),e.attributes.getNamedItem("CartesianScale").nodeValue){case"Meters":this.set_cartesianScale(1);break;case"Feet":this.set_cartesianScale(2);break;case"Inches":this.set_cartesianScale(3);break;case"Miles":this.set_cartesianScale(4);break;case"Kilometers":this.set_cartesianScale(5);break;case"AstronomicalUnits":this.set_cartesianScale(6);break;case"LightYears":this.set_cartesianScale(7);break;case"Parsecs":this.set_cartesianScale(8);break;case"MegaParsecs":this.set_cartesianScale(9);break;case"Custom":this.set_cartesianScale(10)}this.set_cartesianCustomScale(parseFloat(e.attributes.getNamedItem("CartesianCustomScale").nodeValue))}null!=e.attributes.getNamedItem("DynamicData")&&(this.set_dynamicData(t.ss.boolean(e.attributes.getNamedItem("DynamicData").nodeValue)),this.set_autoUpdate(t.ss.boolean(e.attributes.getNamedItem("AutoUpdate").nodeValue)),this.set_dataSourceUrl(e.attributes.getNamedItem("DataSourceUrl").nodeValue))},computeDateDomainRange:function(t,e){},getDomainValues:function(t){return[]},get_decay:function(){return this.decay},set_decay:function(t){return this.decay!==t&&(this.version++,this.decay=t),t},get_coordinatesType:function(){return this._coordinatesType$1},set_coordinatesType:function(t){return this._coordinatesType$1!==t&&(this.version++,this._coordinatesType$1=t),t},get_latColumn:function(){return this.latColumn},set_latColumn:function(t){return this.latColumn!==t&&(this.version++,this.latColumn=t),t},get_lngColumn:function(){return this.lngColumn},set_lngColumn:function(t){return this.lngColumn!==t&&(this.version++,this.lngColumn=t),t},get_geometryColumn:function(){return this.geometryColumn},set_geometryColumn:function(t){return this.geometryColumn!==t&&(this.version++,this.geometryColumn=t),t},get_xAxisColumn:function(){return this._xAxisColumn$1},set_xAxisColumn:function(t){return this._xAxisColumn$1!==t&&(this.version++,this._xAxisColumn$1=t),t},get_yAxisColumn:function(){return this._yAxisColumn$1},set_yAxisColumn:function(t){return this._yAxisColumn$1!==t&&(this.version++,this._yAxisColumn$1=t),t},get_zAxisColumn:function(){return this._zAxisColumn$1},set_zAxisColumn:function(t){return this._zAxisColumn$1!==t&&(this.version++,this._zAxisColumn$1=t),t},get_xAxisReverse:function(){return this._xAxisReverse$1},set_xAxisReverse:function(t){return this._xAxisReverse$1!==t&&(this.version++,this._xAxisReverse$1=t),t},get_yAxisReverse:function(){return this._yAxisReverse$1},set_yAxisReverse:function(t){return this._yAxisReverse$1!==t&&(this.version++,this._yAxisReverse$1=t),t},get_zAxisReverse:function(){return this._zAxisReverse$1},set_zAxisReverse:function(t){return this._zAxisReverse$1!==t&&(this.version++,this._zAxisReverse$1=t),t},get_altType:function(){return this._altType$1},set_altType:function(t){return this._altType$1!==t&&(this.version++,this._altType$1=t),t},get_markerMix:function(){return this._markerMix$1},set_markerMix:function(t){return this._markerMix$1!==t&&(this.version++,this._markerMix$1=t),t},get_raUnits:function(){return this._raUnits$1},set_raUnits:function(t){return this._raUnits$1!==t&&(this.version++,this._raUnits$1=t),t},get__colorMap:function(){return this._colorMap$1},set__colorMap:function(t){return this._colorMap$1!==t&&(this.version++,this._colorMap$1=t),t},get_markerColumn:function(){return this._markerColumn$1},set_markerColumn:function(t){return this._markerColumn$1!==t&&(this.version++,this._markerColumn$1=t),t},get_colorMapColumn:function(){return this._colorMapColumn$1},set_colorMapColumn:function(t){return this._colorMapColumn$1!==t&&(this.version++,this._colorMapColumn$1=t),t},get_plotType:function(){return this._plotType$1},set_plotType:function(t){return this._plotType$1!==t&&(this.version++,this._plotType$1=t),t},get_markerIndex:function(){return this._markerIndex$1},set_markerIndex:function(t){return this._markerIndex$1!==t&&(this.version++,this._markerIndex$1=t),t},get_showFarSide:function(){return this._showFarSide$1},set_showFarSide:function(t){return this._showFarSide$1!==t&&(this.version++,this._showFarSide$1=t),t},get_markerScale:function(){return this._markerScale$1},set_markerScale:function(t){return this._markerScale$1!==t&&(this.version++,this._markerScale$1=t),t},get_altUnit:function(){return this._altUnit$1},set_altUnit:function(t){return this._altUnit$1!==t&&(this.version++,this._altUnit$1=t),t},get_cartesianScale:function(){return this._cartesianScale$1},set_cartesianScale:function(t){return this._cartesianScale$1!==t&&(this.version++,this._cartesianScale$1=t),t},get_cartesianCustomScale:function(){return this._cartesianCustomScale$1},set_cartesianCustomScale:function(t){return this._cartesianCustomScale$1!==t&&(this.version++,this._cartesianCustomScale$1=t),t},get_altColumn:function(){return this.altColumn},set_altColumn:function(t){return this.altColumn!==t&&(this.version++,this.altColumn=t),t},get_startDateColumn:function(){return this.startDateColumn},set_startDateColumn:function(t){return this.startDateColumn!==t&&(this.version++,this.startDateColumn=t),t},get_endDateColumn:function(){return this.endDateColumn},set_endDateColumn:function(t){return this.endDateColumn!==t&&(this.version++,this.endDateColumn=t),t},get_sizeColumn:function(){return this.sizeColumn},set_sizeColumn:function(t){return this.sizeColumn!==t&&(this.version++,this.sizeColumn=t),t},get_nameColumn:function(){return this.nameColumn},set_nameColumn:function(t){return this.nameColumn!==t&&(this.version++,this.nameColumn=t),t},get_hyperlinkFormat:function(){return this._hyperlinkFormat$1},set_hyperlinkFormat:function(t){return this._hyperlinkFormat$1!==t&&(this.version++,this._hyperlinkFormat$1=t),t},get_hyperlinkColumn:function(){return this._hyperlinkColumn$1},set_hyperlinkColumn:function(t){return this._hyperlinkColumn$1!==t&&(this.version++,this._hyperlinkColumn$1=t),t},get_scaleFactor:function(){return this.scaleFactor},set_scaleFactor:function(t){return this.scaleFactor!==t&&(this.version++,this.scaleFactor=t),t},get_pointScaleType:function(){return this.pointScaleType},set_pointScaleType:function(t){return this.pointScaleType!==t&&(this.version++,this.pointScaleType=t),t},prepVertexBuffer:function(t,e){return!0},draw:function(t,e,i){var n=t;this.version!==this.lastVersion&&this.cleanUp(),this.bufferIsFlat!==i&&(this.cleanUp(),this.bufferIsFlat=i),this.dirty&&this.prepVertexBuffer(n,e);var r=Wo.get_jNow()-Wo.utcToJulian(this.baseDate),s=this.scaleFactor;return i&&this.astronomical&&1===this._markerScale$1&&(s=this.scaleFactor/(t.viewCamera.zoom/360)),null!=this.triangleList2d&&(this.triangleList2d.decay=this.decay,this.triangleList2d.sky=this.get_astronomical(),this.triangleList2d.timeSeries=this.timeSeries,this.triangleList2d.jNow=r,this.triangleList2d.draw(t,e*this.get_opacity(),1)),null!=this.triangleList&&(this.triangleList.decay=this.decay,this.triangleList.sky=this.get_astronomical(),this.triangleList.timeSeries=this.timeSeries,this.triangleList.jNow=r,this.triangleList.draw(t,e*this.get_opacity(),1)),null!=this.pointList&&(this.pointList.depthBuffered=!1,this.pointList.decay=this.decay,this.pointList.sky=this.get_astronomical(),this.pointList.timeSeries=this.timeSeries,this.pointList.jNow=r,this.pointList.scale=1===this._markerScale$1?s:-s,this.pointList.draw(t,e*this.get_opacity(),!1)),null!=this.lineList&&(this.lineList.sky=this.get_astronomical(),this.lineList.decay=this.decay,this.lineList.timeSeries=this.timeSeries,this.lineList.jNow=r,this.lineList.drawLines(t,e*this.get_opacity())),null!=this.lineList2d&&(this.lineList2d.sky=this.get_astronomical(),this.lineList2d.decay=this.decay,this.lineList2d.timeSeries=this.timeSeries,this.lineList2d.showFarSide=this.get_showFarSide(),this.lineList2d.jNow=r,this.lineList2d.drawLines(t,e*this.get_opacity())),!0},initFromXml:function(t){Cl.prototype.initFromXml.call(this,t)},cleanUp:function(){null!=this.lineList&&this.lineList.clear(),null!=this.lineList2d&&this.lineList2d.clear(),null!=this.triangleList2d&&this.triangleList2d.clear(),null!=this.pointList&&this.pointList.clear(),null!=this.triangleList&&this.triangleList.clear()},dynamicUpdate:function(){return!1}};function hu(){this.lat=0,this.lng=0,this.alt=0}function uu(){this.extrude=!1,this.astronomical=!1,this.meanRadius=6371e3,this.pointList=[]}function cu(){}function _u(){this._dataDirty$1=!1,this._lastNormalizeSizeColumnIndex$1=-1,this._lastDynamicColorColumnIndex$1=-1,this._table_backcompat$1=null,this._barChartBitmask$1=0,this._barScaleFactor$1=20,this._meanRadius$1=6371e3,this._table$1=new rh,this.isLongIndex=!1,this.shapeVertexCount=0,this.lines=!1,this.latColumn=-1,this.fixedSize=1,this.decay=16,this.timeSeries=!1,this._dynamicData$1=!1,this._autoUpdate$1=!1,this._dataSourceUrl$1="",this._beginRange$1=new Date("1/1/2100"),this._endRange$1=new Date("01/01/1800"),this.markerDomainValues={},this.colorDomainValues={},this._coordinatesType$1=0,this.lngColumn=-1,this.geometryColumn=-1,this._xAxisColumn$1=-1,this._yAxisColumn$1=-1,this._zAxisColumn$1=-1,this._xAxisReverse$1=!1,this._yAxisReverse$1=!1,this._zAxisReverse$1=!1,this._altType$1=3,this._markerMix$1=0,this._raUnits$1=0,this.colorMap=3,this.colorMapperName="Greys",this._dynamicColorColumnName$1="2efc32e3-b9d9-47ff-8036-8cc344c585bd",this.dynamicColor=!1,this.normalizeColorMap=!1,this.normalizeColorMapMin=0,this.normalizeColorMapMax=1,this._markerColumn$1=-1,this.colorMapColumn=-1,this._plotType$1=0,this._markerIndex$1=0,this._showFarSide$1=!1,this._markerScale$1=1,this._altUnit$1=1,this._cartesianScale$1=1,this._cartesianCustomScale$1=1,this.altColumn=-1,this.startDateColumn=-1,this.endDateColumn=-1,this.sizeColumn=-1,this._normalizeSizeColumnName$1="dfe78b4c-f972-4796-b04f-68c5efd4ecb0",this.normalizeSize=!1,this.normalizeSizeClip=!1,this.normalizeSizeMin=0,this.normalizeSizeMax=1,this.nameColumn=0,this._hyperlinkFormat$1="",this._hyperlinkColumn$1=-1,this.scaleFactor=1,this.pointScaleType=1,this.positions=[],this.bufferIsFlat=!1,this.baseDate=new Date(2010,0,1,12,0,0),this.dirty=!0,this.lastVersion=0,Cl.call(this)}n("TimeSeriesLayer",[ou,lu,Cl]),n("KmlCoordinate",[hu,{},null]),n("KmlLineList",[uu,{parseWkt:function(e,i,n,r){for(var s=Fa.split(e,"(,)"),a=t.ss.enumerate(s);a.moveNext();){var o=a.current,l=t.ss.trim(o).split(" ");if(l.length>1){var h=new hu;h.lng=parseFloat(l[0]),this.astronomical&&(h.lng-=180),h.lat=parseFloat(l[1]),l.length>2&&!n?h.alt=parseFloat(l[2]):h.alt=n,h.date=r,this.pointList.push(h)}}},getCenterPoint:function(){var e=new hu;e.lat=0,e.lng=0,e.alt=0;for(var i=t.ss.enumerate(this.pointList);i.moveNext();){var n=i.current;e.lat+=n.lat,e.lng+=n.lng,e.alt+=n.alt}return e.lat/=this.pointList.length,e.lng/=this.pointList.length,e.alt/=this.pointList.length,e}},null]),cu._pinTextureCache={},cu._pins=null,cu.triggerLoadSprite=function(){null==cu._pins&&(cu._pins=rs.fromUrl(zr.singleton.engineAssetUrl("pins.png")))},cu.getPushPinTexture=function(e){var i=null;if(t.ss.keyExists(cu._pinTextureCache,e))return cu._pinTextureCache[e];try{i=Hi.createTexture(),Hi.bindTexture(Yr.TEXTURE_2D,i);var n=Math.floor(e/16),r=e%16,s=document.createElement("canvas");s.height=32,s.width=32,s.getContext("2d").drawImage(cu._pins.imageElement,32*r,32*n,32,32,0,0,32,32);var a=s;Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_S,Yr.CLAMP_TO_EDGE),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_WRAP_T,Yr.CLAMP_TO_EDGE),Hi.texImage2D(Yr.TEXTURE_2D,0,Yr.RGBA,Yr.RGBA,Yr.UNSIGNED_BYTE,a),Hi.texParameteri(Yr.TEXTURE_2D,Yr.TEXTURE_MIN_FILTER,Yr.LINEAR_MIPMAP_NEAREST),Hi.generateMipmap(Yr.TEXTURE_2D),Hi.bindTexture(Yr.TEXTURE_2D,null),cu._pinTextureCache[e]=i}catch(t){}return i},n("PushPin",[cu,{},null]),_u._circleTexture$1=null,_u._getDatafromFeed$1=function(t){return""},_u._executeQuery$1=function(t){return""},_u.parseDate=function(e){var i=t.ss.now();try{i=new Date(e)}catch(t){try{return _u.execlToDateTime(parseFloat(e))}catch(t){}}return i},_u.execlToDateTime=function(e){e>59&&(e-=1),e>73e4&&(e=73e4);var i=new Date(1899,12,31);return new Date(i.getDate()+t.ss.truncate(24*e*60*60*1e3))},_u.get__circleTexture$1=function(){if(null==_u._circleTexture$1){var t=zr.singleton.engineAssetUrl("circle.png");_u._circleTexture$1=rs.fromUrl(t)}return _u._circleTexture$1};var du={getTypeName:function(){return"TerraViewer.SpreadSheetLayer"},get_header:function(){return this._table$1.header},canCopyToClipboard:function(){return!0},copyToClipboard:function(){},dynamicUpdate:function(){var t=_u._getDatafromFeed$1(this.get_dataSourceUrl());return null!=t&&(this.updateData(t,!1,!0,!0),this.guessHeaderAssignments(),!0)},updateData:function(e,i,n,r){return this.loadFromString(t.ss.safeCast(e,String),!0,i,n,r),this.computeDateDomainRange(-1,-1),this._dataDirty$1=!0,this.dirty=!0,!0},loadData:function(t,e){var i=this;this._table$1=new rh;var n=t.getFileBlob(e);this.getStringFromGzipBlob(n,(function(t){i._table$1.loadFromString(t,!1,!0,!0),i._table$1.header.indexOf(i._normalizeSizeColumnName$1)>-1&&i._table$1.removeColumn(i._normalizeSizeColumnName$1),i.computeDateDomainRange(-1,-1),i.get_dynamicData()&&i.get_autoUpdate()&&i.dynamicUpdate(),i._dataDirty$1=!0,i.dirty=!0}))},addFilesToCabinet:function(e){this._fileName$1=e.tempDirectory+t.ss.format("{0}\\{1}.txt",e.get_packageID(),this.id.toString()),this._fileName$1.substring(0,this._fileName$1.lastIndexOf("\\"));var i;i=null==this._table_backcompat$1?this._table$1.save():this._table_backcompat$1.save();var n=new Blob([i]);e.addFile(this._fileName$1,n),Cl.prototype.addFilesToCabinet.call(this,e)},_prepareBackCompatTable$1:function(){if(!(-1!==this.sizeColumn&&this.get_normalizeSize()||-1!==this.colorMapColumn&&this.get_dynamicColor()))return this._lastNormalizeSizeColumnIndex$1=-1,void(this._lastDynamicColorColumnIndex$1=-1);if(this._table_backcompat$1=this._table$1.clone(),this.sizeColumn>-1&&this.get_normalizeSize()){for(var e=[],i=t.ss.enumerate(this._table_backcompat$1.rows);i.moveNext();){var n=i.current;e.push(this.normalizePointSize(parseFloat(n[this.sizeColumn])).toString())}this._table_backcompat$1.addColumn(this._normalizeSizeColumnName$1,e),this._lastNormalizeSizeColumnIndex$1=this._table_backcompat$1.header.length-1}else this._lastNormalizeSizeColumnIndex$1=-1;if(this.colorMapColumn>-1&&this.get_dynamicColor()){for(var r=[],s=t.ss.enumerate(this._table_backcompat$1.rows);s.moveNext();)n=s.current,r.push(this.get_colorMapper().findClosestColor(this.normalizeColorMapValue(parseFloat(n[this.get_colorMapColumn()]))).toSimpleHex());this._table_backcompat$1.addColumn(this._dynamicColorColumnName$1,r),this._lastDynamicColorColumnIndex$1=this._table_backcompat$1.header.length-1}else this._lastDynamicColorColumnIndex$1=-1},guessHeaderAssignments:function(){for(var e=0,i=t.ss.enumerate(this._table$1.header);i.moveNext();){var n=i.current;this._guessHeaderAssignment$1(n,e++)}this._table$1.header.length>0&&(this.nameColumn=0)},guessHeaderAssignmentsFromVoTable:function(e){var i=e.getDecColumn();null!=i&&(this.latColumn=i.index,this.astronomical=!0);var n=e.getRAColumn();null!=n&&(this.lngColumn=n.index,this.astronomical=!0,this.pointScaleType=4);var r=e.getMagColumn();null!=r&&(this.sizeColumn=r.index);for(var s=0,a=t.ss.enumerate(e.column);a.moveNext();){var o=a.current;this._guessHeaderAssignment$1(o.name,s++)}this._table$1.header.length>0&&(this.nameColumn=0)},_guessHeaderAssignment$1:function(e,i){(e=e.toLowerCase()).indexOf("lat")>-1&&-1===this.latColumn&&(this.latColumn=i),(e.indexOf("lon")>-1||e.indexOf("lng")>-1)&&-1===this.lngColumn&&(this.lngColumn=i),e.indexOf("dec")>-1&&-1===this.latColumn&&(this.latColumn=i,this.astronomical=!0),(e.indexOf("ra")>-1||e.indexOf("ascen")>-1)&&-1===this.lngColumn&&(this.lngColumn=i,this.astronomical=!0,this.pointScaleType=4),(e.indexOf("mag")>-1||e.indexOf("size")>-1)&&-1===this.sizeColumn&&(this.sizeColumn=i),(e.indexOf("date")>-1||e.indexOf("time")>-1||e.indexOf("dt")>-1||e.indexOf("tm")>-1)&&(e.indexOf("end")>-1&&-1===this.endDateColumn?this.endDateColumn=i:-1===this.startDateColumn&&(this.startDateColumn=i)),(e.indexOf("altitude")>-1||e.indexOf("alt")>-1)&&-1===this.altColumn&&(this.altColumn=i,this.set_altType(1),this.set_altUnit(1)),e.indexOf("depth")>-1&&-1===this.altColumn&&(this.altColumn=i,this.set_altType(0),this.set_altUnit(5)),t.ss.startsWith(e,"x")&&-1===this.get_xAxisColumn()&&this.set_xAxisColumn(i),t.ss.startsWith(e,"y")&&-1===this.get_yAxisColumn()&&this.set_yAxisColumn(i),t.ss.startsWith(e,"z")&&-1===this.get_zAxisColumn()&&this.set_zAxisColumn(i),e.indexOf("color")>-1&&-1===this.get_colorMapColumn()&&this.set_colorMapColumn(i),(e.indexOf("geometry")>-1||e.indexOf("geography")>-1)&&-1===this.geometryColumn&&(this.geometryColumn=i)},computeDateDomainRange:function(e,i){-1===e&&(e=this.startDateColumn),-1===i&&(i=this.endDateColumn),-1===i&&(i=e),this.set_beginRange(new Date("12/31/2100")),this.set_endRange(new Date("12/31/1890"));for(var n=t.ss.enumerate(this._table$1.rows);n.moveNext();){var r=n.current;try{if(e>-1){var s=new Date("12/31/2100");try{(s=new Date(r[e]))<this.get_beginRange()&&this.set_beginRange(s)}catch(t){}try{var a=new Date("12/31/1890");i>-1&&(a=new Date(r[i]))>this.get_endRange()&&this.set_endRange(a)}catch(t){}}}catch(t){}}},checkState:function(){},getMaxValue:function(e){var i=0;this._table$1.lock();for(var n=t.ss.enumerate(this._table$1.rows);n.moveNext();){var r=n.current;try{if(e>-1)try{var s=parseFloat(r[e]);s>i&&(i=s)}catch(t){}}catch(t){}}return this._table$1.unlock(),i},getDomainValues:function(e){var i=[];this._table$1.lock();for(var n=t.ss.enumerate(this._table$1.rows);n.moveNext();){var r=n.current;try{e>-1&&(i.indexOf(r[e])>=0||i.push(r[e]))}catch(t){}}return i.sort(),this._table$1.unlock(),i},get_barChartBitmask:function(){return this._barChartBitmask$1},set_barChartBitmask:function(t){return this._barChartBitmask$1=t,t},_isPointInFrustum$1:function(t,e){for(var i=new Cn(t.x,t.y,t.z,1),n=0;n<6;n++)if(e[n].dot(i)<0)return!1;return!0},getTableDataInView:function(){for(var e="",i=!0,n=t.ss.enumerate(this.get_header());n.moveNext();)i?i=!1:e+="\t",e+=n.current;e+="\r\n";for(var r=t.ss.enumerate(this.get__table().rows);r.moveNext();){var s=r.current,a=parseFloat(s[this.get_lngColumn()]),o=parseFloat(s[this.get_latColumn()]),l=Qs.geoTo3dDouble(o,a);if(this._isPointInFrustum$1(l,an.get_frustum())){i=!0;for(var h=t.ss.enumerate(s);h.moveNext();)i?i=!1:e+="\t",e+=h.current;e+="\r\n"}}return e},prepVertexBuffer:function(e,i){this._table$1.lock(),null!=this.lineList&&this.lineList.clear(),null!=this.lineList2d&&this.lineList2d.clear(),null!=this.triangleList&&this.triangleList.clear(),null!=this.pointList&&this.pointList.clear(),null!=this.triangleList2d&&this.triangleList2d.clear(),null==this.lineList&&(this.lineList=new Es),null==this.pointList&&(this.pointList=new zs(e)),this.lineList.timeSeries=this.timeSeries,null==this.lineList2d&&(this.lineList2d=new Es,this.lineList2d.set_depthBuffered(!1)),this.lineList.timeSeries=this.timeSeries,null==this.triangleList&&(this.triangleList=new Fs),null==this.triangleList2d&&(this.triangleList2d=new Fs,this.triangleList2d.depthBuffered=!1),this.positions.length=0;var n=this.get_color(),r=Qs.meanObliquityOfEcliptic(Wo.get_jNow())/180*Math.PI,s=Dr()[this.get_referenceFrame()].frame.meanRadius;s&&(this._meanRadius$1=s);for(var o=new wn,l=2e-4,h=Xi.get_white(),u=0,c=0,_=t.ss.enumerate(this._table$1.rows);_.moveNext();){var d=_.current;try{if(this.geometryColumn>-1||!this.get_coordinatesType()&&this.lngColumn>-1&&this.latColumn>-1||1===this.get_coordinatesType()&&this.get_xAxisColumn()>-1&&this.get_yAxisColumn()>-1){var g=0,f=0,m=0,p=1,w=0,b=0,v=this.getScaleFactor(this.get_altUnit(),1);if(-1===this.altColumn||3===this.get_altType()||this.bufferIsFlat)p=1,1==(this.astronomical&!this.bufferIsFlat)&&(p=6323967.17);else{this.get_altType()||(v=-v),p=0;try{p=parseFloat(d[this.altColumn])}catch(t){}this.astronomical?(b=p*(v/=149598e6)/206264.806,w=v*p,p*=v):2===this.get_altType()?(w=v*p,p=v*p/this._meanRadius$1):(w=v*p,p=1+v*p/this._meanRadius$1)}if(!this.get_coordinatesType()&&this.lngColumn>-1&&this.latColumn>-1){g=parseFloat(d[this.lngColumn]),f=parseFloat(d[this.latColumn]),this.astronomical?(this.get_raUnits()||(g*=15),this.bufferIsFlat):g+=180;var y=Qs.geoTo3dRad(f,g,p);this.astronomical&&!this.bufferIsFlat&&y.rotateX(r),o=y,this.positions.push(o)}else if(1===this.get_coordinatesType()){var S=this.getScaleFactor(this.get_cartesianScale(),this.get_cartesianCustomScale());this.astronomical?S/=149598e6:S/=this._meanRadius$1,this.get_zAxisColumn()>-1&&(m=parseFloat(d[this.get_zAxisColumn()])),g=parseFloat(d[this.get_xAxisColumn()]),f=parseFloat(d[this.get_yAxisColumn()]),this.get_xAxisReverse()&&(g=-g),this.get_yAxisReverse()&&(f=-f),this.get_zAxisReverse()&&(m=-m),o=wn.create(g*S,m*S,f*S),this.positions.push(o)}switch(this.get_colorMap()){case 0:h=n;break;case 3:h=this.get_colorMapColumn()>-1?this.get_dynamicColor()?this.get_colorMapper().findClosestColor(this.normalizeColorMapValue(parseFloat(d[this.get_colorMapColumn()]))):this._parseColor$1(d[this.get_colorMapColumn()],n):n}if(null==h&&(h=Xi.get_transparent()),this.sizeColumn>-1)switch(this.pointScaleType){case 0:l=parseFloat(d[this.sizeColumn]),l=this.normalizePointSize(l);break;case 2:l=parseFloat(d[this.sizeColumn]),l=Math.log(l);break;case 1:try{l=parseFloat(d[this.sizeColumn]),l=this.normalizePointSize(l),l=Math.pow(2,l)}catch(t){l=0}break;case 4:var x=0;try{x=parseFloat(d[this.sizeColumn]),this.bufferIsFlat?l=40/Math.pow(1.6,x):(x-=5*(a.logN(b,10)-1),l=12e7/Math.pow(1.6,x))}catch(t){l=0}break;case 3:l=1}else l=.2;if(1===this.get_plotType()&&(l=1),this.astronomical,this.bufferIsFlat,this.startDateColumn>-1){var T=new Date(d[this.startDateColumn]);u=Wo.utcToJulian(T)-Wo.utcToJulian(this.baseDate),this.endDateColumn>-1?(T=new Date(d[this.endDateColumn]),c=Wo.utcToJulian(T)-Wo.utcToJulian(this.baseDate)):c=u}this.pointList.addPoint(o,h,new As(u,c),l),this.geometryColumn>-1&&this._parseGeometry$1(d[this.geometryColumn],h,h,w,new As(u,c))}}catch(t){}this.lines=!1}return this._table$1.unlock(),this._dataDirty$1=!1,this.dirty=!1,!1},_parseGeometry$1:function(e,i,n,r,s){var a=(e=t.ss.trim(e).toLowerCase()).indexOf("(");if(!(a<0)&&t.ss.endsWith(e,")")){var o=t.ss.trim(e.substring(0,a)),l=e.substr(a),h=o.split(" "),u=null,c=null;if(h.length>0)for(var _=t.ss.enumerate(h);_.moveNext();){var d=_.current;t.ss.emptyString(u)?u=d:t.ss.emptyString(c)&&(c=d)}switch(u){case"multipolygon":case"polygon":this._parsePolygon$1(l,c,i,n,r,s);break;case"multilinestring":this._parseLineString$1(l,c,i,r,!1,s);break;case"linestring":this._parseLineString$1(l,c,i,r,!0,s);break;case"geometrycollection":l=l.substring(1,l.length-2);for(var g=Fa.splitString(l,","),f=t.ss.enumerate(g);f.moveNext();){var m=f.current;this._parseGeometry$1(m,i,n,r,s)}}}},_parsePolygon$1:function(e,i,n,r,s,a){if(t.ss.startsWith(e,"(")||!t.ss.endsWith(e,")")){e=e.substring(1,e.length-2);for(var o=Fa.splitString(e,","),l=t.ss.enumerate(o);l.moveNext();){var h=l.current,u=new uu;u.astronomical=this.astronomical,u.meanRadius=this._meanRadius$1,u.parseWkt(h,i,s,a),s?this._addPolygon$1(!1,u,1,r,n,!0,!0,a):this._addPolygonFlat$1(!1,u,1,r,n,!0,!0,a)}}},_parseLineString$1:function(e,i,n,r,s,a){if(t.ss.startsWith(e,"(")||!t.ss.endsWith(e,")")){s||(e=e.substring(1,e.length-2));for(var o=Fa.splitString(e,","),l=t.ss.enumerate(o);l.moveNext();){var h=l.current,u=new uu;u.astronomical=this.astronomical,u.meanRadius=this._meanRadius$1,u.parseWkt(h,i,r,a),this._addPolygon$1(!1,u,1,Xi.get_white(),n,!1,!1,a)}}},_splitShapes$1:function(t){for(;0<t.length;)t.substr(0,1);return[]},_addPolygon$1:function(t,e,i,n,r,s,a,o){for(var l=[],h=[],u=0;u<e.pointList.length;u++)l.push(Qs.geoTo3dRad(e.pointList[u].lat,e.pointList[u].lng,1+e.pointList[u].alt/this._meanRadius$1)),h.push(Qs.geoTo3dRad(e.pointList[u].lat,e.pointList[u].lng,1));for(u=0;u<e.pointList.length-1;u++)t||(s&&this.triangleList.addQuad(l[u],l[u+1],h[u],h[u+1],n,o),i>0&&(s?this.lineList.addLine(l[u],l[u+1],r,o):this.lineList2d.addLine(l[u],l[u+1],r,o),s&&(this.lineList.addLine(h[u],h[u+1],r,o),this.lineList.addLine(l[u],h[u],r,o),this.lineList.addLine(l[u+1],h[u+1],r,o))));if(a){var c=as.tesselateSimplePoly(l);for(u=0;u<c.length;u+=3)this.triangleList.addTriangle(l[c[u]],l[c[u+1]],l[c[u+2]],n,o)}},_addPolygonFlat$1:function(t,e,i,n,r,s,a,o){for(var l=[],h=0;h<e.pointList.length;h++)l.push(Qs.geoTo3dRad(e.pointList[h].lat,e.pointList[h].lng,1+e.pointList[h].alt/this._meanRadius$1));for(h=0;h<e.pointList.length-1;h++)t||i>0&&this.lineList2d.addLine(l[h],l[h+1],r,o);if(a){var u=as.tesselateSimplePoly(l);for(h=0;h<u.length;h+=3)this.triangleList2d.addSubdividedTriangles(l[u[h]],l[u[h+1]],l[u[h+2]],n,o,2)}},_parseColor$1:function(t,e){return Oi.load(t)},getScaleFactor:function(t,e){var i=1;switch(t){case 1:i=1;break;case 2:i=.3048;break;case 3:i=.0254;break;case 4:i=1609.344;break;case 5:i=1e3;break;case 6:i=149598e6;break;case 7:i=9460528406976600;break;case 8:i=0x6da0192cd11520;break;case 9:i=30856802447988e9;break;case 10:i=e}return i},get__table:function(){return this._table$1},set__table:function(t){return this._table$1=t,t},useHeadersFromVoTable:function(e){for(var i=t.ss.enumerate(e.column);i.moveNext();){var n=i.current;this.get_header().push(n.name)}this.guessHeaderAssignmentsFromVoTable(e),null!=e.getRAColumn()&&"deg"===e.getRAColumn().unit.toLowerCase()&&this.set_raUnits(1)},loadFromString:function(t,e,i,n,r){e||(this._table$1=new rh),this._table$1.lock(),this._table$1.loadFromString(t,e,n,r),e||(this.guessHeaderAssignments(),this.astronomical&&this.lngColumn>-1&&this.getMaxValue(this.lngColumn)>24&&this.set_raUnits(1)),i&&this.purgeByTime(),this._table$1.unlock()},purgeByTime:function(){if(!(this.startDateColumn<0)){var e=this.startDateColumn;this.endDateColumn>-1&&(e=this.endDateColumn);var i=Wo.get_now(),n=24*t.ss.truncate(this.decay)*60*60*1e3;i=new Date(i.getDate()-n);for(var r=this._table$1.rows.length,s=0;s<r;s++)try{var a=this._table$1.rows[s];new Date(a[e])<i&&(this._table$1.rows.splice(s,1),r--,s--)}catch(t){}}},cleanUp:function(){this.cleanUpBase(),this._table$1.lock(),Cl.prototype.cleanUp.call(this),this._table$1.unlock(),this.dirty=!0},writeLayerProperties:function(t){t._writeAttributeString("TimeSeries",this.get_timeSeries().toString()),t._writeAttributeString("BeginRange",a.xmlDate(this.get_beginRange())),t._writeAttributeString("EndRange",a.xmlDate(this.get_endRange())),t._writeAttributeString("Decay",this.get_decay().toString()),t._writeAttributeString("CoordinatesType",s.toXml("CoordinatesTypes",this.get_coordinatesType())),t._writeAttributeString("LatColumn",this.get_latColumn().toString()),t._writeAttributeString("LngColumn",this.get_lngColumn().toString()),t._writeAttributeString("GeometryColumn",this.get_geometryColumn().toString()),t._writeAttributeString("AltType",s.toXml("AltTypes",this.get_altType())),t._writeAttributeString("MarkerMix",s.toXml("MarkerMixes",this.get_markerMix())),t._writeAttributeString("ColorMap",s.toXml("ColorMaps",this.get_colorMap())),t._writeAttributeString("MarkerColumn",this.get_markerColumn().toString()),t._writeAttributeString("PlotType",s.toXml("PlotTypes",this.get_plotType())),t._writeAttributeString("MarkerIndex",this.get_markerIndex().toString()),t._writeAttributeString("MarkerScale",s.toXml("MarkerScales",this.get_markerScale())),t._writeAttributeString("AltUnit",s.toXml("AltUnits",this.get_altUnit())),t._writeAttributeString("AltColumn",this.get_altColumn().toString()),t._writeAttributeString("StartDateColumn",this.get_startDateColumn().toString()),t._writeAttributeString("EndDateColumn",this.get_endDateColumn().toString()),this._prepareBackCompatTable$1(),this._lastNormalizeSizeColumnIndex$1>-1?(t._writeAttributeString("SizeColumn",this._lastNormalizeSizeColumnIndex$1),t._writeAttributeString("NormalizeSizeColumn",this.sizeColumn.toString())):t._writeAttributeString("SizeColumn",this.get_sizeColumn().toString()),t._writeAttributeString("NormalizeSize",this.get_normalizeSize().toString()),t._writeAttributeString("NormalizeSizeClip",this.get_normalizeSizeClip().toString()),t._writeAttributeString("NormalizeSizeMin",this.get_normalizeSizeMin().toString()),t._writeAttributeString("NormalizeSizeMax",this.get_normalizeSizeMax().toString()),this._lastDynamicColorColumnIndex$1>-1?(t._writeAttributeString("ColorMapColumn",this._lastDynamicColorColumnIndex$1),t._writeAttributeString("DynamicColorColumn",this.get_colorMapColumn().toString())):t._writeAttributeString("ColorMapColumn",this.get_colorMapColumn().toString()),t._writeAttributeString("DynamicColor",this.get_dynamicColor().toString()),t._writeAttributeString("ColorMapperName",this.get_colorMapperName()),t._writeAttributeString("NormalizeColorMap",this.get_normalizeColorMap().toString()),t._writeAttributeString("NormalizeColorMapMin",this.get_normalizeColorMapMin().toString()),t._writeAttributeString("NormalizeColorMapMax",this.get_normalizeColorMapMax().toString()),t._writeAttributeString("HyperlinkFormat",this.get_hyperlinkFormat()),t._writeAttributeString("HyperlinkColumn",this.get_hyperlinkColumn().toString()),t._writeAttributeString("ScaleFactor",this.get_scaleFactor().toString()),t._writeAttributeString("PointScaleType",s.toXml("PointScaleTypes",this.get_pointScaleType())),t._writeAttributeString("ShowFarSide",this.get_showFarSide().toString()),t._writeAttributeString("RaUnits",s.toXml("RAUnits",this.get_raUnits())),t._writeAttributeString("HoverTextColumn",this.get_nameColumn().toString()),t._writeAttributeString("XAxisColumn",this.get_xAxisColumn().toString()),t._writeAttributeString("XAxisReverse",this.get_xAxisReverse().toString()),t._writeAttributeString("YAxisColumn",this.get_yAxisColumn().toString()),t._writeAttributeString("YAxisReverse",this.get_yAxisReverse().toString()),t._writeAttributeString("ZAxisColumn",this.get_zAxisColumn().toString()),t._writeAttributeString("ZAxisReverse",this.get_zAxisReverse().toString()),t._writeAttributeString("CartesianScale",s.toXml("AltUnits",this.get_cartesianScale())),t._writeAttributeString("CartesianCustomScale",this.get_cartesianCustomScale().toString()),t._writeAttributeString("DynamicData",this.get_dynamicData().toString()),t._writeAttributeString("AutoUpdate",this.get_autoUpdate().toString()),t._writeAttributeString("DataSourceUrl",this.get_dataSourceUrl())},get_dynamicData:function(){return this._dynamicData$1},set_dynamicData:function(t){return this._dynamicData$1=t,t},get_autoUpdate:function(){return this._autoUpdate$1},set_autoUpdate:function(t){return this._autoUpdate$1=t,t},get_dataSourceUrl:function(){return this._dataSourceUrl$1},set_dataSourceUrl:function(t){return this._dataSourceUrl$1=t,t},get_timeSeries:function(){return this.timeSeries},set_timeSeries:function(t){return this.timeSeries!==t&&(this.version++,this.timeSeries=t),t},get_beginRange:function(){return this._beginRange$1},set_beginRange:function(e){return t.ss.compareDates(this._beginRange$1,e)||(this.version++,this._beginRange$1=e),e},get_endRange:function(){return this._endRange$1},set_endRange:function(e){return t.ss.compareDates(this._endRange$1,e)||(this.version++,this._endRange$1=e),e},initializeFromXml:function(e){this.set_timeSeries(t.ss.boolean(e.attributes.getNamedItem("TimeSeries").nodeValue)),this.set_beginRange(new Date(e.attributes.getNamedItem("BeginRange").nodeValue)),this.set_endRange(new Date(e.attributes.getNamedItem("EndRange").nodeValue)),this.set_decay(parseFloat(e.attributes.getNamedItem("Decay").nodeValue)),this.set_coordinatesType(s.parse("CoordinatesTypes",e.attributes.getNamedItem("CoordinatesType").nodeValue)),this.get_coordinatesType()<0&&this.set_coordinatesType(0),this.set_latColumn(parseInt(e.attributes.getNamedItem("LatColumn").nodeValue)),this.set_lngColumn(parseInt(e.attributes.getNamedItem("LngColumn").nodeValue)),null!=e.attributes.getNamedItem("GeometryColumn")&&this.set_geometryColumn(parseInt(e.attributes.getNamedItem("GeometryColumn").nodeValue)),this.set_altType(s.parse("AltTypes",e.attributes.getNamedItem("AltType").nodeValue)),this.set_markerMix(0),this.set_colorMap(s.parse("ColorMaps",e.attributes.getNamedItem("ColorMap").nodeValue)),this.set_markerColumn(parseInt(e.attributes.getNamedItem("MarkerColumn").nodeValue)),this.set_colorMapColumn(parseInt(e.attributes.getNamedItem("ColorMapColumn").nodeValue)),this.set_plotType(s.parse("PlotTypes",e.attributes.getNamedItem("PlotType").nodeValue)),this.set_markerIndex(parseInt(e.attributes.getNamedItem("MarkerIndex").nodeValue)),this.set_markerScale(s.parse("MarkerScales",e.attributes.getNamedItem("MarkerScale").nodeValue)),this.set_altUnit(s.parse("AltUnits",e.attributes.getNamedItem("AltUnit").nodeValue)),this.set_altColumn(parseInt(e.attributes.getNamedItem("AltColumn").nodeValue)),this.set_startDateColumn(parseInt(e.attributes.getNamedItem("StartDateColumn").nodeValue)),this.set_endDateColumn(parseInt(e.attributes.getNamedItem("EndDateColumn").nodeValue)),null!=e.attributes.getNamedItem("NormalizeSizeColumn")?this.set_sizeColumn(parseInt(e.attributes.getNamedItem("NormalizeSizeColumn").nodeValue)):this.set_sizeColumn(parseInt(e.attributes.getNamedItem("SizeColumn").nodeValue)),null!=e.attributes.getNamedItem("NormalizeSize")&&(this.set_normalizeSize(t.ss.boolean(e.attributes.getNamedItem("NormalizeSize").nodeValue)),this.set_normalizeSizeClip(t.ss.boolean(e.attributes.getNamedItem("NormalizeSizeClip").nodeValue)),this.set_normalizeSizeMin(parseFloat(e.attributes.getNamedItem("NormalizeSizeMin").nodeValue)),this.set_normalizeSizeMax(parseFloat(e.attributes.getNamedItem("NormalizeSizeMax").nodeValue))),null!=e.attributes.getNamedItem("DynamicColorColumn")?this.set_colorMapColumn(parseInt(e.attributes.getNamedItem("DynamicColorColumn").nodeValue)):this.set_colorMapColumn(parseInt(e.attributes.getNamedItem("ColorMapColumn").nodeValue)),null!=e.attributes.getNamedItem("DynamicColor")&&(this.set_dynamicColor(t.ss.boolean(e.attributes.getNamedItem("DynamicColor").nodeValue)),this.set_colorMapperName(e.attributes.getNamedItem("ColorMapperName").nodeValue),this.set_normalizeColorMap(t.ss.boolean(e.attributes.getNamedItem("NormalizeColorMap").nodeValue)),this.set_normalizeColorMapMin(parseFloat(e.attributes.getNamedItem("NormalizeColorMapMin").nodeValue)),this.set_normalizeColorMapMax(parseFloat(e.attributes.getNamedItem("NormalizeColorMapMax").nodeValue))),this.set_hyperlinkFormat(e.attributes.getNamedItem("HyperlinkFormat").nodeValue),this.set_hyperlinkColumn(parseInt(e.attributes.getNamedItem("HyperlinkColumn").nodeValue)),this.set_scaleFactor(parseFloat(e.attributes.getNamedItem("ScaleFactor").nodeValue)),this.set_pointScaleType(s.parse("PointScaleTypes",e.attributes.getNamedItem("PointScaleType").nodeValue)),null!=e.attributes.getNamedItem("ShowFarSide")&&this.set_showFarSide(t.ss.boolean(e.attributes.getNamedItem("ShowFarSide").nodeValue)),null!=e.attributes.getNamedItem("RaUnits")&&this.set_raUnits(s.parse("RAUnits",e.attributes.getNamedItem("RaUnits").nodeValue)),null!=e.attributes.getNamedItem("HoverTextColumn")&&this.set_nameColumn(parseInt(e.attributes.getNamedItem("HoverTextColumn").nodeValue)),null!=e.attributes.getNamedItem("XAxisColumn")&&(this.set_xAxisColumn(parseInt(e.attributes.getNamedItem("XAxisColumn").nodeValue)),this.set_xAxisReverse(t.ss.boolean(e.attributes.getNamedItem("XAxisReverse").nodeValue)),this.set_yAxisColumn(parseInt(e.attributes.getNamedItem("YAxisColumn").nodeValue)),this.set_yAxisReverse(t.ss.boolean(e.attributes.getNamedItem("YAxisReverse").nodeValue)),this.set_zAxisColumn(parseInt(e.attributes.getNamedItem("ZAxisColumn").nodeValue)),this.set_zAxisReverse(t.ss.boolean(e.attributes.getNamedItem("ZAxisReverse").nodeValue)),this.set_cartesianScale(s.parse("AltUnits",e.attributes.getNamedItem("CartesianScale").nodeValue)),this.set_cartesianCustomScale(parseFloat(e.attributes.getNamedItem("CartesianCustomScale").nodeValue))),null!=e.attributes.getNamedItem("DynamicData")&&(this.set_dynamicData(t.ss.boolean(e.attributes.getNamedItem("DynamicData").nodeValue)),this.set_autoUpdate(t.ss.boolean(e.attributes.getNamedItem("AutoUpdate").nodeValue)),this.set_dataSourceUrl(e.attributes.getNamedItem("DataSourceUrl").nodeValue))},get_decay:function(){return this.decay},set_decay:function(t){return this.decay!==t&&(this.version++,this.decay=t),t},get_coordinatesType:function(){return this._coordinatesType$1},set_coordinatesType:function(t){return this._coordinatesType$1!==t&&(this.version++,this._coordinatesType$1=t),t},get_latColumn:function(){return this.latColumn},set_latColumn:function(t){return this.latColumn!==t&&(this.version++,this.latColumn=t),t},get_lngColumn:function(){return this.lngColumn},set_lngColumn:function(t){return this.lngColumn!==t&&(this.version++,this.lngColumn=t),t},get_geometryColumn:function(){return this.geometryColumn},set_geometryColumn:function(t){return this.geometryColumn!==t&&(this.version++,this.geometryColumn=t),t},get_xAxisColumn:function(){return this._xAxisColumn$1},set_xAxisColumn:function(t){return this._xAxisColumn$1!==t&&(this.version++,this._xAxisColumn$1=t),t},get_yAxisColumn:function(){return this._yAxisColumn$1},set_yAxisColumn:function(t){return this._yAxisColumn$1!==t&&(this.version++,this._yAxisColumn$1=t),t},get_zAxisColumn:function(){return this._zAxisColumn$1},set_zAxisColumn:function(t){return this._zAxisColumn$1!==t&&(this.version++,this._zAxisColumn$1=t),t},get_xAxisReverse:function(){return this._xAxisReverse$1},set_xAxisReverse:function(t){return this._xAxisReverse$1!==t&&(this.version++,this._xAxisReverse$1=t),t},get_yAxisReverse:function(){return this._yAxisReverse$1},set_yAxisReverse:function(t){return this._yAxisReverse$1!==t&&(this.version++,this._yAxisReverse$1=t),t},get_zAxisReverse:function(){return this._zAxisReverse$1},set_zAxisReverse:function(t){return this._zAxisReverse$1!==t&&(this.version++,this._zAxisReverse$1=t),t},get_altType:function(){return this._altType$1},set_altType:function(t){return this._altType$1!==t&&(this.version++,this._altType$1=t),t},get_markerMix:function(){return this._markerMix$1},set_markerMix:function(t){return this._markerMix$1!==t&&(this.version++,this._markerMix$1=t),t},get_raUnits:function(){return this._raUnits$1},set_raUnits:function(t){return this._raUnits$1!==t&&(this.version++,this._raUnits$1=t),t},get_colorMap:function(){return this.colorMap},set_colorMap:function(t){return this.colorMap!==t&&(this.version++,this.colorMap=t),t},get_colorMapperName:function(){return this.colorMapperName},set_colorMapperName:function(t){if(null==Ba.fromNamedColormap(t))throw new Error("Invalid colormap name");return this.version++,this.colorMapperName=t,t},get_colorMapper:function(){return Ba.fromNamedColormap(this.colorMapperName)},get_dynamicColor:function(){return this.dynamicColor},set_dynamicColor:function(t){return this.version++,this.dynamicColor=t,t},get_normalizeColorMap:function(){return this.normalizeColorMap},set_normalizeColorMap:function(t){return this.version++,this.normalizeColorMap=t,t},get_normalizeColorMapMin:function(){return this.normalizeColorMapMin},set_normalizeColorMapMin:function(t){return this.version++,this.normalizeColorMapMin=t,t},get_normalizeColorMapMax:function(){return this.normalizeColorMapMax},set_normalizeColorMapMax:function(t){return this.version++,this.normalizeColorMapMax=t,t},normalizeColorMapValue:function(t){if(!this.get_normalizeColorMap())return t;var e=(t-this.get_normalizeColorMapMin())/(this.get_normalizeColorMapMax()-this.get_normalizeColorMapMin());return e<0?e=0:e>1&&(e=1),e},get_markerColumn:function(){return this._markerColumn$1},set_markerColumn:function(t){return this._markerColumn$1!==t&&(this.version++,this._markerColumn$1=t),t},get_colorMapColumn:function(){return this.colorMapColumn},set_colorMapColumn:function(t){return this.colorMapColumn!==t&&(this.version++,this.colorMapColumn=t),t},get_plotType:function(){return this._plotType$1},set_plotType:function(t){return this._plotType$1!==t&&(this.version++,this._plotType$1=t),t},get_markerIndex:function(){return this._markerIndex$1},set_markerIndex:function(t){return this._markerIndex$1!==t&&(this.version++,this._markerIndex$1=t),t},get_showFarSide:function(){return this._showFarSide$1},set_showFarSide:function(t){return this._showFarSide$1!==t&&(this.version++,this._showFarSide$1=t),t},get_markerScale:function(){return this._markerScale$1},set_markerScale:function(t){return this._markerScale$1!==t&&(this.version++,this._markerScale$1=t),t},get_altUnit:function(){return this._altUnit$1},set_altUnit:function(t){return this._altUnit$1!==t&&(this.version++,this._altUnit$1=t),t},get_cartesianScale:function(){return this._cartesianScale$1},set_cartesianScale:function(t){return this._cartesianScale$1!==t&&(this.version++,this._cartesianScale$1=t),t},get_cartesianCustomScale:function(){return this._cartesianCustomScale$1},set_cartesianCustomScale:function(t){return this._cartesianCustomScale$1!==t&&(this.version++,this._cartesianCustomScale$1=t),t},get_altColumn:function(){return this.altColumn},set_altColumn:function(t){return this.altColumn!==t&&(this.version++,this.altColumn=t),t},get_startDateColumn:function(){return this.startDateColumn},set_startDateColumn:function(t){return this.startDateColumn!==t&&(this.version++,this.startDateColumn=t),t},get_endDateColumn:function(){return this.endDateColumn},set_endDateColumn:function(t){return this.endDateColumn!==t&&(this.version++,this.endDateColumn=t),t},get_sizeColumn:function(){return this.sizeColumn},set_sizeColumn:function(t){return this.sizeColumn!==t&&(this.version++,this.sizeColumn=t),t},get_normalizeSize:function(){return this.normalizeSize},set_normalizeSize:function(t){return this.normalizeSize!==t&&(this.version++,this.normalizeSize=t),t},get_normalizeSizeClip:function(){return this.normalizeSizeClip},set_normalizeSizeClip:function(t){return this.normalizeSizeClip!==t&&(this.version++,this.normalizeSizeClip=t),t},get_normalizeSizeMin:function(){return this.normalizeSizeMin},set_normalizeSizeMin:function(t){return this.normalizeSizeMin!==t&&(this.version++,this.normalizeSizeMin=t),t},get_normalizeSizeMax:function(){return this.normalizeSizeMax},set_normalizeSizeMax:function(t){return this.normalizeSizeMax!==t&&(this.version++,this.normalizeSizeMax=t),t},normalizePointSize:function(t){if(!this.get_normalizeSize())return t;var e=(t-this.get_normalizeSizeMin())/(this.get_normalizeSizeMax()-this.get_normalizeSizeMin());return this.get_normalizeSizeClip()&&(e<0?e=0:e>1&&(e=1)),e},get_nameColumn:function(){return this.nameColumn},set_nameColumn:function(t){return this.nameColumn!==t&&(this.version++,this.nameColumn=t),t},get_hyperlinkFormat:function(){return this._hyperlinkFormat$1},set_hyperlinkFormat:function(t){return this._hyperlinkFormat$1!==t&&(this.version++,this._hyperlinkFormat$1=t),t},get_hyperlinkColumn:function(){return this._hyperlinkColumn$1},set_hyperlinkColumn:function(t){return this._hyperlinkColumn$1!==t&&(this.version++,this._hyperlinkColumn$1=t),t},get_scaleFactor:function(){return this.scaleFactor},set_scaleFactor:function(t){return this.scaleFactor!==t&&(this.version++,this.scaleFactor=t),t},get_pointScaleType:function(){return this.pointScaleType},set_pointScaleType:function(t){return this.pointScaleType!==t&&(this.version++,this.pointScaleType=t),t},draw:function(t,e,i){var n=t;this.version!==this.lastVersion&&this.cleanUp(),this.lastVersion=this.version,this.bufferIsFlat!==i&&(this.cleanUp(),this.bufferIsFlat=i),this.dirty&&this.prepVertexBuffer(n,e);var r=Wo.get_jNow()-Wo.utcToJulian(this.baseDate),s=3*this.scaleFactor;if(i&&this.astronomical&&1===this._markerScale$1&&(s=this.scaleFactor/(t.viewCamera.zoom/360)),null!=this.triangleList2d&&(this.triangleList2d.decay=this.decay,this.triangleList2d.sky=this.get_astronomical(),this.triangleList2d.timeSeries=this.timeSeries,this.triangleList2d.jNow=r,this.triangleList2d.draw(t,e*this.get_opacity(),1)),null!=this.triangleList&&(this.triangleList.decay=this.decay,this.triangleList.sky=this.get_astronomical(),this.triangleList.timeSeries=this.timeSeries,this.triangleList.jNow=r,this.triangleList.draw(t,e*this.get_opacity(),1)),null!=this.pointList)switch(this.pointList.depthBuffered=!1,this.pointList.showFarSide=this.get_showFarSide(),this.pointList.decay=this.timeSeries?this.decay:0,this.pointList.sky=this.get_astronomical(),this.pointList.timeSeries=this.timeSeries,this.pointList.jNow=r,this.pointList.scale=1===this._markerScale$1?s:-s,this._plotType$1){case 0:this.pointList.draw(t,e*this.get_opacity(),!1);break;case 2:this.pointList.drawTextured(t,_u.get__circleTexture$1().texture2d,e*this.get_opacity());break;case 1:this.pointList.drawTextured(t,cu.getPushPinTexture(19),e*this.get_opacity());break;case 3:this.pointList.drawTextured(t,cu.getPushPinTexture(35),e*this.get_opacity());break;case 5:case 4:this.pointList.drawTextured(t,cu.getPushPinTexture(this._markerIndex$1),e*this.get_opacity())}return null!=this.lineList&&(this.lineList.sky=this.get_astronomical(),this.lineList.decay=this.decay,this.lineList.timeSeries=this.timeSeries,this.lineList.jNow=r,this.lineList.drawLines(t,e*this.get_opacity())),null!=this.lineList2d&&(this.lineList2d.sky=this.get_astronomical(),this.lineList2d.decay=this.decay,this.lineList2d.timeSeries=this.timeSeries,this.lineList2d.showFarSide=this.get_showFarSide(),this.lineList2d.jNow=r,this.lineList2d.drawLines(t,e*this.get_opacity())),!0},cleanUpBase:function(){null!=this.lineList&&this.lineList.clear(),null!=this.lineList2d&&this.lineList2d.clear(),null!=this.triangleList2d&&this.triangleList2d.clear(),null!=this.pointList&&this.pointList.clear(),null!=this.triangleList&&this.triangleList.clear()}};function gu(){this._addedTiles$2={},_u.call(this)}function fu(){this.isLongIndex=!1,this.shapeVertexCount=0,this.lines=!1,this.latColumn=-1,this.fixedSize=1,this.decay=0,this.timeSeries=!1,this._dynamicData$1=!1,this._autoUpdate$1=!1,this._dataSourceUrl$1="",this._beginRange$1=new Date("1/1/2100"),this._endRange$1=new Date("01/01/1800"),this.markerDomainValues={},this.colorDomainValues={},this._coordinatesType$1=0,this.lngColumn=-1,this.geometryColumn=-1,this._xAxisColumn$1=-1,this._yAxisColumn$1=-1,this._zAxisColumn$1=-1,this._xAxisReverse$1=!1,this._yAxisReverse$1=!1,this._zAxisReverse$1=!1,this._altType$1=3,this._markerMix$1=0,this._raUnits$1=0,this._colorMap$1=3,this._markerColumn$1=-1,this._colorMapColumn$1=-1,this._plotType$1=0,this._markerIndex$1=0,this._showFarSide$1=!1,this._markerScale$1=1,this._altUnit$1=1,this._cartesianScale$1=1,this._cartesianCustomScale$1=1,this.altColumn=-1,this.startDateColumn=-1,this.endDateColumn=-1,this.sizeColumn=-1,this.nameColumn=0,this._hyperlinkFormat$1="",this._hyperlinkColumn$1=-1,this.scaleFactor=1,this.pointScaleType=1,this.positions=[],this.bufferIsFlat=!1,this.baseDate=new Date(2010,0,1,12,0,0),this.dirty=!0,this._filename$1="",Cl.call(this),this._table$1=null,this._filename$1="",this.set_plotType(2)}n("SpreadSheetLayer",[_u,du,Cl]),n("CatalogSpreadSheetLayer",[gu,{addTileRows:function(e,i){if(!t.ss.keyExists(this._addedTiles$2,e)){for(var n=t.ss.enumerate(i);n.moveNext();){var r=n.current;this.get__table().rows.push(r)}this.dirty=!0,this._addedTiles$2[e]=!0}},removeTileRows:function(e,i){if(t.ss.keyExists(this._addedTiles$2,e)){for(var n=t.ss.enumerate(i);n.moveNext();){var r=n.current;t.ss.remove(this.get__table().rows,r)}this.dirty=!0,delete this._addedTiles$2[e]}},cleanUp:function(){_u.prototype.cleanUp.call(this),t.ss.clearKeys(this._addedTiles$2),this.get__table().rows.length=0}},_u]),fu._circleTexture$1=null,fu.get__circleTexture$1=function(){if(null==fu._circleTexture$1){var t=zr.singleton.engineAssetUrl("circle.png");fu._circleTexture$1=rs.fromUrl(t)}return fu._circleTexture$1},fu.create=function(t,e){var i=new fu;return i._table$1=t,i._filename$1=t.loadFilename,i.set_lngColumn(t.getRAColumn().index),i.set_latColumn(t.getDecColumn().index),i.sizeColumn=t.getColumnByUcd("phot.mag").index,i.set_plotType(e),i};var mu={get_dynamicData:function(){return this._dynamicData$1},set_dynamicData:function(t){return this._dynamicData$1=t,t},get_autoUpdate:function(){return this._autoUpdate$1},set_autoUpdate:function(t){return this._autoUpdate$1=t,t},get_dataSourceUrl:function(){return this._dataSourceUrl$1},set_dataSourceUrl:function(t){return this._dataSourceUrl$1=t,t},get_timeSeries:function(){return this.timeSeries},set_timeSeries:function(t){return this.timeSeries!==t&&(this.version++,this.timeSeries=t),t},get_beginRange:function(){return this._beginRange$1},set_beginRange:function(e){return t.ss.compareDates(this._beginRange$1,e)||(this.version++,this._beginRange$1=e),e},get_endRange:function(){return this._endRange$1},set_endRange:function(e){return t.ss.compareDates(this._endRange$1,e)||(this.version++,this._endRange$1=e),e},initializeFromXml:function(e){switch(this.set_timeSeries(t.ss.boolean(e.attributes.getNamedItem("TimeSeries").nodeValue)),this.set_beginRange(new Date(e.attributes.getNamedItem("BeginRange").nodeValue)),this.set_endRange(new Date(e.attributes.getNamedItem("EndRange").nodeValue)),this.set_decay(parseFloat(e.attributes.getNamedItem("Decay").nodeValue)),this.set_coordinatesType(s.parse("CoordinatesTypes",e.attributes.getNamedItem("CoordinatesType").nodeValue)),this.get_coordinatesType()<0&&this.set_coordinatesType(0),this.set_latColumn(parseInt(e.attributes.getNamedItem("LatColumn").nodeValue)),this.set_lngColumn(parseInt(e.attributes.getNamedItem("LngColumn").nodeValue)),null!=e.attributes.getNamedItem("GeometryColumn")&&this.set_geometryColumn(parseInt(e.attributes.getNamedItem("GeometryColumn").nodeValue)),e.attributes.getNamedItem("AltType").nodeValue){case"Depth":this.set_altType(0);break;case"Altitude":this.set_altType(1);break;case"Distance":this.set_altType(2);break;case"SeaLevel":this.set_altType(3);break;case"Terrain":this.set_altType(4)}switch(this.set_markerMix(0),e.attributes.getNamedItem("ColorMap").nodeValue){case"Same_For_All":this.set__colorMap(0);break;case"Group_by_Values":this.set__colorMap(2);break;case"Per_Column_Literal":this.set__colorMap(3)}switch(this.set_markerColumn(parseInt(e.attributes.getNamedItem("MarkerColumn").nodeValue)),this.set_colorMapColumn(parseInt(e.attributes.getNamedItem("ColorMapColumn").nodeValue)),e.attributes.getNamedItem("PlotType").nodeValue){case"Gaussian":this.set_plotType(0);break;case"Point":this.set_plotType(1);break;case"Circle":this.set_plotType(2);break;case"PushPin":this.set_plotType(4)}switch(this.set_markerIndex(parseInt(e.attributes.getNamedItem("MarkerIndex").nodeValue)),e.attributes.getNamedItem("MarkerScale").nodeValue){case"Screen":this.set_markerScale(0);break;case"World":this.set_markerScale(1)}switch(e.attributes.getNamedItem("AltUnit").nodeValue){case"Meters":this.set_altUnit(1);break;case"Feet":this.set_altUnit(2);break;case"Inches":this.set_altUnit(3);break;case"Miles":this.set_altUnit(4);break;case"Kilometers":this.set_altUnit(5);break;case"AstronomicalUnits":this.set_altUnit(6);break;case"LightYears":this.set_altUnit(7);break;case"Parsecs":this.set_altUnit(8);break;case"MegaParsecs":this.set_altUnit(9);break;case"Custom":this.set_altUnit(10)}switch(this.set_altColumn(parseInt(e.attributes.getNamedItem("AltColumn").nodeValue)),this.set_startDateColumn(parseInt(e.attributes.getNamedItem("StartDateColumn").nodeValue)),this.set_endDateColumn(parseInt(e.attributes.getNamedItem("EndDateColumn").nodeValue)),this.set_sizeColumn(parseInt(e.attributes.getNamedItem("SizeColumn").nodeValue)),this.set_hyperlinkFormat(e.attributes.getNamedItem("HyperlinkFormat").nodeValue),this.set_hyperlinkColumn(parseInt(e.attributes.getNamedItem("HyperlinkColumn").nodeValue)),this.set_scaleFactor(parseFloat(e.attributes.getNamedItem("ScaleFactor").nodeValue)),e.attributes.getNamedItem("PointScaleType").nodeValue){case"Linear":this.set_pointScaleType(0);break;case"Power":this.set_pointScaleType(1);break;case"Log":this.set_pointScaleType(2);break;case"Constant":this.set_pointScaleType(3);break;case"StellarMagnitude":this.set_pointScaleType(4)}if(null!=e.attributes.getNamedItem("ShowFarSide")&&this.set_showFarSide(t.ss.boolean(e.attributes.getNamedItem("ShowFarSide").nodeValue)),null!=e.attributes.getNamedItem("RaUnits"))switch(e.attributes.getNamedItem("RaUnits").nodeValue){case"Hours":this.set_raUnits(0);break;case"Degrees":this.set_raUnits(1)}if(null!=e.attributes.getNamedItem("HoverTextColumn")&&this.set_nameColumn(parseInt(e.attributes.getNamedItem("HoverTextColumn").nodeValue)),null!=e.attributes.getNamedItem("XAxisColumn")){switch(this.set_xAxisColumn(parseInt(e.attributes.getNamedItem("XAxisColumn").nodeValue)),this.set_xAxisReverse(t.ss.boolean(e.attributes.getNamedItem("XAxisReverse").nodeValue)),this.set_yAxisColumn(parseInt(e.attributes.getNamedItem("YAxisColumn").nodeValue)),this.set_yAxisReverse(t.ss.boolean(e.attributes.getNamedItem("YAxisReverse").nodeValue)),this.set_zAxisColumn(parseInt(e.attributes.getNamedItem("ZAxisColumn").nodeValue)),this.set_zAxisReverse(t.ss.boolean(e.attributes.getNamedItem("ZAxisReverse").nodeValue)),e.attributes.getNamedItem("CartesianScale").nodeValue){case"Meters":this.set_cartesianScale(1);break;case"Feet":this.set_cartesianScale(2);break;case"Inches":this.set_cartesianScale(3);break;case"Miles":this.set_cartesianScale(4);break;case"Kilometers":this.set_cartesianScale(5);break;case"AstronomicalUnits":this.set_cartesianScale(6);break;case"LightYears":this.set_cartesianScale(7);break;case"Parsecs":this.set_cartesianScale(8);break;case"MegaParsecs":this.set_cartesianScale(9);break;case"Custom":this.set_cartesianScale(10)}this.set_cartesianCustomScale(parseFloat(e.attributes.getNamedItem("CartesianCustomScale").nodeValue))}null!=e.attributes.getNamedItem("DynamicData")&&(this.set_dynamicData(t.ss.boolean(e.attributes.getNamedItem("DynamicData").nodeValue)),this.set_autoUpdate(t.ss.boolean(e.attributes.getNamedItem("AutoUpdate").nodeValue)),this.set_dataSourceUrl(e.attributes.getNamedItem("DataSourceUrl").nodeValue))},get_decay:function(){return this.decay},set_decay:function(t){return this.decay!==t&&(this.version++,this.decay=t),t},get_coordinatesType:function(){return this._coordinatesType$1},set_coordinatesType:function(t){return this._coordinatesType$1!==t&&(this.version++,this._coordinatesType$1=t),t},get_latColumn:function(){return this.latColumn},set_latColumn:function(t){return this.latColumn!==t&&(this.version++,this.latColumn=t),t},get_lngColumn:function(){return this.lngColumn},set_lngColumn:function(t){return this.lngColumn!==t&&(this.version++,this.lngColumn=t),t},get_geometryColumn:function(){return this.geometryColumn},set_geometryColumn:function(t){return this.geometryColumn!==t&&(this.version++,this.geometryColumn=t),t},get_xAxisColumn:function(){return this._xAxisColumn$1},set_xAxisColumn:function(t){return this._xAxisColumn$1!==t&&(this.version++,this._xAxisColumn$1=t),t},get_yAxisColumn:function(){return this._yAxisColumn$1},set_yAxisColumn:function(t){return this._yAxisColumn$1!==t&&(this.version++,this._yAxisColumn$1=t),t},get_zAxisColumn:function(){return this._zAxisColumn$1},set_zAxisColumn:function(t){return this._zAxisColumn$1!==t&&(this.version++,this._zAxisColumn$1=t),t},get_xAxisReverse:function(){return this._xAxisReverse$1},set_xAxisReverse:function(t){return this._xAxisReverse$1!==t&&(this.version++,this._xAxisReverse$1=t),t},get_yAxisReverse:function(){return this._yAxisReverse$1},set_yAxisReverse:function(t){return this._yAxisReverse$1!==t&&(this.version++,this._yAxisReverse$1=t),t},get_zAxisReverse:function(){return this._zAxisReverse$1},set_zAxisReverse:function(t){return this._zAxisReverse$1!==t&&(this.version++,this._zAxisReverse$1=t),t},get_altType:function(){return this._altType$1},set_altType:function(t){return this._altType$1!==t&&(this.version++,this._altType$1=t),t},get_markerMix:function(){return this._markerMix$1},set_markerMix:function(t){return this._markerMix$1!==t&&(this.version++,this._markerMix$1=t),t},get_raUnits:function(){return this._raUnits$1},set_raUnits:function(t){return this._raUnits$1!==t&&(this.version++,this._raUnits$1=t),t},get__colorMap:function(){return this._colorMap$1},set__colorMap:function(t){return this._colorMap$1!==t&&(this.version++,this._colorMap$1=t),t},get_markerColumn:function(){return this._markerColumn$1},set_markerColumn:function(t){return this._markerColumn$1!==t&&(this.version++,this._markerColumn$1=t),t},get_colorMapColumn:function(){return this._colorMapColumn$1},set_colorMapColumn:function(t){return this._colorMapColumn$1!==t&&(this.version++,this._colorMapColumn$1=t),t},get_plotType:function(){return this._plotType$1},set_plotType:function(t){return this._plotType$1!==t&&(this.version++,this._plotType$1=t),t},get_markerIndex:function(){return this._markerIndex$1},set_markerIndex:function(t){return this._markerIndex$1!==t&&(this.version++,this._markerIndex$1=t),t},get_showFarSide:function(){return this._showFarSide$1},set_showFarSide:function(t){return this._showFarSide$1!==t&&(this.version++,this._showFarSide$1=t),t},get_markerScale:function(){return this._markerScale$1},set_markerScale:function(t){return this._markerScale$1!==t&&(this.version++,this._markerScale$1=t),t},get_altUnit:function(){return this._altUnit$1},set_altUnit:function(t){return this._altUnit$1!==t&&(this.version++,this._altUnit$1=t),t},get_cartesianScale:function(){return this._cartesianScale$1},set_cartesianScale:function(t){return this._cartesianScale$1!==t&&(this.version++,this._cartesianScale$1=t),t},get_cartesianCustomScale:function(){return this._cartesianCustomScale$1},set_cartesianCustomScale:function(t){return this._cartesianCustomScale$1!==t&&(this.version++,this._cartesianCustomScale$1=t),t},get_altColumn:function(){return this.altColumn},set_altColumn:function(t){return this.altColumn!==t&&(this.version++,this.altColumn=t),t},get_startDateColumn:function(){return this.startDateColumn},set_startDateColumn:function(t){return this.startDateColumn!==t&&(this.version++,this.startDateColumn=t),t},get_endDateColumn:function(){return this.endDateColumn},set_endDateColumn:function(t){return this.endDateColumn!==t&&(this.version++,this.endDateColumn=t),t},get_sizeColumn:function(){return this.sizeColumn},set_sizeColumn:function(t){return this.sizeColumn!==t&&(this.version++,this.sizeColumn=t),t},get_nameColumn:function(){return this.nameColumn},set_nameColumn:function(t){return this.nameColumn!==t&&(this.version++,this.nameColumn=t),t},get_hyperlinkFormat:function(){return this._hyperlinkFormat$1},set_hyperlinkFormat:function(t){return this._hyperlinkFormat$1!==t&&(this.version++,this._hyperlinkFormat$1=t),t},get_hyperlinkColumn:function(){return this._hyperlinkColumn$1},set_hyperlinkColumn:function(t){return this._hyperlinkColumn$1!==t&&(this.version++,this._hyperlinkColumn$1=t),t},get_scaleFactor:function(){return this.scaleFactor},set_scaleFactor:function(t){return this.scaleFactor!==t&&(this.version++,this.scaleFactor=t),t},get_pointScaleType:function(){return this.pointScaleType},set_pointScaleType:function(t){return this.pointScaleType!==t&&(this.version++,this.pointScaleType=t),t},draw:function(t,e,i){this.bufferIsFlat!==i&&(this.cleanUp(),this.bufferIsFlat=i),this.dirty&&(this.prepVertexBuffer(t,e),this.dirty=!1);var n=Wo.get_jNow()-Wo.utcToJulian(this.baseDate),r=this.scaleFactor;if(i&&this.astronomical&&1===this._markerScale$1&&(r=this.scaleFactor/(t.viewCamera.zoom/360)),null!=this.triangleList2d&&(this.triangleList2d.decay=this.decay,this.triangleList2d.sky=this.get_astronomical(),this.triangleList2d.timeSeries=this.timeSeries,this.triangleList2d.jNow=n,this.triangleList2d.draw(t,e*this.get_opacity(),1)),null!=this.triangleList&&(this.triangleList.decay=this.decay,this.triangleList.sky=this.get_astronomical(),this.triangleList.timeSeries=this.timeSeries,this.triangleList.jNow=n,this.triangleList.draw(t,e*this.get_opacity(),1)),null!=this.pointList)switch(this.pointList.depthBuffered=!1,this.pointList.showFarSide=this.get_showFarSide(),this.pointList.decay=this.timeSeries?this.decay:0,this.pointList.sky=this.get_astronomical(),this.pointList.timeSeries=this.timeSeries,this.pointList.jNow=n,this.pointList.scale=1===this._markerScale$1?r:-r,this._plotType$1){case 0:this.pointList.draw(t,e*this.get_opacity(),!1);break;case 2:this.pointList.drawTextured(t,fu.get__circleTexture$1().texture2d,e*this.get_opacity());break;case 1:this.pointList.drawTextured(t,cu.getPushPinTexture(19),e*this.get_opacity());break;case 3:this.pointList.drawTextured(t,cu.getPushPinTexture(35),e*this.get_opacity());break;case 5:case 4:this.pointList.drawTextured(t,cu.getPushPinTexture(this._markerIndex$1),e*this.get_opacity())}return null!=this.lineList&&(this.lineList.sky=this.get_astronomical(),this.lineList.decay=this.decay,this.lineList.timeSeries=this.timeSeries,this.lineList.jNow=n,this.lineList.drawLines(t,e*this.get_opacity())),null!=this.lineList2d&&(this.lineList2d.sky=this.get_astronomical(),this.lineList2d.decay=this.decay,this.lineList2d.timeSeries=this.timeSeries,this.lineList2d.showFarSide=this.get_showFarSide(),this.lineList2d.jNow=n,this.lineList2d.drawLines(t,e*this.get_opacity())),!0},initFromXml:function(t){Cl.prototype.initFromXml.call(this,t)},cleanUp:function(){this.dirty=!0,null!=this.lineList&&this.lineList.clear(),null!=this.lineList2d&&this.lineList2d.clear(),null!=this.triangleList2d&&this.triangleList2d.clear(),null!=this.pointList&&this.pointList.clear(),null!=this.triangleList&&this.triangleList.clear()},dynamicUpdate:function(){return!1},addFilesToCabinet:function(e){var i=this._filename$1,n=e.tempDirectory+t.ss.format("{0}\\{1}.txt",e.get_packageID(),this.id.toString());i.substring(0,i.lastIndexOf("\\")+1),n.substring(0,n.lastIndexOf("\\")+1)},loadData:function(e,i){var n=this,r=e.getFileBlob(i),s=new FileReader;s.onloadend=function(e){var i=t.ss.safeCast(s.result,String);n._table$1=oh.loadFromString(i),n.set_lngColumn(n._table$1.getRAColumn().index),n.set_latColumn(n._table$1.getDecColumn().index)},s.readAsText(r)},canCopyToClipboard:function(){return!0},copyToClipboard:function(){},findClosest:function(e,i,n,r){var s,a=Qs.geoTo3dDouble(e.get_lat(),e.get_lng());if(null!=n){var o=Qs.raDecTo3dAu(n.get_RA(),-n.get_dec(),-1);i=(s=wn.subtractVectors(a,o)).length()}for(var l=-1,h=0,u=t.ss.enumerate(this.positions);u.moveNext();){var c=u.current;(s=wn.subtractVectors(a,c)).length()<i&&(i=s.length(),l=h),h++}if(-1===l)return n;var _=Qs.cartesianToSpherical2(this.positions[l]),d=this._table$1.rows[l].columnData[this.nameColumn].toString();this.nameColumn!==this.startDateColumn&&this.nameColumn!==this.endDateColumn||(d=_u.parseDate(d).toString()),t.ss.emptyString(d)&&(d=t.ss.format("RA={0}, Dec={1}",Qs.formatHMS(_.get_RA()),Qs.formatDMS(_.get_dec())));for(var g=tl.create(d,_.get_lat(),_.get_RA(),268435456,"",2,-1),f={},m=0;m<t.ss.keyCount(this._table$1.columns);m++){var p=this._table$1.rows[l].get_item(m).toString();m!==this.startDateColumn&&m!==this.endDateColumn||(p=_u.parseDate(p).toString()),t.ss.keyExists(f,this._table$1.column[m].name)||t.ss.emptyString(this._table$1.column[m].name)?f["Column"+m.toString()]=p:f[this._table$1.column[m].name]=p}return g.set_tag(f),g},prepVertexBuffer:function(e,i){var n=this._table$1.getColumnByUcd("meta.id");null==n&&(n=this._table$1.column[0]);var r=this.isSiapResultSet();null==this.pointList&&(this.pointList=new zs(e)),null==this.lineList2d&&(this.lineList2d=new Es),this.lineList2d.clear();var s=this._table$1.getColumnByUcd("phys.area;obs.field");null==s&&t.ss.keyExists(this._table$1.columns,"regionSTCS")&&(s=this._table$1.columns.regionSTCS),this.get_plotType()?this.set_markerScale(0):this.set_markerScale(1);var a=[],o=new Vs;this.positions.length=0;var l=Oi.fromArgb(t.ss.truncate(i*this.get_color().a),this.get_color().r,this.get_color().g,this.get_color().b);this.pointScaleType=4;for(var h=t.ss.enumerate(this._table$1.rows);h.moveNext();){var u=h.current;try{if(this.lngColumn>-1&&this.latColumn>-1){var c=parseFloat(u.get_item(this.get_lngColumn()).toString()),_=parseFloat(u.get_item(this.get_latColumn()).toString()),d=Qs.geoTo3dDouble(_,c);if(o.position=d,this.positions.push(o.position),o.set_color(l),this.sizeColumn>-1)try{if(this.get_markerScale())switch(this.pointScaleType){case 0:o.pointSize=parseFloat(u.get_item(this.sizeColumn).toString());break;case 2:o.pointSize=Math.log(parseFloat(u.get_item(this.sizeColumn).toString()));break;case 1:o.pointSize=Math.pow(2,parseFloat(u.get_item(this.sizeColumn).toString()));break;case 4:var g=parseFloat(u.get_item(this.sizeColumn).toString());o.pointSize=40/Math.pow(1.6,g)*10;break;case 3:o.pointSize=1}else o.pointSize=20}catch(t){o.pointSize=.01}else this.get_markerScale()?o.pointSize=100*Math.pow(2,1):o.pointSize=20;if(this.startDateColumn>-1){var f=t.ss.date(u.get_item(this.startDateColumn).toString());o.tu=Wo.utcToJulian(f),o.tv=0}a.push(o),this.pointList.addPoint(o.position,o.color,new As(o.tu,o.tv),o.pointSize)}r&&null!=s&&this._addSiapStcRow$1(s.name,u,u===this._table$1.selectedRow)}catch(t){}this.lines=!1}return r&&null!=s&&this._addSiapStcRow$1(s.name,this._table$1.selectedRow,!0),!0},_addSiapStcRow$1:function(e,i,n){var r=t.ss.replaceString(i.getColumnData(e).toString(),"  "," "),s=Oi.fromArgb(120,255,255,255);if(n&&(s=Xi.get_yellow()),t.ss.startsWith(r,"Polygon J2000"))for(var a=r.split(" "),o=a.length,l=0;l<o;)if("Polygon"===a[l]){l+=2;for(var h=new wn,u=new wn,c=!0,_=l;_<o;_+=2){if("Polygon"===a[_]){c=!0;break}var d=15*Qs.parseRA(a[_],!0)+180,g=Qs.parseDec(a[_+1]),f=Qs.geoTo3dDouble(g,d);c?(u=f,c=!1):this.lineList2d.addLine(h,f,s,new As(0,0)),h=f,l+=2}o>4&&this.lineList2d.addLine(u,h,s,new As(0,0))}},isSiapResultSet:function(){return null!=this._table$1.getColumnByUcd("vox:image.title")&&null!=this._table$1.getColumnByUcd("VOX:Image.AccessReference")},get_header:function(){for(var e=new Array(t.ss.keyCount(this._table$1.columns)),i=0,n=t.ss.enumerate(this._table$1.column);n.moveNext();){var r=n.current;e[i++]=r.name}return e},get_table:function(){return this._table$1},set_table:function(t){return this._table$1=t,t}};n("VoTableLayer",[fu,mu,Cl]);var pu={sky:0,ecliptic:1,galactic:2,sun:3,mercury:4,venus:5,earth:6,mars:7,jupiter:8,saturn:9,uranus:10,neptune:11,pluto:12,moon:13,io:14,europa:15,ganymede:16,callisto:17,custom:18,identity:19,sandbox:20};function wu(){}function bu(t,e){this.childMaps={},this.parent=null,this.layers=[],this.open=!1,this.enabled=!0,this.loadedFromTour=!1,this.frame=new Ql,this.set_name(t),this.frame.reference=e;var i=6371e3;switch(e){case 0:case 1:case 2:case 18:case 19:default:break;case 3:i=696e6;break;case 4:i=2439700;break;case 5:i=6051800;break;case 6:i=6371e3;break;case 7:i=339e4;break;case 8:i=69911e3;break;case 9:i=58232e3;break;case 10:i=25362e3;break;case 11:i=24622e3;break;case 12:i=1161e3;break;case 13:i=1737100;break;case 14:i=1821500;break;case 15:i=1561e3;break;case 16:i=2631200;break;case 17:i=2410300}this.frame.meanRadius=i}function vu(){}function yu(){}function Su(){}function xu(){pl.call(this)}function Tu(){pl.call(this)}function Mu(){pl.call(this)}function Cu(){pl.call(this)}n("ReferenceFrames",pu),r("ReferenceFrames",pu),wu._version=0,wu._tourLayers=!1,wu._layerMaps={},wu._layerMapsTours={},wu._allMaps={},wu._allMapsTours={},wu._currentMap="Earth",wu._layerList={},wu._layerListTours={},wu._moonfile="",wu._selectedLayer=null,wu._lastMenuClick=new vn,wu.get_version=function(){return wu._version},wu.set_version=function(t){return wu._version=t,t},wu.get_frameWizardDialog=function(){return wu._frameWizardDialog},wu.get_dataVizWizardDialog=function(){return wu._dataVizWizardDialog},wu.get_referenceFramePropsDialog=function(){return wu._referenceFramePropsDialog},wu.get_greatCircleDlg=function(){return wu._greatCircleDialog},wu.get_tourLayers=function(){return wu._tourLayers},wu.set_tourLayers=function(t){return wu._tourLayers===t||t?wu._tourLayers!==t&&t&&(wu._tourLayers=t,wu.initLayers()):(wu._clearLayers(),wu._tourLayers=t,wu.loadTree()),t},wu.loadTree=function(){null!=Pr&&Pr.refreshLayerManagerNow()},wu.get_layerMaps=function(){return wu.get_tourLayers()?wu._layerMapsTours:wu._layerMaps},wu.set_layerMaps=function(t){return wu.get_tourLayers()?wu._layerMapsTours=t:wu._layerMaps=t,t},wu.get_allMaps=function(){return wu.get_tourLayers()?wu._allMapsTours:wu._allMaps},function(t){Dr=t}(wu.get_allMaps),wu.set_allMaps=function(t){return wu.get_tourLayers()?wu._allMapsTours=t:wu._allMaps=t,t},wu.get_currentMap=function(){return wu._currentMap},wu.set_currentMap=function(t){return wu._currentMap=t,t},wu.get_layerList=function(){return wu.get_tourLayers()?wu._layerListTours:wu._layerList},wu.set_layerList=function(t){return wu.get_tourLayers()?wu._layerListTours=t:wu._layerList=t,t},wu.oneTimeInitialization=function(){null==wu._webFileMoons&&wu.getMoonFile(zr.singleton.engineAssetUrl("moons.txt")),cu.triggerLoadSprite()},wu.initLayers=function(){wu._clearLayers();var t=null,e=!wu.get_tourLayers()&&!Mr;if(e){(t=new bu("ISS",18)).frame.epoch=Wo._twoLineDateToJulian("10184.51609218"),t.frame.semiMajorAxis=6728829.41,t.frame.referenceFrameType=1,t.frame.inclination=51.6442,t.frame.longitudeOfAscendingNode=147.0262,t.frame.eccentricity=9909e-7,t.frame.meanAnomolyAtEpoch=325.5563,t.frame.meanDailyMotion=5659.821558,t.frame.argumentOfPeriapsis=286.4623,t.frame.scale=1,t.frame.semiMajorAxisUnits=1,t.frame.meanRadius=130,t.frame.oblateness=0,t.frame.showOrbitPath=!0;var i,n=new Array(0),r=zr.singleton.coreDynamicUrl("wwtweb/isstle.aspx");(i=new $a(r)).onStateChange=function(){if(1===i.get_state()){var e=i.getText();(n=e.split("\n")).length>1&&t.frame.fromTLE(n[0],n[1],3986004418e5)}},i.send(),t.enabled=!0}wu.get_layerMaps().Sun=new bu("Sun",3),wu.get_layerMaps().Sun.addChild(new bu("Mercury",4)),wu.get_layerMaps().Sun.addChild(new bu("Venus",5)),wu.get_layerMaps().Sun.addChild(new bu("Earth",6)),wu.get_layerMaps().Sun.childMaps.Earth.addChild(new bu("Moon",13)),e&&wu.get_layerMaps().Sun.childMaps.Earth.addChild(t),wu.get_layerMaps().Sun.addChild(new bu("Mars",7)),wu.get_layerMaps().Sun.addChild(new bu("Jupiter",8)),wu.get_layerMaps().Sun.childMaps.Jupiter.addChild(new bu("Io",14)),wu.get_layerMaps().Sun.childMaps.Jupiter.addChild(new bu("Europa",15)),wu.get_layerMaps().Sun.childMaps.Jupiter.addChild(new bu("Ganymede",16)),wu.get_layerMaps().Sun.childMaps.Jupiter.addChild(new bu("Callisto",17)),wu.get_layerMaps().Sun.addChild(new bu("Saturn",9)),wu.get_layerMaps().Sun.addChild(new bu("Uranus",10)),wu.get_layerMaps().Sun.addChild(new bu("Neptune",11)),wu.get_layerMaps().Sun.addChild(new bu("Pluto",12)),wu._addMoons(wu._moonfile),wu.get_layerMaps().Sky=new bu("Sky",0),wu.get_layerMaps().Sun.open=!0,wu._allMaps={},wu._addAllMaps(wu.get_layerMaps(),null),e&&wu._addIss(),wu._version++,wu.loadTree()},wu._addIss=function(){var t=new Jh;t.set_name(Pi.getLocalizedText(1314,"ISS Model  (Toshiyuki Takahei)")),t.enabled=ko.get_active().get_showISSModel(),wu.get_layerList()[t.id]=t,t.set_referenceFrame("ISS"),wu.get_allMaps().ISS.layers.push(t),wu.get_allMaps().ISS.open=!0},wu._addAllMaps=function(e,i){for(var n=t.ss.enumerate(t.ss.keys(e));n.moveNext();){var r=e[n.current];r.frame.parent=i,wu.get_allMaps()[r.get_name()]=r,wu._addAllMaps(r.childMaps,r.get_name())}},wu._clearLayers=function(){for(var e=t.ss.enumerate(t.ss.keys(wu.get_layerList()));e.moveNext();){var i=e.current;wu.get_layerList()[i].cleanUp()}t.ss.clearKeys(wu.get_layerList()),t.ss.clearKeys(wu.get_layerMaps())},wu.getMoonFile=function(t){wu._webFileMoons=new $a(t),wu._webFileMoons.onStateChange=wu.moonFileStateChange,wu._webFileMoons.send()},wu.moonFileStateChange=function(){2===wu._webFileMoons.get_state()?alert(wu._webFileMoons.get_message()):1===wu._webFileMoons.get_state()&&(wu._moonfile=wu._webFileMoons.getText(),wu.initLayers())},wu._addMoons=function(e){for(var i=e.split("\r\n"),n=!0,r=t.ss.enumerate(i);r.moveNext();){var s=r.current;if(n)n=!1;else{var a=s.split("\t");if(a.length>16){var o=a[0],l=new bu(a[2],18);l.frame._systemGenerated=!0,l.frame.epoch=parseFloat(a[1]),l.frame.semiMajorAxis=1e3*parseFloat(a[3]),l.frame.referenceFrameType=1,l.frame.inclination=parseFloat(a[7]),l.frame.longitudeOfAscendingNode=parseFloat(a[8]),l.frame.eccentricity=parseFloat(a[4]),l.frame.meanAnomolyAtEpoch=parseFloat(a[6]),l.frame.meanDailyMotion=parseFloat(a[9]),l.frame.argumentOfPeriapsis=parseFloat(a[5]),l.frame.scale=1,l.frame.semiMajorAxisUnits=1,l.frame.meanRadius=1e3*parseFloat(a[16]),l.frame.rotationalPeriod=parseFloat(a[17]),l.frame.showAsPoint=!1,l.frame.showOrbitPath=!0,l.frame.set_representativeColor(Oi.fromArgb(255,175,216,230)),l.frame.oblateness=0,wu.get_layerMaps().Sun.childMaps[o].addChild(l)}}}},wu.addVoTableLayer=function(t,e){return wu.addVoTableLayerWithPlotType(t,e,2)},wu.addVoTableLayerWithPlotType=function(t,e,i){var n=fu.create(t,i);return n.set_name(e),n.set_astronomical(!0),n.set_referenceFrame("Sky"),wu.get_layerList()[n.id]=n,wu.get_allMaps().Sky.layers.push(n),wu.get_allMaps().Sky.open=!0,n.enabled=!0,wu._version++,wu.loadTree(),n},wu.addImageSetLayer=function(t,e){var i=Nl.create(t);return wu.addFitsImageSetLayer(i,e)},wu.addImageSetLayerCallback=function(t,e,i){var n=Nl.create(t),r=".fits"===t.get_extension()&&null==n.getFitsImage()&&t.get_projection()!==xo.healpix;return r&&(t.get_fitsProperties().onMainImageLoaded=function(t){t.applyDisplaySettings(),null!=i&&i(n)}),wu.addFitsImageSetLayer(n,e),null==i||r&&!t.get_fitsProperties().mainImageLoadedEventHasFired||i(n),n},wu.addFitsImageSetLayer=function(t,e){return t.doneLoading(null),t.set_name(e),t.set_astronomical(!0),t.set_referenceFrame("Sky"),wu.get_layerList()[t.id]=t,wu.get_allMaps().Sky.layers.push(t),wu.get_allMaps().Sky.open=!0,t.enabled=!0,wu._version++,wu.loadTree(),t},wu.getNextFitsName=function(){return wu._getNextName("Fits Image")},wu.getNextImageSetName=function(){return wu._getNextName("Image Set")},wu._getNextName=function(e){for(var i=0,n=t.ss.enumerate(t.ss.keys(wu.get_allMaps()));n.moveNext();)for(var r=n.current,s=t.ss.enumerate(wu.get_allMaps()[r].layers);s.moveNext();){var a=s.current;if(t.ss.startsWith(a.get_name(),e+" ")){var o=t.ss.replaceString(a.get_name(),e+" ","");try{var l=parseInt(o);l>i&&(i=l)}catch(t){}}}return t.ss.format("{0} {1}",e,i+1)},wu._closeAllTourLoadedLayers=function(){for(var e=[],i=t.ss.enumerate(t.ss.keys(wu.get_layerList()));i.moveNext();){var n=i.current,r=wu.get_layerList()[n];r.loadedFromTour&&e.push(r.id)}for(var s=t.ss.enumerate(e);s.moveNext();){var a=s.current;wu.deleteLayerByID(a,!0,!1)}for(var o=[],l=t.ss.enumerate(t.ss.keys(wu.get_allMaps()));l.moveNext();){n=l.current;var h=wu.get_allMaps()[n];h.loadedFromTour&&!h.layers.length&&o.push(h.get_name())}for(var u=t.ss.enumerate(o);u.moveNext();){var c=u.current;wu.purgeLayerMapDeep(wu.get_allMaps()[c],!0)}wu.set_version(wu.get_version()+1),wu.loadTree()},wu.purgeLayerMapDeep=function(e,i){for(var n=t.ss.enumerate(e.layers);n.moveNext();){var r=n.current;wu.deleteLayerByID(r.id,!1,!1)}e.layers.length=0;for(var s=t.ss.enumerate(t.ss.keys(e.childMaps));s.moveNext();){var a=s.current,o=e.childMaps[a];wu.purgeLayerMapDeep(o,!1)}t.ss.clearKeys(e.childMaps),i&&(t.ss.emptyString(e.frame.parent)?t.ss.keyExists(wu.get_layerMaps(),e.get_name())&&delete wu.get_layerMaps()[e.get_name()]:t.ss.keyExists(wu.get_allMaps(),e.frame.parent)&&delete wu.get_allMaps()[e.frame.parent].childMaps[e.get_name()]),delete wu.get_allMaps()[e.get_name()],wu._version++},wu._cleanAllTourLoadedLayers=function(){for(var e=t.ss.enumerate(t.ss.keys(wu.get_layerList()));e.moveNext();){var i=e.current,n=wu.get_layerList()[i];n.loadedFromTour&&(n.loadedFromTour=!1)}},wu.mergeToursLayers=function(){wu._tourLayers=!1;for(var e=!1,i=!1,n=t.ss.enumerate(t.ss.keys(wu._allMapsTours));n.moveNext();){var r=n.current,s=wu._allMapsTours[r];if(!t.ss.keyExists(wu._allMaps,s.get_name())){var a=new bu(s.get_name(),18);a.frame=s.frame,a.loadedFromTour=!0,wu.get_allMaps()[a.get_name()]=a}}wu.connectAllChildren();for(var o=t.ss.enumerate(t.ss.keys(wu._layerListTours));o.moveNext();){r=o.current;var l=wu._layerListTours[r];t.ss.keyExists(wu.get_layerList(),l.id)&&(i||(e=!0,i=!0),e&&wu.deleteLayerByID(l.id,!0,!1)),t.ss.keyExists(wu.get_layerList(),l.id)?l.cleanUp():t.ss.keyExists(wu.get_allMaps(),l.get_referenceFrame())&&(wu.get_layerList()[l.id]=l,wu.get_allMaps()[l.get_referenceFrame()].layers.push(l))}t.ss.clearKeys(wu._layerListTours),t.ss.clearKeys(wu._allMapsTours),t.ss.clearKeys(wu._layerMapsTours),wu.loadTree()},wu.connectAllChildren=function(){for(var e=t.ss.enumerate(t.ss.keys(wu.get_allMaps()));e.moveNext();){var i=e.current,n=wu.get_allMaps()[i];t.ss.emptyString(n.frame.parent)&&!t.ss.keyExists(wu.get_layerMaps(),n.frame.name)?wu.get_layerMaps()[n.get_name()]=n:!t.ss.emptyString(n.frame.parent)&&t.ss.keyExists(wu.get_allMaps(),n.frame.parent)&&(t.ss.keyExists(wu.get_allMaps()[n.frame.parent].childMaps,n.frame.name)||(wu.get_allMaps()[n.frame.parent].childMaps[n.frame.name]=n,n.parent=wu.get_allMaps()[n.frame.parent]))}},wu.deleteLayerByID=function(e,i,n){if(t.ss.keyExists(wu.get_layerList(),e)){var r=wu.get_layerList()[e];return r.cleanUp(),i&&t.ss.remove(wu.get_allMaps()[r.get_referenceFrame()].layers,r),delete wu.get_layerList()[e],wu._version++,n&&wu.loadTree(),!0}return!1},wu._getFrameTarget=function(e,i){var n=new Su,r=wn.get_empty();if(n.target=wn.get_empty(),n.matrix=yn.get_identity(),!t.ss.keyExists(wu.get_allMaps(),i))return n;var a=[],o=wu.get_allMaps()[i];for(a.push(o);18===o.frame.reference;)o=o.parent,a.splice(0,0,o);for(var l=e.get_world().clone(),h=e.get_worldBaseNonRotating(),u=e.get_worldBase(),c=e.get_nominalRadius(),_=t.ss.enumerate(a);_.moveNext();){var d=_.current;18!==d.frame.reference&&20!==d.frame.reference?Jo.setupPlanetMatrix(e,s.parse("SolarSystemObjects",d.frame.name),wn.get_empty(),!1):(d.computeFrame(e),d.frame.useRotatingParentFrame()?e.set_world(yn.multiplyMatrix(d.frame.worldMatrix,e.get_world())):e.set_world(yn.multiplyMatrix(d.frame.worldMatrix,e.get_worldBaseNonRotating())),3===d.frame.referenceFrameType&&e.set_worldBaseNonRotating(e.get_world().clone()),e.set_nominalRadius(d.frame.meanRadius))}r=e.get_world().transform(r);var g=e.get_world().transform(wn.create(0,0,1)),f=wn.subtractVectors(e.get_world().transform(wn.create(0,1,0)),r);return f.normalize(),n.matrix=yn.lookAtLH(new wn,wn.subtractVectors(g,r),f),e.set_nominalRadius(c),e.set_world(l),e.set_worldBaseNonRotating(h),e.set_worldBase(u),n.target=r,n},wu._prepTourLayers=function(){if(qh.get_playing()){var e=kr.uiController;if(null!=e){var i=e.get_tour();if(null!=i.get_currentTourStop()&&(e.updateTweenPosition(-1),!i.get_currentTourStop().get_keyFramed())){i.get_currentTourStop()._updateLayerOpacity();for(var n=t.ss.enumerate(t.ss.keys(i.get_currentTourStop().layers));n.moveNext();){var r=n.current,s=i.get_currentTourStop().layers[r];t.ss.keyExists(wu.get_layerList(),s.id)&&(wu.get_layerList()[s.id].set_opacity(s.frameOpacity),wu.get_layerList()[s.id].setParams(s.frameParams))}}}}},wu._draw=function(e,i,n,r,s,a){if(t.ss.keyExists(wu.get_allMaps(),r)){var o=wu.get_allMaps()[r];if(o.enabled&&(t.ss.keyCount(o.childMaps)||o.layers.length||o.frame.showAsPoint||o.frame.showOrbitPath)){if(qh.get_playing()){var l=kr.uiController;if(null!=l){var h=l.get_tour();if(null!=h.get_currentTourStop()){l.updateTweenPosition(-1),h.get_currentTourStop()._updateLayerOpacity();for(var u=t.ss.enumerate(t.ss.keys(h.get_currentTourStop().layers));u.moveNext();){var c=u.current,_=h.get_currentTourStop().layers[c];t.ss.keyExists(wu.get_layerList(),_.id)&&(wu.get_layerList()[_.id].set_opacity(_.frameOpacity),wu.get_layerList()[_.id].setParams(_.frameParams))}}}}var d=e.get_world(),g=e.get_worldBaseNonRotating(),f=e.get_nominalRadius();1==(18===o.frame.reference|18===o.frame.reference)&&(o.computeFrame(e),1!==o.frame.referenceFrameType&&2!==o.frame.referenceFrameType?e.set_world(yn.multiplyMatrix(o.frame.worldMatrix,e.get_world())):e.set_world(yn.multiplyMatrix(o.frame.worldMatrix,e.get_worldBaseNonRotating())),e.set_nominalRadius(o.frame.meanRadius)),o.frame.showAsPoint;for(var m=0;m<2;m++)for(var p=t.ss.enumerate(wu.get_allMaps()[r].layers);p.moveNext();){var w=p.current;if(!m&&t.ss.canCast(w,Nl)||1===m&&!t.ss.canCast(w,Nl)){var b=!1;if(m||(b=!n&&w.get_overrideDefaultLayer()),w.enabled&&!b){var v=Wo.utcToJulian(w.get_startTime()),y=Wo.utcToJulian(w.get_endTime()),S=Wo.utcToJulian(w.get_startTime())-(1===w.get_fadeType()||3===w.get_fadeType()?w.get_fadeSpan()/864e6:0),x=Wo.utcToJulian(w.get_endTime())+(2===w.get_fadeType()||3===w.get_fadeType()?w.get_fadeSpan()/864e6:0);if(Wo.get_jNow()>S&&Wo.get_jNow()<x){var T=1;Wo.get_jNow()<v&&(T=(Wo.get_jNow()-S)/(w.get_fadeSpan()/864e6)),Wo.get_jNow()>y&&(T=(x-Wo.get_jNow())/(w.get_fadeSpan()/864e6)),w.set_astronomical(n),t.ss.canCast(w,_u)?t.ss.safeCast(w,_u).draw(e,i*T,a):w.draw(e,i*T,a)}}}}if(s)for(var M=t.ss.enumerate(t.ss.keys(wu.get_allMaps()[r].childMaps));M.moveNext();){c=M.current;var C=wu.get_allMaps()[r].childMaps[c];if(t.ss.canCast(C,bu)){if(C.enabled&&C.frame.showOrbitPath&&ko.get_active().get_solarSystemOrbits()&&ko.get_active().get_solarSystemMinorOrbits())if(1===C.frame.referenceFrameType){null==C.frame.get_orbit()&&C.frame.set_orbit(new ql(C.frame.get_elements(),360,C.frame.get_representativeColor(),1,C.parent.frame.meanRadius));var A=e.get_world();e.set_world(yn.multiplyMatrix(o.frame.worldMatrix,e.get_worldBaseNonRotating())),C.frame.get_orbit().draw3D(e,.5,wn.create(0,0,0)),e.set_world(A)}else C.frame.referenceFrameType;18!==C.frame.reference&&19!==C.frame.reference||wu._draw(e,i,n,C.get_name(),s,a)}}e.set_nominalRadius(f),e.set_world(d),e.set_worldBaseNonRotating(g)}}},wu._getVisibleLayerList=function(e){for(var i={},n=t.ss.enumerate(t.ss.keys(wu.get_layerList()));n.moveNext();){var r=n.current,s=wu.get_layerList()[r];if(s.enabled){var a=new Fh;a.startOpacity=a.endOpacity=s.get_opacity(),a.id=s.id,a.startParams=s.getParams(),t.ss.keyExists(e,a.id)?(a.endOpacity=e[a.id].endOpacity,a.endParams=e[a.id].endParams):a.endParams=s.getParams(),i[s.id]=a}}return i},wu.setVisibleLayerList=function(e){for(var i=t.ss.enumerate(t.ss.keys(wu.get_layerList()));i.moveNext();){var n=i.current,r=wu.get_layerList()[n];r.enabled=t.ss.keyExists(e,r.id);try{r.enabled&&(r.set_opacity(e[r.id].frameOpacity),r.setParams(e[r.id].frameParams))}catch(t){}}},function(t){Rr=t}(wu.setVisibleLayerList),wu._preDraw=function(e,i,n,r,s){if(t.ss.keyExists(wu.get_allMaps(),r)){var a=wu.get_allMaps()[r];if(t.ss.keyCount(a.childMaps)||a.layers.length){if(qh.get_playing()){var o=t.ss.safeCast(kr.uiController,qh);if(null!=o){var l=o.get_tour();if(null!=l.get_currentTourStop()){o.updateTweenPosition(-1),l.get_currentTourStop()._updateLayerOpacity();for(var h=t.ss.enumerate(t.ss.keys(l.get_currentTourStop().layers));h.moveNext();){var u=h.current,c=l.get_currentTourStop().layers[u];t.ss.keyExists(wu.get_layerList(),c.id)&&(wu.get_layerList()[c.id].set_opacity(c.frameOpacity),wu.get_layerList()[c.id].setParams(c.frameParams))}}}}var _=e.get_world(),d=e.get_worldBaseNonRotating(),g=e.get_nominalRadius();18===a.frame.reference&&(a.computeFrame(e),1!==a.frame.referenceFrameType?e.set_world(yn.multiplyMatrix(a.frame.worldMatrix,e.get_world())):e.set_world(yn.multiplyMatrix(a.frame.worldMatrix,e.get_worldBaseNonRotating())),e.set_nominalRadius(a.frame.meanRadius));for(var f=0;f<2;f++)for(var m=t.ss.enumerate(wu.get_allMaps()[r].layers);m.moveNext();){var p=m.current;if((!f&&t.ss.canCast(p,Nl)||1===f&&!t.ss.canCast(p,Nl))&&p.enabled){var w=Wo.utcToJulian(p.get_startTime()),b=Wo.utcToJulian(p.get_endTime()),v=Wo.utcToJulian(p.get_startTime())-(1===p.get_fadeType()||3===p.get_fadeType()?p.get_fadeSpan()/864e6:0),y=Wo.utcToJulian(p.get_endTime())+(2===p.get_fadeType()||3===p.get_fadeType()?p.get_fadeSpan()/864e6:0);if(Wo.get_jNow()>v&&Wo.get_jNow()<y){var S=1;Wo.get_jNow()<w&&(S=(Wo.get_jNow()-v)/(p.get_fadeSpan()/864e6)),Wo.get_jNow()>b&&(S=(y-Wo.get_jNow())/(p.get_fadeSpan()/864e6)),a.frame.reference||p.set_astronomical(!0),p.preDraw(e,i*S)}}}if(s)for(var x=t.ss.enumerate(t.ss.keys(wu.get_allMaps()[r].childMaps));x.moveNext();){u=x.current;var T=wu.get_allMaps()[r].childMaps[u];18!==T.frame.reference&&19!==T.frame.reference||wu._preDraw(e,i,n,T.get_name(),s)}e.set_nominalRadius(g),e.set_world(_),e.set_worldBaseNonRotating(d)}}},wu.add=function(e,i){t.ss.keyExists(wu.get_layerList(),e.id)||t.ss.keyExists(wu.get_allMaps(),e.get_referenceFrame())&&(wu.get_layerList()[e.id]=e,wu.get_allMaps()[e.get_referenceFrame()].layers.push(e),wu._version++,i&&wu.loadTree())},wu.layerSelectionChanged=function(e){if(wu._selectedLayer=e,null!=wu._selectedLayer)if(t.ss.canCast(wu._selectedLayer,bu)){var i=t.ss.safeCast(wu._selectedLayer,bu);null!=i&&wu.set_currentMap(i.get_name())}else{var n=t.ss.safeCast(wu._selectedLayer,Nl);if(null!=n&&t.ss.canCast(n.get_imageSet().get_wcsImage(),Ga))return}Pr.setTimeSlider("left",""),Pr.setTimeSlider("right",""),Pr.setTimeSlider("title",Pi.getLocalizedText(667,"Time Scrubber"))},wu.setTimeSliderValue=function(e){var i=t.ss.safeCast(wu._selectedLayer,Nl);null!=i&&t.ss.canCast(i.get_imageSet().get_wcsImage(),Ga)},wu.showLayerMenu=function(e,i,n){if(wu._lastMenuClick=vn.create(i,n),wu._selectedLayer=e,t.ss.canCast(e,bu)?wu.set_currentMap(e.get_name()):t.ss.canCast(e,Cl)&&wu.set_currentMap(e.get_referenceFrame()),t.ss.canCast(e,Cl)&&!t.ss.canCast(e,vu)){var r=e;wu._contextMenu=new Gs;var a=Xs.create(Pi.getLocalizedText(225,"Rename")),o=Xs.create(Pi.getLocalizedText(981,"Expand")),l=Xs.create(Pi.getLocalizedText(982,"Collapse")),h=Xs.create(Pi.getLocalizedText(428,"Copy")),u=Xs.create(Pi.getLocalizedText(167,"Delete")),c=Xs.create(Pi.getLocalizedText(960,"Save...")),_=Xs.create(Pi.getLocalizedText(983,"Publish to Community...")),d=Xs.create(Pi.getLocalizedText(458,"Color/Opacity")),g=Xs.create(Pi.getLocalizedText(305,"Opacity")),f=Xs.create(Pi.getLocalizedText(20,"Properties")),m=Xs.create(Pi.getLocalizedText(1291,"Scale/Histogram")),p=Xs.create(Pi.getLocalizedText(683,"Lifetime")),w=new Hs,b=Xs.create(Pi.getLocalizedText(684,"Move to Top")),v=Xs.create(Pi.getLocalizedText(685,"Move Up")),y=Xs.create(Pi.getLocalizedText(686,"Move Down")),S=Xs.create(Pi.getLocalizedText(687,"Move to Bottom")),x=Xs.create(Pi.getLocalizedText(957,"VO Table Viewer")),T=new Hs,M=Xs.create(Pi.getLocalizedText(1294,"Background Image Set"));if(b.click=wu._top_Click,v.click=wu._up_Click,y.click=wu._down_Click,S.click=wu._bottom_Click,c.click=wu._saveMenu_Click,_.click=wu._publishMenu_Click,o.click=wu._expand_Click,l.click=wu._collapse_Click,h.click=wu._copyMenu_Click,d.click=wu._colorMenu_Click,u.click=wu._deleteMenu_Click,a.click=wu._renameMenu_Click,f.click=wu._propertiesMenu_Click,m.click=wu.scaleMenu_click,M.click=wu._defaultImageset_Click,g.click=wu._opacityMenu_Click,p.click=wu._lifeTimeMenu_Click,x.click=wu._showViewer_Click,wu._contextMenu.items.push(a),!r.get_opened()&&null!=r.getPrimaryUI()&&r.getPrimaryUI().get_hasTreeViewNodes()&&wu._contextMenu.items.push(o),r.get_opened()&&wu._contextMenu.items.push(l),r.canCopyToClipboard(),wu._contextMenu.items.push(u),wu._contextMenu.items.push(T),wu._contextMenu.items.push(d),t.ss.canCast(e,Nl)){wu._contextMenu.items.push(M);var C=t.ss.safeCast(e,Nl);M.checked=C.get_overrideDefaultLayer()}(t.ss.canCast(e,_u)||t.ss.canCast(e,El))&&wu._contextMenu.items.push(f),t.ss.canCast(e,fu)&&wu._contextMenu.items.push(x),t.ss.canCast(e,Nl)&&(C=t.ss.safeCast(e,Nl),wu._contextMenu.items.push(m)),wu.get_allMaps()[r.get_referenceFrame()].layers.length>1&&(wu._contextMenu.items.push(w),wu._contextMenu.items.push(b),wu._contextMenu.items.push(v),wu._contextMenu.items.push(y),wu._contextMenu.items.push(S)),wu._contextMenu._show(vn.create(i,n))}else if(t.ss.canCast(e,bu)){var A=t.ss.safeCast(e,bu),L="Sandbox"===A.frame.reference.toString(),I="Dome"===A.frame.name,k="Sky"===A.frame.name;if(I)return;wu._contextMenu=new Gs;var P=Xs.create(Pi.getLocalizedText(1298,"Track this frame")),R=Xs.create(Pi.getLocalizedText(1299,"Fly Here")),E=Xs.create("Show Orbit"),D=Xs.create(Pi.getLocalizedText(674,"New Reference Frame")),F=Xs.create(Pi.getLocalizedText(675,"New Layer Group")),N=Xs.create(Pi.getLocalizedText(166,"Add")),$=Xs.create("Add Light"),z=(Xs.create(Pi.getLocalizedText(956,"Add OData/table feed as Layer")),Xs.create(Pi.getLocalizedText(987,"New WMS Layer")),Xs.create(Pi.getLocalizedText(1300,"New Lat/Lng Grid"))),B=Xs.create(Pi.getLocalizedText(988,"New Great Circle")),U=(Xs.create(Pi.getLocalizedText(989,"Import Orbital Elements")),Xs.create(Pi.getLocalizedText(1301,"Add Minor Planet"))),V=Xs.create(Pi.getLocalizedText(167,"Delete")),O=Xs.create(Pi.getLocalizedText(425,"Paste")),G=(Xs.create(Pi.getLocalizedText(1290,"Add to Timeline")),Xs.create(Pi.getLocalizedText(1280,"Add Keyframe")),Xs.create(Pi.getLocalizedText(20,"Properties"))),X=(c=Xs.create(Pi.getLocalizedText(990,"Save Layers")),Xs.create(Pi.getLocalizedText(991,"Publish Layers to Community")),w=new Hs,new Hs),H=(T=new Hs,Xs.create("As Reference Frame")),Y=Xs.create("As Orbital Line");if(P.click=wu._trackFrame_Click,R.click=wu._goTo_Click,H.click=wu._addMpc_Click,Y.click=wu._asOrbitalLines_Click,U.dropDownItems.push(H),U.dropDownItems.push(Y),N.click=wu._addMenu_Click,F.click=wu._newLayerGroupMenu_Click,O.click=wu._pasteLayer_Click,D.click=wu._newMenu_Click,V.click=wu._deleteFrameMenu_Click,G.click=wu._framePropertiesMenu_Click,B.click=wu._addGreatCircle_Click,z.click=wu._addGirdLayer_Click,Xs.create("Extract Orbit Layer"),19!==A.frame.reference){if(1==(kr.get_solarSystemMode()|kr.sandboxMode)){var j=!1;if(18===A.frame.reference||kr.sandboxMode)L||k||(wu._contextMenu.items.push(P),j=!0),E.checked=A.frame.showOrbitPath,E.click=wu._showOrbit_Click;else try{var W=A.frame.reference.toString();if("Sandbox"!==W){var q=s.parse("SolarSystemObjects",W),Z=Math.pow(2,q);E.checked=!!(ko.get_active().get_planetOrbitsFilter()&Z),E.click=wu._showOrbitPlanet_Click,E.tag=Z.toString()}}catch(t){}j&&wu._contextMenu.items.push(T),k||L||(wu._contextMenu.items.push(E),wu._contextMenu.items.push(X)),"Sandbox"===A.frame.reference.toString()&&wu._contextMenu.items.push($)}k||wu._contextMenu.items.push(D)}k||(wu._contextMenu.items.push(B),wu._contextMenu.items.push(z)),(19!==A.frame.reference&&"Sun"===A.frame.name||19===A.frame.reference&&null!=A.parent&&"Sun"===A.parent.frame.name)&&wu._contextMenu.items.push(U),18===A.frame.reference&&1===A.frame.referenceFrameType&&null!=A.parent&&A.parent.frame.name,wu._contextMenu.items.push(O),19===A.frame.reference&&wu._contextMenu.items.push(V),18===A.frame.reference&&(wu._contextMenu.items.push(V),wu._contextMenu.items.push(G)),wu._contextMenu.items.push(w),wu._contextMenu._show(vn.create(i,n))}},wu._publishMenu_Click=function(t,e){},wu._addGirdLayer_Click=function(t,e){var i=new Fl;i.enabled=!0,i.set_name("Lat-Lng Grid"),wu.get_layerList()[i.id]=i,i.set_referenceFrame(wu._currentMap),wu.get_allMaps()[wu._currentMap].layers.push(i),wu.get_allMaps()[wu._currentMap].open=!0,wu._version++,wu.loadTree()},wu._trackFrame_Click=function(t,e){var i=wu._selectedLayer;an.set_solarSystemTrack(20),an.set_trackingFrame(i.get_name()),an.viewCamera.zoom=an.targetCamera.zoom=1e-9},wu._goTo_Click=function(t,e){},wu._saveMenu_Click=function(t,e){},wu._expand_Click=function(t,e){},wu._collapse_Click=function(t,e){},wu._copyMenu_Click=function(e,i){null!=wu._selectedLayer&&t.ss.canCast(wu._selectedLayer,Cl)&&wu._selectedLayer.copyToClipboard()},wu._newLayerGroupMenu_Click=function(t,e){},wu._importTLEFile=function(t){},wu._makeLayerGroupNow=function(t){var e=wu._selectedLayer;wu._makeLayerGroup(t,e)},wu._makeLayerGroup=function(t,e){var i=new Ql;i.name=t,i.reference=19;var n=new bu(i.name,19);n.frame=i,n.frame._systemGenerated=!1,e.addChild(n),n.frame.parent=e.get_name(),wu.get_allMaps()[i.name]=n,wu._version++},wu._lifeTimeMenu_Click=function(t,e){},wu._deleteFrameMenu_Click=function(t,e){},wu._framePropertiesMenu_Click=function(t,e){var i=wu._selectedLayer;wu.get_referenceFramePropsDialog().show(i.frame,e)},wu._newMenu_Click=function(t,e){var i=new Ql;wu.get_frameWizardDialog().show(i,e)},wu.referenceFrameWizardFinished=function(e){var i=wu._selectedLayer,n=new bu(e.name,18);t.ss.keyExists(wu.get_allMaps(),e.name)||(n.frame=e,i.addChild(n),n.frame.parent=i.get_name(),wu.get_allMaps()[e.name]=n,wu._version++,wu.loadTree())},wu.pasteFromTle=function(e,i){for(var n="",r="",s=0;s<e.length;s++)e[s]=t.ss.trim(e[s]),69===e[s].length&&Ql.isTLECheckSumGood(e[s])&&(n.length||"1"!==e[s].substring(0,1)||(n=e[s]),r.length||"2"!==e[s].substring(0,1)||(r=e[s]));return 69===n.length&&69===r.length&&(i.fromTLE(n,r,3986004418e5),!0)},wu._opacityMenu_Click=function(t,e){},wu._defaultImageset_Click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,Nl);n.set_overrideDefaultLayer(!n.get_overrideDefaultLayer())},wu._propertiesMenu_Click=function(e,i){if(t.ss.canCast(wu._selectedLayer,_u)){var n=wu._selectedLayer;wu.get_dataVizWizardDialog().show(n,i)}t.ss.canCast(wu._selectedLayer,El)&&wu.get_greatCircleDlg().show(wu._selectedLayer,new t.ss.EventArgs)},wu._renameMenu_Click=function(e,i){var n=wu._selectedLayer,r=new qs(Pi.getLocalizedText(225,"Rename"),Pi.getLocalizedText(228,"New Name"),n.get_name(),32);r.show(wu._lastMenuClick,(function(){t.ss.emptyString(r.text)||(n.set_name(r.text),wu._version++,wu.loadTree())}))},wu._colorMenu_Click=function(t,e){var i=wu._selectedLayer,n=new ml;null!=i.get_color()&&(n.color=i.get_color()),n.callBack=function(){i.set_color(n.color)},n.show(e)},wu._addMenu_Click=function(t,e){},wu._deleteMenu_Click=function(t,e){wu._deleteSelectedLayer()},wu._deleteSelectedLayer=function(){if(null!=wu._selectedLayer&&t.ss.canCast(wu._selectedLayer,Cl)){var e=wu._selectedLayer;delete wu.get_layerList()[e.id],t.ss.remove(wu.get_allMaps()[wu.get_currentMap()].layers,e),e.cleanUp(),e.set_version(e.get_version()+1),wu.loadTree(),wu._version++}},wu.scaleMenu_click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,Nl);if(null!=n){var r=new bl;r.image=n.getFitsImage(),r.layer=n,r.show(vn.create(200,200))}},wu._showViewer_Click=function(e,i){if(t.ss.canCast(wu._selectedLayer,fu)){var n=t.ss.safeCast(wu._selectedLayer,fu);Pr.displayVoTableLayer(n)}},wu._bottom_Click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,Cl);null!=n&&(t.ss.remove(wu.get_allMaps()[n.get_referenceFrame()].layers,n),wu.get_allMaps()[n.get_referenceFrame()].layers.push(n)),wu._version++,wu.loadTree()},wu._down_Click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,Cl);if(null!=n){var r=wu.get_allMaps()[n.get_referenceFrame()].layers.lastIndexOf(n);r<wu.get_allMaps()[n.get_referenceFrame()].layers.length-1&&(t.ss.remove(wu.get_allMaps()[n.get_referenceFrame()].layers,n),wu.get_allMaps()[n.get_referenceFrame()].layers.splice(r+1,0,n))}wu._version++,wu.loadTree()},wu._up_Click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,Cl);if(null!=n){var r=wu.get_allMaps()[n.get_referenceFrame()].layers.lastIndexOf(n);r>0&&(t.ss.remove(wu.get_allMaps()[n.get_referenceFrame()].layers,n),wu.get_allMaps()[n.get_referenceFrame()].layers.splice(r-1,0,n))}wu._version++,wu.loadTree()},wu._top_Click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,Cl);null!=n&&(t.ss.remove(wu.get_allMaps()[n.get_referenceFrame()].layers,n),wu.get_allMaps()[n.get_referenceFrame()].layers.splice(0,0,n)),wu._version++,wu.loadTree()},wu._pasteLayer_Click=function(t,e){wu.get_dataVizWizardDialog().show(wu.get_currentMap(),e)},wu.createSpreadsheetLayer=function(t,e,i){var n=new _u;return n.loadFromString(i,!1,!1,!1,!0),n.set_name(e),wu.addSpreadsheetLayer(n,t),n},wu.addSpreadsheetLayer=function(t,e){t.enabled=!0,t.set_referenceFrame(e),wu.add(t,!0)},wu._showOrbitPlanet_Click=function(t,e){try{var i=parseInt(t.tag.toString());ko.get_globalSettings().get_planetOrbitsFilter()&i?ko.get_globalSettings().set_planetOrbitsFilter(ko.get_globalSettings().get_planetOrbitsFilter()&~i):ko.get_globalSettings().set_planetOrbitsFilter(ko.get_globalSettings().get_planetOrbitsFilter()|i)}catch(t){}},wu._showOrbit_Click=function(e,i){var n=t.ss.safeCast(wu._selectedLayer,bu);n.frame.showOrbitPath=!n.frame.showOrbitPath},wu._addGreatCircle_Click=function(t,e){wu._addGreatCircleLayer()},wu._addMpc_Click=function(e,i){var n=wu._selectedLayer,r=new qs(Pi.getLocalizedText(1302,"Minor planet name or designation"),Pi.getLocalizedText(238,"Name"),"",32),s=!1;do{if(1===r.showDialog())if(t.ss.keyExists(n.childMaps,r.text))s=!0;else try{wu._getMpc(r.text,n),s=!1}catch(t){s=!0}else s=!1}while(s)},wu._asOrbitalLines_Click=function(e,i){var n=wu._selectedLayer,r=new qs(Pi.getLocalizedText(1302,"Minor planet name or designation"),Pi.getLocalizedText(238,"Name"),"",32);r.show(Ri.get_position(),(function(){t.ss.keyExists(n.childMaps,r.text)||wu._getMpcAsTLE(r.text,n)}))},wu._getMpcAsTLE=function(e,i){var n=new $a("https://www.minorplanetcenter.net/db_search/show_object?object_id="+e);n.onStateChange=function(){if(1===n.get_state()){var r=n.getText(),s=r.indexOf("show-orbit-button"),a=r.indexOf("/form",s),o=r.substring(s,a),l=e,h=new Ql;h.oblateness=0,h.showOrbitPath=!0,h.showAsPoint=!0,h.epoch=Wo.utcToJulian(t.ss.date(wu._getValueByID(o,"epoch").substring(0,10))),h.semiMajorAxis=149598e3*parseFloat(wu._getValueByID(o,"a"))*1e3,h.referenceFrameType=1,h.inclination=parseFloat(wu._getValueByID(o,"incl")),h.longitudeOfAscendingNode=parseFloat(wu._getValueByID(o,"node")),h.eccentricity=parseFloat(wu._getValueByID(o,"e")),h.meanAnomolyAtEpoch=parseFloat(wu._getValueByID(o,"m")),h.meanDailyMotion=$n.meanMotionFromSemiMajorAxis(parseFloat(wu._getValueByID(o,"a"))),h.argumentOfPeriapsis=parseFloat(wu._getValueByID(o,"peri")),h.scale=1,h.semiMajorAxisUnits=1,h.meanRadius=10,h.oblateness=0;var u=l+"\n"+h.toTLE();wu._loadOrbitsFile(e,u,i.get_name()),wu.loadTree()}},n.send()},wu._getMpc=function(e,i){var n=new $a("https://www.minorplanetcenter.net/db_search/show_object?object_id="+e);n.onStateChange=function(){var r=n.getText(),s=r.indexOf("show-orbit-button"),a=r.indexOf("/form",s),o=r.substring(s,a),l=e,h=new bu(t.ss.trim(l),18);h.frame.oblateness=0,h.frame.showOrbitPath=!0,h.frame.showAsPoint=!0,h.frame.epoch=Wo.utcToJulian(t.ss.date(wu._getValueByID(o,"epoch").substring(0,10))),h.frame.semiMajorAxis=149598e3*parseFloat(wu._getValueByID(o,"a"))*1e3,h.frame.referenceFrameType=1,h.frame.inclination=parseFloat(wu._getValueByID(o,"incl")),h.frame.longitudeOfAscendingNode=parseFloat(wu._getValueByID(o,"node")),h.frame.eccentricity=parseFloat(wu._getValueByID(o,"e")),h.frame.meanAnomolyAtEpoch=parseFloat(wu._getValueByID(o,"m")),h.frame.meanDailyMotion=$n.meanMotionFromSemiMajorAxis(parseFloat(wu._getValueByID(o,"a"))),h.frame.argumentOfPeriapsis=parseFloat(wu._getValueByID(o,"peri")),h.frame.scale=1,h.frame.semiMajorAxisUnits=1,h.frame.meanRadius=10,h.frame.oblateness=0,t.ss.keyExists(wu.get_allMaps()[i.get_name()].childMaps,t.ss.trim(l))||wu.get_allMaps()[i.get_name()].addChild(h),wu.get_allMaps()[h.get_name()]=h,h.frame.parent=i.get_name(),wu._makeLayerGroup("Minor Planet",h),wu.loadTree()}},wu._getValueByID=function(t,e){var i=t.indexOf('id="'+e+'"');i=t.indexOf("value=",i)+7;var n=t.indexOf('"',i);return t.substr(i,n-i)},wu._addGreatCircleLayer=function(){var e=new El,i=an.viewCamera;e.set_latStart(i.lat),e.set_latEnd(i.lat-5),e.set_lngStart(i.lng),e.set_lngEnd(i.lng+5),e.set_width(4),e.enabled=!0,e.set_name(Pi.getLocalizedText(1144,"Great Circle Route")),wu.get_layerList()[e.id]=e,e.set_referenceFrame(wu._currentMap),wu.get_allMaps()[wu._currentMap].layers.push(e),wu.get_allMaps()[wu._currentMap].open=!0,wu._version++,wu.loadTree(),wu.get_greatCircleDlg().show(e,new t.ss.EventArgs)},wu._loadOrbitsFile=function(t,e,i){var n=new eh;return n.loadString(e),n.enabled=!0,n.set_name(t),wu.get_layerList()[n.id]=n,n.set_referenceFrame(i),wu.get_allMaps()[i].layers.push(n),wu.get_allMaps()[i].open=!0,wu._version++,wu.loadTree(),n},n("LayerManager",[wu,{},null]),n("LayerMap",[bu,{addChild:function(t){t.parent=this,this.childMaps[t.get_name()]=t},get_name:function(){return this.frame.name},set_name:function(t){return this.frame.name=t,t},computeFrame:function(t){18===this.frame.reference&&this.frame.computeFrame(t)},toString:function(){return this.get_name()}},null]),n("SkyOverlays",[vu,{},null]),n("GroundOverlayLayer",[yu,{},null]),n("FrameTarget",[Su,{},null]),Cl.fromXml=function(e,i){var n=e.attributes.getNamedItem("Type").nodeValue,r=t.ss.replaceString(n,"TerraViewer.","");if(null==r)return null;var s=null;switch(r){case"SpreadSheetLayer":s=new _u;break;case"GreatCirlceRouteLayer":s=new El;break;case"GridLayer":s=new Fl;break;case"ImageSetLayer":s=new Nl;break;case"Object3dLayer":s=new Bl;break;case"OrbitLayer":s=new eh;break;case"VoTableLayer":s=new fu;break;default:return null}return s.initFromXml(e),s},n("FrameWizard",[xu,{OK:function(t){wu.referenceFrameWizardFinished(t)}},pl]),n("ReferenceFrameProps",[Tu,{OK:function(t){wu.loadTree()}},pl]),n("GreatCircleDialog",[Mu,{OK:function(t){}},pl]),n("DataVizWizard",[Cu,{OK:function(){}},pl]),wu._frameWizardDialog=new xu,wu._dataVizWizardDialog=new Cu,wu._referenceFramePropsDialog=new Tu,wu._greatCircleDialog=new Mu;var Au={beginner:0,intermediate:1,advanced:2,educator:3,professional:4};function Lu(){this._tourDirty=0,this._workingDirectory="",this.url="",this._tagId="",this._representativeThumbnailTourstop=0,this._id="",this._title="",this._runTime=0,this._lastDirtyCheck=0,this._description="",this._attributesAndCredits="",this._authorEmailOther="",this._authorEmail="",this._authorUrl="",this._authorPhone="",this._authorContactText="",this._orgName="None",this._orgUrl="",this._author="",this._authorImageUrl="",this._authorImage=null,this._organizationUrl="",this._filename="",this._level=0,this._type=268435456,this._taxonomy="",this._keywords="",this._objects="",this._editMode=!1,this.explicitTourLinks=[],this.implicitTourLinks=[],this._tourStops=[],this._currentTourstopIndex=-1,this._textureList={},this._textureList2d={},this._fileCache={},this.dontCleanUpTempFiles=!1,this._id=Ii.newGuid().toString()}n("UserLevel",Au),r("UserLevel",Au),Lu.get_baseWorkingDirectory=function(){return""},Lu.fromUrl=function(e,i){var n=new Lu;return n.url=e,n._callMe=i,n._cabinet=ch.fromUrl(e,t.ss.bind("_loadXmlDocument",n)),n},Lu.fromUrlRaw=function(t,e){var i=new Lu;return i.url=t,i._callMe=e,i._cabinet=ch.fromUrl(t,e),i},function(t){Er=t}(Lu.fromUrlRaw);var Iu={get_tourDirty:function(){return this._tourDirty>0},set_tourDirty:function(t){return t?this._tourDirty++:this._tourDirty=0,t},get_workingDirectory:function(){return t.ss.emptyString(this._workingDirectory)&&(this._workingDirectory=Lu.get_baseWorkingDirectory()+this._id+"\\"),this._workingDirectory},set_workingDirectory:function(t){return this._workingDirectory=t,t},_loadXmlDocument:function(){var e=this;try{var i=this._cabinet.get_masterFile(),n=new FileReader;n.onloadend=function(i){var r=t.ss.safeCast(n.result,String),s=new DOMParser;e.fromXml(s.parseFromString(r,"text/xml")),e._callMe()},n.readAsText(this._cabinet.getFileBlob(i))}catch(t){Pr._fireTourError(t)}},fromXml:function(e){var i=a.selectSingleNode(e,"Tour");this._id=i.attributes.getNamedItem("ID").nodeValue,this.set_title(i.attributes.getNamedItem("Title").nodeValue),this.set_author(i.attributes.getNamedItem("Author").nodeValue),null!=i.attributes.getNamedItem("Descirption")&&this.set_description(i.attributes.getNamedItem("Descirption").nodeValue),null!=i.attributes.getNamedItem("AuthorEmail")&&(this._authorEmail=i.attributes.getNamedItem("AuthorEmail").nodeValue),null!=i.attributes.getNamedItem("Keywords")&&this.set_keywords(i.attributes.getNamedItem("Keywords").nodeValue),null!=i.attributes.getNamedItem("OrganizationName")&&this.set_orgName(i.attributes.getNamedItem("OrganizationName").nodeValue),this._organizationUrl=i.attributes.getNamedItem("OrganizationUrl").nodeValue,this._level=s.parse("UserLevel",i.attributes.getNamedItem("UserLevel").nodeValue),this._type=s.parse("Classification",i.attributes.getNamedItem("Classification").nodeValue),this._taxonomy=i.attributes.getNamedItem("Taxonomy").nodeValue;for(var n=a.selectSingleNode(i,"TourStops"),r=t.ss.enumerate(n.childNodes);r.moveNext();){var o=r.current;"TourStop"===o.nodeName&&this.addTourStop(Eh._fromXml(this,o))}var l=a.selectSingleNode(i,"ReferenceFrames");if(null!=l){for(var h=t.ss.enumerate(l.childNodes);h.moveNext();){var u=h.current;if("ReferenceFrame"===u.nodeName){var c=new Ql;if(c.initializeFromXml(u),!t.ss.keyExists(Dr(),c.name)){var _=new bu(c.name,18);_.frame=c,_.loadedFromTour=!0,Dr()[c.name]=_}}}wu.connectAllChildren(),wu.loadTree()}var d=a.selectSingleNode(i,"Layers");if(null!=d){for(var g=t.ss.enumerate(d.childNodes);g.moveNext();){var f=g.current;if("Layer"===f.nodeName){var m=Cl.fromXml(f,!0);if(null!=m){if(t.ss.canCast(m,Nl)){var p=m.get_imageSet();if(p.get_projection()===xo.healpix&&".tsv"===p.get_extension()){kr.addCatalogHips(p);continue}}var w=t.ss.format("{0}.txt",m.id.toString());t.ss.keyExists(wu.get_layerList(),m.id)&&wu.deleteLayerByID(m.id,!0,!1);try{m.loadedFromTour=!0,m.loadData(this,w),wu.add(m,!1)}catch(t){}}}}wu.loadTree()}this._tourDirty=0},saveToDataUrl:function(){return URL.createObjectURL(this.saveToBlob())},saveToBlob:function(){this.cleanUp();var e=this.getTourXML(),i=new ch;i.set_packageID(this.get_id()),i.addFile("Tour.wwtxml",new Blob([e])),this._authorImage;for(var n=t.ss.enumerate(this.get_tourStops());n.moveNext();)n.current._addFilesToCabinet(i,!1);for(var r=this._createLayerMasterList(),s=t.ss.enumerate(r);s.moveNext();){var a=s.current;t.ss.keyExists(wu.get_layerList(),a)&&wu.get_layerList()[a].addFilesToCabinet(i)}return this.set_tourDirty(!1),i.packageFiles()},getTourXML:function(){var e=new Ks;e.formatting=1,e._writeProcessingInstruction("xml","version='1.0' encoding='UTF-8'"),e._writeStartElement("Tour"),e._writeAttributeString("ID",this._id),e._writeAttributeString("Title",this._title),e._writeAttributeString("Descirption",this.get_description()),e._writeAttributeString("Description",this.get_description()),e._writeAttributeString("RunTime",(this.get_runTime()/1e3).toString()),e._writeAttributeString("Author",this._author),e._writeAttributeString("AuthorEmail",this._authorEmail),e._writeAttributeString("OrganizationUrl",this._organizationUrl),e._writeAttributeString("OrganizationName",this.get_orgName()),e._writeAttributeString("Keywords",this.get_keywords()),e._writeAttributeString("UserLevel",s.toXml("UserLevel",this._level)),e._writeAttributeString("Classification",s.toXml("Classification",this._type)),e._writeAttributeString("Taxonomy",this._taxonomy);var i=this._isTimelineTour();e._writeAttributeString("TimeLineTour",i.toString()),e._writeStartElement("TourStops");for(var n=t.ss.enumerate(this.get_tourStops());n.moveNext();)n.current._saveToXml(e,!0);e._writeEndElement();var r=this._createLayerMasterList(),a=this._getReferenceFrameList();e._writeStartElement("ReferenceFrames");for(var o=t.ss.enumerate(a);o.moveNext();)o.current.saveToXml(e);e._writeEndElement(),e._writeStartElement("Layers");for(var l=t.ss.enumerate(r);l.moveNext();){var h=l.current;if(t.ss.keyExists(wu.get_layerList(),h)){var u=wu.get_layerList()[h].get_name(),c=an.getCatalogHipsByName(u);if(null!=c){var _=Nl.create(c);_.id=h,_.set_name(u),_.set_referenceFrame("Sky"),_.saveToXml(e)}else wu.get_layerList()[h].saveToXml(e)}}return e._writeEndElement(),e._writeFullEndElement(),e._close(),e.body},_getReferenceFrameList:function(){for(var e=[],i=t.ss.enumerate(t.ss.keys(Dr()));i.moveNext();){var n=i.current,r=Dr()[n];18!==r.frame.reference&&19!==r.frame.reference||e.indexOf(r.frame)>=0||r.frame._systemGenerated||e.push(r.frame)}return e},_createLayerMasterList:function(){for(var e=[],i=t.ss.enumerate(this.get_tourStops());i.moveNext();)for(var n=i.current,r=t.ss.enumerate(t.ss.keys(n.layers));r.moveNext();){var s=r.current;e.indexOf(s)>=0||t.ss.keyExists(wu.get_layerList(),s)&&e.push(s)}return e},_isTimelineTour:function(){return!1},get_tagId:function(){return this._tagId},set_tagId:function(t){return this._tagId=t,t},get_authorThumbnailFilename:function(){return"Author.Png"},get_tourThumbnailFilename:function(){return this._representativeThumbnailTourstop<this._tourStops.length?this._tourStops[this._representativeThumbnailTourstop].get_tourStopThumbnailFilename():null},get_id:function(){return this._id},set_id:function(t){return this._id=t,t},get_title:function(){return this._title},set_title:function(t){return this._title=t,this.set_tourDirty(!0),t},get_runTime:function(){return this._runTime&&this._lastDirtyCheck===this._tourDirty||(this._runTime=this._calculateRunTime(),this._lastDirtyCheck=this._tourDirty),this._runTime},get_description:function(){return this._description},set_description:function(t){return this._description=t,this.set_tourDirty(!0),t},get_attributesAndCredits:function(){return this._attributesAndCredits},set_attributesAndCredits:function(t){return this._attributesAndCredits=t,this.set_tourDirty(!0),t},get_authorEmailOther:function(){return this._authorEmailOther},set_authorEmailOther:function(t){return this._authorEmailOther=t,this.set_tourDirty(!0),t},get_authorEmail:function(){return this._authorEmail},set_authorEmail:function(t){return this._authorEmail=t,this.set_tourDirty(!0),t},get_authorUrl:function(){return this._authorUrl},set_authorUrl:function(t){return this._authorUrl=t,this.set_tourDirty(!0),t},get_authorPhone:function(){return this._authorPhone},set_authorPhone:function(t){return this._authorPhone=t,this.set_tourDirty(!0),t},get_authorContactText:function(){return this._authorContactText},set_authorContactText:function(t){return this._authorContactText=t,this.set_tourDirty(!0),t},get_orgName:function(){return this._orgName},set_orgName:function(t){return this._orgName=t,this.set_tourDirty(!0),t},get_orgUrl:function(){return this._orgUrl},set_orgUrl:function(t){return this._orgUrl=t,this.set_tourDirty(!0),t},get_author:function(){return this._author},set_author:function(t){return this._author=t,this.set_tourDirty(!0),t},get_authorImageUrl:function(){return this._authorImageUrl},set_authorImageUrl:function(t){return this._authorImageUrl=t,this.set_tourDirty(!0),t},get_authorImage:function(){return this._authorImage},set_authorImage:function(t){return this._authorImage=t,this.set_tourDirty(!0),t},get_organizationUrl:function(){return this._organizationUrl},set_organizationUrl:function(t){return this._organizationUrl=t,this.set_tourDirty(!0),t},get_fileName:function(){return this._filename},set_fileName:function(t){return this._filename=t,t},get_level:function(){return this._level},set_level:function(t){return this._level=t,this.set_tourDirty(!0),t},get_type:function(){return this._type},set_type:function(t){return this._type=t,this.set_tourDirty(!0),t},get_taxonomy:function(){return this._taxonomy},set_taxonomy:function(t){return this._taxonomy=t,this.set_tourDirty(!0),t},get_keywords:function(){return this._keywords},set_keywords:function(t){return this._keywords=t,this.set_tourDirty(!0),t},get_objects:function(){return this._objects},set_objects:function(t){return this._objects=t,this.set_tourDirty(!0),t},get_editMode:function(){return this._editMode},set_editMode:function(t){return this._editMode=t,t},get_tourStops:function(){return this._tourStops},set_tourStops:function(t){return this._tourStops=t,t},get_currentTourstopIndex:function(){return this._currentTourstopIndex},set_currentTourstopIndex:function(t){return this._currentTourstopIndex=t,t},addTourStop:function(t){t.set_owner(this),this.get_tourStops().push(t),this._currentTourstopIndex=this._tourStops.length-1,this.set_tourDirty(!0)},insertTourStop:function(t){t.set_owner(this),this._currentTourstopIndex>-1?this.get_tourStops().splice(this._currentTourstopIndex,0,t):(this.get_tourStops().push(t),this._currentTourstopIndex=this._tourStops.length-1),this.set_tourDirty(!0)},insertAfterTourStop:function(t){t.set_owner(this),this._currentTourstopIndex>-1||this._currentTourstopIndex<this.get_tourStops().length?this.get_tourStops().splice(this._currentTourstopIndex+1,0,t):(this.get_tourStops().push(t),this._currentTourstopIndex=this._tourStops.length-1),this.set_tourDirty(!0)},removeTourStop:function(e){t.ss.remove(this._tourStops,e),this._currentTourstopIndex>this._tourStops.length-1&&this._currentTourstopIndex--,this.set_tourDirty(!0)},_calculateRunTime:function(){for(var e=0,i=0;i<this._tourStops.length;i++)if(e+=this._tourStops[i].get_duration(),i>0&&0===this._tourStops[i].get__transition()&&(null==this._tourStops[i].get_target().get_backgroundImageset()||this._tourStops[i-1].get_target().get_backgroundImageset().get_dataSetType()===this._tourStops[i].get_target().get_backgroundImageset().get_dataSetType()&&(this._tourStops[i-1].get_target().get_backgroundImageset().get_dataSetType()!=To.solarSystem||this._tourStops[i-1].get_target().get_target()===this._tourStops[i].get_target().get_target()))){var n=null==this._tourStops[i-1].get_endTarget()?this._tourStops[i-1].get_target().get_camParams():this._tourStops[i-1].get_endTarget().get_camParams();e+=1e3*dl.create(n,this._tourStops[i].get_target().get_camParams()).get_moveTime()}return t.ss.truncate(e)},elapsedTimeTillTourstop:function(t){if(!t&&t>=this._tourStops.length)return 0;for(var e=0,i=0;i<t;i++)if(e+=this._tourStops[i].get_duration(),i>0&&0===this._tourStops[i].get__transition()){var n=null==this._tourStops[i-1].get_endTarget()?this._tourStops[i-1].get_target().get_camParams():this._tourStops[i-1].get_endTarget().get_camParams();this._tourStops[i-1].get_target().get_backgroundImageset().get_dataSetType()!==this._tourStops[i].get_target().get_backgroundImageset().get_dataSetType()||this._tourStops[i-1].get_target().get_backgroundImageset().get_dataSetType()==To.solarSystem&&this._tourStops[i-1].get_target().get_target()!==this._tourStops[i].get_target().get_target()||(e+=1e3*dl.create(n,this._tourStops[i].get_target().get_camParams()).get_moveTime())}return e/1e3},elapsedTimeSinceLastMaster:function(t){var e=null;if(!t&&t>=this._tourStops.length)return null;for(var i=0,n=0;n<t;n++)if(this._tourStops[n].get_masterSlide()&&(i=0,e=this._tourStops[n]),i+=this._tourStops[n].get_duration(),n>0&&0===this._tourStops[n].get__transition()){var r=null==this._tourStops[n-1].get_endTarget()?this._tourStops[n-1].get_target().get_camParams():this._tourStops[n-1].get_endTarget().get_camParams();this._tourStops[n-1].get_target().get_backgroundImageset().get_dataSetType()!==this._tourStops[n].get_target().get_backgroundImageset().get_dataSetType()||this._tourStops[n-1].get_target().get_backgroundImageset().get_dataSetType()==To.solarSystem&&this._tourStops[n-1].get_target().get_target()!==this._tourStops[n].get_target().get_target()||(i+=1e3*dl.create(r,this._tourStops[n].get_target().get_camParams()).get_moveTime())}return new Kh(e,i/1e3)},getMasterSlideForIndex:function(t){for(var e=-1,i=0;i<t;i++)this._tourStops[i].get_masterSlide()&&(e=i);return-1===e?null:this._tourStops[e]},getTourStopIndexByID:function(e){if(!e||"Next"===e)return this._currentTourstopIndex++;for(var i=0,n=t.ss.enumerate(this._tourStops);n.moveNext();){if(n.current.get_id()===e)return i;i++}return-1},cleanUp:function(){},getCachedTexture:function(e,i){if(null==this._textureList&&(this._textureList={}),t.ss.keyExists(this._textureList,e))return i(),this._textureList[e];var n=this.getFileStream(e);if(t.ss.whitespace(n))return null;var r=document.createElement("img");return r.src=this.getFileStream(e),r.addEventListener("load",(function(){i()}),!1),this._textureList[e]=r,r},getCachedTexture2d:function(e){if(null==this._textureList2d&&(this._textureList2d={}),t.ss.keyExists(this._textureList2d,e))return this._textureList2d[e];var i=new rs;return i.load(this.getFileStream(e)),this._textureList2d[e]=i,i},addCachedFile:function(e,i){this._fileCache[e]=i,t.ss.keyExists(this._textureList2d,e)&&delete this._textureList2d[e],t.ss.keyExists(this._textureList,e)&&delete this._textureList[e]},getFileStream:function(t){var e=this.getFileBlob(t);return null==e?null:URL.createObjectURL(e)},getFileBlob:function(e){return t.ss.keyExists(this._fileCache,e)?this._fileCache[e]:null!=this._cabinet?this._cabinet.getFileBlob(this.get_workingDirectory()+e):null},get_currentTourStop:function(){return this._currentTourstopIndex>-1?this.get_tourStops()[this._currentTourstopIndex]:null},set_currentTourStop:function(e){for(var i=0,n=t.ss.enumerate(this.get_tourStops());n.moveNext();){if(n.current===e){this._currentTourstopIndex,this._currentTourstopIndex=i;break}i++}return e},clearTempFiles:function(){}};function ku(){this.musicTrack=new Yh,this.voiceTrack=new Yh,this._tour=null,this.tourStopList=new jh,this.tourEditorUI=new Oh,this._contextMenu=new Gs,this.nextSlideCallback=null,this.playing=!1,this._player=null,this._defultColor=Xi.get_white()}n("TourDocument",[Lu,Iu,null]);var Pu={setUiStrings:function(){},get_tour:function(){return this._tour},set_tour:function(t){return this._tour=t,this.tourEditorUI.set_tour(this._tour),this.tourStopList.tour=this._tour,ph.defaultAnchor=1,this._tour.get_tourStops().length>0&&(kr.gotoTarget(this._tour.get_tourStops()[0].get_target(),!1,!0,!1),this._tour.set_currentTourstopIndex(0),this.tourStopList.selectedItem=this._tour.get_currentTourstopIndex(),this.musicTrack.target=this._tour.get_currentTourStop(),this.voiceTrack.target=this._tour.get_currentTourStop(),Rr(this._tour.get_currentTourStop().layers)),this.setEditMode(this._tour.get_editMode()),t},tour_CurrentTourstopChanged:function(){Xh._updateOverlayList(this._tour.get_currentTourStop(),this.tourEditorUI.selection),null!=this.tourEditorUI&&this.tourEditorUI.clearSelection(),this.tourStopList.refresh()},setFocusedChild:function(){},selectCurrent:function(){this.tourStopList.selectedItem=this._tour.get_currentTourstopIndex(),this.tourStopList.refresh()},tourEdit_Load:function(t,e){},playNow:function(t){this.playing=!0,(this.get_tour().get_editMode()||t)&&this.get_tour().set_currentTourstopIndex(-1),this.setPlayPauseMode()},_tourPlayer_TourEnded:function(t,e){},_endTour_CloseTour:function(t,e){},_endTour_LaunchTour:function(t,e){this.playNow(!0)},setEditMode:function(t){},tourStopList_ItemClicked:function(e,i){this._tour.get_currentTourStop()!==i&&(this._tour.set_currentTourStop(i),null!=i?(this.musicTrack.target=this._tour.get_currentTourStop(),this.voiceTrack.target=this._tour.get_currentTourStop()):(this.musicTrack.target=null,this.voiceTrack.target=null),this.tourEditorUI.clearSelection()),this.playing&&this._playFromHere_Click(e,new t.ss.EventArgs)},tourStopList_ItemDoubleClicked:function(t,e){this.showSlideStartPosition(e)},showSlideStartPosition:function(t){this._tour.set_currentTourStop(t),null!=t?(this.musicTrack.target=this._tour.get_currentTourStop(),this.voiceTrack.target=this._tour.get_currentTourStop()):(this.musicTrack.target=null,this.voiceTrack.target=null),this.tourEditorUI.clearSelection(),null!=this._tour.get_currentTourStop()&&(this._tour.get_currentTourStop().syncSettings(),Wo.set_now(this._tour.get_currentTourStop().get_startTime()),Wo.set_syncToClock(!1),kr.gotoTarget(t.get_target(),!1,!0,!1),this._tour.get_currentTourStop().set_tweenPosition(0),this._tour.get_currentTourStop()._updateLayerOpacity(),Rr(this._tour.get_currentTourStop().layers))},tourStopList_MouseClick:function(e,i){if(this._tour.get_editMode(),this.tourStopList.multipleSelection){null!=this._contextMenu&&this._contextMenu._dispose(),this._contextMenu=new Gs;var n=Xs.create(Pi.getLocalizedText(1345,"Select All")),r=Xs.create(Pi.getLocalizedText(427,"Cut")),s=Xs.create(Pi.getLocalizedText(428,"Copy")),a=Xs.create(Pi.getLocalizedText(429,"Paste")),o=Xs.create(Pi.getLocalizedText(167,"Delete"));r.click=t.ss.bind("_cutMenu_Click",this),s.click=t.ss.bind("_copyMenu_Click",this),a.click=t.ss.bind("_pasteMenu_Click",this),o.click=t.ss.bind("_deleteMenu_Click",this),n.click=t.ss.bind("_selectAllMenu_Click",this);var l=new Hs;this._contextMenu.items.push(n),this._contextMenu.items.push(l),this._contextMenu.items.push(r),this._contextMenu.items.push(s),a.enabled="WorldWideTelescope.Slide"===this.tourEditorUI.clipboardType,this._contextMenu.items.push(a),this._contextMenu.items.push(o),this._contextMenu._show(Ri.get_position())}else if(null==this._tour.get_currentTourStop()){null!=this._contextMenu&&this._contextMenu._dispose(),this._contextMenu=new Gs,n=Xs.create(Pi.getLocalizedText(1345,"Select All")),a=Xs.create(Pi.getLocalizedText(425,"Paste")),l=new Hs;var h=new Hs,u=Xs.create(Pi.getLocalizedText(426,"Add New Slide"));a.click=t.ss.bind("_pasteMenu_Click",this),n.click=t.ss.bind("_selectAllMenu_Click",this),u.click=t.ss.bind("_addNewSlide_Click",this),a.enabled="WorldWideTelescope.Slide"===this.tourEditorUI.clipboardType,this._contextMenu.items.push(n),this._contextMenu.items.push(l),this._contextMenu.items.push(a),this._contextMenu.items.push(h),this._contextMenu.items.push(u),this._contextMenu._show(Ri.get_position())}else{null!=this._contextMenu&&this._contextMenu._dispose(),this._contextMenu=new Gs,n=Xs.create(Pi.getLocalizedText(1345,"Select All")),r=Xs.create(Pi.getLocalizedText(427,"Cut")),s=Xs.create(Pi.getLocalizedText(428,"Copy")),a=Xs.create(Pi.getLocalizedText(429,"Paste")),o=Xs.create(Pi.getLocalizedText(167,"Delete")),l=new Hs;var c=new Hs,_=new Hs,d=new Hs,g=new Hs,f=new Hs,m=(u=Xs.create(Pi.getLocalizedText(431,"Insert New Slide")),Xs.create(Pi.getLocalizedText(627,"Duplicate Slide at End Position"))),p=Xs.create(Pi.getLocalizedText(628,"Merge Tour after slide...")),w=Xs.create(Pi.getLocalizedText(432,"Preview Tour From Here")),b=(h=new Hs,Xs.create(Pi.getLocalizedText(433,"Capture New Thumbnail"))),v=Xs.create(Pi.getLocalizedText(434,"Set Start Camera Position")),y=Xs.create(Pi.getLocalizedText(435,"Set End Camera Position")),S=Xs.create(Pi.getLocalizedText(436,"Show Start Camera Position")),x=Xs.create(Pi.getLocalizedText(437,"Show End Camera Position")),T=Xs.create(Pi.getLocalizedText(438,"Master Slide")),M=(Xs.create(Pi.getLocalizedText(1346,"Create Timeline")),Xs.create(Pi.getLocalizedText(1347,"Show Timeline")),this._tour.get_currentTourStop().get_nextSlide());switch(M){case"":case null:case"Next":M=" ("+Pi.getLocalizedText(610,"Next Slide")+")";break;case"Return":M=" ("+Pi.getLocalizedText(602,"Return to Caller")+")";break;default:var C=this.get_tour().getTourStopIndexByID(M);C>-1&&(M=t.ss.emptyString(this._tour.get_tourStops()[C].get_description())?t.ss.format(" (Slide {0})",C):" ("+this._tour.get_tourStops()[C].get_description()+")")}var A=Xs.create(Pi.getLocalizedText(590,"Set Next Slide")+M),L=Xs.create(Pi.getLocalizedText(439,"Track Date/Time/Location")),I=Xs.create(Pi.getLocalizedText(629,"Fade In Slide Elements")),k=Xs.create(Pi.getLocalizedText(20,"Properties")),P=Xs.create(Pi.getLocalizedText(1029,"Animation Tween Type")),R=Xs.create(Pi.getLocalizedText(1030,"Linear")),E=Xs.create(Pi.getLocalizedText(1031,"Ease In/Out")),D=Xs.create(Pi.getLocalizedText(1032,"Ease In")),F=Xs.create(Pi.getLocalizedText(1033,"Ease Out")),N=Xs.create(Pi.getLocalizedText(1034,"Exponential"));switch(R.tag=0,E.tag=3,D.tag=1,F.tag=2,N.tag=4,R.click=t.ss.bind("_interpolation_Click",this),E.click=t.ss.bind("_interpolation_Click",this),D.click=t.ss.bind("_interpolation_Click",this),F.click=t.ss.bind("_interpolation_Click",this),N.click=t.ss.bind("_interpolation_Click",this),this._tour.get_currentTourStop().get_interpolationType()){case 0:R.checked=!0;break;case 1:D.checked=!0;break;case 2:F.checked=!0;break;case 3:E.checked=!0;break;case 4:N.checked=!0}P.dropDownItems.push(R),P.dropDownItems.push(E),P.dropDownItems.push(D),P.dropDownItems.push(F),P.dropDownItems.push(N),n.click=t.ss.bind("_selectAllMenu_Click",this),m.click=t.ss.bind("_insertDuplicate_Click",this),r.click=t.ss.bind("_cutMenu_Click",this),s.click=t.ss.bind("_copyMenu_Click",this),a.click=t.ss.bind("_pasteMenu_Click",this),o.click=t.ss.bind("_deleteMenu_Click",this),u.click=t.ss.bind("_insertNewSlide_Click",this),k.click=t.ss.bind("_properties_Click",this),b.click=t.ss.bind("_captureThumbnail_Click",this),v.click=t.ss.bind("_setSkyPosition_Click",this),y.click=t.ss.bind("_setEndSkyPosition_Click",this),x.click=t.ss.bind("_showEndSkyPosition_Click",this),S.click=t.ss.bind("_showSkyPosition_Click",this),w.click=t.ss.bind("_playFromHere_Click",this),T.click=t.ss.bind("_masterSlide_Click",this),A.click=t.ss.bind("_setNextSlide_Click",this),L.click=t.ss.bind("_trackSpaceTime_Click",this),p.click=t.ss.bind("_insertSlideshow_Click",this),I.click=t.ss.bind("_fadeInOverlays_Click",this),this._tour.get_currentTourStop().get_masterSlide()&&(T.checked=!0),this._tour.get_currentTourStop().get_hasTime()&&(L.checked=!0),I.checked=this._tour.get_currentTourStop().get_fadeInOverlays(),this._contextMenu.items.push(n),this._contextMenu.items.push(f),this._contextMenu.items.push(r),this._contextMenu.items.push(s),a.enabled="WorldWideTelescope.Slide"===this.tourEditorUI.clipboardType,this._contextMenu.items.push(a),this._contextMenu.items.push(o),this._contextMenu.items.push(l),this._contextMenu.items.push(u),this._contextMenu.items.push(m),this._contextMenu.items.push(p),this._contextMenu.items.push(h),this._contextMenu.items.push(w),this._contextMenu.items.push(c),this._contextMenu.items.push(v),this._contextMenu.items.push(y),this._contextMenu.items.push(_),this._contextMenu.items.push(S),this._contextMenu.items.push(x),this._contextMenu.items.push(d),this._contextMenu.items.push(b),this._contextMenu.items.push(g),this._contextMenu.items.push(T),this._contextMenu.items.push(A),this._contextMenu.items.push(I),this._contextMenu.items.push(L),this._contextMenu.items.push(P),this._contextMenu._show(vn.create(i.clientX,i.clientY))}},_selectAllMenu_Click:function(t,e){this.tourStopList.selectAll()},_interpolation_Click:function(t,e){var i=t;this._tour.get_currentTourStop().set_interpolationType(i.tag)},_nextSlideChosen:function(){this._selectDialog.get_OK()&&this._tour.get_currentTourStop().set_nextSlide(this._selectDialog.get_id())},_setNextSlide_Click:function(e,i){this._selectDialog=new Fi(null),this.nextSlideCallback(this._selectDialog,t.ss.bind("_nextSlideChosen",this))},_insertDuplicate_Click:function(e,i){zh.push(new Uh(Pi.getLocalizedText(530,"Duplicate Slide at End Position"),this._tour));var n=this._tour.get_currentTourStop().copy();if(null!=n){null!=n.get_endTarget()&&(n.get_endTarget().set_backgroundImageset(n.get_target().get_backgroundImageset()),n.get_endTarget().set_studyImageset(n.get_target().get_studyImageset()),n.set_target(n.get_endTarget()),n.set_startTime(n.get_endTime()),n.set_endTarget(null));for(var r=t.ss.enumerate(n.get_overlays());r.moveNext();){var s=r.current;s.set_tweenFactor(1),s.set_animate(!s.get_animate()),s.set_animate(!s.get_animate())}n.set_tweenPosition(0),n.set_fadeInOverlays(!1),this._tour.insertAfterTourStop(n),this.tourStopList.refresh()}},_fadeInOverlays_Click:function(t,e){this._tour.get_currentTourStop().set_fadeInOverlays(!this._tour.get_currentTourStop().get_fadeInOverlays())},_insertSlideshow_Click:function(t,e){},_trackSpaceTime_Click:function(t,e){zh.push(new Nh(Pi.getLocalizedText(532,"Track Time Edit"),this._tour)),this._tour.get_currentTourStop().set_hasTime(!this._tour.get_currentTourStop().get_hasTime())},_masterSlide_Click:function(t,e){zh.push(new Nh(Pi.getLocalizedText(533,"Master Slide State Edit"),this._tour)),this._tour.get_currentTourStop().set_masterSlide(!this._tour.get_currentTourStop().get_masterSlide()),this.tourStopList.refresh()},_playFromHere_Click:function(t,e){this.playFromCurrentTourstop()},playFromCurrentTourstop:function(){this.playing=!0,kr.gotoTarget(this._tour.get_currentTourStop().get_target(),!1,!0,!1),Wo.set_now(this._tour.get_currentTourStop().get_startTime()),Wo.set_syncToClock(!1),this.setPlayPauseMode()},playFromTourstop:function(t){this._tour.set_currentTourStop(t),this.playFromCurrentTourstop()},_showSkyPosition_Click:function(t,e){null!=this._tour.get_currentTourStop()&&(kr.gotoTarget(this._tour.get_currentTourStop().get_target(),!1,!0,!1),this._tour.get_currentTourStop().syncSettings(),Wo.set_now(this._tour.get_currentTourStop().get_startTime()),Wo.set_syncToClock(!1),this._tour.get_currentTourStop().set_tweenPosition(0),Rr(this._tour.get_currentTourStop().layers),this.tourStopList.refresh())},_showEndSkyPosition_Click:function(t,e){this._tour.get_currentTourStop().set_tweenPosition(1),this._tour.get_currentTourStop()._updateLayerOpacity(),null!=this._tour.get_currentTourStop()&&null!=this._tour.get_currentTourStop().get_endTarget()&&(kr.gotoTargetFull(!1,!0,this._tour.get_currentTourStop().get_endTarget().get_camParams(),this._tour.get_currentTourStop().get_target().get_studyImageset(),this._tour.get_currentTourStop().get_target().get_backgroundImageset()),an.set_solarSystemTrack(this._tour.get_currentTourStop().get_endTarget().get_target()),Wo.set_now(this._tour.get_currentTourStop().get_endTime()),this._tour.get_currentTourStop().syncSettings(),Rr(this._tour.get_currentTourStop().layers),Wo.set_syncToClock(!1),this.tourStopList.refresh(),this.tourEditorUI.clearSelection())},_setEndSkyPosition_Click:function(e,i){if(null!=this._tour.get_currentTourStop()){zh.push(new Nh(Pi.getLocalizedText(435,"Set End Camera Position"),this._tour));var n=tl.createCameraParams("End Place",an.viewCamera.copy(),268435456,kr.constellation,an.get_backgroundImageset().get_dataSetType(),an.get_solarSystemTrack());this._tour.get_currentTourStop().set_endTarget(n),this._tour.get_currentTourStop().get_endTarget().set_constellation(kr.constellation),this._tour.get_currentTourStop().set_endTime(Wo.get_now()),this._tour.get_currentTourStop().set_tweenPosition(1);for(var r=t.ss.enumerate(t.ss.keys(this._tour.get_currentTourStop().layers));r.moveNext();){var s=r.current,a=this._tour.get_currentTourStop().layers[s];t.ss.keyExists(wu.get_layerList(),a.id)&&(a.endOpacity=wu.get_layerList()[a.id].get_opacity(),a.endParams=wu.get_layerList()[a.id].getParams())}this._tour.get_currentTourStop()._updateLayerOpacity(),this.tourStopList.refresh(),Wh.refreshUi(),this.tourEditorUI.clearSelection()}},_setSkyPosition_Click:function(t,e){null!=this._tour.get_currentTourStop()&&(zh.push(new Nh(Pi.getLocalizedText(434,"Set Start Camera Position"),this._tour)),this._tour.get_currentTourStop().get_target().set_target(an.get_solarSystemTrack()),this._tour.get_currentTourStop().get_target().set_type(an.get_backgroundImageset().get_dataSetType()),this._tour.get_currentTourStop().get_target().set_camParams(an.viewCamera.copy()),this._tour.get_currentTourStop().get_target().set_constellation(kr.constellation),this._tour.get_currentTourStop().get_target().set_studyImageset(an.get_foregroundImageset()),this._tour.get_currentTourStop().get_target().set_type(an.get_backgroundImageset().get_dataSetType()),this._tour.get_currentTourStop().get_target().set_backgroundImageset(an.get_backgroundImageset().get_stockImageSet()),this._tour.get_currentTourStop().captureSettings(),this._tour.get_currentTourStop().layers=wu._getVisibleLayerList(this._tour.get_currentTourStop().layers),this._tour.get_currentTourStop().set_tweenPosition(0),this.tourStopList.refresh(),Wh.refreshUi(),this.tourEditorUI.clearSelection())},_captureThumbnail_Click:function(t,e){null!=this._tour.get_currentTourStop()&&this._captureThumbnail(this._tour.get_currentTourStop())},_captureThumbnail:function(e){var i=this;kr.captureThumbnail((function(n){var r=t.ss.format("{0}.thumb.png",e.get_id());i._tour.addCachedFile(r,n),e.set_thumbnail(i._tour.getCachedTexture(r,(function(){i.tourStopList.refresh()})))}))},_properties_Click:function(t,e){throw new Error("The method or operation is not implemented.")},tourStopList_AddNewSlide:function(t,e){this.addSlide(!1),this.tourStopList.ensureAddVisible()},_addNewSlide_Click:function(t,e){this.addSlide(!1),this.tourStopList.ensureAddVisible()},_insertNewSlide_Click:function(t,e){this.addSlide(!0)},addSlide:function(t){zh.push(new Uh(Pi.getLocalizedText(426,"Add New Slide"),this._tour)),Ri.set_current(Ei.get_waitCursor());var e=tl.createCameraParams("Current Screen",an.viewCamera.copy(),268435456,kr.constellation,an.get_backgroundImageset().get_dataSetType(),an.get_solarSystemTrack());e.set_studyImageset(an.get_foregroundImageset()),e.set_backgroundImageset(an.get_backgroundImageset().get_stockImageSet());var i=Eh.create(e);t?this._tour.insertTourStop(i):this._tour.addTourStop(i),null!=this._tour.get_currentTourStop()?(this.musicTrack.target=this._tour.get_currentTourStop(),this.voiceTrack.target=this._tour.get_currentTourStop()):(this.musicTrack.target=null,this.voiceTrack.target=null),this._tour.get_currentTourStop().layers=wu._getVisibleLayerList(this._tour.get_currentTourStop().layers),this._captureThumbnail(i),this.tourStopList.selectedItem=this.tourStopList.findItem(i),this.tourStopList.refresh(),this.tourEditorUI.clearSelection(),Ri.set_current(Ei.get_defaultV()),Wh.refreshUi()},_deleteMenu_Click:function(e,i){zh.push(new Uh(Pi.getLocalizedText(534,"Delete Slide"),this._tour));for(var n=t.ss.enumerate(t.ss.keys(this.tourStopList.selectedItems));n.moveNext();){var r=n.current,s=this.tourStopList.selectedItems[r];this._tour.removeTourStop(s)}t.ss.clearKeys(this.tourStopList.selectedItems),this.tourStopList.selectedItem=-1,this._tour.set_currentTourStop(null),this.musicTrack.target=null,this.voiceTrack.target=null,this.tourStopList.refresh(),this.tourEditorUI.clearSelection()},_pasteMenu_Click:function(e,i){if("WorldWideTelescope.Slide"===this.tourEditorUI.clipboardType){zh.push(new Uh(Pi.getLocalizedText(535,"Paste Slide"),this._tour));for(var n=(new DOMParser).parseFromString(this.tourEditorUI.clipboardData,"text/xml"),r=a.selectSingleNode(n,"TourStops"),s=new t.ss.Stack,o=t.ss.enumerate(r.childNodes);o.moveNext();){var l=o.current;"TourStop"===l.nodeName&&((u=Eh._fromXml(this._tour,l)).set_id(Ii.newGuid().toString()),s.push(u))}t.ss.clearKeys(this.tourStopList.selectedItems);for(var h=this.tourStopList.selectedItem+s.count-1;s.count>0;){var u=s.pop();this._tour.insertTourStop(u),this.tourStopList.selectedItems[h--]=u}this.tourStopList.refresh(),this.tourEditorUI.clearSelection()}},_copyMenu_Click:function(e,i){var n=new Ks;n._writeProcessingInstruction("xml","version='1.0' encoding='UTF-8'"),n._writeStartElement("TourStops");for(var r=t.ss.enumerate(t.ss.keys(this.tourStopList.selectedItems));r.moveNext();){var s=r.current;this.tourStopList.selectedItems[s]._saveToXml(n,!0)}n._writeEndElement(),this.tourEditorUI.clipboardType="WorldWideTelescope.Slide",this.tourEditorUI.clipboardData=n.body},_cutMenu_Click:function(e,i){zh.push(new Uh(Pi.getLocalizedText(536,"Cut Slide"),this._tour)),this._copyMenu_Click(e,i);for(var n=t.ss.enumerate(t.ss.keys(this.tourStopList.selectedItems));n.moveNext();){var r=n.current,s=this.tourStopList.selectedItems[r];this._tour.removeTourStop(s)}t.ss.clearKeys(this.tourStopList.selectedItems),this.tourStopList.refresh(),this.tourEditorUI.clearSelection()},pauseTour:function(){this.playing&&(this.playing=!1),this.setPlayPauseMode()},preview_Click:function(t,e){this.playing=!this.playing,this.playing&&this._tour.get_editMode()&&this.get_tour().set_currentTourstopIndex(-1),this.setPlayPauseMode()},setPlayPauseMode:function(){this._tour.get_editMode()?this.playing?(null==this._player&&(this._player=new qh),this._player.set_tour(this._tour),kr.uiController=this._player,this._player.play(),this.tourStopList.showAddButton=!1):(kr.uiController=this.tourEditorUI,null!=this._player&&this._player.stop(!1),this._player=null,kr.set__mover(null),this.tourStopList.showAddButton=this._tour.get_editMode()):this.playing?(null==this._player&&(this._player=new qh),this._player.set_tour(this._tour),kr.uiController=this._player,this._player.play(),this.tourStopList.showAddButton=!1):(kr.uiController=null,an.freezeView(),null!=this._player&&this._player.stop(!1),this._player=null,kr.uiController=null,kr.set__mover(null),this.tourStopList.showAddButton=this._tour.get_editMode()),this.tourStopList.refresh()},playerTimer_Tick:function(t,e){this.playing&&null!=this._player&&(qh.get_playing()?this.tourStopList.selectedItem!==this._tour.get_currentTourstopIndex()&&(this.tourStopList.selectedItem=this._tour.get_currentTourstopIndex()):(this.playing=!1,this.setPlayPauseMode()))},insertShapeCircle_Click:function(t,e){this.tourEditorUI.addShape("",0)},insertShapeRectangle_Click:function(t,e){this.tourEditorUI.addShape("",1)},insertShapeLine_Click:function(t,e){this.tourEditorUI.addShape("",5)},insertDonut_Click:function(t,e){this.tourEditorUI.addShape("",3)},_addArrow_Click:function(t,e){this.tourEditorUI.addShape("",4)},insertVideo_Click:function(t,e){},insertAudio_Click:function(t,e){},insertHyperlink_Click:function(t,e){},colorPicker_Click:function(t,e){},tourEditTab_Leave:function(t,e){},editTourProperties_Click:function(t,e){},saveTour_Click:function(t,e){this.save(!1)},save:function(t){return!0},addVideo_Click:function(t,e){},addPicture_Click:function(t,e){},addShape_Click:function(t,e){},_addOpenRectangle_Click:function(t,e){this.tourEditorUI.addShape("",6)},_addStar_Click:function(t,e){this.tourEditorUI.addShape("",2)},addText_Click:function(t,e){},preview_EnabledChanged:function(t,e){this.playing},preview_MouseEnter:function(t,e){},preview_MouseLeave:function(t,e){},preview_MouseUp:function(t,e){},preview_MouseDown:function(t,e){},tourStopList_ItemHover:function(t,e){},refresh:function(){},undoStep:function(){zh.peekAction()&&(zh.stepBack(),this.tourStopList.refresh(),this.tourStopList.selectedItem=this._tour.get_currentTourstopIndex(),this.showSlideStartPosition(this._tour.get_currentTourStop()),this.refresh(),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.tourEditorUI.selection))},redoStep:function(){zh.peekRedoAction()&&(zh.stepForward(),this.tourStopList.refresh(),this.tourStopList.selectedItem=this._tour.get_currentTourstopIndex(),this.showSlideStartPosition(this._tour.get_currentTourStop()),this.refresh(),Xh._updateOverlayList(this._tour.get_currentTourStop(),this.tourEditorUI.selection))},tourStopList_ShowEndPosition:function(e,i){this._showEndSkyPosition_Click(this,new t.ss.EventArgs)},tourStopList_ShowStartPosition:function(t,e){this.showSlideStartPosition(this.get_tour().get_currentTourStop()),this.tourEditorUI.clearSelection()},tourStopList_KeyDown:function(e,i){if(i.ctrlKey)switch(i.keyCode){case 67:this._copyMenu_Click(null,new t.ss.EventArgs);break;case 86:this._pasteMenu_Click(null,new t.ss.EventArgs);break;case 88:this._cutMenu_Click(null,new t.ss.EventArgs);break;case 90:zh.peekAction()?Hh._undoStep():Fa._beep();break;case 89:zh.peekRedoAction()?Hh._redoStep():Fa._beep()}46===i.keyCode&&this._deleteMenu_Click(null,new t.ss.EventArgs)},_ensureSelectedVisible:function(){this.tourStopList.ensureSelectedVisible()}};n("TourEditTab",[ku,Pu,null]);var Ru={explorer:0,tour:1,search:2,constellation:3,view:4,goTo:5,community:6,context:7,voTable:8,imageStack:9};n("FolderGroup",Ru),r("FolderGroup",Ru);var Eu={interval:0,conditionalGet:1,viewChange:2};n("FolderRefreshType",Eu),r("FolderRefreshType",Eu);var Du={earth:0,planet:1,sky:2,panorama:3};function Fu(){this.parent=null,this.isProxy=!1,this._versionDependent=!1,this._readOnly=!0,this._dirty=!1,this._thumbnail=null,this._proxyFolder=null,this._lastUpdate=new Date,this._childList=[],this._itemsField=[],this._imagesets=[],this._tours=[],this._folders=[],this._places=[],this._groupField=0,this._refreshTypeField=0,this._refreshTypeFieldSpecified=!1,this._browseableField=!0,this._browseableFieldSpecified=!1,this._searchableField=!1,this._typeField=0,this._communityIdField=0,this._componentIdField=0,this._permissionField=0}n("FolderType",Du),r("FolderType",Du);var Nu={toString:function(){return this._nameField},get_versionDependent:function(){return this._versionDependent},set_versionDependent:function(e){this._versionDependent=e;for(var i=t.ss.enumerate(this._folders);i.moveNext();)i.current.set_versionDependent(this._versionDependent);return e},get_readOnly:function(){return this._readOnly},set_readOnly:function(t){return this._readOnly=t,t},get_dirty:function(){return this._dirty},set_dirty:function(t){return this._dirty=t,t},loadFromUrlWithErrorCallback:function(t,e,i){this._onError=i,this.loadFromUrl(t,e)},loadFromUrl:function(e,i){this._onComplete=i,this._webFile=new $a(zr.singleton.rewrite(e,1)),this._webFile.onStateChange=t.ss.bind("_loadData",this),this._webFile.send()},_loadData:function(){if(2===this._webFile.get_state())console.error(this._webFile.get_message()),null!=this._onError&&this._onError();else if(1===this._webFile.get_state()){var t=a.selectSingleNode(this._webFile.getXml(),"Folder");if(null==t){var e=this._webFile.getXml();null!=e&&(t=a.selectSingleNode(e,"Folder"))}null!=t&&(this._clearChildren(),this._parseXML(t)),null!=this._onComplete&&this._onComplete()}},_clearChildren:function(){this._folders.length=0,this._tours.length=0,this._places.length=0,this.get_imagesets().length=0},_parseXML:function(e){null!=e.attributes.getNamedItem("Name")?this._nameField=e.attributes.getNamedItem("Name").nodeValue:this._nameField="",null!=e.attributes.getNamedItem("Url")&&(this._urlField=e.attributes.getNamedItem("Url").nodeValue),null!=e.attributes.getNamedItem("Thumbnail")&&(this._thumbnailUrlField=e.attributes.getNamedItem("Thumbnail").nodeValue);for(var i=t.ss.enumerate(e.childNodes);i.moveNext();){var n=i.current;switch(n.nodeName){case"Folder":var r=new Fu;r.parent=this,r._parseXML(n),this._folders.push(r);break;case"Place":this._places.push(tl._fromXml(n));break;case"ImageSet":this.get_imagesets().push(Co.fromXMLNode(n));break;case"Tour":this.get_tours().push(ll._fromXml(n))}}},addChildFolder:function(t){this._folders.push(t),this._dirty=!0},removeChildFolder:function(e){t.ss.remove(this._folders,e),this._dirty=!0},addChildPlace:function(t){this._places.push(t),this._dirty=!0},removeChildPlace:function(e){t.ss.remove(this._places,e),this._dirty=!0},get_thumbnail:function(){return this._thumbnail},set_thumbnail:function(t){return this._thumbnail=t,t},get_bounds:function(){return this._bounds},set_bounds:function(t){return this._bounds=t,t},get_isImage:function(){return!1},get_isTour:function(){return!1},get_isFolder:function(){return!0},get_isCloudCommunityItem:function(){return!!this._communityIdField||this._permissionField>0},refresh:function(){null==this._proxyFolder&&(this._proxyFolder=new Fu,this._proxyFolder.isProxy=!0,this._proxyFolder.parent=this.parent),this._proxyFolder.loadFromUrlWithErrorCallback(this._urlField,this._childReadyCallback,this._childReadyCallback),this._childReadyCallback=null},childLoadCallback:function(t){this._childReadyCallback=t,this.get_children(),null==this._proxyFolder&&t()},get_children:function(){if(t.ss.emptyString(this._urlField)){if(this._childList.length=0,null!=this.parent){var e=new nl;e.parent=this.parent,this._childList.push(e)}if(null!=this.get_folders())for(var i=t.ss.enumerate(this.get_folders());i.moveNext();){var n=i.current;this._childList.push(n)}if(null!=this.get_imagesets())for(var r=t.ss.enumerate(this.get_imagesets());r.moveNext();){var s=r.current;this._childList.push(s)}if(null!=this.get_places())for(var a=t.ss.enumerate(this.get_places());a.moveNext();){var o=a.current;this._childList.push(o)}if(null!=this.get_tours())for(var l=t.ss.enumerate(this.get_tours());l.moveNext();){var h=l.current;this._childList.push(h)}return this._childList}var u=(this._lastUpdate-t.ss.now())/1e3;return(1===this.get_refreshType()||null==this._proxyFolder||!this.get_refreshType()&&parseInt(this._refreshIntervalField)<u)&&this.refresh(),null!=this._proxyFolder?this._proxyFolder.get_children():null},get_msrCommunityId:function(){return this._communityIdField},set_msrCommunityId:function(t){return this._communityIdField=t,t},get_msrComponentId:function(){return this._componentIdField},set_msrComponentId:function(t){return this._componentIdField=t,t},get_permission:function(){return this._permissionField},set_permission:function(t){return this._permissionField=t,t},get_folders:function(){return this._folders},set_folders:function(t){return this._folders=t,t},get_places:function(){return this._places},set_places:function(t){return this._places=t,t},get_imagesets:function(){return this._imagesets},set_imagesets:function(t){return this._imagesets=t,t},get_tours:function(){return this._tours},set_tours:function(t){return this._tours=t,t},get_name:function(){return null==this._nameField?"":this._nameField},set_name:function(t){return this._nameField=t,t},get_group:function(){return this._groupField},set_group:function(t){return this._groupField=t,t},get_url:function(){return this._urlField},set_url:function(t){return this._urlField=t,t},get_thumbnailUrl:function(){return t.ss.emptyString(this._thumbnailUrlField)?zr.singleton.engineAssetUrl("thumb_folder.jpg"):this._thumbnailUrlField},set_thumbnailUrl:function(t){return this._thumbnailUrlField=t,t},get_refreshType:function(){return this._refreshTypeField},set_refreshType:function(t){return this._refreshTypeField=t,this.set_refreshTypeSpecified(!0),t},get_refreshTypeSpecified:function(){return this._refreshTypeFieldSpecified},set_refreshTypeSpecified:function(t){return this._refreshTypeFieldSpecified=t,t},get_refreshInterval:function(){return this._refreshIntervalField},set_refreshInterval:function(t){return this._refreshIntervalField=t,t},get_browseable:function(){return this._browseableField},set_browseable:function(t){return this._browseableField=t,this._browseableFieldSpecified=!0,t},get_browseableSpecified:function(){return this._browseableFieldSpecified},set_browseableSpecified:function(t){return this._browseableFieldSpecified=t,t},get_searchable:function(){return this._searchableField},set_searchable:function(t){return this._searchableField=t,t},get_type:function(){return this._typeField},set_type:function(t){return this._typeField=t,t},get_subType:function(){return this._subTypeField},set_subType:function(t){return this._subTypeField=t,t}};n("Folder",[Fu,Nu,null,ua]),Lr=function(){return new Fu};var $u={small:0,big:1};function zu(){this._items=[],this.top=10,this.left=10,this._indexTouchDown=-1,this._mouseDown=!1,this._lastX=0,this._lastY=0,this._ignoreClick=!1,this._thumbnailSize=0,this._horzSpacing=110,this._vertSpacing=75,this._thumbHeight=65,this._thumbWidth=110,this._horzMultiple=110,this._rowCount=1,this._colCount=6,this._dragging=!1,this._startIndex=0,this._startOffset=0,this._selectedItem=-1,this._hoverItem=-1,this.showAddButton=!1,this.width=0,this.height=0,this._addButtonHover=!1,this.imageClicked=!1}n("ThumbnailSize",$u),r("ThumbnailSize",$u),zu._downloading=!1,zu._imagesLoaded=!1,zu._imageLoadCount=0,zu.create=function(){var t=new zu;return t.height=85,t.width=1920,t.canvas=document.createElement("canvas"),t.canvas.width=t.width,t.canvas.height=t.height,t.setup(),t.loadImages(),t};var Bu={setup:function(){this.canvas.addEventListener("click",t.ss.bind("onClick",this),!1),this.canvas.addEventListener("dblclick",t.ss.bind("onDoubleClick",this),!1),this.canvas.addEventListener("mousemove",t.ss.bind("onMouseMove",this),!1),this.canvas.addEventListener("mouseup",t.ss.bind("onMouseUp",this),!1),this.canvas.addEventListener("mousedown",t.ss.bind("onMouseDown",this),!1),this.canvas.addEventListener("touchstart",t.ss.bind("onTouchStart",this),!1),this.canvas.addEventListener("touchmove",t.ss.bind("onTouchMove",this),!1),this.canvas.addEventListener("touchend",t.ss.bind("onTouchEnd",this),!1),this.canvas.addEventListener("mouseout",t.ss.bind("onMouseUp",this),!1)},onTouchStart:function(t){var e=t;e.preventDefault(),this._mouseDown=!0,this._lastX=e.targetTouches[0].pageX,this._lastY=e.targetTouches[0].pageY,this._indexTouchDown=this._getItemIndexFromCursor(vn.create(e.targetTouches[0].pageX,e.targetTouches[0].pageY))},onTouchMove:function(t){var e=t;if(e.preventDefault(),this._mouseDown){if(e.targetTouches[0].pageX,this._lastX,e.targetTouches[0].pageY,this._lastY,this._mouseDown&&(this._dragging=!0),this._dragging){var i=Math.round((e.targetTouches[0].pageX-this._lastX+this._startOffset)/this._horzSpacing),n=Math.round(e.targetTouches[0].pageX-this._lastX+this._startOffset-i*this._horzSpacing);this._startOffset=n,this._startIndex-=i,this._startIndex<0&&(this._startOffset-=this._horzSpacing*this._startIndex,this._startIndex=0),this._lastX=e.targetTouches[0].pageX,this._lastY=e.targetTouches[0].pageY}else{var r=this._getItemIndexFromCursor(vn.create(e.targetTouches[0].pageX,e.targetTouches[0].pageY));this._hoverItem!==r&&(this._hoverItem=r)}this.refresh()}},onTouchEnd:function(t){t.preventDefault(),this._dragging?(this._dragging=!1,this._ignoreClick=!0):this._indexTouchDown>-1&&this._mouseDown&&this._handleClick(this._indexTouchDown),this._startOffset=0,this._mouseDown=!1,this.refresh()},onClick:function(t){if(this._ignoreClick)this._ignoreClick=!1;else{var e=this._getItemIndexFromCursor(vn.create(t.offsetX,t.offsetY));this._handleClick(e)}},_handleClick:function(e){var i=this;if(e>-1){if(t.ss.canCast(this._items[e],tl)){var n=this._items[e];return void kr.gotoTarget(n,!1,!1,!0)}if(t.ss.canCast(this._items[e],Co)){var r=this._items[e];return void an.set_backgroundImageset(r)}if(t.ss.canCast(this._items[e],ll)){var s=this._items[e];return void kr.playTour(s.get_tourUrl())}if(t.ss.canCast(this._items[e],Fu)){var a=this._items[e];return this._startIndex=0,void a.childLoadCallback((function(){i._items=a.get_children(),i.refresh()}))}if(t.ss.canCast(this._items[e],nl)){var o=this._items[e];return void(null!=o.parent&&(this._startIndex=0,o.parent.childLoadCallback((function(){i._items=o.parent.get_children(),i.refresh()}))))}}},onDoubleClick:function(t){no.renderingOn=!no.renderingOn},onGestureChange:function(t){var e=t;this._mouseDown=!1,e.scale},onMouseDown:function(t){this._mouseDown=!0,this._lastX=ki.offsetX(this.canvas,t),this._lastY=ki.offsetY(this.canvas,t)},onMouseMove:function(t){if(this._mouseDown&&(this._dragging=!0),this._dragging){var e=Math.round((ki.offsetX(this.canvas,t)-this._lastX+this._startOffset)/this._horzSpacing),i=Math.round(ki.offsetX(this.canvas,t)-this._lastX+this._startOffset-e*this._horzSpacing);this._startOffset=i,this._startIndex-=e,this._startIndex<0&&(this._startOffset-=this._horzSpacing*this._startIndex,this._startIndex=0),this._lastX=ki.offsetX(this.canvas,t),this._lastY=ki.offsetY(this.canvas,t)}else{var n=this._getItemIndexFromCursor(vn.create(ki.offsetX(this.canvas,t),ki.offsetY(this.canvas,t)));this._hoverItem!==n&&(this._hoverItem=n)}this.refresh()},onMouseUp:function(t){this._dragging&&(this._startOffset=0,this._dragging=!1,this._ignoreClick=!0),this._mouseDown=!1,this.refresh()},loadImages:function(){var t=this;zu._imagesLoaded||zu._downloading||(zu._imageLoadCount=0,zu._imagesLoaded=!1,zu._downloading=!0,zu._bmpBackground=document.createElement("img"),zu._bmpBackground.src="images/thumbBackground.png",zu._bmpBackground.addEventListener("load",(function(e){zu._imageLoadCount++,5===zu._imageLoadCount&&(zu._downloading=!1,zu._imagesLoaded=!0,t.refresh())}),!1),zu._bmpBackgroundHover=document.createElement("img"),zu._bmpBackgroundHover.src="images/thumbBackgroundHover.png",zu._bmpBackgroundHover.addEventListener("load",(function(e){zu._imageLoadCount++,5===zu._imageLoadCount&&(zu._downloading=!1,zu._imagesLoaded=!0,t.refresh())}),!1),zu._bmpBackgroundWide=document.createElement("img"),zu._bmpBackgroundWide.src="images/thumbBackgroundWide.png",zu._bmpBackgroundWide.addEventListener("load",(function(e){zu._imageLoadCount++,5===zu._imageLoadCount&&(zu._downloading=!1,zu._imagesLoaded=!0,t.refresh())}),!1),zu._bmpBackgroundWideHover=document.createElement("img"),zu._bmpBackgroundWideHover.src="images/thumbBackgroundWideHover.png",zu._bmpBackgroundWideHover.addEventListener("load",(function(e){zu._imageLoadCount++,5===zu._imageLoadCount&&(zu._downloading=!1,zu._imagesLoaded=!0,t.refresh())}),!1),zu._bmpDropInsertMarker=document.createElement("img"),zu._bmpDropInsertMarker.src="images/dragInsertMarker.png",zu._bmpDropInsertMarker.addEventListener("load",(function(e){zu._imageLoadCount++,5===zu._imageLoadCount&&(zu._downloading=!1,zu._imagesLoaded=!0,t.refresh())}),!1))},get_thumbnailSize:function(){return this._thumbnailSize},set_thumbnailSize:function(t){switch(this._thumbnailSize=t,t){case 1:this._horzSpacing=180,this._vertSpacing=75,this._thumbHeight=65,this._thumbWidth=180;break;case 0:this._horzSpacing=110,this._vertSpacing=75,this._thumbHeight=65,this._thumbWidth=110}return this._updatePaginator(),this.refresh(),t},refresh:function(){this.width!==window.innerWidth&&(this.width=window.innerWidth),this.paint()},get_rowCount:function(){return this._rowCount},set_rowCount:function(t){return this._rowCount!==t&&(this._rowCount=t,this._updatePaginator()),t},_updatePaginator:function(){},get_colCount:function(){return this._colCount},set_colCount:function(t){return this._colCount!==t&&(this._colCount=t,this._updatePaginator()),t},get_itemsPerPage:function(){return this._rowCount*this._colCount},get_currentPage:function(){return this._startIndex/this.get_itemsPerPage()},get_pageCount:function(){return Math.max(1,(this._items.length+this.get_itemsPerPage()-1+(this.showAddButton?1:0))/this.get_itemsPerPage())},paint:function(){var e=this,i=this.canvas.getContext("2d");if(i.fillStyle="rgb(20, 22, 31)",i.fillRect(0,0,this.width,this.height),zu._imagesLoaded){var n,r=this.height-20,s=this.width-20;this.set_rowCount(Math.round(Math.max(r/this._thumbHeight,1))),this.set_colCount(Math.round(Math.max(s/this._horzSpacing,1))),this._horzMultiple=(s+13)/this.get_colCount(),this._startIndex=Math.round(this._startIndex/this.get_itemsPerPage()*this.get_itemsPerPage());for(var a=this._startIndex,o=0;o<this._rowCount;o++){for(var l=0;l<this._colCount;l++){if(a>=this._items.length){this._items.length&&!this.showAddButton||(n=Ai.create(this.left+l*this._horzMultiple+3+this._startOffset,this.top+o*this._vertSpacing,this._thumbWidth-10,60),i.drawImage(1===this._thumbnailSize?zu._bmpBackgroundWide:zu._bmpBackground,t.ss.truncate(l*this._horzMultiple)+this._startOffset,o*this._vertSpacing));break}n=Ai.create(this.left+l*this._horzMultiple+3+this._startOffset,this.top+o*this._vertSpacing,this._thumbWidth-14,60);var h="white";a===this._hoverItem||a===this._selectedItem&&-1===this._hoverItem?(i.drawImage(1===this._thumbnailSize?zu._bmpBackgroundWideHover:zu._bmpBackgroundHover,this.left+t.ss.truncate(l*this._horzMultiple)+this._startOffset,this.top+o*this._vertSpacing),h="yellow"):i.drawImage(1===this._thumbnailSize?zu._bmpBackgroundWide:zu._bmpBackground,this.left+t.ss.truncate(l*this._horzMultiple)+this._startOffset,this.top+o*this._vertSpacing),this._items[a].set_bounds(Ai.create(this.left+l*this._horzMultiple+this._startOffset,this.top+o*this._vertSpacing,t.ss.truncate(this._horzMultiple),this._vertSpacing));try{var u=this._items[a].get_thumbnail();null!=u?(i.drawImage(u,this.left+l*this._horzMultiple+2+this._startOffset,this.top+o*this._vertSpacing+3),i.strokeStyle="rgb(0,0,0)",i.rect(this.left+t.ss.truncate(l*this._horzMultiple)+2+this._startOffset,this.top+o*this._vertSpacing+3,this._items[a].get_thumbnail().width,this._items[a].get_thumbnail().height)):(this._items[a].set_thumbnail(document.createElement("img")),this._items[a].get_thumbnail().src=this._items[a].get_thumbnailUrl(),this._items[a].get_thumbnail().addEventListener("load",(function(t){e.refresh()}),!1))}catch(t){}i.fillStyle=h,i.strokeStyle=h,i.lineWidth=1,i.font="normal 8pt Arial",i.fillText(this._items[a].get_name(),n.x,n.y+n.height,n.width),a++}if(a>=this._items.length)break}}},_getItemIndexFromCursor:function(e){var i=vn.create(e.x+this.left,e.y+this.top);this.imageClicked=!1;var n,r=t.ss.truncate(i.x/this._horzMultiple),s=t.ss.truncate(i.x%this._horzMultiple);if(r>=this._colCount)return-1;if(r<0)return-1;var a=t.ss.truncate(i.y/this._vertSpacing),o=t.ss.truncate(i.y%this._vertSpacing);return a>=this._rowCount||a<0?-1:((n=this._startIndex+a*this._colCount+r)===this._items.length?this._addButtonHover=!0:this._addButtonHover=!1,n>this._items.length-1?-1:(this._items[n].get_isImage()&&o<16&&s>78&&(this.imageClicked=!0),n))},_addItems:function(t){this._items=t}};function Uu(t){this._properties={},this._catalogColumnInfo=null,this._catalogSpreadSheetLayer=new gu,this._downloadComplete=!1,this.dataset=t,this._datasetName=t.get_name(),this._url=t.get_url(),this._url.toLowerCase().indexOf("norder")>-1&&(this._url=this._url.substring(0,this._url.toLowerCase().indexOf("norder"))),this._url+="properties",this._download()}n("FolderBrowser",[zu,Bu,null]);var Vu={get_properties:function(){return this._properties},get_catalogSpreadSheetLayer:function(){return this._catalogSpreadSheetLayer},set_catalogSpreadSheetLayer:function(t){return this._catalogSpreadSheetLayer=t,t},get_catalogColumnInfo:function(){return this._catalogColumnInfo},set_catalogColumnInfo:function(t){return this._catalogColumnInfo=t,t},get_downloadComplete:function(){return this._downloadComplete},_download:function(){this._webFile=new $a(this._url),this._webFile.onStateChange=t.ss.bind("_onPropertiesDownloadComplete",this),this._webFile.send()},_onPropertiesDownloadComplete:function(){if(1===this._webFile.get_state())if(this._parseProperties(this._webFile.getText()),t.ss.keyExists(this.get_properties(),"dataproduct_type")&&"catalog"===this.get_properties().dataproduct_type.toLowerCase())this._catalogColumnInfo=oh.loadFromUrl(t.ss.replaceString(this._url,"/properties","/metadata.xml"),t.ss.bind("_onCatalogMetadataDownloadComplete",this));else{if(t.ss.keyExists(this.get_properties(),"hips_data_range")){var e=this.get_properties().hips_data_range;this.dataset.get_fitsProperties().minVal=parseFloat(e.split(" ")[0]),this.dataset.get_fitsProperties().maxVal=parseFloat(e.split(" ")[1]),this.dataset.get_fitsProperties().lowerCut=this.dataset.get_fitsProperties().minVal,this.dataset.get_fitsProperties().upperCut=this.dataset.get_fitsProperties().maxVal}if(t.ss.keyExists(this.get_properties(),"hips_pixel_cut")){var i=this.get_properties().hips_pixel_cut;this.dataset.get_fitsProperties().lowerCut=parseFloat(i.split(" ")[0]),this.dataset.get_fitsProperties().upperCut=parseFloat(i.split(" ")[1]),t.ss.keyExists(this.get_properties(),"hips_data_range")||(this.dataset.get_fitsProperties().minVal=this.dataset.get_fitsProperties().lowerCut,this.dataset.get_fitsProperties().maxVal=this.dataset.get_fitsProperties().upperCut)}this._downloadComplete=!0,null!=this._onDownloadComplete&&this._onDownloadComplete()}},_onCatalogMetadataDownloadComplete:function(){this._catalogSpreadSheetLayer.useHeadersFromVoTable(this._catalogColumnInfo),this._catalogSpreadSheetLayer.set_name(this._datasetName),this._catalogSpreadSheetLayer.id=Ii.createFrom(this._datasetName),wu.addSpreadsheetLayer(this.get_catalogSpreadSheetLayer(),"Sky"),this._downloadComplete=!0,null!=this._onDownloadComplete&&this._onDownloadComplete()},setDownloadCompleteListener:function(t){this._onDownloadComplete=t},_parseProperties:function(e){for(var i=e.split("\n"),n=t.ss.enumerate(i);n.moveNext();){var r=n.current;if(!t.ss.whitespace(r)&&!t.ss.startsWith(r,"#")){var s=r.split("=");if(2===s.length){var a=t.ss.trim(s[0]),o=t.ss.trim(s[1]);t.ss.whitespace(a)||t.ss.whitespace(o)||(this.get_properties()[a]=o)}}}}};function Ou(){this.aborted=!1}function Gu(){this.height=0,this.width=0,this.lighting=!1,this._viewPoint=new wn,this.space=!1,this._fovAngle=0,this._fovScale=0,this._nominalRadius=6378137,this._mainTexture=null,this.viewMover=null,this.viewCamera=new Aa,this.targetCamera=new Aa,this.alt=0,this.az=0,this.targetAlt=0,this.targetAz=0,this._backgroundImageset=null,this._foregroundImageset=null,this._activeCatalogHipsImagesets=[],this._targetHeight=1,this.targetAltitude=0,this._galactic=!0,this._galacticMatrix=yn.create(-.4838350155,-.0548755604,-.8734370902,0,.7469822445,.4941094279,-.44482963,0,.4559837762,-.867666149,-.1980763734,0,0,0,0,1),this._firstTimeInit=!1,this._useSolarSystemTilt=!0,this.customTrackingParams=new Aa,this._cameraOffset=new wn,this._fovLocal=Math.PI/4,this.perspectiveFov=Math.PI/4,this.nearPlane=0,this._frustumDirty=!0,this._frustum=new Array(6),this._ambientLightColor=Xi.get_black(),this._hemiLightColor=Xi.get_black(),this._hemiLightUp=new wn,this._sunlightColor=Xi.get_white(),this._sunPosition=new wn,this._reflectedLightColor=Xi.get_black(),this._reflectedLightPosition=new wn,this._occludingPlanetRadius=0,this._occludingPlanetPosition=new wn,this._lightingStateDirty=!0,this._twoSidedLighting=!1,this.cameraPosition=new wn,this._skyColor="Blue";for(var t=0;t<6;t++)this._frustum[t]=new Mn(0,0,0,0)}n("HipsProperties",[Uu,Vu,null]),Ar=function(t){return new Uu(t)},n("InViewReturnMessage",[Ou,{},null]),Gu.back=0,Gu.create=function(t){var e=new Gu;return e.device=t,e.viewCamera.zoom=700,e.viewCamera.target=65536,e},Gu.getTilesYForLevel=function(t,e){var i=1;switch(t.get_projection()){case xo.mercator:i=Math.pow(2,e);break;case xo.equirectangular:i=Math.pow(2,e)*(180/t.get_baseTileDegrees());break;case xo.tangent:i=Math.pow(2,e);break;case xo.spherical:i=1;break;case xo.healpix:i=4*Math.pow(2,e);break;default:i=Math.pow(2,e)}return i===Number.POSITIVE_INFINITY&&(i=1),i},Gu.getTilesXForLevel=function(e,i){var n=1;switch(e.get_projection()){case xo.plotted:case xo.toast:n=Math.pow(2,i);break;case xo.mercator:n=Math.pow(2,i)*t.ss.truncate(e.get_baseTileDegrees()/360);break;case xo.equirectangular:n=Math.pow(2,i)*t.ss.truncate(360/e.get_baseTileDegrees());break;case xo.tangent:n=1===e.get_widthFactor()?2*Math.pow(2,i):Math.pow(2,i);break;case xo.skyImage:case xo.spherical:n=1;break;case xo.healpix:n=3*Math.pow(2,i);break;default:n=2*Math.pow(2,i)}return n};var Xu={save:function(){null!=this.gl||this.device.save()},restore:function(){null!=this.gl||this.device.restore()},clear:function(){null!=this.gl?(this.gl.viewport(0,0,t.ss.truncate(this.width),t.ss.truncate(this.height)),this.gl.clear(Yr.COLOR_BUFFER_BIT|Yr.DEPTH_BUFFER_BIT)):(this.device.save(),this.device.fillStyle="black",this.device.fillRect(0,0,this.width,this.height),this.device.restore())},get_viewPoint:function(){return this._viewPoint},get_RA:function(){return((180-(this.viewCamera.lng-180))/15%24+48)%24},rAtoViewLng:function(t){return 180-t/24*360-180},get_dec:function(){return this.viewCamera.lat},get_fovAngle:function(){return this._fovAngle},get_fovScale:function(){return this._fovScale},set_fovScale:function(t){return this._fovScale=t,t},get_view:function(){return this._view},set_view:function(t){return this._view=t,this._frustumDirty=!0,t},get_viewBase:function(){return this._viewBase},set_viewBase:function(t){return this._viewBase=t,t},get_projection:function(){return this._projection},set_projection:function(t){return this._projection=t,this._frustumDirty=!0,t},get_world:function(){return this._world},set_world:function(t){return this._world=t,this._frustumDirty=!0,t},_getScreenTexture:function(){return null},get_worldBase:function(){return this._worldBase},set_worldBase:function(t){return this._worldBase=t,t},get_worldBaseNonRotating:function(){return this._worldBaseNonRotating},set_worldBaseNonRotating:function(t){return this._worldBaseNonRotating=t,t},get_nominalRadius:function(){return this._nominalRadius},set_nominalRadius:function(t){return this._nominalRadius=t,t},get_mainTexture:function(){return this._mainTexture},set_mainTexture:function(t){return null!=t&&(this._mainTexture=t,this.gl.bindTexture(Yr.TEXTURE_2D,this._mainTexture.texture2d)),t},onTarget:function(t){return Math.abs(this.viewCamera.lat-this.targetCamera.lat)<1e-12&&Math.abs(this.viewCamera.lng-this.targetCamera.lng)<1e-12&&Math.abs(this.viewCamera.zoom-this.targetCamera.zoom)<1e-12&&null==this.viewMover},setTexture:function(t){},get_backgroundImageset:function(){return this._backgroundImageset},set_backgroundImageset:function(t){var e=null!=this._backgroundImageset&&null!=t&&this._backgroundImageset.get_dataSetType()!==t.get_dataSetType();return this._backgroundImageset=t,e&&(kr._freezeView(),kr.clampZooms(this)),t},get_foregroundImageset:function(){return this._foregroundImageset},set_foregroundImageset:function(t){return this._foregroundImageset=t,t},get_catalogHipsImagesets:function(){return this._activeCatalogHipsImagesets},getCatalogHipsDataInView:function(t,e,i){var n=this,r=new gu,s=function(){r.useHeadersFromVoTable(t.get_hipsProperties().get_catalogColumnInfo()),n._tryGetAllDataInView(t,e,r,i,0)};null==t.get_hipsProperties()?(t.set_hipsProperties(Ar(t)),t.get_hipsProperties().setDownloadCompleteListener(s)):null!=t.get_hipsProperties()&&t.get_hipsProperties().get_downloadComplete()?s():t.get_hipsProperties().setDownloadCompleteListener(s)},_tryGetAllDataInView:function(t,e,i,n,r){for(var s=this,a=Gu.getTilesXForLevel(t,t.get_baseLevel()),o=Gu.getTilesYForLevel(t,t.get_baseLevel()),l=!1,h=0;h<a;h++)for(var u=0;u<o;u++){var c=rn(t.get_baseLevel(),h,u,t,null);if(null!=c){var _=c.getDataInView(this,e,i);l=l||!_}else l=!0}if(l)((g=i.get__table().rows.length)>1e4||r>3e4)&&e?(console.log("Too Many results - Aborting"),console.log(g),(d=new Ou).aborted=!0,d.table=i.getTableDataInView(),n(d),i.cleanUp()):(setTimeout((function(){s._tryGetAllDataInView(t,e,i,n,r)}),10),r%200||(console.log("Waiting for more tiles to load"),console.log(g)),r++);else{var d,g=i.get__table().rows.length;console.log("Done!"),console.log(g),(d=new Ou).aborted=!1,d.table=i.getTableDataInView(),n(d),i.cleanUp()}},addCatalogHips:function(t,e){this._activeCatalogHipsImagesets.indexOf(t)>=0||this._activeCatalogHipsImagesets.push(t),null==t.get_hipsProperties()?(t.set_hipsProperties(Ar(t)),t.get_hipsProperties().setDownloadCompleteListener(e)):null!=t.get_hipsProperties()&&t.get_hipsProperties().get_downloadComplete()&&(wu.addSpreadsheetLayer(t.get_hipsProperties().get_catalogSpreadSheetLayer(),"Sky"),null!=e&&e())},removeCatalogHips:function(e){t.ss.remove(this._activeCatalogHipsImagesets,e),null!=e.get_hipsProperties()&&wu.deleteLayerByID(e.get_hipsProperties().get_catalogSpreadSheetLayer().id,!0,!0)},getCatalogHipsByName:function(e){for(var i=t.ss.enumerate(this._activeCatalogHipsImagesets);i.moveNext();){var n=i.current;if(n.get_name()===e)return n}return null},getAltitudeForLatLongForPlanet:function(t,e,i){var n=kr.getImagesetByName(Jo.getNameFrom3dId(t));if(null==n)return 0;for(var r=Gu.getTilesXForLevel(n,n.get_baseLevel()),s=Gu.getTilesYForLevel(n,n.get_baseLevel()),a=0;a<r;a++)for(var o=0;o<s;o++){var l=rn(n.get_baseLevel(),a,o,n,null);if(null!=l&&l.isPointInTile(e,i))return l.getSurfacePointAltitude(e,i,!0)}return 0},getEarthAltitude:function(t,e,i){if(kr.get_solarSystemMode()){var n=Qs.geoTo3dDouble(t,e+90),r=Jo.earthMatrixInv;(n=wn._transformCoordinate(n,r)).normalize();var s=Qs.cartesianToLatLng(n);return this.getAltitudeForLatLongForPlanet(this.viewCamera.target,s.y,s.x)}return this.get_backgroundImageset().get_dataSetType()!=To.earth?i?this.getMetersAltitudeForLatLong(t,e):this.getScaledAltitudeForLatLong(t,e):0},drawImageSet:function(t,e){for(var i=Gu.getTilesXForLevel(t,t.get_baseLevel()),n=Gu.getTilesYForLevel(t,t.get_baseLevel()),r=0;r<i;r++)for(var s=0;s<n;s++){var a=rn(t.get_baseLevel(),r,s,t,null);null!=a&&a.draw3D(this,e)}},_getTileAtLatLong:function(t,e){var i=this.get_backgroundImageset();if(null==i)return null;for(var n=Gu.getTilesXForLevel(i,i.get_baseLevel()),r=Gu.getTilesYForLevel(i,i.get_baseLevel()),s=0;s<n;s++)for(var a=0;a<r;a++){var o=rn(i.get_baseLevel(),s,a,i,null);if(null!=o&&o.isPointInTile(t,e))return o}return null},getScaledAltitudeForLatLong:function(t,e){var i=this._getTileAtLatLong(t,e);return null!=i?i.getSurfacePointAltitude(t,e,!1):0},getMetersAltitudeForLatLong:function(t,e){var i=this._getTileAtLatLong(t,e);return null!=i?i.getSurfacePointAltitude(t,e,!0):0},_setupMatricesLand3d:function(){this.lighting=!1,this.space=!1,no.cullInside=!1;var t=yn._rotationY((this.viewCamera.lng-90)/180*Math.PI);t._multiply(yn._rotationX(-this.viewCamera.lat/180*Math.PI)),this.set_world(t),this.set_worldBase(t.clone()),this._viewPoint=Qs.geoTo3d(this.viewCamera.lat,this.viewCamera.lng);var e;if(e=this._backgroundImageset.get_isMandelbrot()?this.viewCamera.zoom/180*4+1e-41:this.viewCamera.zoom/180*4+1e-6,this._fovAngle=this.viewCamera.zoom/343.774/Math.PI*180,this._fovScale=this._fovAngle/this.height*3600,null!=this.gl){this.targetAltitude=this.getScaledAltitudeForLatLong(this.viewCamera.lat,this.viewCamera.lng);var i=1+this.targetAltitude;this.targetAltitude*=this.get_nominalRadius(),this._targetHeight<i?this._targetHeight=(2*this._targetHeight+i)/3:this._targetHeight=(9*this._targetHeight+i)/10}else this.targetAltitude=0,this._targetHeight=1;var n=this.viewCamera.rotation;this.cameraPosition=wn.create(Math.sin(n)*Math.sin(this.viewCamera.angle)*e,Math.cos(n)*Math.sin(this.viewCamera.angle)*e,-this._targetHeight-Math.cos(this.viewCamera.angle)*e);var r=wn.create(0,0,-this._targetHeight),s=(this.cameraPosition.length(),wn.create(Math.sin(n)*Math.cos(this.viewCamera.angle),Math.cos(n)*Math.cos(this.viewCamera.angle),Math.sin(this.viewCamera.angle)));this.set_view(yn.lookAtLH(this.cameraPosition,r,s)),this.set_viewBase(this.get_view());var a,o=Math.sqrt((e+1)*(e+1)-1);o=Math.max(.5,o),a=.05*e,this.set_projection(yn.perspectiveFovLH(Math.PI/4,this.width/this.height,a,o)),this._setMatrixes(),this.makeFrustum()},setupMatricesSpace3d:function(t,e){this.lighting=!1,this._firstTimeInit||(this._galacticMatrix=yn.get_identity(),this._galacticMatrix._multiply(yn._rotationY(-.019972251100208244*Math.PI)),this._galacticMatrix._multiply(yn._rotationX(.1607565219927189*Math.PI)),this._galacticMatrix._multiply(yn._rotationZ(-.3254330396661*Math.PI)),this._firstTimeInit=!0),this.space=!0,no.cullInside=!0;var i=yn.get_identity();if(ko.get_active().get_galacticMode()){i._multiply(this._galacticMatrix),i._multiply(yn._rotationY(this.az/180*Math.PI)),i._multiply(yn._rotationX(-this.alt/180*Math.PI));var n=Qs.galactictoJ2000(this.az,this.alt);this._viewPoint=Qs.raDecTo3dAu(n[0]/15,n[1],1),this.targetCamera.lng=this.rAtoViewLng(n[0]/15),this.targetCamera.lat=n[1],this.viewCamera.lat=this.targetCamera.lat,this.viewCamera.lng=this.targetCamera.lng}else i._multiply(yn._rotationY(-(this.viewCamera.lng-90)/180*Math.PI)),i._multiply(yn._rotationX(-this.viewCamera.lat/180*Math.PI)),this._viewPoint=Qs.raDecTo3dAu(this.get_RA(),this.get_dec(),1);var r=this.viewCamera.rotation;if(this._fovAngle=this.viewCamera.zoom/343.774/Math.PI*180,this._fovScale=this._fovAngle/e*3600,ko.get_active().get_localHorizonMode()&&this._backgroundImageset.get_dataSetType()==To.sky){var s=new Qs(0,0);s.set_az(0),s.set_alt(0);var a=Qs.horizonToEquitorial(s,Wo.get_location(),Wo.get_now()),o=-(a.get_RA()-6)/24*(2*Math.PI),l=-a.get_dec()/360*(2*Math.PI);Qs.formatDMS(a.get_RA()),(i=yn._rotationY(-o-Math.PI))._multiply(yn._rotationX(l)),Wo.get_location().get_lat()<0?(i._multiply(yn._rotationY(this.az/180*Math.PI)),i._multiply(yn._rotationX(this.alt/180*Math.PI)),r+=Math.PI):(i._multiply(yn._rotationY(-this.az/180*Math.PI)),i._multiply(yn._rotationX(-this.alt/180*Math.PI)));var h=Qs.horizonToEquitorial(Qs.fromLatLng(this.alt,this.az),Wo.get_location(),Wo.get_now());this.viewCamera.lat=this.targetCamera.lat=h.get_dec(),this.viewCamera.lng=this.targetCamera.lng=this.rAtoViewLng(h.get_RA())}this.set_world(i),this.set_worldBase(i.clone());var u=this.viewCamera.zoom;Math.PI,this.cameraPosition=wn.create(0,0,0),this.set_view(yn.lookAtLH(this.cameraPosition,wn.create(0,0,-1),wn.create(Math.sin(r),Math.cos(r),0))),this.set_viewBase(this.get_view().clone()),this.nearPlane=.1,this.set_projection(yn.perspectiveFovLH(u/343.774,t/e,.1,-2)),this._setMatrixes(),this.makeFrustum()},get_solarSystemTrack:function(){return this.viewCamera.target},set_solarSystemTrack:function(t){return this.viewCamera.target=t,t},get_solarSystemCameraDistance:function(){return this.viewCamera.zoom/9*4+1e-6},get_sandboxMode:function(){return null!=this._backgroundImageset&&this._backgroundImageset.get_dataSetType()===To.sandbox},get_trackingFrame:function(){return this.viewCamera.targetReferenceFrame},set_trackingFrame:function(t){return this.viewCamera.targetReferenceFrame=t,t},get_fovLocal:function(){return this._fovLocal},set_fovLocal:function(t){return this._fovLocal=t,t},setupMatricesOverlays:function(){this.set_world(yn.get_identity()),yn.get_identity();var t,e=wn.create(0,0,0),i=wn.create(0,0,1),n=wn.create(0,1,0);(t=yn.lookAtLH(e,i,n))._multiply(yn._scaling(1,-1,1)),this.set_view(t),this.nearPlane=.1,this.set_projection(yn.perspectiveFovLH(this._fovLocal,this.width/this.height,this.nearPlane,1e4))},setupMatricesSolarSystem:function(e){this.lighting=ko.get_active().get_solarSystemLighting(),this.space=!1,20!==this.get_solarSystemTrack()&&65536!==this.get_solarSystemTrack()&&(this.viewCamera.viewTarget=Jo.getPlanetTargetPoint(this.get_solarSystemTrack(),this.viewCamera.lat,this.viewCamera.lng,0)),no.cullInside=!1;var i=this.get_solarSystemCameraDistance(),n=yn.get_identity();if(i-=1e-6,20!==this.get_solarSystemTrack()||t.ss.emptyString(this.get_trackingFrame()))t.ss.emptyString(this.get_trackingFrame())||this.set_trackingFrame("");else{var r=wu._getFrameTarget(this,this.get_trackingFrame());this.viewCamera.viewTarget=r.target,n=r.matrix}this.viewCamera.viewTarget,this.viewCamera.zoom;var s=new wn,o=yn.get_identity();o._multiply(yn._rotationX(-this.viewCamera.lat/180*Math.PI)),o._multiply(yn._rotationY(-this.viewCamera.lng/180*Math.PI));var l,h=yn.get_identity();if(this._useSolarSystemTilt&&!this.get_sandboxMode()){var u=this.viewCamera.angle;if(i>8e-4)u=0;else if(i>1e-5){var c=Math.min(1.903089987,a.log10(i)+5)/1.903089987;u*=Math.max(0,1-c)}this.cameraPosition=wn.create(Math.sin(-this.viewCamera.rotation)*Math.sin(u)*i,Math.cos(-this.viewCamera.rotation)*Math.sin(u)*i,Math.cos(u)*i),l=wn.create(Math.sin(-this.viewCamera.rotation),Math.cos(-this.viewCamera.rotation),1e-5)}else this.cameraPosition=wn.create(0,0,i),l=wn.create(Math.sin(-this.viewCamera.rotation),Math.cos(-this.viewCamera.rotation),1e-4);this.cameraPosition=o.transform(this.cameraPosition),this._cameraOffset=this.cameraPosition.copy();var _=n.clone();_.invert(),this._cameraOffset=wn._transformCoordinate(this._cameraOffset,_),l=o.transform(l),this.set_world(yn.get_identity()),this.set_worldBase(yn.get_identity()),this.set_worldBaseNonRotating(yn.get_identity()),this.set_view(yn.multiplyMatrix(yn.multiplyMatrix(n,yn.lookAtLH(this.cameraPosition,s,l)),h)),this.set_viewBase(this.get_view().clone());var d=wn.subtractVectors(s,this.cameraPosition);d.normalize(),(d=wn._transformCoordinate(d,n)).normalize(),this._viewPoint=d,i<2*Jo.getAdjustedPlanetRadius(this.get_solarSystemTrack())&&!e?(this.nearPlane=.03*i,this.nearPlane=Math.max(this.nearPlane,1e-11),Gu.back=1900):e?(Gu.back=900056,Gu.back=i>900056?3*i:900056,this.nearPlane=3e-5):(Gu.back=i>1900?i+200:1900,ko.get_active().get_solarSystemScale()<13?this.nearPlane=Math.min(.03*i,.01):this.nearPlane=.001),this.set_projection(yn.perspectiveFovLH(this._fovLocal,this.width/this.height,this.nearPlane,Gu.back)),this.perspectiveFov=this._fovLocal,this._fovAngle=this.viewCamera.zoom/343.774/Math.PI*180,this._fovScale=this._fovAngle/this.height*3600,this._setMatrixes(),this.makeFrustum()},_setMatrixes:function(){},get_frustum:function(){return this._frustum},get_ambientLightColor:function(){return this._ambientLightColor},set_ambientLightColor:function(t){return this._ambientLightColor=t,this._lightingStateDirty=!0,t},get_hemisphereLightColor:function(){return this._hemiLightColor},set_hemisphereLightColor:function(t){return this._hemiLightColor=t,this._lightingStateDirty=!0,t},get_hemisphereLightUp:function(){return this._hemiLightUp},set_hemisphereLightUp:function(t){return this._hemiLightUp=t,this._lightingStateDirty=!0,t},get_sunlightColor:function(){return this._sunlightColor},set_sunlightColor:function(t){return this._sunlightColor=t,this._lightingStateDirty=!0,t},get_sunPosition:function(){return this._sunPosition},set_sunPosition:function(t){return this._sunPosition=t,this._lightingStateDirty=!0,t},get_reflectedLightColor:function(){return this._reflectedLightColor},set_reflectedLightColor:function(t){return this._reflectedLightColor!==t&&(this._reflectedLightColor=t,this._lightingStateDirty=!0),t},get_reflectedLightPosition:function(){return this._reflectedLightPosition},set_reflectedLightPosition:function(t){return this._reflectedLightPosition=t,this._lightingStateDirty=!0,t},get_occludingPlanetRadius:function(){return this._occludingPlanetRadius},set_occludingPlanetRadius:function(t){return this._occludingPlanetRadius=t,t},get_occludingPlanetPosition:function(){return this._occludingPlanetPosition},set_occludingPlanetPosition:function(t){return this._occludingPlanetPosition=t,t},get_twoSidedLighting:function(){return this._twoSidedLighting},set_twoSidedLighting:function(t){return t!==this._twoSidedLighting&&(this._twoSidedLighting=t,this._lightingStateDirty=!0),t},makeFrustum:function(){this.WV=yn.multiplyMatrix(this.get_world(),this.get_view());var t=yn.multiplyMatrix(this.WV,this.get_projection());this.WVP=t.clone(),this.get_world().clone().invert(),this._frustum[0].a=t.get_m14()+t.get_m11(),this._frustum[0].b=t.get_m24()+t.get_m21(),this._frustum[0].c=t.get_m34()+t.get_m31(),this._frustum[0].d=t.get_m44()+t.get_m41(),this._frustum[1].a=t.get_m14()-t.get_m11(),this._frustum[1].b=t.get_m24()-t.get_m21(),this._frustum[1].c=t.get_m34()-t.get_m31(),this._frustum[1].d=t.get_m44()-t.get_m41(),this._frustum[2].a=t.get_m14()-t.get_m12(),this._frustum[2].b=t.get_m24()-t.get_m22(),this._frustum[2].c=t.get_m34()-t.get_m32(),this._frustum[2].d=t.get_m44()-t.get_m42(),this._frustum[3].a=t.get_m14()+t.get_m12(),this._frustum[3].b=t.get_m24()+t.get_m22(),this._frustum[3].c=t.get_m34()+t.get_m32(),this._frustum[3].d=t.get_m44()+t.get_m42(),this._frustum[4].a=t.get_m13(),this._frustum[4].b=t.get_m23(),this._frustum[4].c=t.get_m33(),this._frustum[4].d=t.get_m43(),this._frustum[5].a=t.get_m14()-t.get_m13(),this._frustum[5].b=t.get_m24()-t.get_m23(),this._frustum[5].c=t.get_m34()-t.get_m33(),this._frustum[5].d=t.get_m44()-t.get_m43();for(var e=0;e<6;e++)this._frustum[e].normalize();this._frustumDirty=!1,this.WVP.scale(wn.create(this.width/2,-this.height/2,1)),this.WVP.translate(wn.create(this.width/2,this.height/2,0)),this._setMatrixes()},_initGL:function(){null!=this.gl&&(this.gl.getExtension("OES_element_index_uint"),Wi(1),Zi(!0),ps.init(this))},freezeView:function(){this.targetAlt=this.alt,this.targetAz=this.az,this.targetCamera=this.viewCamera.copy()},_setVertexBuffer:function(t){},_setIndexBuffer:function(t){},setMaterial:function(t,e,i,n,r){this.set_mainTexture(e)},preDraw:function(){}};function Hu(e){t.ss.EventArgs.call(this),this.set_caption(e)}function Yu(e,i,n){this._ra$2=0,this._dec$2=0,this._zoom$2=0,t.ss.EventArgs.call(this),this.set_RA(15*e),this.set_dec(i),this.set_zoom(n/6)}function ju(e,i,n){this._ra$2=0,this._dec$2=0,t.ss.EventArgs.call(this),this.set_RA(15*e),this.set_dec(i),this.set_id(n)}function Wu(e){t.ss.EventArgs.call(this),this._url$2=e}function qu(){this._missedReady=!1,this.hideTourFeedback=!1,this._smoothAnimation=!1,this._showCaptions=!0}n("RenderContext",[Gu,Xu,null]),n("SlideChangedEventArgs",[Hu,{get_caption:function(){return this._caption$2},set_caption:function(t){return this._caption$2=t,t}},t.ss.EventArgs]),n("ArrivedEventArgs",[Yu,{get_RA:function(){return this._ra$2},set_RA:function(t){return this._ra$2=t,t},get_dec:function(){return this._dec$2},set_dec:function(t){return this._dec$2=t,t},get_zoom:function(){return this._zoom$2},set_zoom:function(t){return this._zoom$2=t,t}},t.ss.EventArgs]),n("AnnotationClickEventArgs",[ju,{get_RA:function(){return this._ra$2},set_RA:function(t){return this._ra$2=t,t},get_dec:function(){return this._dec$2},set_dec:function(t){return this._dec$2=t,t},get_id:function(){return this._id$2},set_id:function(t){return this._id$2=t,t}},t.ss.EventArgs]),n("CollectionLoadedEventArgs",[Wu,{get_url:function(){return this._url$2},set_url:function(t){return this._url$2=t,t}},t.ss.EventArgs]),qu._containsFitsLikeExtentsion=function(e){var i=e.toLowerCase();return t.ss.endsWith(i,"fits")||t.ss.endsWith(i,"ftz")||t.ss.endsWith(i,"fit")||t.ss.endsWith(i,"fts")},qu._addImageSet=function(e,i,n,r){t.ss.whitespace(e)&&(e=wu.getNextImageSetName());var s=wu.addImageSetLayerCallback(r,e,n);if(i){var a=r._guessZoomSetting(an.viewCamera.zoom);kr.gotoRADecZoom(r.get_viewCenterX()/15,r.get_viewCenterY(),a,!1,null)}return s},qu._addFitsLayer=function(e,i,n,r){t.ss.whitespace(i)&&(i=wu.getNextFitsName());var s=new Nl,o=new Co,l=function(e){if(!e.errored){if(t.ss.truncate(e.get_sizeX()),t.ss.truncate(e.get_sizeY()),o.setInitialParameters(e.get_description(),e.get_filename(),2,3,5,a.getHashCode(e.get_filename()),0,0,e.get_scaleY(),".fits",e.get_scaleX()>0,"",e.get_centerX(),e.get_centerY(),e.get_rotation(),!1,"",!1,!1,1,e.get_referenceX(),e.get_referenceY(),e.get_copyright(),e.get_creditsUrl(),"","",0,""),o.set_wcsImage(e),s.set_imageSet(o),wu.addFitsImageSetLayer(s,i),n){var l=o._guessZoomSetting(an.viewCamera.zoom);kr.gotoRADecZoom(e.get_viewCenterX()/15,e.get_viewCenterY(),l,!1,null)}null!=r&&r(s)}};return t.ss.whitespace(i)&&(i=wu.getNextFitsName()),Ji?new Ga(o,e,null,l):new Ja(o,e,null,l),s};var Zu={add_ready:function(e){this.__ready=t.ss.bindAdd(this.__ready,e)},remove_ready:function(e){this.__ready=t.ss.bindSub(this.__ready,e)},_fireReady:function(){null!=this.__ready?this.__ready(this,new t.ss.EventArgs):this._missedReady=!0},add_collectionLoaded:function(e){this.__collectionLoaded=t.ss.bindAdd(this.__collectionLoaded,e)},remove_collectionLoaded:function(e){this.__collectionLoaded=t.ss.bindSub(this.__collectionLoaded,e)},_fireCollectionLoaded:function(t){null!=this.__collectionLoaded&&this.__collectionLoaded(this,new Wu(t))},add_colorPickerDisplay:function(e){this.__colorPickerDisplay=t.ss.bindAdd(this.__colorPickerDisplay,e)},remove_colorPickerDisplay:function(e){this.__colorPickerDisplay=t.ss.bindSub(this.__colorPickerDisplay,e)},add_voTableDisplay:function(e){this.__voTableDisplay=t.ss.bindAdd(this.__voTableDisplay,e)},remove_voTableDisplay:function(e){this.__voTableDisplay=t.ss.bindSub(this.__voTableDisplay,e)},add_refreshLayerManager:function(e){this.__refreshLayerManager=t.ss.bindAdd(this.__refreshLayerManager,e)},remove_refreshLayerManager:function(e){this.__refreshLayerManager=t.ss.bindSub(this.__refreshLayerManager,e)},add_arrived:function(e){this.__arrived=t.ss.bindAdd(this.__arrived,e)},remove_arrived:function(e){this.__arrived=t.ss.bindSub(this.__arrived,e)},add_clicked:function(e){this.__clicked=t.ss.bindAdd(this.__clicked,e)},remove_clicked:function(e){this.__clicked=t.ss.bindSub(this.__clicked,e)},add_annotationClicked:function(e){this.__annotationClicked=t.ss.bindAdd(this.__annotationClicked,e)},remove_annotationClicked:function(e){this.__annotationClicked=t.ss.bindSub(this.__annotationClicked,e)},add_imageryLoaded:function(e){this.__imageryLoaded=t.ss.bindAdd(this.__imageryLoaded,e)},remove_imageryLoaded:function(e){this.__imageryLoaded=t.ss.bindSub(this.__imageryLoaded,e)},add_tourReady:function(e){this.__tourReady=t.ss.bindAdd(this.__tourReady,e)},remove_tourReady:function(e){this.__tourReady=t.ss.bindSub(this.__tourReady,e)},add_tourError:function(e){this.__tourError=t.ss.bindAdd(this.__tourError,e)},remove_tourError:function(e){this.__tourError=t.ss.bindSub(this.__tourError,e)},add_tourPaused:function(e){this.__tourPaused=t.ss.bindAdd(this.__tourPaused,e)},remove_tourPaused:function(e){this.__tourPaused=t.ss.bindSub(this.__tourPaused,e)},add_tourResumed:function(e){this.__tourResumed=t.ss.bindAdd(this.__tourResumed,e)},remove_tourResumed:function(e){this.__tourResumed=t.ss.bindSub(this.__tourResumed,e)},add_tourEnded:function(e){this.__tourEnded=t.ss.bindAdd(this.__tourEnded,e)},remove_tourEnded:function(e){this.__tourEnded=t.ss.bindSub(this.__tourEnded,e)},add_slideChanged:function(e){this.__slideChanged=t.ss.bindAdd(this.__slideChanged,e)},remove_slideChanged:function(e){this.__slideChanged=t.ss.bindSub(this.__slideChanged,e)},add_timeScrubberHook:function(e){this.__timeScrubberHook=t.ss.bindAdd(this.__timeScrubberHook,e)},remove_timeScrubberHook:function(e){this.__timeScrubberHook=t.ss.bindSub(this.__timeScrubberHook,e)},setTimeScrubberPosition:function(t){wu.setTimeSliderValue(t)},setTimeSlider:function(t,e){this.__timeScrubberHook(t,e)},showColorPicker:function(t,e){null!=this.__colorPickerDisplay&&this.__colorPickerDisplay(t,e)},displayVoTableLayer:function(e){null!=this.__voTableDisplay&&this.__voTableDisplay(e,new t.ss.EventArgs)},refreshLayerManagerNow:function(){null!=this.__refreshLayerManager&&this.__refreshLayerManager(null,new t.ss.EventArgs)},_fireTourReady:function(){null!=this.__tourReady&&this.__tourReady(this,new t.ss.EventArgs)},_fireTourError:function(e){null!=this.__tourError&&this.__tourError(e,new t.ss.EventArgs)},_fireTourPaused:function(){null!=this.__tourPaused&&this.__tourPaused(this,new t.ss.EventArgs)},_fireTourResume:function(){null!=this.__tourResumed&&this.__tourResumed(this,new t.ss.EventArgs)},_fireTourEnded:function(){null!=this.__tourEnded&&this.__tourEnded(this,new t.ss.EventArgs)},_fireImageryLoaded:function(){null!=this.__imageryLoaded&&this.__imageryLoaded(this,new t.ss.EventArgs)},_fireClick:function(t,e){null!=this.__clicked&&this.__clicked(this,new Yu(t,e,an.viewCamera.zoom))},_fireArrived:function(t,e,i){null!=this.__arrived&&this.__arrived(this,new Yu(t,e,i))},_fireAnnotationclicked:function(t,e,i){try{null!=this.__annotationClicked&&this.__annotationClicked(this,new ju(t,e,i))}catch(t){}},_fireSlideChanged:function(t){try{null!=this.__slideChanged&&this.__slideChanged(this,new Hu(t))}catch(t){}},endInit:function(){this._missedReady&&this._fireReady()},gotoRaDecZoom:function(t,e,i,n,r){null!=kr&&kr.gotoRADecZoom(t/15,e,6*i,n,r)},setBackgroundImageByName:function(t){null!=kr&&kr.setBackgroundImageByName(t)},addVoTableLayer:function(t){return wu.addVoTableLayer(t,"Vo Table")},getLayers:function(){return wu.get_layerList()},setForegroundImageByName:function(t){null!=kr&&(kr.setForegroundImageByName(t),an.viewCamera.opacity=100)},setForegroundOpacity:function(t){null!=kr&&(an.viewCamera.opacity=t)},addCatalogHipsByName:function(t){null!=kr&&kr.addCatalogHipsByName(t)},addCatalogHipsByNameWithCallback:function(t,e){null!=kr&&kr.addCatalogHipsByNameWithCallback(t,e)},removeCatalogHipsByName:function(t){null!=kr&&kr.removeCatalogHipsByName(t)},getCatalogHipsDataInView:function(t,e,i){null!=kr&&kr.getCatalogHipsDataInView(t,e,i)},setCutsForFits:function(t,e,i){null!=kr&&kr.setCutsForFits(t,e,i)},setColorMapForFits:function(t,e){null!=kr&&kr.setColorMapForFits(t,e)},setScaleTypeForFits:function(t,e){null!=kr&&kr.setScaleTypeForFits(t,e)},hideUI:function(t){},loadTour:function(t){null!=kr&&kr.playTour(t)},loadFits:function(t){return this.loadFitsLayer(t,"",!0,null)},loadFitsLayer:function(t,e,i,n){return this.addImageSetLayer(t,"fits",e,i,n)},addImageSetLayer:function(t,e,i,n,r){if(null!=e&&"fits"===e.toLowerCase())return qu._addFitsLayer(t,i,n,r);if(null!=e&&"preloaded"===e.toLowerCase()){if(null!=(s=kr.getImageSetByUrl(t)))return qu._addImageSet(i,n,r,s)}else{var s;if(null!=(s=kr.getImageSetByUrl(t)))return qu._addImageSet(i,n,r,s);if(qu._containsFitsLikeExtentsion(t))return qu._addFitsLayer(t,i,n,r)}return null},setImageSetLayerOrder:function(e,i){var n=wu.get_layerList()[e];t.ss.canCast(n,Nl)&&i>=0&&(t.ss.remove(Dr()[n.get_referenceFrame()].layers,n),Dr()[n.get_referenceFrame()].layers.splice(i,0,n))},isUsingWebGl2:function(){return Ji},get_hideTourFeedback:function(){return this.hideTourFeedback},set_hideTourFeedback:function(t){return this.hideTourFeedback=t,t},playTour:function(){null!=kr&&kr.playCurrentTour()},stopTour:function(){null!=kr&&kr.stopCurrentTour()},loadImageCollection:function(t,e){var i=this;this._imageUrl=t,Fr(t,(function(){i._fireCollectionLoaded(t)}),e)},_imageFileLoaded:function(){this._fireCollectionLoaded(this._imageUrl)},zoom:function(t){null!=kr&&kr.zoom(t)},getRA:function(){return null!=kr?an.get_RA():0},getDec:function(){return null!=kr?an.get_dec():0},createFolder:function(){return new Fu},createPolygon:function(t){var e=new ya;return e.set_fill(t),e},createPolyLine:function(t){return new xa},createCircle:function(t){var e=new ba;return e.set_fill(t),e},addAnnotation:function(e){null!=e&&t.ss.canCast(e,pa)&&null!=kr&&kr._addAnnotation(e)},removeAnnotation:function(t){null!=t&&null!=kr&&kr._removeAnnotation(t)},clearAnnotations:function(){null!=kr&&kr._clearAnnotations()},get_smoothAnimation:function(){return this._smoothAnimation},set_smoothAnimation:function(t){return this._smoothAnimation=t,t},get_showCaptions:function(){return this._showCaptions},set_showCaptions:function(t){return this._showCaptions=t,t},loadVOTable:function(t,e){},get_fov:function(){return null!=kr?an.viewCamera.zoom/6:60}};function Ku(){}function Ju(){}function Qu(){}function tc(){this.freestandingMode=!1,this.uiController=null,this._annotations=[],this._hoverText="",this._hoverTextPoint=new vn,this._lastMouseMove=new Date(1900,1,0,0,0,0,0),this.layers=[],this._frameCount=0,this._zoomMax=360,this._zoomMaxSolarSystem=1e16,this._zoomMin=.001373291015625,this._zoomMinSolarSystem=1e-8,this.constellation="UMA",this._fadePoints=null,this.fader=xr.create(!0,2e3),this._crossFadeFrame=!1,this._crossFadeTexture=null,this._sprite=new qo,this.renderType=2,this._milkyWayBackground=null,this.capturingVideo=!1,this._videoBlobReady=null,this.dumpFrameParams=null,this._videoBlobQueue={},this._videoQueueIndex=0,this._emptyFrames=[],this._beginZoom=1,this._dragging=!1,this._mouseDown=!1,this._hasTwoTouches=!1,this._lastX=0,this._lastY=0,this._pointerIds=new Array(2),this._pinchingZoomRect=new Array(2),this._moved=!1,this._foregroundCanvas=null,this._fgDevice=null,this._tracking=!1,this._trackingObject=null,this.sandboxMode=!1,this._solarSystemTrack=65536,this._moving=!1,this._targetStudyImageset=null,this._targetBackgroundImageset=null,this.tour=null,this.tourEdit=null,this._crossHairs=null}n("ScriptInterface",[qu,Zu,null]),Ku.mpcList=[],Ku._initBegun=!1,Ku._mpcBlendStates=new Array(7),Ku.starTexture=null,Ku._mpcVertexBuffer=null,Ku._mpcCount=0,Ku.getMpcFile=function(t){Ku._webMpcFile=new $a(t),Ku._webMpcFile.responseType="blob",Ku._webMpcFile.onStateChange=Ku.starFileStateChange,Ku._webMpcFile.send()},Ku.starFileStateChange=function(){if(2===Ku._webMpcFile.get_state())alert(Ku._webMpcFile.get_message());else if(1===Ku._webMpcFile.get_state()){var t=Ku._webMpcFile.getBlob(),e=new FileReader;e.onloadend=function(t){Ku._readFromBin(new js(new Uint8Array(e.result))),Ku.initMPCVertexBuffer()},e.readAsArrayBuffer(t)}},Ku._readFromBin=function(t){Ku.mpcList=[];var e,i=t.get_length();try{for(;t.get_position()<i;)e=En._create(t),Ku.mpcList.push(e)}catch(t){}t.close()},Ku.drawMPC3D=function(e,i,n){var r=e.viewCamera.zoom,s=90*(Math.log(Math.max(1,r))/Math.log(4)-15.5);if(!(Math.min(255,Math.max(0,t.ss.truncate(s)))>254))if(null!=Ku._mpcVertexBuffer){var a=yn.translation(wn.negate(n)),o=yn.multiplyMatrix(e.get_world(),a),l=yn.multiplyMatrix(o,e.get_view());if(wn._transformCoordinate(e.cameraPosition,yn.invertMatrix(e.get_world())),null!=Ku._mpcVertexBuffer)for(h=0;h<7;h++)Ku._mpcBlendStates[h].set_targetState(!0),Ku._mpcBlendStates[h].get_state()&&(ds.use(e,l,Ku._mpcVertexBuffer[h].vertexBuffer,Ku.starTexture.texture2d,Xi.get_white(),i*Ku._mpcBlendStates[h].get_opacity(),!1,Wo.get_jNow()-al.baseDate,0,e.cameraPosition,200,.1),e.gl.drawArrays(Yr.POINTS,0,Ku._mpcVertexBuffer[h].count))}else{null==Ku.starTexture&&(Ku.starTexture=rs.fromUrl(zr.singleton.engineAssetUrl("StarProfileAlpha.png")));for(var h=0;h<7;h++)Ku._mpcBlendStates[h]=xr.create(!1,1e3);Ku._initBegun||(Ku._startInit(),Ku._initBegun=!0)}},Ku._startInit=function(){Mr||Ku.getMpcFile(zr.singleton.coreStaticUrl("wwtweb/catalog.aspx?Q=mpcbin"))},Ku.initMPCVertexBuffer=function(){try{if(null==Ku._mpcVertexBuffer){var e=new Array(7);Ku._mpcCount=Ku.mpcList.length;for(var i=new Array(7),n=0;n<7;n++)i[n]=[];for(var r=t.ss.enumerate(Ku.mpcList);r.moveNext();){var s,a=r.current;s=a.a<2.5?0:a.a<2.83?1:a.a<2.96?2:a.a<3.3?3:a.a<5?4:a.a<10?5:6;var o=new al;o.fill(a),i[s].push(o)}for(n=0;n<7;n++)e[n]=ts.create(i[n]),e[n].unlock();Ku._mpcVertexBuffer=e}}finally{}},n("MinorPlanets",[Ku,{},null]),Ju._queue={},Ju._tiles={},Ju.openThreads=8,Ju.readyToRenderCount=0,Ju.maxTileCacheSize=800,Ju.maxReadyToRenderSize=200,Ju._maxTotalToPurge=0,Ju.get_queueCount=function(){return t.ss.keyCount(Ju._queue)},Ju.getTile=function(e,i,n,r,s){var a=null,o=Bi(r,e,i,n,s);return t.ss.keyExists(Ju._tiles,o)?a=Ju._tiles[o]:null!=(a=Co.getNewTile(r,e,i,n,s))&&(Ju._tiles[o]=a),a},function(t){rn=t}(Ju.getTile),Ju.getCachedTile=function(e,i,n,r,s){if(e<r.get_baseLevel())return null;var a=null,o=Bi(r,e,i,n,s);try{if(!t.ss.keyExists(Ju._tiles,o))return null;a=Ju._tiles[o]}catch(t){}return a},function(t){sn=t}(Ju.getCachedTile),Ju.getReadyToRenderTileCount=function(){var e=[],i=[];try{try{for(var n=t.ss.enumerate(t.ss.keys(Ju._tiles));n.moveNext();){var r=n.current,s=Ju._tiles[r];s.renderedGeneration<eo.currentRenderGeneration-10&&!s.requestPending&&!s.downloading&&(s.readyToRender?i.push(s):e.push(s))}}catch(t){}return i.length}catch(t){return-1}},Ju.processQueue=function(e){for(;t.ss.keyCount(Ju._queue)>0&&Ju.openThreads>0;){for(var i=1e5,n=!1,r=null,s=t.ss.enumerate(t.ss.keys(Ju._queue));s.moveNext();){var a=s.current,o=Ju._queue[a];if(!o.requestPending&&o.inViewFrustum){var l=wn.makeCopy(o.get_sphereCenter());l._transformByMatrics(e.get_world()),e.space?l.subtract(wn.create(0,0,-1)):l.subtract(e.cameraPosition);var h=Math.max(0,l.length()-o.get_sphereRadius()),u=o.get_dataset().get_projection()===xo.tangent||o.get_dataset().get_projection()===xo.skyImage;h<i&&(!n||u)&&(i=h,r=o.get_key(),o.level,n=u)}}if(null==r)return;var c=Ju._queue[r];c.requestPending=!0,Ju.openThreads--,Ju.openThreads<0&&(Ju.openThreads=0),c.requestImage(),c.get_dataset().get_elevationModel()&&c.requestDem()}},Ju.addTileToQueue=function(e){return e.downloading||e.readyToRender||(t.ss.keyExists(Ju._queue,e.get_key())?Ju._queue[e.get_key()].requestHits+=256:(e.requestHits=256,Ju._queue[e.get_key()]=e)),!0},function(t){tn=t}(Ju.addTileToQueue),Ju.removeFromQueue=function(t,e){if(e){var i=Ju._queue[t];null!=i&&(i.requestPending=!1,delete Ju._queue[i.get_key()]),Ju.openThreads++}delete Ju._queue[t]},function(t){en=t}(Ju.removeFromQueue),Ju.clearCache=function(){t.ss.clearKeys(Ju._tiles)},Ju.purgeQueue=function(){t.ss.clearKeys(Ju._queue)},Ju.purgeLRU=function(){if(!(t.ss.keyCount(Ju._tiles)<Ju.maxReadyToRenderSize)){var e=[],i=[];try{try{for(var n=t.ss.enumerate(t.ss.keys(Ju._tiles));n.moveNext();){var r=n.current;(o=Ju._tiles[r]).renderedGeneration<eo.currentRenderGeneration-10&&!o.requestPending&&!o.downloading&&(o.readyToRender?i.push(o):e.push(o))}}catch(t){}if(Ju.readyToRenderCount=i.length,i.length>Ju.maxReadyToRenderSize){i.sort((function(t,e){return e.accessCount<t.accessCount?1:e.accessCount===t.accessCount?0:-1}));for(var s=i.length-Ju.maxReadyToRenderSize,a=t.ss.enumerate(i);a.moveNext();){var o=a.current;if(s<1)break;o.cleanUp(!1),s--}}if(t.ss.keyCount(Ju._tiles)<Ju.maxTileCacheSize)return;if(e.length>Ju.maxTileCacheSize){e.sort((function(t,e){return e.accessCount<t.accessCount?1:e.accessCount===t.accessCount?0:-1})),(s=e.length-Ju.maxTileCacheSize)>20&&(s=20);for(var l=t.ss.enumerate(e);l.moveNext()&&(o=l.current,!(s<1));)o.cleanUp(!0),delete Ju._tiles[o.get_key()],s--}}catch(t){}}},Ju.decimateQueue=function(){for(var e=[],i=t.ss.enumerate(t.ss.keys(Ju._queue));i.moveNext();){var n=i.current;if(!(s=Ju._queue[n]).requestPending){s.requestHits=s.requestHits/2;try{s.requestHits<2?e.push(s):s.inViewFrustum||e.push(s)}catch(t){}}}for(var r=t.ss.enumerate(e);r.moveNext();){var s=r.current;delete Ju._queue[s.get_key()]}},n("TileCache",[Ju,{},null]),Qu._ringsTriangleLists=new Array(2),Qu._ringImage=null,Qu._triangleCountRings=194,Qu._ringsVertexBuffer=null,Qu.getImageSetNameNameFrom3dId=function(t){switch(t){case 0:return"Sun";case 1:return"Mercury";case 2:return"Venus";case 3:return"Visible Imagery";case 4:return"Jupiter";case 5:return"Saturn";case 6:return"Uranus";case 7:return"Neptune";case 8:return"Pluto";case 9:return"Moon";case 10:return"Io (Jupiter)";case 11:return"Europa (Jupiter)";case 12:return"Ganymede (Jupiter)";case 13:return"Callisto (Jupiter)";case 19:return"Bing Maps Aerial";default:return""}},Qu.initPlanetResources=function(t){},Qu.drawPlanets3D=function(e,i,n){Qu.initPlanetResources(e);var r=Fa.solarSystemToMeters(e.get_solarSystemCameraDistance()),s=(Math.min(1,Math.max(a.log10(r)-7.3,0)),Math.min(1,Math.max(a.log10(r)-8.6,0)));if(ko.get_active().get_solarSystemOrbits()&&s>0){for(var o=1;o<10;o++){var l=o;9===o&&(l=19);var h=Math.atan2(Jo._planet3dLocations[l].z,Jo._planet3dLocations[l].x);Qu._drawSingleOrbit(e,Jo.planetColors[l],l,n,h,Jo._planet3dLocations[l],s)}Qu._drawSingleOrbit(e,Jo.planetColors[9],9,n,0,Jo._planet3dLocations[9],s)}t.ss.clearKeys(Jo._drawOrder);for(var u=e.cameraPosition.copy(),c=0;c<14;c++)if(!ko.get_active().get_solarSystemLighting()||!Jo._planetLocations[c].eclipsed){var _=wn.subtractVectors(u,wn.subtractVectors(Jo._planet3dLocations[c],n));t.ss.keyExists(Jo._drawOrder,_.length())||(Jo._drawOrder[_.length()]=c)}var d=wn.subtractVectors(u,wn.subtractVectors(Jo._planet3dLocations[19],n));t.ss.keyExists(Jo._drawOrder,d.length())||(Jo._drawOrder[d.length()]=19);for(var g=t.ss.enumerate(t.ss.keys(Jo._drawOrder));g.moveNext();){var f=g.current;c=Jo._drawOrder[f],Qu._drawPlanet3d(e,c,n)}return!0},Qu._drawSingleOrbit=function(e,i,n,r,s,a,o){if(!(o<.01))if(null==e.gl){var l=Jo._orbitalSampleRate,h=!1,u=(e.get_viewPoint(),e.device);u.save(),u.strokeStyle=i.toString(),u.lineWidth=2,u.globalAlpha=1;for(var c=new wn,_=new wn,d=new wn,g=!0,f=yn.translation(wn.negate(r)),m=yn.multiplyMatrix(f,e.WVP),p=yn.multiplyMatrix(f,e.WV),w=0;w<l;w++){var b=Jo._orbits[n][w],v=(Math.atan2(Jo._orbits[n][w].z,Jo._orbits[n][w].x)+2*Math.PI-s)%(2*Math.PI),y=(T=t.ss.truncate(v/(2*Math.PI)*255))/255;T<2&&!h&&(b=a,y=1),_=p.transform(b),c=m.transform(b),_.z>0&&(g?g=!1:(u.beginPath(),u.globalAlpha=y*o,u.moveTo(d.x,d.y),u.lineTo(c.x,c.y),u.stroke())),d=c}u.restore()}else if(9!==n){l=Jo._orbitalSampleRate,h=!1,e.get_viewPoint(),c=new wn,_=new wn,d=new wn;var S=new Oi,x=(g=!0,new Ps);for(w=0;w<l;w++){b=Jo._orbits[n][w].copy(),v=(Math.atan2(b.z,b.x)+2*Math.PI-s)%(2*Math.PI),y=(T=t.ss.truncate(v/(2*Math.PI)*255))/255;var T,M=Oi.fromArgb(T,i.r,i.g,i.b);T<2&&!h&&!g&&(b=wn.subtractVectors(a,r),y=1,T=255,M.a=255,S.a=255,x.addLine(d,b.copy(),S._clone(),M._clone()),S.a=0,M.a=0,b=Jo._orbits[n][w].copy(),h=!0),b=wn.subtractVectors(b,r),g?g=!1:x.addLine(d,b,S,M),d=b,S=M._clone()}x.drawLines(e,1,Xi.get_white()),x.clear()}else{var C=0;switch(n){case 9:C=403503.21979;break;case 10:case 11:case 12:case 13:C=126686534;break;default:C=132712440018.8}var A=Jo.getPlanetPositionDirect(n,Jo._jNow),L=Jo.getPlanetPositionDirect(n,Jo._jNow-1/1440*.1),I=wn.scale(wn.subtractVectors(A,L),14400),k=Jo._stateVectorToKeplerian(A,I,C);Qu._drawSingleOrbitElements(e,i,n,r,s,a,k)}},Qu._drawSingleOrbitElements=function(t,e,i,n,r,s,a){var o;switch(i){case 9:o=ko.get_active().get_solarSystemScale()>1?ko.get_active().get_solarSystemScale()/2:1;break;case 10:case 11:case 12:case 13:o=ko.get_active().get_solarSystemScale();break;default:o=1}var l=wn.negate(n);9===i?l.add(Jo._planet3dLocations[19]):10!==i&&11!==i&&12!==i&&13!==i||l.add(Jo._planet3dLocations[4]);var h=wn.subtractVectors(s,n),u=yn.multiplyMatrix(yn.multiplyMatrix(a.orientation,yn.translation(l)),t.get_world());Kl.drawEllipseWithPosition(t,a.a/149598e3*o,a.e,a.ea,e,u,h)},Qu.isPlanetInFrustum=function(t,e){for(var i=t.get_frustum(),n=(wn.create(0,0,0),new Cn(0,0,0,1)),r=0;r<6;r++)if(i[r].dot(n)+e<0)return!1;return!0},Qu._drawPlanet3d=function(t,e,i){0===e?ps.minLightingBrightness=1:(ps.minLightingBrightness=.025,ps.atmosphereColor=19===e?Oi.fromArgb(255,65,157,217):Oi.fromArgb(0,0,0,0));var n=t.get_world(),r=t.get_worldBase(),s=t.get_worldBaseNonRotating(),a=Jo.getAdjustedPlanetRadius(e);Jo.setupPlanetMatrix(t,e,i,!0);var o=1;if(5===e&&(o=3),Qu.isPlanetInFrustum(t,o)){t.get_world(),t.get_worldBase(),t.get_worldBaseNonRotating();var l=Jo._planet3dLocations[0].copy(),h=Jo._planet3dLocations[e].copy();l=n.transform(l),h=n.transform(h),t.set_world(n),t.set_worldBase(r),t.set_worldBaseNonRotating(s),Jo._setupMatrixForPlanetGeometry(t,e,i,!0);var u=wn.subtractVectors(l,h);u.normalize(),t.set_sunPosition(u),ps.sunPosition=wn.subtractVectors(Jo._planet3dLocations[0],h);var c=wn.subtractVectors(Jo._planet3dLocations[e],i);c.subtract(t.cameraPosition);var _,d=c.length(),g=2*Math.atan(a/d*.5)/Math.PI*180;if(_=g>10.5?0:g>3.9?1:g>.72?2:g>.05?3:4,19===e&&_<2&&ko.get_active().get_solarSystemScale(),_<4){var f=t.lighting;5===e&&null==t.gl&&(t.lighting=!1,Qu.drawSaturnsRings(t,!1,d),t.lighting=f),e||(t.lighting=!1),Qu._drawSphere(t,e),5===e&&(null==t.gl?(t.lighting=!1,Qu.drawSaturnsRings(t,!0,d)):(t.lighting=!1,Qu._drawRings(t),t.lighting=f)),t.lighting=f}else if(e)if(e<9||19===e){var m=800*Jo._planetDiameters[e];_o.drawPointPlanet(t,new wn,Math.max(.05,Math.min(.1,m)),Jo.planetColors[e],!0)}else g>.002&&(m=800*Jo._planetDiameters[e],_o.drawPointPlanet(t,new wn,Math.max(.05,Math.min(.1,m)),Jo.planetColors[e],!0));else _o.drawPointPlanet(t,new wn,10*Jo._planetDiameters[e],Jo.planetColors[e],!0)}wu._draw(t,1,!1,Jo.getNameFrom3dId(e),!0,!1),t.set_world(n),t.set_worldBase(r),t.set_worldBaseNonRotating(s)},Qu.drawSaturnsRings=function(e,i,n){if(null==Qu._ringsTriangleLists[0]){Qu._ringImage=document.createElement("img"),Qu._ringImage.crossOrigin="anonymous",Qu._ringImage.src=zr.singleton.engineAssetUrl("saturnringsshadow.png"),Qu._ringsTriangleLists[0]=[],Qu._ringsTriangleLists[1]=[];var r,s=2.25,a=wn.create(-2.25,0,-2.25),o=wn.create(s,0,-2.25),l=wn.create(-2.25,0,s),h=wn.create(s,0,s),u=(wn.create(0,0,0),wn.create(-2.25,0,0),wn.create(0,0,-2.25),wn.create(0,0,s),wn.create(s,0,0),1024),c=1024;(r=[]).push(cn.createPosSize(a,0,0,u,c)),r.push(cn.createPosSize(o,1,0,u,c)),r.push(cn.createPosSize(l,0,1,u,c)),r.push(cn.createPosSize(h,1,1,u,c));var _=[];_.push(bo.create(0,2,1)),_.push(bo.create(2,3,1));for(var d=5;d-- >1;){for(var g=[],f=t.ss.enumerate(_);f.moveNext();)(C=f.current).subDivideNoNormalize(g,r);_=g}for(var m=.6/(u/256),p=t.ss.enumerate(_);p.moveNext();){var w=r[(C=p.current).a],b=r[C.b],v=r[C.c];Qu._ringsTriangleLists[0].push(no.createWithMiter(w,b,v,Qu._ringImage,6,m))}}if(null==e.gl){e.cameraPosition,new wn;var y=yn.multiplyMatrix(yn._rotationY(Math.atan2(e.get_sunPosition().x,e.get_sunPosition().z)),e.get_worldBaseNonRotating()),S=yn.multiplyMatrix(y,e.get_view()),x=yn.multiplyMatrix(S,e.get_projection());u=e.width,c=e.height,x.scale(wn.create(u/2,-c/2,1)),x.translate(wn.create(u/2,c/2,0));for(var T=0;T<2;T++){for(var M=t.ss.enumerate(Qu._ringsTriangleLists[0]);M.moveNext();){var C=M.current,A=S.transform(C.a.position).length()>n;i&&(A=!A),A&&(C.opacity=1,C.draw(e.device,x))}no.cullInside=!no.cullInside}}},Qu._drawRings=function(t){Qu._initRings(),ps.use(t,Qu._ringsVertexBuffer.vertexBuffer,null,Jo._ringsTexture.texture2d,1,!1,wn.zero),t.gl.drawArrays(Yr.TRIANGLE_STRIP,0,Qu._triangleCountRings)},Qu._initRings=function(){if(null==Qu._ringsVertexBuffer){Jo._ringsTexture=rs.fromUrl(zr.singleton.engineAssetUrl("saturnringsstrip.png"));var t=1.113,e=2.25;Qu._ringsVertexBuffer=new Kr(386),Qu._triangleCountRings=386;for(var i=Qu._ringsVertexBuffer.lock(),n=2*Math.PI/192,r=0,s=0;s<=192;s+=2){var a=s*n,o=(s+1)*n;i[r]=new cn,i[r].position=wn.create(Math.cos(a)*t,0,Math.sin(a)*t),i[r].tu=1,i[r].tv=0,i[++r]=new cn,i[r].position=wn.create(Math.cos(a)*e,0,Math.sin(a)*e),i[r].tu=0,i[r].tv=0,i[++r]=new cn,i[r].position=wn.create(Math.cos(o)*t,0,Math.sin(o)*t),i[r].tu=1,i[r].tv=1,i[++r]=new cn,i[r].position=wn.create(Math.cos(o)*e,0,Math.sin(o)*e),i[r].tu=0,i[r].tv=1,r++}Qu._ringsVertexBuffer.unlock()}},Qu._drawSphere=function(t,e){var i=Qu.getImageSetNameNameFrom3dId(e),n=kr.getImagesetByName(i);null==n&&(n=kr.getImagesetByName("Bing Maps Aerial")),null==n||t.drawImageSet(n,100)},n("Planets3d",[Qu,{},null]),tc.imageSets=[],tc.imageSetName="",tc.showDataLayers=!1,tc._renderNeeded=!1,tc.constellationsFigures=null,tc.constellationsBoundries=null,tc.solarSystemObjectsNames=["Sun","Mercury","Venus","Mars","Jupiter","Saturn","Uranus","Neptune","Pluto","Moon","Io","Europa","Ganymede","Callisto","IoShadow","EuropaShadow","GanymedeShadow","CallistoShadow","SunEclipsed","Earth","Custom","Undefined"],tc.addImageSetToRepository=function(e){for(var i=t.ss.enumerate(tc.imageSets);i.moveNext();){var n=i.current;if(n.get_imageSetID()===e.get_imageSetID())return n}return tc.imageSets.push(e),e},tc.getImageSets=function(){return tc.imageSets},tc.get_renderNeeded=function(){return tc._renderNeeded},tc.set_renderNeeded=function(t){return tc._renderNeeded=!0,t},tc.initControl=function(t){return tc.initControl2(t,!0)},tc.initControlParam=function(t,e){return tc.initControl2(t,!0)},tc.initControl2=function(t,e){return tc.initControl6(t,e,0,0,360,"Sky")},tc.initControl6=function(t,e,i,n,r,s){if(null==an.device){tc.scriptInterface=new qu,tc.scriptInterface.settings=ko.get_current(),function(t){Pr=t}(tc.scriptInterface);var a=tc._createCanvasElement(t),o=a.getContext("webgl2");if(null!=o?Qi(!0):(console.warn("This browser does not support WebGL 2.0. Some features will work suboptimally. To get the full AAS WWT experience, consider using the latest version of Chrome, Firefox or Edge. In case you would like to use Safari, we recommend that you enable WebGL 2.0"),o=a.getContext("webgl")),null==o&&(o=a.getContext("experimental-webgl")),null==o){var l=a.getContext("2d");an.device=l}else Yi(o),an.gl=o,Ki=!0;kr.canvas=a,an.width=a.width,an.height=a.height,kr.setup(a,i,n,r),Yo.initializeConstellations(),wu.oneTimeInitialization(),"earth"===s?an.set_backgroundImageset(Co.create("Blue Marble",zr.singleton.coreStaticUrl("wwtweb/tiles.aspx?q={1},{2},{3},bm200407"),To.earth,Mo.visible,xo.toast,101,0,7,256,180,".png",!1,"",0,0,0,!1,zr.singleton.coreStaticUrl("wwtweb/thumbnail.aspx?name=bm200407"),!0,!1,0,0,0,"","","","",6371e3,"Earth")):"black"===s?an.set_backgroundImageset(Co.create("Black Sky Background","",To.sky,Mo.visible,xo.toast,102,0,0,256,180,".png",!1,"0123",0,0,0,!1,"",!1,!1,2,0,0,"","","","",1,"Sky")):an.set_backgroundImageset(Co.create("DSS",zr.singleton.coreStaticUrl("wwtweb/dss.aspx?q={1},{2},{3}"),To.sky,Mo.visible,xo.toast,100,0,12,256,180,".png",!1,"",0,0,0,!1,zr.singleton.coreStaticUrl("thumbnails/DSS.png"),!0,!1,0,0,0,"","","","",1,"Sky"))}return an.viewCamera.lng+=0,an._initGL(),e&&kr.render(),Pr},tc._createCanvasElement=function(t){var e=document.getElementById(t),i=document.createElement("canvas");return i.height=e.clientHeight,i.width=e.clientWidth,e.appendChild(i),i},tc.useUserLocation=function(){navigator.geolocation.getCurrentPosition(tc._getLocation,tc._getLocationError)},tc._getLocation=function(t){t.coords.latitude&&ko.get_globalSettings().set_locationLat(t.coords.latitude),t.coords.longitude&&ko.get_globalSettings().set_locationLng(t.coords.longitude),t.coords.altitude&&ko.get_globalSettings().set_locationAltitude(t.coords.altitude)},tc._getLocationError=function(t){null!=t&&null!=t.coords&&(t.coords.latitude,t.coords.longitude)},tc.setBackgroundImageName=function(t){tc.imageSetName=t},tc.setForegroundImageName=function(t){tc.imageSetName=t},tc.showLayers=function(t){tc.showDataLayers=t};var ec={_addAnnotation:function(t){this._annotations.push(t),pa.batchDirty=!0},_removeAnnotation:function(e){t.ss.remove(this._annotations,e),pa.batchDirty=!0},_clearAnnotations:function(){this._annotations.length=0,pa.batchDirty=!0},_annotationclicked:function(e,i,n,r){if(null!=this._annotations&&this._annotations.length>0)for(var s=t.ss.enumerate(this._annotations);s.moveNext();){var a=s.current;if(a.hitTest(this.renderContext,e,i,n,r))return Pr._fireAnnotationclicked(e,i,a.get_id()),!0}return!1},_annotationHover:function(e,i,n,r){if(null!=this._annotations&&this._annotations.length>0)for(var s=t.ss.enumerate(this._annotations);s.moveNext();){var a=s.current;if(a.hitTest(this.renderContext,e,i,n,r))return this._hoverText=a.get_label(),this._hoverTextPoint=vn.create(n,r),!0}return!1},get_zoomMax:function(){return null!=this.renderContext.get_backgroundImageset()&&this.renderContext.get_backgroundImageset().get_dataSetType()==To.solarSystem?this._zoomMaxSolarSystem:this._zoomMax},set_zoomMax:function(t){return this._zoomMax=t,t},setSolarSystemMaxZoom:function(t){this._zoomMaxSolarSystem=t},get_zoomMin:function(){return null!=this.renderContext.get_backgroundImageset()&&this.renderContext.get_backgroundImageset().get_dataSetType()==To.solarSystem?this._zoomMinSolarSystem:this._zoomMin},set_zoomMin:function(t){return this._zoomMin=t,t},setSolarSystemMinZoom:function(t){this._zoomMinSolarSystem=t},_notifyMoveComplete:function(){},get_crossFadeFrame:function(){return this._crossFadeFrame},set_crossFadeFrame:function(t){return t&&this._crossFadeFrame!==t&&(this._crossFadeTexture,this._crossFadeTexture=this.renderContext._getScreenTexture()),this._crossFadeFrame=t,t||null!=this._crossFadeTexture&&(this._crossFadeTexture=null),t},_fadeFrame:function(){if(null!=this.renderContext.gl){var e=ko.get_active().getSetting(17);if(e.opacity>0){var i=Oi._fromArgbColor(255-Fa.gamma(255-t.ss.truncate(255*e.opacity),1/2.2),Xi.get_black());if(e.opacity>0||(i=Oi._fromArgbColor(255-Fa.gamma(255-t.ss.truncate(255*e.opacity),1/2.2),Xi.get_black())),this._crossFadeFrame?i=Oi._fromArgbColor(Fa.gamma(t.ss.truncate(255*e.opacity),1/2.2),Xi.get_white()):null!=this._crossFadeTexture&&(this._crossFadeTexture=null),null==this._fadePoints){this._fadePoints=new Array(4);for(var n=0;n<4;n++)this._fadePoints[n]=new dn}this._fadePoints[0].position.x=-this.renderContext.width/2,this._fadePoints[0].position.y=this.renderContext.height/2,this._fadePoints[0].position.z=1347,this._fadePoints[0].tu=0,this._fadePoints[0].tv=1,this._fadePoints[0].color=i,this._fadePoints[1].position.x=-this.renderContext.width/2,this._fadePoints[1].position.y=-this.renderContext.height/2,this._fadePoints[1].position.z=1347,this._fadePoints[1].tu=0,this._fadePoints[1].tv=0,this._fadePoints[1].color=i,this._fadePoints[2].position.x=this.renderContext.width/2,this._fadePoints[2].position.y=this.renderContext.height/2,this._fadePoints[2].position.z=1347,this._fadePoints[2].tu=1,this._fadePoints[2].tv=1,this._fadePoints[2].color=i,this._fadePoints[3].position.x=this.renderContext.width/2,this._fadePoints[3].position.y=-this.renderContext.height/2,this._fadePoints[3].position.z=1347,this._fadePoints[3].tu=1,this._fadePoints[3].tv=0,this._fadePoints[3].color=i,this._sprite.draw(this.renderContext,this._fadePoints,4,this._crossFadeTexture,!0,1)}}},captureVideo:function(e,i,n,r,s,a){this.capturingVideo=!0,this._videoBlobReady=e,t.ss.clearKeys(this._videoBlobQueue),this._videoQueueIndex=0,this._emptyFrames.length=0,this.dumpFrameParams=new ul(i,n,r,a,!0),Wo.frameDumping=!0,Wo.framesPerSecond=r,Wo.totalFrames=s,Wo.currentFrameNumber=0},render:function(){var t=this;this.renderOneFrame(),setTimeout((function(){t.render()}),10)},renderOneFrame:function(){null!=this.renderContext.get_backgroundImageset()?this.renderType=this.renderContext.get_backgroundImageset().get_dataSetType():this.renderType=2;var e=!1;if(this.canvas.width!==this.canvas.parentNode.clientWidth&&(this.canvas.width=this.canvas.parentNode.clientWidth,e=!0),this.canvas.height!==this.canvas.parentNode.clientHeight&&(this.canvas.height=this.canvas.parentNode.clientHeight,e=!0),e&&null!=this.explorer&&this.explorer.refresh(),!(this.canvas.width<1||this.canvas.height<1)){if(e&&(this._crossHairs=null),eo.lastDeepestLevel=eo.deepestLevel,no.width=this.renderContext.width=this.canvas.width,no.height=this.renderContext.height=this.canvas.height,eo.tilesInView=0,eo.tilesTouched=0,eo.deepestLevel=0,Wo.set_metaNow(t.ss.now()),null!=this.get__mover()){if(Wo.set_now(this.get__mover().get_currentDateTime()),Jo.updatePlanetLocations(this.get_solarSystemMode()),null!=this.get__mover()){var i=this.get__mover().get_currentPosition();if(this.renderContext.targetCamera=i.copy(),this.renderContext.viewCamera=i.copy(),this.renderContext.space&&ko.get_active().get_galacticMode()){var n=Qs.j2000toGalactic(15*i.get_RA(),i.get_dec());this.renderContext.targetAlt=this.renderContext.alt=n[1],this.renderContext.targetAz=this.renderContext.az=n[0]}else if(this.renderContext.space&&ko.get_active().get_localHorizonMode()){var r=Qs.equitorialToHorizon(Qs.fromRaDec(i.get_RA(),i.get_dec()),Wo.get_location(),Wo.get_now());this.renderContext.targetAlt=this.renderContext.alt=r.get_alt(),this.renderContext.targetAz=this.renderContext.az=r.get_az()}this.get__mover().get_complete()&&(Pr._fireArrived(this.get__mover().get_currentPosition().get_RA(),this.get__mover().get_currentPosition().get_dec(),an.viewCamera.zoom),this.set__mover(null),this._notifyMoveComplete())}}else Wo.updateClock(),Jo.updatePlanetLocations(this.get_solarSystemMode()),this._updateViewParameters();if(this.renderContext.clear(),4===this.renderType){this._solarSystemTrack<20&&(Jo.getAdjustedPlanetRadius(this._solarSystemTrack),this.renderContext.get_solarSystemCameraDistance(),this.renderContext.get_fovLocal()),this._trackingObject,this.renderContext.setupMatricesSolarSystem(!0);var s=this.renderContext.viewCamera.zoom,a=Math.min(1,Math.max(0,Math.log(s)-8.4)/4.2),o=Math.min(1,Math.max(0,Math.log(s)-17.9)/2.3),l=this.renderContext.get_world(),h=this.renderContext.get_world().clone();h._multiply(yn._scaling(1e5,1e5,1e5)),h._multiply(yn._rotationX(23.5/180*Math.PI)),h._multiply(yn.translation(this.renderContext.cameraPosition)),this.renderContext.set_world(h),this.renderContext.set_worldBase(h),this.renderContext.space=!0,this.renderContext.makeFrustum();var u=this.renderContext.lighting;if(this.renderContext.lighting=!1,ko.get_active().get_solarSystemMilkyWay()&&a<1&&(null==this._milkyWayBackground&&(this._milkyWayBackground=this.getImagesetByName("Digitized Sky Survey (Color)")),null!=this._milkyWayBackground)){no.cullInside=!0;var c=(1-a)/2;this.renderContext.drawImageSet(this._milkyWayBackground,100*c),no.cullInside=!1}this._drawSkyOverlays(),this.renderContext.lighting=u,this.renderContext.space=!1,this.renderContext.set_world(l),this.renderContext.set_worldBase(l),this.renderContext.makeFrustum();var _=this.renderContext.cameraPosition,d=this.renderContext.get_world(),g=this.renderContext.get_world();g._multiply(yn.translation(this.renderContext.viewCamera.viewTarget)),this.renderContext.cameraPosition=wn.subtractVectors(this.renderContext.cameraPosition,this.renderContext.viewCamera.viewTarget),this.renderContext.set_world(g),this.renderContext.makeFrustum(),ko.get_active().get_solarSystemCosmos()&&sl.drawCosmos3D(this.renderContext,1),ko.get_active().get_solarSystemMilkyWay()&&o>0&&sl.drawGalaxyImage(this.renderContext,o),ko.get_active().get_solarSystemStars()&&sl.drawStars3D(this.renderContext,1),g=d;var f=this.renderContext.viewCamera.viewTarget,m=wn.create(-f.x,-f.y,-f.z);this.renderContext.cameraPosition=_,g._multiply(yn.translation(m)),this.renderContext.set_world(g),this.renderContext.makeFrustum(),wu._draw(this.renderContext,1,!0,"Sky",!0,!1),this.renderContext.set_world(d),this.renderContext.makeFrustum(),this.renderContext.get_solarSystemCameraDistance()<15e3&&(this.renderContext.setupMatricesSolarSystem(!1),ko.get_active().get_solarSystemMinorPlanets()&&Ku.drawMPC3D(this.renderContext,1,this.renderContext.viewCamera.viewTarget),ko.get_active().get_solarSystemPlanets()&&Qu.drawPlanets3D(this.renderContext,1,this.renderContext.viewCamera.viewTarget))}else{if(this.renderType&&1!==this.renderType?this.renderContext.setupMatricesSpace3d(this.renderContext.width,this.renderContext.height):this.renderContext._setupMatricesLand3d(),this.renderContext.drawImageSet(this.renderContext.get_backgroundImageset(),100),null!=this.renderContext.get_foregroundImageset())if(this.renderContext.get_foregroundImageset().get_dataSetType()!==this.renderContext.get_backgroundImageset().get_dataSetType())this.renderContext.set_foregroundImageset(null);else if(100!==this.renderContext.viewCamera.opacity&&null==this.renderContext.gl){this._foregroundCanvas.width===this.renderContext.width&&this._foregroundCanvas.height===this.renderContext.height||(this._foregroundCanvas.width=t.ss.truncate(this.renderContext.width),this._foregroundCanvas.height=t.ss.truncate(this.renderContext.height));var p=this.renderContext.device;this._fgDevice.clearRect(0,0,this.renderContext.width,this.renderContext.height),this.renderContext.device=this._fgDevice,this.renderContext.drawImageSet(this.renderContext.get_foregroundImageset(),100),this.renderContext.device=p,this.renderContext.device.save(),this.renderContext.device.globalAlpha=this.renderContext.viewCamera.opacity/100,this.renderContext.device.drawImage(this._foregroundCanvas,0,0),this.renderContext.device.restore()}else this.renderContext.drawImageSet(this.renderContext.get_foregroundImageset(),this.renderContext.viewCamera.opacity);if(2===this.renderType)for(var w=t.ss.enumerate(this.renderContext.get_catalogHipsImagesets());w.moveNext();){var b=w.current;b.get_hipsProperties().get_catalogSpreadSheetLayer().enabled&&b.get_hipsProperties().get_catalogSpreadSheetLayer().lastVersion===b.get_hipsProperties().get_catalogSpreadSheetLayer().get_version()&&this.renderContext.drawImageSet(b,100)}if(2===this.renderType&&ko.get_active().get_showSolarSystem()&&(Jo.drawPlanets(this.renderContext,1),this.constellation=Yo.containment.findConstellationForPoint(this.renderContext.viewCamera.get_RA(),this.renderContext.viewCamera.get_dec()),this._drawSkyOverlays()),this.get_planetLike()||this.get_space()){if(this.get_space())this.renderContext.set_worldBaseNonRotating(this.renderContext.get_world()),null!=this._targetBackgroundImageset&&this.renderContext.set_nominalRadius(this._targetBackgroundImageset.get_meanRadius());else{var v=Qs.mstFromUTC2(Wo.get_now(),0)/180*Math.PI;this.renderContext.set_worldBaseNonRotating(yn.multiplyMatrix(yn._rotationY(v),this.renderContext.get_worldBase())),null!=this._targetBackgroundImageset&&this.renderContext.set_nominalRadius(this._targetBackgroundImageset.get_meanRadius())}var y=this.getCurrentReferenceFrame();wu._draw(this.renderContext,1,this.get_space(),y,!0,this.get_space())}}var S=this.renderContext.get_world(),x=this.renderContext.get_view(),T=this.renderContext.get_projection();if(ko.get_current().get_showCrosshairs()&&this._drawCrosshairs(this.renderContext),null!=this.uiController)this.uiController.render(this.renderContext);else{pa.prepBatch(this.renderContext);for(var M=t.ss.enumerate(this._annotations);M.moveNext();)M.current.draw(this.renderContext);if(pa.drawBatch(this.renderContext),t.ss.now()-this._lastMouseMove>400){var C=this.getCoordinatesForScreenPoint(this._hoverTextPoint.x,this._hoverTextPoint.y);this._annotationHover(C.x,C.y,this._hoverTextPoint.x,this._hoverTextPoint.y),this._lastMouseMove=new Date(2100,1,1)}t.ss.emptyString(this._hoverText)||this._drawHoverText(this.renderContext)}var A=!Ju.get_queueCount();this.renderContext.setupMatricesOverlays(),this._fadeFrame(),this._frameCount++,Ju.decimateQueue(),Ju.processQueue(this.renderContext),eo.currentRenderGeneration++,qh.get_playing()||this.set_crossFadeFrame(!1),this.renderContext.set_world(S),this.renderContext.set_view(x),this.renderContext.set_projection(T);var L=t.ss.now();L-this._lastUpdate>1e3&&(this._lastUpdate=L,this._frameCount=0,no.trianglesRendered=0,no.trianglesCulled=0),this.capturingVideo&&(null==this.dumpFrameParams||this.dumpFrameParams.waitDownload&&!A||(this.captureFrameForVideo(this._videoBlobReady,this.dumpFrameParams.width,this.dumpFrameParams.height,this.dumpFrameParams.format),Wo.nextFrame()),Wo.get_doneDumping()&&(Wo.frameDumping=!1,Wo.cancelFrameDump=!1,this.capturingVideo=!1))}},getCurrentReferenceFrame:function(){if(null==this.renderContext.get_backgroundImageset())return"Sun";if(!t.ss.emptyString(this.renderContext.get_backgroundImageset().get_referenceFrame()))return this.renderContext.get_backgroundImageset().get_referenceFrame();if(!this.renderContext.get_backgroundImageset().get_dataSetType())return"Earth";if("Visible Imagery"===this.renderContext.get_backgroundImageset().get_name()&&this.renderContext.get_backgroundImageset().get_url().toLowerCase().indexOf("mars")>-1)return this.renderContext.get_backgroundImageset().set_referenceFrame("Mars"),this.renderContext.get_backgroundImageset().get_referenceFrame();if(1===this.renderContext.get_backgroundImageset().get_dataSetType())for(var e=t.ss.enumerate(tc.solarSystemObjectsNames);e.moveNext();){var i=e.current;if(this.renderContext.get_backgroundImageset().get_name().toLowerCase().indexOf(i.toLowerCase())>-1)return this.renderContext.get_backgroundImageset().set_referenceFrame(i),i}return 2===this.renderContext.get_backgroundImageset().get_dataSetType()?"Sky":""},get_planetLike:function(){return null==this.renderContext.get_backgroundImageset()||!this.renderContext.get_backgroundImageset().get_dataSetType()||1===this.renderContext.get_backgroundImageset().get_dataSetType()},get_space:function(){return null==this.renderContext.get_backgroundImageset()||2===this.renderContext.get_backgroundImageset().get_dataSetType()},_drawSkyOverlays:function(){ko.get_active().get_showConstellationPictures()&&!this.freestandingMode&&Yo.drawArtwork(this.renderContext),ko.get_active().get_showConstellationFigures()&&(null==tc.constellationsFigures&&(tc.constellationsFigures=Yo.create("Constellations",zr.singleton.engineAssetUrl("figures.txt"),!1,!1,!1)),tc.constellationsFigures.draw(this.renderContext,!1,"UMA",!1)),ko.get_active().get_showEclipticGrid()&&(sl.drawEclipticGrid(this.renderContext,1,ko.get_active().get_eclipticGridColor()),ko.get_active().get_showEclipticGridText()&&sl.drawEclipticGridText(this.renderContext,1,ko.get_active().get_eclipticGridColor())),ko.get_active().get_showGalacticGrid()&&(sl.drawGalacticGrid(this.renderContext,1,ko.get_active().get_galacticGridColor()),ko.get_active().get_showGalacticGridText()&&sl.drawGalacticGridText(this.renderContext,1,ko.get_active().get_galacticGridColor())),ko.get_active().get_showAltAzGrid()&&(sl.drawAltAzGrid(this.renderContext,1,ko.get_active().get_altAzGridColor()),ko.get_active().get_showAltAzGridText()&&sl.drawAltAzGridText(this.renderContext,1,ko.get_active().get_altAzGridColor())),ko.get_active().get_showPrecessionChart()&&sl.drawPrecessionChart(this.renderContext,1,ko.get_active().get_precessionChartColor()),ko.get_active().get_showEcliptic()&&(sl.drawEcliptic(this.renderContext,1,ko.get_active().get_eclipticColor()),ko.get_active().get_showEclipticOverviewText()&&sl.drawEclipticText(this.renderContext,1,ko.get_active().get_eclipticColor())),ko.get_active().get_showGrid()&&(sl.drawEquitorialGrid(this.renderContext,1,ko.get_active().get_equatorialGridColor()),ko.get_active().get_showEquatorialGridText()&&sl.drawEquitorialGridText(this.renderContext,1,ko.get_active().get_equatorialGridColor())),ko.get_active().get_showConstellationBoundries()&&(null==tc.constellationsBoundries&&(tc.constellationsBoundries=Yo.create("Constellations",zr.singleton.engineAssetUrl("constellations.txt"),!0,!1,!1)),tc.constellationsBoundries.draw(this.renderContext,ko.get_active().get_showConstellationSelection(),this.constellation,!1)),ko.get_active().get_showConstellationLabels()&&Yo.drawConstellationNames(this.renderContext,1,Xi.get_yellow())},_drawHoverText:function(t){if(null==t.gl){var e=t.device;e.save(),e.fillStyle="White",e.font="15px Arial",e.fillText(this._hoverText,this._hoverTextPoint.x,this._hoverTextPoint.y),e.restore()}},rAtoViewLng:function(t){return(180-t/24*360-180+540)%360-180},_updateViewParameters:function(){if(this.renderContext.space&&this._tracking&&null!=this._trackingObject)if(ko.get_active().get_galacticMode()&&this.renderContext.space){var t=Qs.j2000toGalactic(15*this._trackingObject.get_RA(),this._trackingObject.get_dec());this.renderContext.targetAlt=this.renderContext.alt=t[1],this.renderContext.targetAz=this.renderContext.az=t[0]}else if(this.renderContext.space&&ko.get_active().get_localHorizonMode()){var e=Qs.equitorialToHorizon(Qs.fromRaDec(this._trackingObject.get_RA(),this._trackingObject.get_dec()),Wo.get_location(),Wo.get_now());this.renderContext.targetAlt=e.get_alt(),this.renderContext.targetAz=e.get_az()}else this.renderContext.viewCamera.lng=this.renderContext.targetCamera.lng=this.rAtoViewLng(this._trackingObject.get_RA()),this.renderContext.viewCamera.lat=this.renderContext.targetCamera.lat=this._trackingObject.get_dec();else this.get_solarSystemMode()||(this._tracking=!1,this._trackingObject=null);var i=1-.8;if(!this._tracking){var n=this.renderContext.viewCamera.zoom/4e3;this.renderContext.viewCamera.zoom>360&&(n=.009),this.renderContext.space&&(ko.get_active().get_localHorizonMode()||ko.get_active().get_galacticMode())?1==(Math.abs(this.renderContext.targetAlt-this.renderContext.alt)>=n|Math.abs(this.renderContext.targetAz-this.renderContext.az)>=n)&&(this.renderContext.alt+=(this.renderContext.targetAlt-this.renderContext.alt)/10,Math.abs(this.renderContext.targetAz-this.renderContext.az)>170?this.renderContext.targetAz>this.renderContext.az?this.renderContext.az+=(this.renderContext.targetAz-(360+this.renderContext.az))/10:this.renderContext.az+=(360+this.renderContext.targetAz-this.renderContext.az)/10:this.renderContext.az+=(this.renderContext.targetAz-this.renderContext.az)/10,this.renderContext.az=(this.renderContext.az+720)%360):1==(Math.abs(this.renderContext.targetCamera.lat-this.renderContext.viewCamera.lat)>=n|Math.abs(this.renderContext.targetCamera.lng-this.renderContext.viewCamera.lng)>=n)?(this.renderContext.viewCamera.lat+=(this.renderContext.targetCamera.lat-this.renderContext.viewCamera.lat)/10,Math.abs(this.renderContext.targetCamera.lng-this.renderContext.viewCamera.lng)>170?this.renderContext.targetCamera.lng>this.renderContext.viewCamera.lng?this.renderContext.viewCamera.lng+=(this.renderContext.targetCamera.lng-(360+this.renderContext.viewCamera.lng))/10:this.renderContext.viewCamera.lng+=(360+this.renderContext.targetCamera.lng-this.renderContext.viewCamera.lng)/10:this.renderContext.viewCamera.lng+=(this.renderContext.targetCamera.lng-this.renderContext.viewCamera.lng)/10,this.renderContext.viewCamera.lng=(this.renderContext.viewCamera.lng+720)%360):this.renderContext.viewCamera.lat===this.renderContext.targetCamera.lat&&this.renderContext.viewCamera.lng===this.renderContext.targetCamera.lng||(this.renderContext.viewCamera.lat=this.renderContext.targetCamera.lat,this.renderContext.viewCamera.lng=this.renderContext.targetCamera.lng)}this.renderContext.viewCamera.zoom=.8*this.renderContext.viewCamera.zoom+i*this.renderContext.targetCamera.zoom,this.renderContext.viewCamera.rotation=.8*this.renderContext.viewCamera.rotation+i*this.renderContext.targetCamera.rotation,this.renderContext.viewCamera.angle=.8*this.renderContext.viewCamera.angle+i*this.renderContext.targetCamera.angle},move:function(t,e){var i=Math.atan2(e,t),n=Math.sqrt(t*t+e*e);this.get_solarSystemMode()||this.get_planetLike()?(t=Math.cos(i+this.renderContext.viewCamera.rotation)*n,e=Math.sin(i+this.renderContext.viewCamera.rotation)*n):(t=Math.cos(i-this.renderContext.viewCamera.rotation)*n,e=Math.sin(i-this.renderContext.viewCamera.rotation)*n);var r=this.renderContext.get_fovScale()/3600;this.renderContext.get_backgroundImageset().get_dataSetType()==To.solarSystem&&(r=.06);var s=r/Math.max(.2,Math.cos(this.renderContext.viewCamera.lat/180*Math.PI));this.renderContext.get_backgroundImageset().get_dataSetType()&&1!==this.renderContext.get_backgroundImageset().get_dataSetType()&&this.renderContext.get_backgroundImageset().get_dataSetType()!=To.solarSystem||(s*=6.3,r*=6.3),this.renderContext.space&&(ko.get_active().get_galacticMode()||ko.get_active().get_localHorizonMode())?(t=ko.get_active().get_localHorizonMode()?-t:t,this.renderContext.targetAz+=t*s,this.renderContext.targetAz=(this.renderContext.targetAz+720)%360,this.renderContext.targetAlt+=e*r,this.renderContext.targetAlt>90&&(this.renderContext.targetAlt=90),this.renderContext.targetAlt<-90&&(this.renderContext.targetAlt=-90)):(this.renderContext.targetCamera.lng-=t*s,this.renderContext.targetCamera.lng=(this.renderContext.targetCamera.lng+720)%360,this.renderContext.targetCamera.lat+=e*r,this.renderContext.targetCamera.lat>90&&(this.renderContext.targetCamera.lat=90),this.renderContext.targetCamera.lat<-90&&(this.renderContext.targetCamera.lat=-90)),ko.get_globalSettings().get_smoothPan()||(this.renderContext.viewCamera=this.renderContext.targetCamera.copy()),t&&e&&(this._tracking=!1,this._trackingObject=null)},zoom:function(t){this.renderContext.targetCamera.zoom*=t,this.renderContext.targetCamera.zoom>this.get_zoomMax()&&(this.renderContext.targetCamera.zoom=this.get_zoomMax()),ko.get_globalSettings().get_smoothPan()||(this.renderContext.viewCamera=this.renderContext.targetCamera.copy())},roll:function(t){this.renderContext.targetCamera.rotation+=t},onGestureStart:function(t){this._mouseDown=!1,this._beginZoom=this.renderContext.viewCamera.zoom},onGestureChange:function(t){var e=t;this._mouseDown=!1,this.renderContext.targetCamera.zoom=this.renderContext.viewCamera.zoom=Math.min(360,this._beginZoom*(1/e.scale))},onGestureEnd:function(t){this._mouseDown=!1},onTouchStart:function(t){var e=t;if(e.preventDefault(),e.stopPropagation(),this._lastX=e.targetTouches[0].pageX,this._lastY=e.targetTouches[0].pageY,2!==e.targetTouches.length){if(null!=this.uiController){var i=new rc(this._lastX,this._lastY);if(this.uiController.mouseDown(this,i))return this._mouseDown=!1,void(this._dragging=!1)}this._mouseDown=!0}else this._hasTwoTouches=!0},onTouchMove:function(t){var e=t;if(this._hasTwoTouches){var i=e.touches[0],n=e.touches[1],r=new Array(2);if(r[0]=vn.create(i.pageX,i.pageY),r[1]=vn.create(n.pageX,n.pageY),null!=this._pinchingZoomRect[0]&&null!=this._pinchingZoomRect[1]){var s=vn.create(this.renderContext.width/2,this.renderContext.height/2),a=vn.subtract(r[0],this._pinchingZoomRect[0]),o=vn.subtract(r[1],this._pinchingZoomRect[1]),l=vn.subtract(this._pinchingZoomRect[0],s),h=vn.subtract(this._pinchingZoomRect[1],s);l.normalize(),h.normalize();var u=a.x*l.x+a.y*l.y,c=o.x*h.x+o.y*h.y,_=vn.create(u*l.x,u*l.y),d=vn.create(c*h.x,c*h.y),g=vn.subtract(a,_),f=vn.subtract(o,d);if(_.get_length()+d.get_length()>=g.get_length()+f.get_length()){var m=this.getDistance(this._pinchingZoomRect[0],this._pinchingZoomRect[1])/this.getDistance(r[0],r[1]);this.zoom(m)}else{var p=vn.subtract(this._pinchingZoomRect[0],s),w=vn.subtract(this._pinchingZoomRect[1],s),b=vn.subtract(r[0],s),v=vn.subtract(r[1],s),y=this.crossProductZ(p,b),S=this.crossProductZ(w,v),x=Math.asin(y/(p.get_length()*b.get_length())),T=Math.asin(S/(w.get_length()*v.get_length()));if(x*T>=0){var M=x+T;(this.get_planetLike()||this.get_solarSystemMode())&&(M*=-1),this.roll(M)}}}return this._pinchingZoomRect=r,e.stopPropagation(),void e.preventDefault()}if(e.preventDefault(),e.stopPropagation(),this._mouseDown){this._dragging=!0;var C=e.targetTouches[0].pageX-this._lastX,A=e.targetTouches[0].pageY-this._lastY;this.move(C,A),this._lastX=e.targetTouches[0].pageX,this._lastY=e.targetTouches[0].pageY}else if(null!=this.uiController&&this.uiController.mouseMove(this,t))return t.preventDefault(),void t.stopPropagation()},onTouchEnd:function(t){var e=t;if(e.preventDefault(),e.stopPropagation(),this._pinchingZoomRect[0]=null,this._pinchingZoomRect[1]=null,this._hasTwoTouches)e.touches.length<2&&(this._hasTwoTouches=!1);else{if(null!=this.uiController){var i=new rc(this._lastX,this._lastY);if(this.uiController.mouseUp(this,i))return this._mouseDown=!1,void(this._dragging=!1)}this._mouseDown=!1,this._dragging=!1}},onPointerDown:function(t){var e=t,i=0,n=arguments[0],r=arguments[0].target;if(r.setPointerCapture?r.setPointerCapture(n.pointerId):r.msSetPointerCapture&&r.msSetPointerCapture(n.pointerId),this._pointerIds[0]===e.pointerId)i=0;else if(this._pointerIds[1]===e.pointerId)i=1;else if(this._pointerIds[0]){if(this._pointerIds[1])return;i=1}else i=0;this._pointerIds[i]=e.pointerId,this._pinchingZoomRect[i]=vn.create(t.offsetX,t.offsetY)},onPointerMove:function(t){var e=t,i=0;if(this._pointerIds[0]===e.pointerId)i=0;else{if(this._pointerIds[1]!==e.pointerId)return;i=1}if(null!=this._pinchingZoomRect[0]&&null!=this._pinchingZoomRect[1]){var n=this.getDistance(this._pinchingZoomRect[0],this._pinchingZoomRect[1]),r=vn.create(t.offsetX,t.offsetY),s=n/this.getDistance(r,this._pinchingZoomRect[0]),a=Math.abs(Math.log(s));isFinite(a)||(a=1e3);var o=n/this.getDistance(r,this._pinchingZoomRect[1]),l=Math.abs(Math.log(o));isFinite(l)||(l=1e3),l<a?(this._pinchingZoomRect[0]=r,this.zoom(o)):(this._pinchingZoomRect[1]=r,this.zoom(s))}else this._pinchingZoomRect[i]=vn.create(t.offsetX,t.offsetY);t.stopPropagation(),t.preventDefault()},onPointerUp:function(t){var e=t;this._pointerIds[0]===e.pointerId&&(this._pointerIds[0]=-2,this._pinchingZoomRect[0]=null),this._pointerIds[1]===e.pointerId&&(this._pointerIds[1]=-2,this._pinchingZoomRect[1]=null)},onMouseDown:function(e){document.addEventListener("mousemove",t.ss.bind("onMouseMove",this),!1),document.addEventListener("mouseup",t.ss.bind("onMouseUp",this),!1),null!=this.uiController&&this.uiController.mouseDown(this,e)||(this._mouseDown=!0,this._lastX=ki.offsetX(this.canvas,e),this._lastY=ki.offsetY(this.canvas,e))},onMouseMove:function(e){if(this._lastMouseMove=t.ss.now(),this._hoverTextPoint=vn.create(ki.offsetX(this.canvas,e),ki.offsetY(this.canvas,e)),this._hoverText="",this._mouseDown)e.preventDefault(),e.stopPropagation(),this._moved=!0,e.ctrlKey?this._tilt(ki.offsetX(this.canvas,e)-this._lastX,ki.offsetY(this.canvas,e)-this._lastY):this.move(ki.offsetX(this.canvas,e)-this._lastX,ki.offsetY(this.canvas,e)-this._lastY),this._lastX=ki.offsetX(this.canvas,e),this._lastY=ki.offsetY(this.canvas,e);else if(null!=this.uiController&&this.uiController.mouseMove(this,e))return e.preventDefault(),void e.stopPropagation()},onMouseUp:function(e){if(document.removeEventListener("mousemove",t.ss.bind("onMouseMove",this),!1),document.removeEventListener("mouseup",t.ss.bind("onMouseUp",this),!1),null!=this.uiController&&this.uiController.mouseUp(this,e))return this._mouseDown=!1,void e.preventDefault();if(this._mouseDown&&!this._moved){var i=this.getCoordinatesForScreenPoint(ki.offsetX(this.canvas,e),ki.offsetY(this.canvas,e));this._annotationclicked(i.x,i.y,ki.offsetX(this.canvas,e),ki.offsetY(this.canvas,e))||Pr._fireClick(i.x,i.y)}this._mouseDown=!1,this._moved=!1},onMouseWheel:function(t){var e=t;(e.deltaY?-e.deltaY:e.detail?-1*e.detail:e.wheelDelta)>0?this.zoom(.9):this.zoom(1.1),t.stopPropagation(),t.preventDefault()},onDoubleClick:function(t){tc.showDataLayers=!0},onKeyDown:function(t){null!=this.uiController&&this.uiController.keyDown(this,t)},getDistance:function(t,e){var i,n;return i=t.x-e.x,n=t.y-e.y,Math.sqrt(i*i+n*n)},crossProductZ:function(t,e){return t.x*e.y-t.y*e.x},onContextMenu:function(t){t.preventDefault(),t.stopPropagation()},_tilt:function(t,e){this.renderContext.targetCamera.rotation+=.001*t,this.renderContext.targetCamera.angle+=.001*e,this.renderContext.targetCamera.angle<-1.52&&(this.renderContext.targetCamera.angle=-1.52),this.renderContext.targetCamera.angle>0&&(this.renderContext.targetCamera.angle=0)},getCoordinatesForScreenPoint:function(t,e){var i=vn.create(t,e),n=this.transformPickPointToWorldSpace(i,this.renderContext.width,this.renderContext.height);return Qs.cartesianToSphericalSky(n)},transformPickPointToWorldSpace:function(t,e,i){var n=new wn;if(null!=this.renderContext.get_projection()){var r=new wn;r.x=(2*t.x/e-1)/this.renderContext.get_projection().get_m11(),r.y=(2*t.y/i-1)/this.renderContext.get_projection().get_m22(),r.z=1;var s=yn.multiplyMatrix(this.renderContext.get_view(),this.renderContext.get_world());s.invert(),n.x=r.x*s.get_m11()+r.y*s.get_m21()+r.z*s.get_m31(),n.y=r.x*s.get_m12()+r.y*s.get_m22()+r.z*s.get_m32(),n.z=r.x*s.get_m13()+r.y*s.get_m23()+r.z*s.get_m33(),n.normalize()}return n},transformWorldPointToPickSpace:function(t,e,i){var n=yn.multiplyMatrix(this.renderContext.get_view(),this.renderContext.get_world());n.invert();var r=new vn,s=t.x*n.get_m31()+t.y*n.get_m32()+t.z*n.get_m33(),a=(t.x*n.get_m11()+t.y*n.get_m12()+t.z*n.get_m13())/s,o=(t.x*n.get_m21()+t.y*n.get_m22()+t.z*n.get_m23())/s;return r.x=Math.round((1+this.renderContext.get_projection().get_m11()*a)*(e/2)),r.y=Math.round((1+this.renderContext.get_projection().get_m22()*o)*(i/2)),r},getScreenPointForCoordinates:function(t,e){var i=vn.create(t,e),n=Qs.sphericalSkyToCartesian(i);return this.transformWorldPointToPickSpace(n,this.renderContext.width,this.renderContext.height)},setup:function(e,i,n,r){var s=this;window.addEventListener("contextmenu",t.ss.bind("onContextMenu",this),!1),document.body.addEventListener("keydown",t.ss.bind("onKeyDown",this),!1),e.addEventListener("dblclick",t.ss.bind("onDoubleClick",this),!1),e.addEventListener("mousedown",t.ss.bind("onMouseDown",this),!1),e.addEventListener("wheel",t.ss.bind("onMouseWheel",this),!1),e.addEventListener("mousewheel",t.ss.bind("onMouseWheel",this),!1),e.addEventListener("DOMMouseScroll",t.ss.bind("onMouseWheel",this),!1),e.addEventListener("touchstart",t.ss.bind("onTouchStart",this),!1),e.addEventListener("touchmove",t.ss.bind("onTouchMove",this),!1),e.addEventListener("touchend",t.ss.bind("onTouchEnd",this),!1),e.addEventListener("gesturechange",t.ss.bind("onGestureChange",this),!1),e.addEventListener("gesturestart",t.ss.bind("onGestureStart",this),!1),e.addEventListener("gestureend",t.ss.bind("onGestureEnd",this),!1),e.addEventListener("pointerdown",t.ss.bind("onPointerDown",this),!1),e.addEventListener("pointermove",t.ss.bind("onPointerMove",this),!1),e.addEventListener("pointerup",t.ss.bind("onPointerUp",this),!1),this.renderContext.viewCamera.lat=i,this.renderContext.viewCamera.lng=n,this.renderContext.viewCamera.zoom=r,this.renderContext.targetCamera=this.renderContext.viewCamera.copy(),null==this.renderContext.gl&&(this._foregroundCanvas=document.createElement("canvas"),this._foregroundCanvas.width=e.width,this._foregroundCanvas.height=e.height,this._fgDevice=this._foregroundCanvas.getContext("2d")),this.freestandingMode?setTimeout((function(){s._setupComplete()}),0):Fr(zr.singleton.coreDynamicUrl("wwtweb/catalog.aspx?X=ImageSets6"),t.ss.bind("_setupComplete",this),!0)},_setupComplete:function(){Pr._fireReady()},gotoRADecZoom:function(t,e,i,n,r){this._tracking=!1,this._trackingObject=null,this.gotoTargetFull(!1,n,this._cameraParametersFromRADecZoom(t,e,i,r),an.get_foregroundImageset(),an.get_backgroundImageset())},_cameraParametersFromRADecZoom:function(t,e,i,n){for(;t>24;)t-=24;for(;t<0;)t+=24;e=Tn.clamp(e,-90,90),i=Tn.clamp(i,this.get_zoomMin(),this.get_zoomMax());var r=null==n?an.viewCamera.rotation:n;return Aa.create(e,an.rAtoViewLng(t),i,r,an.viewCamera.angle,an.viewCamera.opacity)},timeToRADecZoom:function(t,e,i,n){var r=this._cameraParametersFromRADecZoom(t,e,i,n);return this.timeToTargetFull(r,!1)},get_solarSystemMode:function(){return null!=this.renderContext.get_backgroundImageset()&&this.renderContext.get_backgroundImageset().get_dataSetType()==To.solarSystem},gotoTarget:function(e,i,n,r){if(null!=e){if(r&&this.get_solarSystemMode()&&(536870912===e.get_classification()&&4!==e.get_type()||1===e.get_classification()||1048576===e.get_classification()&&e.get_distance()>0)){var s=65536;if(1===e.get_classification()||1048576===e.get_classification())s=20;else try{s=65536!==e.get_target()?e.get_target():Jo.getPlanetIDFromName(e.get_name())}catch(t){}if(65536!==s){if(this._trackingObject=e,s===this._solarSystemTrack&&1!==e.get_classification()&&1048576!==e.get_classification())return void this.gotoTarget3(e.get_camParams(),i,n);var a=4;20===s?a=17:a+=13*(101-ko.get_active().get_solarSystemScale())/100,n&&(a=1);var o=this.renderContext.viewCamera.copy();o.targetReferenceFrame="",o.target=s;var l=10;if(20===s){l=e.get_classification()===Qo.galaxy?1404946007758:6323967.17;var h=Qs.raDecTo3dAu(e.get_RA(),e.get_dec(),e.get_distance()),u=Qs.meanObliquityOfEcliptic(Wo.get_jNow())/180*Math.PI;h.rotateX(u),o.viewTarget=wn.negate(o.viewTarget)}else{switch(o.viewTarget=Jo.getPlanet3dLocationJD(s,Wo.getJNowForFutureTime(a)),s){case 0:l=.6;break;case 1:case 2:case 3:case 8:case 9:case 10:case 11:case 12:case 13:case 19:l=4e-4;break;case 4:case 5:l=.007;break;case 6:case 7:l=.004;break;case 20:l=10}l*=ko.get_active().get_solarSystemScale()}var c=this.renderContext.viewCamera.copy();20!==this._solarSystemTrack||t.ss.emptyString(this.renderContext.get_trackingFrame())||(c=this.renderContext.customTrackingParams,this.renderContext.set_trackingFrame("")),o.zoom=l;var _=o.viewTarget;if(_.subtract(c.viewTarget),1===e.get_classification()&&(_=wn.negate(_)),_.length()){var d=_.toRaDec();o.lat=20===s?-d.y:d.y,o.lng=15*d.x-90}else o.lat=this.renderContext.viewCamera.lat,o.lng=this.renderContext.viewCamera.lng;s!==Ma.custom&&(o.viewTarget=Jo.getPlanetTargetPoint(s,o.lat,o.lng,Wo.getJNowForFutureTime(a)));var g=new cl(c,o,a,Wo.get_now(),Wo.getTimeForFutureTime(a),3);return g.fastDirectionMove=!0,void this.set__mover(g)}}this._tracking=!1,this._trackingObject=null;var f=e.get_camParams().copy();null!=this.renderContext.get_backgroundImageset()&&e.get_type()!==this.renderContext.get_backgroundImageset().get_dataSetType()?(this.renderContext.targetCamera=e.get_camParams().copy(),this.renderContext.viewCamera=this.renderContext.targetCamera.copy(),this.renderContext.set_backgroundImageset(this.getDefaultImageset(e.get_type(),3)),n=!0):this.get_solarSystemMode()&&e.get_target()!==this._solarSystemTrack&&(this.renderContext.targetCamera=e.get_camParams().copy(),this.renderContext.viewCamera=this.renderContext.targetCamera.copy(),this._solarSystemTrack=e.get_target(),n=!0),128===e.get_classification()?(f.zoom=this.get_zoomMax(),this.gotoTargetFull(!1,n,f,null,null)):(this._solarSystemTrack=e.get_target(),this.gotoTargetFull(i,n,f,e.get_studyImageset(),e.get_backgroundImageset()),r&&(this._tracking=!0,this._trackingObject=e))}},gotoTarget3:function(t,e,i){this._tracking=!1,this._trackingObject=null,this.gotoTargetFull(e,i,t,this.renderContext.get_foregroundImageset(),this.renderContext.get_backgroundImageset())},_tooCloseForSlewMove:function(t){return Math.abs(this.renderContext.viewCamera.lat-t.lat)<1e-12&&Math.abs(this.renderContext.viewCamera.lng-t.lng)<1e-12&&Math.abs(this.renderContext.viewCamera.zoom-t.zoom)<1e-12&&Math.abs(this.renderContext.viewCamera.rotation-t.rotation)<1e-12},gotoTargetFull:function(e,i,n,r,s){if(this._tracking=!1,this._trackingObject=null,this._targetStudyImageset=r,this._targetBackgroundImageset=s,e?(n.zoom=this.renderContext.viewCamera.zoom,n.angle=this.renderContext.viewCamera.angle,n.rotation=this.renderContext.viewCamera.rotation):-1!==n.zoom&&n.zoom||(this.renderContext.space?n.zoom=1.40625:n.zoom=.09),i||this._tooCloseForSlewMove(n)){if(this.set__mover(null),this.renderContext.targetCamera=n.copy(),this.renderContext.viewCamera=this.renderContext.targetCamera.copy(),this.renderContext.space&&ko.get_active().get_galacticMode()){var a=Qs.j2000toGalactic(15*this.renderContext.viewCamera.get_RA(),this.renderContext.viewCamera.get_dec());this.renderContext.targetAlt=this.renderContext.alt=a[1],this.renderContext.targetAz=this.renderContext.az=a[0]}else if(this.renderContext.space&&ko.get_active().get_localHorizonMode()){var o=Qs.equitorialToHorizon(Qs.fromRaDec(this.renderContext.viewCamera.get_RA(),this.renderContext.viewCamera.get_dec()),Wo.get_location(),Wo.get_now());this.renderContext.targetAlt=this.renderContext.alt=o.get_alt(),this.renderContext.targetAz=this.renderContext.az=o.get_az()}this._mover_Midpoint()}else this.set__mover(dl.create(this.renderContext.viewCamera,n)),this.get__mover().set_midpoint(t.ss.bind("_mover_Midpoint",this))},_slewTimeBetweenTargets:function(t,e){return dl.create(t,e).get_moveTime()},timeToTargetFull:function(t,e){return e&&(t.zoom=this.renderContext.viewCamera.zoom,t.angle=this.renderContext.viewCamera.angle,t.rotation=this.renderContext.viewCamera.rotation),this._tooCloseForSlewMove(t)?0:this._slewTimeBetweenTargets(an.viewCamera,t)},_freezeView:function(){this.renderContext.viewCamera=this.renderContext.targetCamera.copy(),this.set__mover(null)},get__mover:function(){return this.renderContext.viewMover},set__mover:function(t){return this.renderContext.viewMover=t,t},fadeInImageSet:function(t){null!=this.renderContext.get_backgroundImageset()&&t.get_dataSetType()!==this.renderContext.get_backgroundImageset().get_dataSetType()&&(Ju.purgeQueue(),Ju.clearCache()),this.renderContext.set_backgroundImageset(t)},_mover_Midpoint:function(){(null!=this._targetStudyImageset&&null==this.renderContext.get_foregroundImageset()||null!=this.renderContext.get_foregroundImageset()&&!this.renderContext.get_foregroundImageset().equals(this._targetStudyImageset))&&this.renderContext.set_foregroundImageset(this._targetStudyImageset),null==this.renderContext.get_backgroundImageset()||null==this._targetBackgroundImageset||this.renderContext.get_backgroundImageset().equals(this._targetBackgroundImageset)||(null!=this._targetBackgroundImageset&&this._targetBackgroundImageset.get_generic()?this.fadeInImageSet(this._getRealImagesetFromGeneric(this._targetBackgroundImageset)):this.fadeInImageSet(this._targetBackgroundImageset))},getDefaultImageset:function(e,i){for(var n=t.ss.enumerate(tc.imageSets);n.moveNext();)if((a=n.current).get_defaultSet()&&a.get_bandPass()===i&&a.get_dataSetType()===e)return a;for(var r=t.ss.enumerate(tc.imageSets);r.moveNext();)if((a=r.current).get_bandPass()===i&&a.get_dataSetType()===e)return a;for(var s=t.ss.enumerate(tc.imageSets);s.moveNext();){var a;if((a=s.current).get_dataSetType()===e)return a}return tc.imageSets[0]},_getRealImagesetFromGeneric:function(e){for(var i=t.ss.enumerate(tc.imageSets);i.moveNext();)if((r=i.current).get_defaultSet()&&r.get_bandPass()===e.get_bandPass()&&r.get_dataSetType()===e.get_dataSetType())return r;for(var n=t.ss.enumerate(tc.imageSets);n.moveNext();){var r;if((r=n.current).get_bandPass()===e.get_bandPass()&&r.get_dataSetType()===e.get_dataSetType())return r}return tc.imageSets[0]},_hideUI:function(t){},createTour:function(e){return t.ss.canCast(this.uiController,qh)&&this.uiController.stop(!1),this.tour=new Lu,this.tour.set_title(e),this.setupTour(),this.tour.set_editMode(!0),this.tour},setupTour:function(){this.tourEdit=new ku,this.tourEdit.set_tour(this.tour),this.tour.set_currentTourstopIndex(0),this.tour.set_editMode(!1),this.uiController=this.tourEdit.tourEditorUI},loadTour:function(e){var i=this;t.ss.canCast(this.uiController,qh)&&this.uiController.stop(!1),this.tour=Lu.fromUrl(e,(function(){i.setupTour();var t=new qh;t.set_tour(i.tour),kr.uiController=t,Pr._fireTourReady()}))},playTour:function(e){var i=this;t.ss.canCast(this.uiController,qh)&&this.uiController.stop(!1),this.tour=Lu.fromUrl(e,(function(){i.setupTour(),i.tourEdit.playNow(!0),Pr._fireTourReady()}))},playCurrentTour:function(){t.ss.canCast(this.uiController,qh)&&this.uiController.play()},pauseCurrentTour:function(){t.ss.canCast(this.uiController,qh)&&this.uiController.pauseTour()},stopCurrentTour:function(){t.ss.canCast(this.uiController,qh)&&this.uiController.stop(!1)},_closeTour:function(){},getImagesetByName:function(e){for(var i=t.ss.enumerate(tc.imageSets);i.moveNext();){var n=i.current;if(n.get_name().toLowerCase().indexOf(e.toLowerCase())>-1)return n}return null},getImageSetByUrl:function(e){for(var i=t.ss.enumerate(tc.imageSets);i.moveNext();){var n=i.current;if(n.get_url()===e)return n}return null},setBackgroundImageByName:function(t){var e=this.getImagesetByName(t);null!=e&&this.renderContext.set_backgroundImageset(e)},setForegroundImageByName:function(t){var e=this.getImagesetByName(t);null!=e&&this.renderContext.set_foregroundImageset(e)},addCatalogHips:function(t){this.renderContext.addCatalogHips(t,null)},addCatalogHipsByName:function(t){this.addCatalogHipsByNameWithCallback(t,null)},addCatalogHipsByNameWithCallback:function(t,e){var i=this.getImagesetByName(t);null!=i&&this.renderContext.addCatalogHips(i,e)},removeCatalogHipsByName:function(t){var e=this.getImagesetByName(t);null!=e&&this.renderContext.removeCatalogHips(e)},getCatalogHipsByName:function(t){return this.renderContext.getCatalogHipsByName(t)},getCatalogHipsDataInView:function(t,e,i){var n=this.getImagesetByName(t);null!=n&&this.renderContext.getCatalogHipsDataInView(n,e,i)},setCutsForFits:function(t,e,i){var n=this.getImagesetByName(t);null!=n&&null!=n.get_fitsProperties()?(n.get_fitsProperties().lowerCut=e,n.get_fitsProperties().upperCut=i):console.log(t+" not found")},setColorMapForFits:function(t,e){var i=this.getImagesetByName(t);null!=i&&null!=i.get_fitsProperties()?i.get_fitsProperties().colorMapName=e:console.log(t+" not found")},setScaleTypeForFits:function(t,e){var i=this.getImagesetByName(t);null!=i&&null!=i.get_fitsProperties()?i.get_fitsProperties().scaleType=e:console.log(t+" not found")},_drawCrosshairs:function(t){if(null==t.gl){var e=t.device;e.save(),e.beginPath(),e.strokeStyle=ko.get_current().get_crosshairsColor(),e.lineWidth=2;var i=t.width/2,n=t.height/2;e.moveTo(i,n+5),e.lineTo(i,n-5),e.moveTo(i+5,n),e.lineTo(i-5,n),e.stroke(),e.restore()}else{if(null==this._crossHairs){var r=.03*t.height/t.width;this._crossHairs=new Is,this._crossHairs.set_depthBuffered(!1),this._crossHairs.pure2D=!0,this._crossHairs.addLine(wn.create(-r,0,0),wn.create(r,0,0)),this._crossHairs.addLine(wn.create(0,-.03,0),wn.create(0,.03,0))}this._crossHairs.drawLines(t,1,Oi.load(ko.get_current().get_crosshairsColor()))}},captureThumbnail:function(t){this.captureFrame(t,96,45,"image/jpeg",!0)},captureCurrentFrame:function(t,e,i,n){this.captureFrame(t,e,i,n,!1)},captureFrameForVideo:function(e,i,n,r){var s=this,a=Wo.currentFrameNumber;this.captureCurrentFrame((function(i){var n;if(a===s._videoQueueIndex)for(e(i),s._videoQueueIndex+=1;(n=t.ss.keyExists(s._videoBlobQueue,s._videoQueueIndex))||s._emptyFrames.indexOf(s._videoQueueIndex)>=0;)n?(e(s._videoBlobQueue[s._videoQueueIndex]),s._videoBlobQueue[s._videoQueueIndex]=null):t.ss.remove(s._emptyFrames,s._videoQueueIndex),s._videoQueueIndex+=1;else null!=i?s._videoBlobQueue[a]=i:s._emptyFrames.push(a);s._videoQueueIndex>=Wo.totalFrames&&(s._videoBlobReady=null,s._videoBlobQueue=null,s._videoQueueIndex=0,s._emptyFrames.length=0)}),i,n,r)},captureFrame:function(e,i,n,r,s){s&&this.renderOneFrame();var a=document.createElement("img");a.addEventListener("load",(function(s){var o=a.width/a.height,l=i,h=n;o<i/n?h=t.ss.truncate(l/o):l=t.ss.truncate(h*o);var u=(i-l)/2,c=(n-h)/2,_=document.createElement("canvas");if(_.height=n,_.width=i,_.getContext("2d").drawImage(a,u,c,l,h),"function"==typeof _.msToBlob){var d=_.msToBlob();e(d)}else _.toBlob(e,r)}),!1),a.src=kr.canvas.toDataURL()},clampZooms:function(t){t.viewCamera.zoom=Tn.clamp(t.viewCamera.zoom,this.get_zoomMin(),this.get_zoomMax()),t.targetCamera.zoom=Tn.clamp(t.targetCamera.zoom,this.get_zoomMin(),this.get_zoomMax())}};function ic(t){this._divId=null,this._startRenderLoop=!1,this._startLat=0,this._startLng=0,this._startZoom=360,this._freestandingAssetBaseurl="",this._startMode="",this._divId=t}n("WWTControl",[tc,ec,null]);var nc={startRenderLoop:function(t){this._startRenderLoop=t},initialView:function(t,e,i){this._startLat=t,this._startLng=e,this._startZoom=i},freestandingMode:function(t){this._freestandingAssetBaseurl=t},initialMode:function(t){this._startMode=t},create:function(){var t,e=!!this._freestandingAssetBaseurl;return t=this._startMode?this._startMode:e?"black":"sky",Cr(e),e&&zr.singleton.overrideAssetBaseurl(this._freestandingAssetBaseurl),tc.initControl6(this._divId,this._startRenderLoop,this._startLat,this._startLng,this._startZoom,t)}};function rc(t,e){this.offsetX=0,this.offsetY=0,this.offsetX=t,this.offsetY=e}function sc(t,e){this.loadChildFolders=!1,this._numLoadingFolders=0,this._onComplete=t,this.loadChildFolders=e}function ac(){}function oc(){}n("WWTControlBuilder",[ic,nc,null]),n("WWTElementEvent",[rc,{},null]),n("FolderDownloadAction",[sc,{_folderLoaded:function(){this._numLoadingFolders--,this._numLoadingFolders||this._onComplete()},startingNewFolderLoad:function(t){var e=this;this._numLoadingFolders++,t.childLoadCallback((function(){ac.loadImagesets(t,e),e._folderLoaded()}))}},null]),ac.getWtmlFile=function(t,e,i){null==i&&(i=!1);var n=new Fu;return n.set_url(t),new sc(e,i).startingNewFolderLoad(n),n},function(t){Fr=t}(ac.getWtmlFile),ac.loadImagesets=function(e,i){for(var n=e.get_children(),r=t.ss.enumerate(n);r.moveNext();){var s=r.current;if(t.ss.canCast(s,Co)){var a=s;tc.addImageSetToRepository(a)}if(t.ss.canCast(s,tl)){var o=s;null!=o.get_studyImageset()&&tc.addImageSetToRepository(o.get_studyImageset()),null!=o.get_backgroundImageset()&&tc.addImageSetToRepository(o.get_backgroundImageset())}t.ss.canCast(s,Fu)&&i.loadChildFolders&&i.startingNewFolderLoad(s)}if(!t.ss.emptyString(tc.imageSetName))for(var l=tc.imageSetName.toLowerCase(),h=t.ss.enumerate(tc.getImageSets());h.moveNext();){var u=h.current;u.get_name().toLowerCase()===l&&an.set_backgroundImageset(u)}},n("Wtml",[ac,{},null]),n("GFX",[oc,null,null]),tc.exploreRoot=new Fu,tc.singleton=new tc,tc.singleton.renderContext=new Gu,function(t){kr=t}(tc.singleton),function(t){an=t}(tc.singleton.renderContext),Wo._metaNow=t.ss.now(),Wo._now=t.ss.now(),Wo.last=Wo.get_metaNow(),Wo.updateClock(),al.baseDate=t.ss.truncate(Wo.utcToJulian(t.ss.now()))})(),__webpack_exports__})()));